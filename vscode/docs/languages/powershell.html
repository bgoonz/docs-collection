<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>powershell</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="powershell-in-visual-studio-code">PowerShell in Visual Studio Code</h1>
<p><a href="https://docs.microsoft.com/powershell/">PowerShell</a> is a task-based command-line shell and scripting language built on <a href="https://docs.microsoft.com/dotnet">.NET</a>, which provides a powerful toolset for administrators on any platform.</p>
<p>The Microsoft <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell">PowerShell</a> extension for Visual Studio Code provides rich language support and capabilities such as completions, definition tracking, and linting analysis for PowerShell versions 3, 4, 5, and 5.1 as well as all versions of <a href="https://docs.microsoft.com/powershell/scripting/whats-new/what-s-new-in-powershell-core-60">PowerShell Core</a>.</p>
<h2 id="install-the-powershell-extension">Install the PowerShell extension</h2>
<p>The official PowerShell extension can be installed by following the steps described in the <a href="/docs/editor/extension-marketplace.md">Visual Studio Code User Guide</a> or by going directly to the Visual Studio Code Marketplace and clicking the <a href="vscode:extension/ms-vscode.PowerShell">Install Button</a>.</p>
<p>You can also install the PowerShell extension from within Visual Studio Code by opening the Extensions view with keyboard shortcut <code>kb(workbench.view.extensions)</code> and typing “PowerShell” and select the PowerShell extension:</p>
<figure>
<img src="images/powershell/PowerShellExtension.png" alt="PowerShell extension" /><figcaption>PowerShell extension</figcaption>
</figure>
<h2 id="install-from-the-command-line">Install from the command line</h2>
<p>Alternatively, the PowerShell extension can be installed from any command line (including PowerShell, Cmd, bash) on all platforms using the following command</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">code</span> --install-extension ms-vscode.powershell</a></code></pre></div>
<p>If you are running VS Code <a href="/insiders">Insiders</a>, you will need this command instead:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="ex">code-insiders</span> --install-extension ms-vscode.powershell</a></code></pre></div>
<h2 id="example-scripts">Example scripts</h2>
<p>Example scripts are included with the extension and can be found at the following path.</p>
<pre><code>C:\Users\&lt;yourusername&gt;\.vscode\extensions\ms-vscode.PowerShell-&lt;version&gt;\examples</code></pre>
<p>To open or view the examples in Visual Studio Code, run the following from your PowerShell command prompt:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="ex">code</span> (Get-ChildItem <span class="va">$Home</span>\.vscode\extensions\ms-vscode.PowerShell-*\examples)[<span class="ex">-1</span>]</a></code></pre></div>
<p>If using the <a href="/insiders">Insiders</a> edition:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="ex">code-insiders</span> (Get-ChildItem <span class="va">$Home</span>\.vscode-insiders\extensions\ms-vscode.PowerShell-*\examples)[<span class="ex">-1</span>]</a></code></pre></div>
<p>You can also open the examples from the Command Palette (<code>kb(workbench.action.showCommands)</code>) with the <strong>PowerShell: Open Examples Folder</strong> command.</p>
<figure>
<img src="images/powershell/pwshExamples.png" alt="Open PowerShell Examples" /><figcaption>Open PowerShell Examples</figcaption>
</figure>
<h2 id="major-features">Major features</h2>
<ul>
<li>Syntax highlighting</li>
<li>Code snippets</li>
<li>IntelliSense for cmdlets and more</li>
<li>Rule-Based analysis provided by PowerShell Script Analyzer</li>
<li>“Go to definition” of cmdlets and variables</li>
<li>Find references of cmdlets and variables</li>
<li>Document and Workspace symbol discovery</li>
<li>Run selected section of PowerShell code using <code>kbstyle(F8)</code></li>
<li>Launch online help for the symbol under the cursor using <code>kbstyle(Ctrl + F1)</code></li>
<li>Local script debugging and basic interactive console support</li>
<li>Enable ISE mode using <code>kbstyle(Ctrl + Shift + P)</code> then search for “Enable ISE Mode”</li>
</ul>
<h2 id="debugging">Debugging</h2>
<p>The PowerShell extension uses the built-in debugging interface of VS Code to allow for debugging of PowerShell scripts and modules. You can learn more about <a href="/docs/editor/debugging.md">VS Code debugging</a> here.</p>
<h3 id="hey-scripting-guy-blog">Hey, Scripting Guy! blog</h3>
<figure>
<img src="images/powershell/HSGavatar.png" alt="HSG" /><figcaption>HSG</figcaption>
</figure>
<p>For more information on debugging, check out the “Hey, Scripting Guy!” two-part blog post series written by <span class="citation" data-cites="keithHill">[@keithHill]</span>(https://twitter.com/r_keith_hill) on debugging with the PowerShell extension:</p>
<p><a href="https://blogs.technet.microsoft.com/heyscriptingguy/2017/02/06/debugging-powershell-script-in-visual-studio-code-part-1/">Debugging PowerShell script in Visual Studio Code – Part 1</a></p>
<p><a href="https://blogs.technet.microsoft.com/heyscriptingguy/2017/02/13/debugging-powershell-script-in-visual-studio-code-part-2/">Debugging PowerShell script in Visual Studio Code – Part 2</a></p>
<h2 id="powershell-extension-settings">PowerShell extension settings</h2>
<p>You can customize VS Code <a href="/docs/getstarted/settings.md">settings</a> from the <strong>File</strong> &gt; <strong>Preferences</strong> &gt; <strong>Settings</strong> menu item (<strong>Code</strong> &gt; <strong>Preferences</strong> &gt; <strong>Settings</strong> on macOS).</p>
<p>You can also click the gear icon located in the lower left corner of the Activity Bar.</p>
<figure>
<img src="images/powershell/codeGear.png" alt="codeGear" /><figcaption>codeGear</figcaption>
</figure>
<p>You can also use the keyboard shortcut <code>kb(workbench.action.openSettings)</code> to open your settings. The VS Code team has introduced a settings GUI in version 1.27.1 as the new default interface for customizing settings. In VS Code versions prior to 1.27.1, this will open your <code>settings.json</code> file.</p>
<p>You can still open the <code>settings.json</code> file by using <strong>Preferences: Open Settings (JSON)</strong> command from the Command Palette (<code>kb(workbench.action.showCommands)</code>) or by changing the default settings editor with the <code>"workbench.settings.editor"</code> setting.</p>
<p>Go to <a href="/docs/getstarted/settings.md">User and Workspace settings</a> for more information on configuring VS Code settings.</p>
<h2 id="multi-version-support">Multi-version support</h2>
<p>You can configure the PowerShell extension to use any version of PowerShell installed on your machine by following <a href="https://docs.microsoft.com/powershell/scripting/dev-cross-plat/vscode/using-vscode?view=powershell-7#choosing-a-version-of-powershell-to-use-with-the-extension">these instructions</a>.</p>
<p>You can also change the version by clicking on the version number in the lower right corner:</p>
<figure>
<img src="images/powershell/pwshChangeVersion.png" alt="Change PowerShell Version" /><figcaption>Change PowerShell Version</figcaption>
</figure>
<p>Or run the <strong>PowerShell: Show Session Menu</strong> command from the Command Palette (<code>kb(workbench.action.showCommands)</code>).</p>
<h2 id="pester">Pester</h2>
<p><a href="https://pester.dev/">Pester</a> is a <a href="https://en.wikipedia.org/wiki/Behavior-driven_development">Behavior-driven Development</a> (BDD) based unit test runner for PowerShell. Pester provides a framework for running unit tests to execute and validate PowerShell commands. Pester follows a file naming convention for naming tests to be discovered by Pester at test time and a simple set of functions that expose a testing <a href="https://en.wikipedia.org/wiki/Domain-specific_language">domain-specific language</a> (DSL) for isolating, running, evaluating and reporting the results of PowerShell commands.</p>
<p>Windows 10 and Server 2016 comes with Pester 3.40 pre-installed. To update Pester or to install the latest version on other platforms follow the <a href="https://pester.dev/docs/introduction/installation">Pester installation instructions</a>.</p>
<figure>
<img src="images/powershell/pesterCodeLens.png" alt="Pester CodeLens Integration" /><figcaption>Pester CodeLens Integration</figcaption>
</figure>
<h2 id="plaster">Plaster</h2>
<p>Plaster is a template-based file and project generator written in PowerShell. Its purpose is to streamline the creation of PowerShell module projects, Pester tests, DSC configurations and more. See the <a href="https://github.com/PowerShell/Plaster">GitHub Plaster repository</a> for more information, for documentation on Plaster’s cmdlets see <a href="https://github.com/PowerShell/Plaster/blob/master/docs/en-US/Plaster.md">Cmdlet Documentation</a>.</p>
<p>The PowerShell extension allows the creation of new Plaster projects by running the <strong>PowerShell: Create New Project from Plaster Template</strong> command from the Command Palette (<code>kb(workbench.action.showCommands)</code>).</p>
<figure>
<img src="images/powershell/cpPlasterCommand.png" alt="Plaster Project" /><figcaption>Plaster Project</figcaption>
</figure>
<h2 id="psscriptanalyzer">PSScriptAnalyzer</h2>
<p><a href="https://github.com/PowerShell/PSScriptAnalyzer#introduction">PSScriptAnalyzer</a> is a static source code checker for PowerShell modules and scripts. PSScriptAnalyzer checks the quality of PowerShell code by running a set of rules. The rules are based on PowerShell best practices identified by the PowerShell Team and the community. PSScriptAnalyzer generates diagnostic records (errors and warnings) to inform users about potential code defects and suggests possible solutions for improvements.</p>
<p>The PowerShell extension includes PSScriptAnalyzer by default, and automatically performs analysis on PowerShell script files being edited in VS Code.</p>
<h3 id="psscriptanalyzer-settings">PSScriptAnalyzer Settings</h3>
<p>PSScriptAnalyzer is shipped with a collection of built-in rules that checks various aspects of PowerShell source code such as presence of uninitialized variables, usage of PSCredential Type, usage of Invoke-Expression, etc. Additional functionality such as exclude/include specific rules is also supported.</p>
<p>To disable PSScriptAnalyzer, open your settings, browse Extensions, select the PowerShell extension and deselect the checkbox for PSScriptAnalyzer.</p>
<figure>
<img src="images/powershell/pssaExtensionSetting.png" alt="PSScriptAnalyzer Settings" /><figcaption>PSScriptAnalyzer Settings</figcaption>
</figure>
<p>Format document command is provided by the PSScriptAnalyzer module.</p>
<h3 id="document-formatting">Document Formatting</h3>
<p>Automatic document formatting can be invoked using the <strong>Format Document</strong> command or the (<code>kb(editor.action.formatDocument)</code>) keyboard shortcut.</p>
<h2 id="codelens">CodeLens</h2>
<p>CodeLenses are a VS Code feature to provide actionable, contextual information that is displayed within the source code.</p>
<p>CodeLens support was added in version 1.3.0 of the PowerShell extension, read the <a href="https://marketplace.visualstudio.com/items/ms-vscode.PowerShell/changelog">PowerShell extension changelog</a> for more information.</p>
<h3 id="pester-codelens-support">Pester CodeLens support</h3>
<p>Pester supports CodeLens integration for <strong>Run tests</strong> and <strong>Debug tests</strong>.</p>
<h3 id="codelens-pester-debug-support">CodeLens Pester debug support</h3>
<figure>
<img src="images/powershell/codeLensPesterDebug.gif" alt="CodeLens Pester Debug Support" /><figcaption>CodeLens Pester Debug Support</figcaption>
</figure>
<h3 id="codelens-pester-symbol-support">CodeLens Pester symbol support</h3>
<figure>
<img src="images/powershell/codeLensPesterSymbol.gif" alt="CodeLens Pester Symbol Support" /><figcaption>CodeLens Pester Symbol Support</figcaption>
</figure>
<h3 id="function-reference-codelens-support">Function reference CodeLens support</h3>
<p>CodeLens function reference support shows the number of times a function is referenced within your code and allows you to jump to specific references.</p>
<figure>
<img src="images/powershell/codeLensFuncRef.gif" alt="CodeLens Function Reference Support" /><figcaption>CodeLens Function Reference Support</figcaption>
</figure>
<h2 id="extension-faq-page">Extension FAQ page</h2>
<p>Check out the FAQ page on the <a href="https://github.com/PowerShell/vscode-powershell/wiki/FAQ">PowerShell extensions Wiki</a></p>
<h2 id="types.ps1xml-and-format.ps1xml-files">Types.ps1xml and Format.ps1xml files</h2>
<p><code>ps1xml</code> files are PowerShell’s way to extend the type system and define output formatting. For more information on these files, please refer to the official PowerShell documentation on <a href="https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_types.ps1xml?view=powershell-6">Types.ps1xml</a> and <a href="https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_format.ps1xml?view=powershell-6">Format.ps1xml</a>. You can get IntelliSense features when authoring <code>ps1xml</code> files by installing the <a href="https://marketplace.visualstudio.com/items?itemName=redhat.vscode-xml">XML extension by Red Hat</a>. After installing, add this configuration to your user settings:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb6-1" title="1"><span class="er">&quot;xml.fileAssociations&quot;:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="fu">{</span></a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="dt">&quot;systemId&quot;</span><span class="fu">:</span> <span class="st">&quot;https://raw.githubusercontent.com/PowerShell/PowerShell/master/src/Schemas/Format.xsd&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="dt">&quot;pattern&quot;</span><span class="fu">:</span> <span class="st">&quot;**/*.Format.ps1xml&quot;</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="fu">}</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="fu">{</span></a>
<a class="sourceLine" id="cb6-7" title="7">    <span class="dt">&quot;systemId&quot;</span><span class="fu">:</span> <span class="st">&quot;https://raw.githubusercontent.com/PowerShell/PowerShell/master/src/Schemas/Types.xsd&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb6-8" title="8">    <span class="dt">&quot;pattern&quot;</span><span class="fu">:</span> <span class="st">&quot;**/*.Types.ps1xml&quot;</span></a>
<a class="sourceLine" id="cb6-9" title="9">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="ot">]</span></a></code></pre></div>
<p>This tells the XML extension to use the official XML schemas from the PowerShell repository for all <code>.ps1xml</code> files. This enables the following features in <code>ps1xml</code> files:</p>
<ul>
<li>Syntax error reporting</li>
<li>Schema validation</li>
<li>Tag and attribute completion</li>
<li>Auto-close tags</li>
<li>Symbol highlighting</li>
<li>Document folding</li>
<li>Document symbols and outline</li>
<li>Renaming support</li>
<li>Document Formatting</li>
</ul>
</body>
</html>
