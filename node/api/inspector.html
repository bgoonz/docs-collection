<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>inspector</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <h1 id="inspector">Inspector</h1>
    <!--introduced_in=v8.0.0-->
    <blockquote>
      <p>Stability: 2 - Stable</p>
    </blockquote>
    <!-- source_link=lib/inspector.js -->
    <p>
      The <code>inspector</code> module provides an API for interacting with the
      V8 inspector.
    </p>
    <p>It can be accessed using:</p>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> inspector <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;inspector&#39;</span>)<span class="op">;</span></a></code></pre>
    </div>
    <h2 id="inspector.close"><code>inspector.close()</code></h2>
    <p>
      Deactivate the inspector. Blocks until there are no active connections.
    </p>
    <h2 id="inspector.console"><code>inspector.console</code></h2>
    <ul>
      <li>
        {Object} An object to send messages to the remote inspector console.
      </li>
    </ul>
    <div class="sourceCode" id="cb2">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="at">require</span>(<span class="st">&#39;inspector&#39;</span>).<span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;a message&#39;</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p>The inspector console does not have API parity with Node.js console.</p>
    <h2 id="inspector.openport-host-wait">
      <code>inspector.open([port[, host[, wait]]])</code>
    </h2>
    <ul>
      <li>
        <code>port</code> {number} Port to listen on for inspector connections.
        Optional. <strong>Default:</strong> what was specified on the CLI.
      </li>
      <li>
        <code>host</code> {string} Host to listen on for inspector connections.
        Optional. <strong>Default:</strong> what was specified on the CLI.
      </li>
      <li>
        <code>wait</code> {boolean} Block until a client has connected.
        Optional. <strong>Default:</strong> <code>false</code>.
      </li>
    </ul>
    <p>
      Activate inspector on host and port. Equivalent to
      <code>node --inspect=[[host:]port]</code>, but can be done
      programmatically after node has started.
    </p>
    <p>
      If wait is <code>true</code>, will block until a client has connected to
      the inspect port and flow control has been passed to the debugger client.
    </p>
    <p>
      See the <a href="cli.md#inspector_security">security warning</a> regarding
      the <code>host</code> parameter usage.
    </p>
    <h2 id="inspector.url"><code>inspector.url()</code></h2>
    <ul>
      <li>Returns: {string|undefined}</li>
    </ul>
    <p>
      Return the URL of the active inspector, or <code>undefined</code> if there
      is none.
    </p>
    <pre class="console"><code>$ node --inspect -p &#39;inspector.url()&#39;
Debugger listening on ws://127.0.0.1:9229/166e272e-7a30-4d09-97ce-f1c012b43c34
For help see https://nodejs.org/en/docs/inspector
ws://127.0.0.1:9229/166e272e-7a30-4d09-97ce-f1c012b43c34

$ node --inspect=localhost:3000 -p &#39;inspector.url()&#39;
Debugger listening on ws://localhost:3000/51cf8d0e-3c36-4c59-8efd-54519839e56a
For help see https://nodejs.org/en/docs/inspector
ws://localhost:3000/51cf8d0e-3c36-4c59-8efd-54519839e56a

$ node -p &#39;inspector.url()&#39;
undefined</code></pre>
    <h2 id="inspector.waitfordebugger">
      <code>inspector.waitForDebugger()</code>
    </h2>
    <!-- YAML
added: v12.7.0
-->
    <p>
      Blocks until a client (existing or connected later) has sent
      <code>Runtime.runIfWaitingForDebugger</code> command.
    </p>
    <p>An exception will be thrown if there is no active inspector.</p>
    <h2 id="class-inspector.session">Class: <code>inspector.Session</code></h2>
    <ul>
      <li>Extends: {EventEmitter}</li>
    </ul>
    <p>
      The <code>inspector.Session</code> is used for dispatching messages to the
      V8 inspector back-end and receiving message responses and notifications.
    </p>
    <h3 id="new-inspector.session"><code>new inspector.Session()</code></h3>
    <!-- YAML
added: v8.0.0
-->
    <p>
      Create a new instance of the <code>inspector.Session</code> class. The
      inspector session needs to be connected through
      <a href="#inspector_session_connect"><code>session.connect()</code></a>
      before the messages can be dispatched to the inspector backend.
    </p>
    <h3 id="event-inspectornotification">
      Event: <code>'inspectorNotification'</code>
    </h3>
    <!-- YAML
added: v8.0.0
-->
    <ul>
      <li>{Object} The notification message object</li>
    </ul>
    <p>Emitted when any notification from the V8 Inspector is received.</p>
    <div class="sourceCode" id="cb4">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="va">session</span>.<span class="at">on</span>(<span class="st">&#39;inspectorNotification&#39;</span><span class="op">,</span> (message) <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="va">message</span>.<span class="at">method</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">// Debugger.paused</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">// Debugger.resumed</span></a></code></pre>
    </div>
    <p>
      It is also possible to subscribe only to notifications with specific
      method:
    </p>
    <h3 id="event-inspector-protocol-method">
      Event: <code>&lt;inspector-protocol-method&gt;</code>;
    </h3>
    <!-- YAML
added: v8.0.0
-->
    <ul>
      <li>{Object} The notification message object</li>
    </ul>
    <p>
      Emitted when an inspector notification is received that has its method
      field set to the <code>&lt;inspector-protocol-method&gt;</code> value.
    </p>
    <p>
      The following snippet installs a listener on the
      <a
        href="https://chromedevtools.github.io/devtools-protocol/v8/Debugger#event-paused"
        ><code>'Debugger.paused'</code></a
      >
      event, and prints the reason for program suspension whenever program
      execution is suspended (through breakpoints, for example):
    </p>
    <div class="sourceCode" id="cb5">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="va">session</span>.<span class="at">on</span>(<span class="st">&#39;Debugger.paused&#39;</span><span class="op">,</span> (<span class="op">{</span> params <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="va">params</span>.<span class="at">hitBreakpoints</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">// [ &#39;/the/file/that/has/the/breakpoint.js:11:0&#39; ]</span></a></code></pre>
    </div>
    <h3 id="session.connect"><code>session.connect()</code></h3>
    <!-- YAML
added: v8.0.0
-->
    <p>Connects a session to the inspector back-end.</p>
    <h3 id="session.connecttomainthread">
      <code>session.connectToMainThread()</code>
    </h3>
    <!-- YAML
added: v12.11.0
-->
    <p>
      Connects a session to the main thread inspector back-end. An exception
      will be thrown if this API was not called on a Worker thread.
    </p>
    <h3 id="session.disconnect"><code>session.disconnect()</code></h3>
    <!-- YAML
added: v8.0.0
-->
    <p>
      Immediately close the session. All pending message callbacks will be
      called with an error.
      <a href="#inspector_session_connect"><code>session.connect()</code></a>
      will need to be called to be able to send messages again. Reconnected
      session will lose all inspector state, such as enabled agents or
      configured breakpoints.
    </p>
    <h3 id="session.postmethod-params-callback">
      <code>session.post(method[, params][, callback])</code>
    </h3>
    <!-- YAML
added: v8.0.0
-->
    <ul>
      <li><code>method</code> {string}</li>
      <li><code>params</code> {Object}</li>
      <li><code>callback</code> {Function}</li>
    </ul>
    <p>
      Posts a message to the inspector back-end. <code>callback</code> will be
      notified when a response is received. <code>callback</code> is a function
      that accepts two optional arguments: error and message-specific result.
    </p>
    <div class="sourceCode" id="cb6">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="va">session</span>.<span class="at">post</span>(<span class="st">&#39;Runtime.evaluate&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">expression</span><span class="op">:</span> <span class="st">&#39;2 + 2&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb6-2" title="2">             (error<span class="op">,</span> <span class="op">{</span> result <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(result))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">// Output: { type: &#39;number&#39;, value: 4, description: &#39;4&#39; }</span></a></code></pre>
    </div>
    <p>
      The latest version of the V8 inspector protocol is published on the
      <a href="https://chromedevtools.github.io/devtools-protocol/v8/"
        >Chrome DevTools Protocol Viewer</a
      >.
    </p>
    <p>
      Node.js inspector supports all the Chrome DevTools Protocol domains
      declared by V8. Chrome DevTools Protocol domain provides an interface for
      interacting with one of the runtime agents used to inspect the application
      state and listen to the run-time events.
    </p>
    <h2 id="example-usage">Example usage</h2>
    <p>
      Apart from the debugger, various V8 Profilers are available through the
      DevTools protocol.
    </p>
    <h3 id="cpu-profiler">CPU profiler</h3>
    <p>
      Here’s an example showing how to use the
      <a href="https://chromedevtools.github.io/devtools-protocol/v8/Profiler"
        >CPU Profiler</a
      >:
    </p>
    <div class="sourceCode" id="cb7">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">const</span> inspector <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;inspector&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">const</span> fs <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;fs&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">const</span> session <span class="op">=</span> <span class="kw">new</span> <span class="va">inspector</span>.<span class="at">Session</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="va">session</span>.<span class="at">connect</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5"></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="va">session</span>.<span class="at">post</span>(<span class="st">&#39;Profiler.enable&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="va">session</span>.<span class="at">post</span>(<span class="st">&#39;Profiler.start&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-8" title="8">    <span class="co">// Invoke business logic under measurement here...</span></a>
<a class="sourceLine" id="cb7-9" title="9"></a>
<a class="sourceLine" id="cb7-10" title="10">    <span class="co">// some time later...</span></a>
<a class="sourceLine" id="cb7-11" title="11">    <span class="va">session</span>.<span class="at">post</span>(<span class="st">&#39;Profiler.stop&#39;</span><span class="op">,</span> (err<span class="op">,</span> <span class="op">{</span> profile <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-12" title="12">      <span class="co">// Write profile to disk, upload, etc.</span></a>
<a class="sourceLine" id="cb7-13" title="13">      <span class="cf">if</span> (<span class="op">!</span>err) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-14" title="14">        <span class="va">fs</span>.<span class="at">writeFileSync</span>(<span class="st">&#39;./profile.cpuprofile&#39;</span><span class="op">,</span> <span class="va">JSON</span>.<span class="at">stringify</span>(profile))<span class="op">;</span></a>
<a class="sourceLine" id="cb7-15" title="15">      <span class="op">}</span></a>
<a class="sourceLine" id="cb7-16" title="16">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-17" title="17">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <h3 id="heap-profiler">Heap profiler</h3>
    <p>
      Here’s an example showing how to use the
      <a
        href="https://chromedevtools.github.io/devtools-protocol/v8/HeapProfiler"
        >Heap Profiler</a
      >:
    </p>
    <div class="sourceCode" id="cb8">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">const</span> inspector <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;inspector&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">const</span> fs <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;fs&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">const</span> session <span class="op">=</span> <span class="kw">new</span> <span class="va">inspector</span>.<span class="at">Session</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw">const</span> fd <span class="op">=</span> <span class="va">fs</span>.<span class="at">openSync</span>(<span class="st">&#39;profile.heapsnapshot&#39;</span><span class="op">,</span> <span class="st">&#39;w&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-6" title="6"></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="va">session</span>.<span class="at">connect</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-8" title="8"></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="va">session</span>.<span class="at">on</span>(<span class="st">&#39;HeapProfiler.addHeapSnapshotChunk&#39;</span><span class="op">,</span> (m) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-10" title="10">  <span class="va">fs</span>.<span class="at">writeSync</span>(fd<span class="op">,</span> <span class="va">m</span>.<span class="va">params</span>.<span class="at">chunk</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-12" title="12"></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="va">session</span>.<span class="at">post</span>(<span class="st">&#39;HeapProfiler.takeHeapSnapshot&#39;</span><span class="op">,</span> <span class="kw">null</span><span class="op">,</span> (err<span class="op">,</span> r) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-14" title="14">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;HeapProfiler.takeHeapSnapshot done:&#39;</span><span class="op">,</span> err<span class="op">,</span> r)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-15" title="15">  <span class="va">session</span>.<span class="at">disconnect</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-16" title="16">  <span class="va">fs</span>.<span class="at">closeSync</span>(fd)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
  </body>
</html>
