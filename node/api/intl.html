<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>intl</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <h1 id="internationalization-support">Internationalization support</h1>
    <!--introduced_in=v8.2.0-->
    <!-- type=misc -->
    <p>
      Node.js has many features that make it easier to write internationalized
      programs. Some of them are:
    </p>
    <ul>
      <li>
        Locale-sensitive or Unicode-aware functions in the
        <a href="https://tc39.github.io/ecma262/"
          >ECMAScript Language Specification</a
        >:
        <ul>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize"
              ><code>String.prototype.normalize()</code></a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/toLowerCase"
              ><code>String.prototype.toLowerCase()</code></a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/toUpperCase"
              ><code>String.prototype.toUpperCase()</code></a
            >
          </li>
        </ul>
      </li>
      <li>
        All functionality described in the
        <a href="https://tc39.github.io/ecma402/"
          >ECMAScript Internationalization API Specification</a
        >
        (aka ECMA-402):
        <ul>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl"
              ><code>Intl</code></a
            >
            object
          </li>
          <li>
            Locale-sensitive methods like
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare"
              ><code>String.prototype.localeCompare()</code></a
            >
            and
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString"
              ><code>Date.prototype.toLocaleString()</code></a
            >
          </li>
        </ul>
      </li>
      <li>
        The <a href="url.md#url_the_whatwg_url_api">WHATWG URL parser</a>’s
        <a href="https://en.wikipedia.org/wiki/Internationalized_domain_name"
          >internationalized domain names</a
        >
        (IDNs) support
      </li>
      <li>
        <a href="buffer.md#buffer_buffer_transcode_source_fromenc_toenc"
          ><code>require('buffer').transcode()</code></a
        >
      </li>
      <li>More accurate <a href="repl.md#repl_repl">REPL</a> line editing</li>
      <li>
        <a href="util.md#util_class_util_textdecoder"
          ><code>require('util').TextDecoder</code></a
        >
      </li>
      <li>
        <a
          href="https://github.com/tc39/proposal-regexp-unicode-property-escapes"
          ><code>RegExp</code> Unicode Property Escapes</a
        >
      </li>
    </ul>
    <p>
      Node.js and the underlying V8 engine use
      <a href="http://site.icu-project.org/"
        >International Components for Unicode (ICU)</a
      >
      to implement these features in native C/C++ code. The full ICU data set is
      provided by Node.js by default. However, due to the size of the ICU data
      file, several options are provided for customizing the ICU data set either
      when building or running Node.js.
    </p>
    <h2 id="options-for-building-node.js">Options for building Node.js</h2>
    <p>
      To control how ICU is used in Node.js, four <code>configure</code> options
      are available during compilation. Additional details on how to compile
      Node.js are documented in
      <a href="https://github.com/nodejs/node/blob/HEAD/BUILDING.md"
        >BUILDING.md</a
      >.
    </p>
    <ul>
      <li><code>--with-intl=none</code>/<code>--without-intl</code></li>
      <li><code>--with-intl=system-icu</code></li>
      <li><code>--with-intl=small-icu</code></li>
      <li><code>--with-intl=full-icu</code> (default)</li>
    </ul>
    <p>
      An overview of available Node.js and JavaScript features for each
      <code>configure</code> option:
    </p>
    <table style="width: 100%">
      <colgroup>
        <col style="width: 28%" />
        <col style="width: 24%" />
        <col style="width: 21%" />
        <col style="width: 16%" />
        <col style="width: 8%" />
      </colgroup>
      <thead>
        <tr class="header">
          <th>Feature</th>
          <th><code>none</code></th>
          <th><code>system-icu</code></th>
          <th><code>small-icu</code></th>
          <th><code>full-icu</code></th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize"
              ><code>String.prototype.normalize()</code></a
            >
          </td>
          <td>none (function is no-op)</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
        <tr class="even">
          <td><code>String.prototype.to*Case()</code></td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
        <tr class="odd">
          <td>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl"
              ><code>Intl</code></a
            >
          </td>
          <td>none (object does not exist)</td>
          <td>partial/full (depends on OS)</td>
          <td>partial (English-only)</td>
          <td>full</td>
        </tr>
        <tr class="even">
          <td>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare"
              ><code>String.prototype.localeCompare()</code></a
            >
          </td>
          <td>partial (not locale-aware)</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
        <tr class="odd">
          <td><code>String.prototype.toLocale*Case()</code></td>
          <td>partial (not locale-aware)</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
        <tr class="even">
          <td>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString"
              ><code>Number.prototype.toLocaleString()</code></a
            >
          </td>
          <td>partial (not locale-aware)</td>
          <td>partial/full (depends on OS)</td>
          <td>partial (English-only)</td>
          <td>full</td>
        </tr>
        <tr class="odd">
          <td><code>Date.prototype.toLocale*String()</code></td>
          <td>partial (not locale-aware)</td>
          <td>partial/full (depends on OS)</td>
          <td>partial (English-only)</td>
          <td>full</td>
        </tr>
        <tr class="even">
          <td><a href="url.md#url_legacy_url_api">Legacy URL Parser</a></td>
          <td>partial (no IDN support)</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
        <tr class="odd">
          <td><a href="url.md#url_the_whatwg_url_api">WHATWG URL Parser</a></td>
          <td>partial (no IDN support)</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
        <tr class="even">
          <td>
            <a href="buffer.md#buffer_buffer_transcode_source_fromenc_toenc"
              ><code>require('buffer').transcode()</code></a
            >
          </td>
          <td>none (function does not exist)</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
        <tr class="odd">
          <td><a href="repl.md#repl_repl">REPL</a></td>
          <td>partial (inaccurate line editing)</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
        <tr class="even">
          <td>
            <a href="util.md#util_class_util_textdecoder"
              ><code>require('util').TextDecoder</code></a
            >
          </td>
          <td>partial (basic encodings support)</td>
          <td>partial/full (depends on OS)</td>
          <td>partial (Unicode-only)</td>
          <td>full</td>
        </tr>
        <tr class="odd">
          <td>
            <a
              href="https://github.com/tc39/proposal-regexp-unicode-property-escapes"
              ><code>RegExp</code> Unicode Property Escapes</a
            >
          </td>
          <td>none (invalid <code>RegExp</code> error)</td>
          <td>full</td>
          <td>full</td>
          <td>full</td>
        </tr>
      </tbody>
    </table>
    <p>
      The “(not locale-aware)” designation denotes that the function carries out
      its operation just like the non-<code>Locale</code> version of the
      function, if one exists. For example, under <code>none</code> mode,
      <code>Date.prototype.toLocaleString()</code>’s operation is identical to
      that of <code>Date.prototype.toString()</code>.
    </p>
    <h3 id="disable-all-internationalization-features-none">
      Disable all internationalization features (<code>none</code>)
    </h3>
    <p>
      If this option is chosen, ICU is disabled and most internationalization
      features mentioned above will be <strong>unavailable</strong> in the
      resulting <code>node</code> binary.
    </p>
    <h3 id="build-with-a-pre-installed-icu-system-icu">
      Build with a pre-installed ICU (<code>system-icu</code>)
    </h3>
    <p>
      Node.js can link against an ICU build already installed on the system. In
      fact, most Linux distributions already come with ICU installed, and this
      option would make it possible to reuse the same set of data used by other
      components in the OS.
    </p>
    <p>
      Functionalities that only require the ICU library itself, such as
      <a
        href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize"
        ><code>String.prototype.normalize()</code></a
      >
      and the <a href="url.md#url_the_whatwg_url_api">WHATWG URL parser</a>, are
      fully supported under <code>system-icu</code>. Features that require ICU
      locale data in addition, such as
      <a
        href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat"
        ><code>Intl.DateTimeFormat</code></a
      >
      <em>may</em> be fully or partially supported, depending on the
      completeness of the ICU data installed on the system.
    </p>
    <h3 id="embed-a-limited-set-of-icu-data-small-icu">
      Embed a limited set of ICU data (<code>small-icu</code>)
    </h3>
    <p>
      This option makes the resulting binary link against the ICU library
      statically, and includes a subset of ICU data (typically only the English
      locale) within the <code>node</code> executable.
    </p>
    <p>
      Functionalities that only require the ICU library itself, such as
      <a
        href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize"
        ><code>String.prototype.normalize()</code></a
      >
      and the <a href="url.md#url_the_whatwg_url_api">WHATWG URL parser</a>, are
      fully supported under <code>small-icu</code>. Features that require ICU
      locale data in addition, such as
      <a
        href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat"
        ><code>Intl.DateTimeFormat</code></a
      >, generally only work with the English locale:
    </p>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> january <span class="op">=</span> <span class="kw">new</span> <span class="at">Date</span>(<span class="fl">9e8</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">const</span> english <span class="op">=</span> <span class="kw">new</span> <span class="va">Intl</span>.<span class="at">DateTimeFormat</span>(<span class="st">&#39;en&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">month</span><span class="op">:</span> <span class="st">&#39;long&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">const</span> spanish <span class="op">=</span> <span class="kw">new</span> <span class="va">Intl</span>.<span class="at">DateTimeFormat</span>(<span class="st">&#39;es&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">month</span><span class="op">:</span> <span class="st">&#39;long&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="va">console</span>.<span class="at">log</span>(<span class="va">english</span>.<span class="at">format</span>(january))<span class="op">;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">// Prints &quot;January&quot;</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="va">console</span>.<span class="at">log</span>(<span class="va">spanish</span>.<span class="at">format</span>(january))<span class="op">;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">// Prints &quot;M01&quot; on small-icu</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">// Should print &quot;enero&quot;</span></a></code></pre>
    </div>
    <p>This mode provides a balance between features and binary size.</p>
    <h4 id="providing-icu-data-at-runtime">Providing ICU data at runtime</h4>
    <p>
      If the <code>small-icu</code> option is used, one can still provide
      additional locale data at runtime so that the JS methods would work for
      all ICU locales. Assuming the data file is stored at
      <code>/some/directory</code>, it can be made available to ICU through
      either:
    </p>
    <ul>
      <li>
        <p>
          The
          <a href="cli.md#cli_node_icu_data_file"><code>NODE_ICU_DATA</code></a>
          environment variable:
        </p>
        <div class="sourceCode" id="cb2">
          <pre
            class="sourceCode bash"
          ><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="fu">env</span> NODE_ICU_DATA=/some/directory node</a></code></pre>
        </div>
      </li>
      <li>
        <p>
          The
          <a href="cli.md#cli_icu_data_dir_file"><code>--icu-data-dir</code></a>
          CLI parameter:
        </p>
        <div class="sourceCode" id="cb3">
          <pre
            class="sourceCode bash"
          ><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="ex">node</span> --icu-data-dir=/some/directory</a></code></pre>
        </div>
      </li>
    </ul>
    <p>
      (If both are specified, the <code>--icu-data-dir</code> CLI parameter
      takes precedence.)
    </p>
    <p>
      ICU is able to automatically find and load a variety of data formats, but
      the data must be appropriate for the ICU version, and the file correctly
      named. The most common name for the data file is
      <code>icudt6X[bl].dat</code>, where <code>6X</code> denotes the intended
      ICU version, and <code>b</code> or <code>l</code> indicates the system’s
      endianness. Check
      <a href="http://userguide.icu-project.org/icudata">“ICU Data”</a> article
      in the ICU User Guide for other supported formats and more details on ICU
      data in general.
    </p>
    <p>
      The <a href="https://www.npmjs.com/package/full-icu">full-icu</a> npm
      module can greatly simplify ICU data installation by detecting the ICU
      version of the running <code>node</code> executable and downloading the
      appropriate data file. After installing the module through
      <code>npm i full-icu</code>, the data file will be available at
      <code>./node_modules/full-icu</code>. This path can be then passed either
      to <code>NODE_ICU_DATA</code> or <code>--icu-data-dir</code> as shown
      above to enable full <code>Intl</code> support.
    </p>
    <h3 id="embed-the-entire-icu-full-icu">
      Embed the entire ICU (<code>full-icu</code>)
    </h3>
    <p>
      This option makes the resulting binary link against ICU statically and
      include a full set of ICU data. A binary created this way has no further
      external dependencies and supports all locales, but might be rather large.
      This is the default behavior if no <code>--with-intl</code> flag is
      passed. The official binaries are also built in this mode.
    </p>
    <h2 id="detecting-internationalization-support">
      Detecting internationalization support
    </h2>
    <p>
      To verify that ICU is enabled at all (<code>system-icu</code>,
      <code>small-icu</code>, or <code>full-icu</code>), simply checking the
      existence of <code>Intl</code> should suffice:
    </p>
    <div class="sourceCode" id="cb4">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">const</span> hasICU <span class="op">=</span> <span class="kw">typeof</span> Intl <span class="op">===</span> <span class="st">&#39;object&#39;</span><span class="op">;</span></a></code></pre>
    </div>
    <p>
      Alternatively, checking for <code>process.versions.icu</code>, a property
      defined only when ICU is enabled, works too:
    </p>
    <div class="sourceCode" id="cb5">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> hasICU <span class="op">=</span> <span class="kw">typeof</span> <span class="va">process</span>.<span class="va">versions</span>.<span class="at">icu</span> <span class="op">===</span> <span class="st">&#39;string&#39;</span><span class="op">;</span></a></code></pre>
    </div>
    <p>
      To check for support for a non-English locale (i.e. <code>full-icu</code>
      or <code>system-icu</code>),
      <a
        href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat"
        ><code>Intl.DateTimeFormat</code></a
      >
      can be a good distinguishing factor:
    </p>
    <div class="sourceCode" id="cb6">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> hasFullICU <span class="op">=</span> (() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="kw">const</span> january <span class="op">=</span> <span class="kw">new</span> <span class="at">Date</span>(<span class="fl">9e8</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="kw">const</span> spanish <span class="op">=</span> <span class="kw">new</span> <span class="va">Intl</span>.<span class="at">DateTimeFormat</span>(<span class="st">&#39;es&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">month</span><span class="op">:</span> <span class="st">&#39;long&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5">    <span class="cf">return</span> <span class="va">spanish</span>.<span class="at">format</span>(january) <span class="op">===</span> <span class="st">&#39;enero&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="op">}</span> <span class="cf">catch</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-7" title="7">    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="op">}</span>)()<span class="op">;</span></a></code></pre>
    </div>
    <p>
      For more verbose tests for <code>Intl</code> support, the following
      resources may be found to be helpful:
    </p>
    <ul>
      <li>
        <a href="https://github.com/srl295/btest402">btest402</a>: Generally
        used to check whether Node.js with <code>Intl</code> support is built
        correctly.
      </li>
      <li>
        <a href="https://github.com/tc39/test262/tree/HEAD/test/intl402"
          >Test262</a
        >: ECMAScript’s official conformance test suite includes a section
        dedicated to ECMA-402.
      </li>
    </ul>
  </body>
</html>
