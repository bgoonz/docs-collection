<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2012-09-17" />
  <title>Content Security Policy</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Content Security Policy</h1>
<p class="date">2012-09-17</p>
</header>
<p>{% Aside ‘caution’ %}</p>
<p><strong>Important:</strong> Chrome will be removing support for Chrome Apps on all platforms. Chrome browser and the Chrome Web Store will continue to support extensions. <a href="https://blog.chromium.org/2020/08/changes-to-chrome-app-support-timeline.html"><strong>Read the announcement</strong></a> and learn more about <a href="/apps/migration"><strong>migrating your app</strong></a>.</p>
<p>{% endAside %}</p>
<p>If you’re not familiar with Content Security Policy (CSP), <a href="http://www.html5rocks.com/en/tutorials/security/content-security-policy/">An Introduction to Content Security Policy</a> is a good starting point. That document covers the broader web platform view of CSP; Chrome App CSP isn’t as flexible.</p>
<p>CSP is a policy to mitigate against cross-site scripting issues, and we all know that cross-site scripting is bad. We aren’t going to try and convince you that CSP is a warm-and-fuzzy new policy. There’s work involved; you’ll need to learn how to do fundamental tasks differently.</p>
<p>The purpose of this document is to tell you exactly what the CSP policy is for Chrome Apps, what you need to do to comply with it, and how you can still do those fundamental tasks in a way that is CSP–compliant.</p>
<h2 id="what-is-the-csp-for-chrome-apps-what">What is the CSP for Chrome Apps? {: #what }</h2>
<p>The content security policy for Chrome Apps restricts you from doing the following:</p>
<ul>
<li>You can’t use inline scripting in your Chrome App pages. The restriction bans both <code>&lt;script&gt;</code> blocks and event handlers (<code>&lt;button onclick="..."&gt;</code>).</li>
<li>You can’t reference any external resources in any of your app files (except for video and audio resources). You can’t embed external resources in an iframe.</li>
<li>You can’t use string-to-JavaScript methods like <code>eval()</code> and <code>new Function()</code>.</li>
</ul>
<p>This is implemented via the following policy value:</p>
<pre class="text"><code>default-src &#39;self&#39;;
connect-src * data: blob: filesystem:;
style-src &#39;self&#39; data: &#39;unsafe-inline&#39;;
img-src &#39;self&#39; data:;
frame-src &#39;self&#39; data:;
font-src &#39;self&#39; data:;
media-src * data: blob: filesystem:;</code></pre>
<p>Your Chrome App can only refer to scripts and objects within your app, with the exception of media files (apps can refer to video and audio outside the package). Chrome extensions will let you relax the default Content Security Policy; Chrome Apps won’t.</p>
<h2 id="how-to-comply-with-csp-how">How to comply with CSP {: #how }</h2>
<p>All JavaScript and all resources should be local (everything gets packaged in your Chrome App).</p>
<h2 id="but-then-how-do-i-but">“But then how do I…” {: #but }</h2>
<p>It’s very possible that you are using templating libraries and many of these won’t work with CSP. You may also want to access external resources in your app (external images, content from websites).</p>
<h3 id="use-templating-libraries-templating">Use templating libraries {: #templating }</h3>
<p>Use a library that offers precompiled templates and you’re all set. You can still use a library that doesn’t offer precompilation, but it will require some work on your part and there are restrictions.</p>
<p>You will need to use sandboxing to isolate any content that you want to do ‘eval’ things to. Sandboxing lifts CSP on the content that you specify. If you want to use the very powerful Chrome APIs in your Chrome App, your sandboxed content can’t directly interact with these APIs (see <a href="app_external#sandboxing">Sandbox local content</a>).</p>
<h3 id="access-remote-resources-remote_resources">Access remote resources {: #remote_resources }</h3>
<p>You can fetch remote resources via <code>XMLHttpRequest</code> and serve them via <code>blob:</code>, <code>data:</code>, or <code>filesystem:</code> URLs (see <a href="app_external#external">Referencing external resources</a>).</p>
<p>Video and audio can be loaded from remote services because they have good fallback behavior when offline or under spotty connectivity.</p>
<h3 id="embed-web-content-embed_content">Embed web content {: #embed_content }</h3>
<p>Instead of using an iframe, you can call out to an external URL using a webview tag (see <a href="app_external#webview">Embed external web pages</a>).</p>
</body>
</html>
