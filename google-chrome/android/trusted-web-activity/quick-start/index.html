<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2019-08-28" />
  <title>Quick Start Guide</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Quick Start Guide</h1>
<p class="date">2019-08-28</p>
</header>
<p>Trusted Web Activities can be a bit tricky to set up, especially if all you want to do is display your website. This guide will take you through creating a basic project that uses Trusted Web Activities, covering all the gotchas.</p>
<p>By the end of this guide, you will:</p>
<ul>
<li>Have used <a href="https://github.com/GoogleChromeLabs/bubblewrap">Bubblewrap</a> to build an application that uses a Trusted Web Activity and passes verification.</li>
<li>Understand when your signing keys are used.</li>
<li>Be able to determine the signature your Android Application is being built with.</li>
<li>Know how to create a basic <a href="/digital-asset-links/v1/getting-started">Digital Asset Links</a> file.</li>
</ul>
<p>To follow this guide you’ll need:</p>
<ul>
<li><a href="https://nodejs.org/en/">Node.js</a> 10 or above installed on the development computer.</li>
<li>An Android phone or emulator connected and set up for development (<a href="https://developer.android.com/studio/debug/dev-options.html#enable">Enable USB debugging</a> if you’re using a physical phone).</li>
<li>A browser that supports Trusted Web Activity on your development phone. Chrome 72 or later will work. Support in other browsers is on its way.</li>
<li>A website you’d like to view in the Trusted Web Activity.</li>
</ul>
<p>A Trusted Web Activity lets your Android App launch a full screen Browser Tab without any browser UI. This capability is restricted to websites that you own, and you prove this by setting up Digital Asset Links. We’ll talk <a href="#creating-your-asset-link-file">more about them later</a>.</p>
<p>When you launch a Trusted Web Activity, the browser will check that the Digital Asset Links check out, this is called <strong>verification</strong>. If verification fails, the browser will fall back to displaying your website as a <a href="/docs/android/custom-tabs/">Custom Tab</a>.</p>
<h2 id="install-and-configure-bubblewrap-install-and-configure-bubblewrap">Install and configure Bubblewrap {: #install-and-configure-bubblewrap }</h2>
<p><a href="https://github.com/GoogleChromeLabs/bubblewrap">Bubblewrap</a> is a set of libraries and a command line tool (CLI) for Node.js that helps developers generate, build and run Progressive Web Apps inside Android applications, using Trusted Web Activity.</p>
<p>The CLI can be installed with the following command:</p>
<pre class="shell"><code>npm i -g @bubblewrap/cli</code></pre>
<h3 id="setting-up-the-environment">Setting up the Environment</h3>
<p>When running Bubblewrap for the first time, it will offer to automatically download and install the required external dependencies. We recommend allowing the tool do do this, as it guarantees that the dependencies are configured correctly. Check the <a href="https://github.com/GoogleChromeLabs/bubblewrap/blob/main/packages/cli/README.md">Bubblewrap documentation</a> to use an existing Java Development Kit (JDK) or Android command line tools installation.</p>
<h2 id="initialize-and-build-project-initialize-and-build">Initialize and build project {: initialize-and-build}</h2>
<p>Initializing an Android project that wraps a PWA is done by running the init command:</p>
<pre class="shell"><code>bubblewrap init --manifest=https://my-twa.com/manifest.json</code></pre>
<p>Bubblewrap will read the <a href="https://developer.mozilla.org/en-US/docs/Web/Manifest">Web Manifest</a>, ask developers to confirm values to be used in the Android project, and generate the project using those values. Once the project has been generated, generate an APK by running:</p>
<pre class="shell"><code>bubblewrap build</code></pre>
<h2 id="run-build-and-run">Run {: #build-and-run }</h2>
<p>The build step will output a file called <code>app-release-signed.apk</code>. This file can be installed on a development device for testing or uploaded to the Play Store for release.</p>
<p>Bubblewrap provides a command to install and test the application on a local device. With the development device connected to the computer run:</p>
<pre class="shell"><code>bubblewrap install</code></pre>
<p>Alternatively, the <a href="https://developer.android.com/studio/command-line/adb#move">adb</a> tool can be used.</p>
<pre class="shell"><code>adb install app-release-signed.apk</code></pre>
<p>Note: the <code>adb</code> command-line tool is located inside the Android command-line tools in <code>android_sdk/platform-tools/</code>.</p>
<p>The application should now be available on the device launcher. When opening the application you’ll notice that your website is launched as a Custom Tab, not a Trusted Web Activity, this is because we haven’t set up our Digital Asset Links validation yet, but first…</p>
<h3 id="graphical-user-interface-gui-alternatives-for-bubblewrap">Graphical User Interface (GUI) alternatives for Bubblewrap</h3>
<p><a href="https://www.pwabuilder.com/">PWA Builder</a> provides a GUI interface that uses the Bubblewrap library to power the generation of Trusted Web Activity projects. Find more instructions on how to use PWA Builder to create an Android App that opens your PWA in <a href="https://www.davrous.com/2020/02/07/publishing-your-pwa-in-the-play-store-in-a-couple-of-minutes-using-pwa-builder/">this blogpost</a>.</p>
<h3 id="a-note-on-signing-keys-a-note-on-signing-keys">A note on signing keys {: #a-note-on-signing-keys }</h3>
<p>Digital Asset Links take into account the key that an APK has been signed with and a common cause for verification failing is to use the wrong signature. (Remember, failing verification means you’ll launch your website as a Custom Tab with browser UI at the top of the page.) When Bubblewrap builds the application, an APK will be created with a key setup during the <code>init</code> step. However, when you publish your app in Google Play, another key may be created for you, depending on how you choose to handle signing keys. Learn more on <a href="/docs/android/trusted-web-activity/android-for-web-devs#upload-vs-signing-key">signing keys and how they relate to Bubblewrap and Google Play</a>.</p>
<h2 id="setting-up-your-asset-link-file-creating-your-asset-link-file">Setting up your asset link file {: #creating-your-asset-link-file }</h2>
<p>Digital Asset Links consist essentially of a file on your website that points to your app and some metadata in your app that points to your website.</p>
<p>{% YouTube id=‘3bAQPnxLd4c’ %}</p>
<p>After creating your <code>assetlinks.json</code> file, upload it to your website at <code>.well-known/assetlinks.json</code> relative to the root) so that your app can be verified properly by the browser. Check out a <a href="/docs/android/trusted-web-activity/android-for-web-devs#digital-asset-links">deep dive on Digital Asset Links</a> for more information on how it relates to your signing key.</p>
<h2 id="checking-your-browser-checking-your-browser">Checking your browser {: #checking-your-browser }</h2>
<p>A Trusted Web Activity will try to adhere to the user’s default choice of browser. If the user’s default browser supports Trusted Web Activities, it will be launched. Failing that, if any installed browser supports Trusted Web Activities, it will be chosen. Finally, the default behavior is to fall back to a Custom Tabs mode.</p>
<p>This means that if you’re debugging something to do with Trusted Web Activities, you should make sure you’re using the browser you think that you are. You can use the following command to check which browser is being used:</p>
<pre class="shell"><code>&gt; adb logcat -v brief | grep -e TWAProviderPicker
D/TWAProviderPicker(17168): Found TWA provider, finishing search: com.google.android.apps.chrome</code></pre>
<h2 id="next-steps-next-steps">Next Steps {: #next-steps }</h2>
<p>Hopefully, if you’ve followed this guide, you’ll have a working Trusted Web Activity and have enough knowledge to debug what’s going on when verification fails. If not, have a look at more <a href="/docs/android/trusted-web-activity/android-for-web-devs">Android concepts for web developers</a> or file a GitHub issue against <a href="https://github.com/google/WebFundamentals/issues">these docs</a>.</p>
<p>For your next steps, I’d recommend you start off by <a href="https://developer.android.com/studio/write/image-asset-studio#launcher">creating an icon for your app</a>. With that done, you can consider deploying your app to the Play Store.</p>
</body>
</html>
