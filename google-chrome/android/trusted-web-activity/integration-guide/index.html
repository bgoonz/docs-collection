<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2020-02-04" />
  <title>Integration Guide</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Integration Guide</h1>
<p class="date">2020-02-04</p>
</header>
<p>{% Aside %} Note: A simpler <a href="/docs/android/trusted-web-activity/quick-start">quick start guide for Trusted Web Activities</a> is now available. {% endAside%}</p>
<p>Setting up a Trusted Web Activity doesn’t require developers to author Java code, but <a href="https://developer.android.com/studio/">Android Studio</a> is required. This guide was created using <em>Android Studio 3.3</em>. Check the <a href="https://developer.android.com/studio/install">docs on how to install it</a>.</p>
<h2 id="create-a-trusted-web-activity-project-create-project">Create a Trusted Web Activity Project {: #create-project }</h2>
<p>When using Trusted Web Activities, the project must target API 16 or higher.</p>
<p>Note: This section will guide you on setting up a new project on Android Studio. If you are already familiar with the tool feel free to skip to the <a href="#get-support-lib">Getting the Trusted Web Activity Library</a> section.</p>
<p>Open Android Studio and click on <em>Start a new Android Studio project</em>.</p>
<p>Android Studio will prompt to choose an Activity type. Since Trusted Web Activities use an Activity provided by support library, choose <em>Add No Activity</em> and click <em>Next</em>.</p>
<p>Next step, the wizard will prompt for configurations for the project. Here’s a short description of each field:</p>
<ul>
<li><strong>Name:</strong> The name that will be used for your application on the <em>Android Launcher</em>.</li>
<li><strong>Package Name:</strong> An unique identifier for Android Applications on the Play Store and on Android devices. Check the <a href="https://developer.android.com/guide/topics/manifest/manifest-element#package">documentation</a> for more information on requirements and best practices for creating package names for Android apps.</li>
<li><strong>Save location:</strong> Where Android Studio will create the project in the file system.</li>
<li><strong>Language:</strong> The project doesn’t require writing any Java or Kotlin code. Select Java, as the default.</li>
<li><strong>Minimum API Level:</strong> The Support Library requires at least <em>API Level 16</em>. Select API 16 any version above.</li>
</ul>
<p>Leave the remaining checkboxes unchecked, as we will not be using Instant Apps or AndroidX artifacts, and click <em>Finish</em>.</p>
<h2 id="get-the-trusted-web-activity-support-library-get-support-lib">Get the Trusted Web Activity Support Library {: #get-support-lib }</h2>
<p>To setup the Trusted Web Activity library in the project you will need to edit the Application build file. Look for the <em>Gradle Scripts</em> section in the <em>Project Navigator</em>. There are two files called <code>build.gradle</code>, which may be a bit confusing and the descriptions in parenthesis help identifying the correct one.</p>
<p>The file we are are looking for is the one with module <strong>Module</strong> next to its name.</p>
<p>The Trusted Web Activities library uses <a href="https://developer.android.com/studio/write/java8-support">Java 8 features</a> and the first change enables Java 8. Add a <code>compileOptions</code> section to the bottom of the <code>android</code> section, as below:</p>
<pre class="groovy"><code>android {
        ...
    compileOptions {
       sourceCompatibility JavaVersion.VERSION_1_8
       targetCompatibility JavaVersion.VERSION_1_8
    }
}</code></pre>
<p>The next step will add the Trusted Web Activity Support Library to the project. Add a new dependency to the <code>dependencies</code> section:</p>
<pre class="groovy"><code>dependencies {
    implementation &#39;com.google.androidbrowserhelper:androidbrowserhelper:2.2.0&#39;
}</code></pre>
<p>Android Studio will show prompt asking to synchronize the project once more. Click on the <em>Sync Now</em> link and synchronize it.</p>
<h2 id="launch-the-trusted-web-activity-add-activity">Launch the Trusted Web Activity {: #add-activity }</h2>
<p>Setting up the Trusted Web Activity is achieved by editing the <a href="https://developer.android.com/guide/topics/manifest/manifest-intro">Android App Manifest</a>.</p>
<p>On the <em>Project Navigator</em>, expand the <em>app</em> section, followed by the <em>manifests</em> and double click on <code>AndroidManifest.xml</code> to open the file.</p>
<p>Since we asked Android Studio not to add any Activity to our project when creating it, the manifest is empty and contains only the application tag.</p>
<p>Add the Trusted Web Activity by inserting an <code>activity</code> tag into the <code>application</code> tag:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">&lt;manifest</span><span class="ot"> xmlns:android=</span><span class="st">&quot;http://schemas.android.com/apk/res/android&quot;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="ot">    xmlns:tools=</span><span class="st">&quot;http://schemas.android.com/tools&quot;</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="ot">    package=</span><span class="st">&quot;com.example.twa.myapplication&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="kw">&lt;application</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="ot">        android:allowBackup=</span><span class="st">&quot;true&quot;</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="ot">        android:icon=</span><span class="st">&quot;@mipmap/ic_launcher&quot;</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="ot">        android:label=</span><span class="st">&quot;@string/app_name&quot;</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="ot">        android:roundIcon=</span><span class="st">&quot;@mipmap/ic_launcher_round&quot;</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="ot">        android:supportsRtl=</span><span class="st">&quot;true&quot;</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="ot">        android:theme=</span><span class="st">&quot;@style/AppTheme&quot;</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="ot">        tools:ignore=</span><span class="st">&quot;GoogleAppIndexingWarning&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-13" title="13">        <span class="kw">&lt;activity</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="ot">            android:name=</span><span class="st">&quot;com.google.androidbrowserhelper.trusted.LauncherActivity&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-15" title="15"></a>
<a class="sourceLine" id="cb3-16" title="16">           <span class="co">&lt;!-- Edit android:value to change the url opened by the Trusted Web Activity --&gt;</span></a>
<a class="sourceLine" id="cb3-17" title="17">           <span class="kw">&lt;meta-data</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="ot">               android:name=</span><span class="st">&quot;android.support.customtabs.trusted.DEFAULT_URL&quot;</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="ot">               android:value=</span><span class="st">&quot;https://airhorner.com&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb3-20" title="20"></a>
<a class="sourceLine" id="cb3-21" title="21">           <span class="co">&lt;!-- This intent-filter adds the Trusted Web Activity to the Android Launcher --&gt;</span></a>
<a class="sourceLine" id="cb3-22" title="22">           <span class="kw">&lt;intent-filter&gt;</span></a>
<a class="sourceLine" id="cb3-23" title="23">               <span class="kw">&lt;action</span><span class="ot"> android:name=</span><span class="st">&quot;android.intent.action.MAIN&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb3-24" title="24">               <span class="kw">&lt;category</span><span class="ot"> android:name=</span><span class="st">&quot;android.intent.category.LAUNCHER&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb3-25" title="25">           <span class="kw">&lt;/intent-filter&gt;</span></a>
<a class="sourceLine" id="cb3-26" title="26"></a>
<a class="sourceLine" id="cb3-27" title="27">           <span class="co">&lt;!--</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">             This intent-filter allows the Trusted Web Activity to handle Intents to open</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">             airhorner.com.</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">           --&gt;</span></a>
<a class="sourceLine" id="cb3-31" title="31">           <span class="kw">&lt;intent-filter&gt;</span></a>
<a class="sourceLine" id="cb3-32" title="32">               <span class="kw">&lt;action</span><span class="ot"> android:name=</span><span class="st">&quot;android.intent.action.VIEW&quot;</span><span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb3-33" title="33">               <span class="kw">&lt;category</span><span class="ot"> android:name=</span><span class="st">&quot;android.intent.category.DEFAULT&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb3-34" title="34">               <span class="kw">&lt;category</span><span class="ot"> android:name=</span><span class="st">&quot;android.intent.category.BROWSABLE&quot;</span><span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb3-35" title="35"></a>
<a class="sourceLine" id="cb3-36" title="36">               <span class="co">&lt;!-- Edit android:host to handle links to the target URL--&gt;</span></a>
<a class="sourceLine" id="cb3-37" title="37">               <span class="kw">&lt;data</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="ot">                 android:scheme=</span><span class="st">&quot;https&quot;</span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="ot">                 android:host=</span><span class="st">&quot;airhorner.com&quot;</span><span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb3-40" title="40">           <span class="kw">&lt;/intent-filter&gt;</span></a>
<a class="sourceLine" id="cb3-41" title="41">        <span class="kw">&lt;/activity&gt;</span></a>
<a class="sourceLine" id="cb3-42" title="42">    <span class="kw">&lt;/application&gt;</span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="kw">&lt;/manifest&gt;</span></a></code></pre></div>
<p>The tags added to the XML are standard <a href="https://developer.android.com/guide/topics/manifest/manifest-intro">Android App Manifest</a>. There are two relevant pieces of information for the context of Trusted Web Activities:</p>
<ol type="1">
<li>The <code>meta-data</code> tag tells the Trusted Web Activity which URL it should open. Change the <code>android:value</code> attribute with the URL of the PWA you want to open. In this example, it is <code>https://airhorner.com</code>.</li>
<li>The <strong>second</strong> <code>intent-filter</code> tag allows the Trusted Web Activity to intercept Android Intents that open <code>https://airhorner.com</code>. The <code>android:host</code> attribute inside the <code>data</code> tag must point to the domain being opened by the Trusted Web Activity.</li>
</ol>
<p>Note: When running the project at this stage, the URL Bar from Custom Tabs will still show on the top of the screen. <strong>This is not a bug</strong>.</p>
<p>The next section will show how to setup <a href="/digital-asset-links/v1/getting-started">Digital AssetLinks</a> to verify relationship between the website and the app, and remove the URL bar.</p>
<h2 id="remove-the-url-bar-remove-url-bar">Remove the URL bar {: #remove-url-bar }</h2>
<p>Trusted Web Activities require an association between the Android application and the website to be established to remove the URL bar.</p>
<p>This association is created via <a href="/digital-asset-links/v1/getting-started">Digital Asset Links</a> and the association must be established in both ways, linking <a href="/digital-asset-links/v1/create-statement">from the app to the website</a> and <a href="https://developer.android.com/training/app-links/verify-site-associations#web-assoc">from the website to the app</a>.</p>
<p>It is possible to setup the app to website validation and setup Chrome to skip the website to app validation, for debugging purposes.</p>
<h3 id="establish-an-association-from-app-to-the-website-link-app-to-site">Establish an association from app to the website {: #link-app-to-site }</h3>
<p>Open the string resources file <code>app &gt; res &gt; values &gt; strings.xml</code> and add the Digital AssetLinks statement below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">&lt;resources&gt;</span></a>
<a class="sourceLine" id="cb4-2" title="2">    <span class="kw">&lt;string</span><span class="ot"> name=</span><span class="st">&quot;app_name&quot;</span><span class="kw">&gt;</span>AirHorner Trusted Web Activity<span class="kw">&lt;/string&gt;</span></a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="kw">&lt;string</span><span class="ot"> name=</span><span class="st">&quot;asset_statements&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-4" title="4">        [{</a>
<a class="sourceLine" id="cb4-5" title="5">            \&quot;relation\&quot;: [\&quot;delegate_permission/common.handle_all_urls\&quot;],</a>
<a class="sourceLine" id="cb4-6" title="6">            \&quot;target\&quot;: {</a>
<a class="sourceLine" id="cb4-7" title="7">                \&quot;namespace\&quot;: \&quot;web\&quot;,</a>
<a class="sourceLine" id="cb4-8" title="8">                \&quot;site\&quot;: \&quot;https://airhorner.com\&quot;}</a>
<a class="sourceLine" id="cb4-9" title="9">        }]</a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="kw">&lt;/string&gt;</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="kw">&lt;/resources&gt;</span></a></code></pre></div>
<p>Change the contents for the <code>site</code> attribute to match the schema and domain opened by the Trusted Web Activity.</p>
<p>Back in the Android App Manifest file, <code>AndroidManifest.xml</code>, link to the statement by adding a new <code>meta-data</code> tag, but this time as a child of the <code>application</code> tag:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">&lt;manifest</span><span class="ot"> xmlns:android=</span><span class="st">&quot;http://schemas.android.com/apk/res/android&quot;</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="ot">    package=</span><span class="st">&quot;com.example.twa.myapplication&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="kw">&lt;application</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="ot">        android:allowBackup=</span><span class="st">&quot;true&quot;</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="ot">        android:icon=</span><span class="st">&quot;@mipmap/ic_launcher&quot;</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="ot">        android:label=</span><span class="st">&quot;@string/app_name&quot;</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="ot">        android:roundIcon=</span><span class="st">&quot;@mipmap/ic_launcher_round&quot;</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="ot">        android:supportsRtl=</span><span class="st">&quot;true&quot;</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="ot">        android:theme=</span><span class="st">&quot;@style/AppTheme&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb5-11" title="11"></a>
<a class="sourceLine" id="cb5-12" title="12">        <span class="kw">&lt;meta-data</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="ot">            android:name=</span><span class="st">&quot;asset_statements&quot;</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="ot">            android:resource=</span><span class="st">&quot;@string/asset_statements&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb5-15" title="15"></a>
<a class="sourceLine" id="cb5-16" title="16">        <span class="kw">&lt;activity&gt;</span></a>
<a class="sourceLine" id="cb5-17" title="17">            ...</a>
<a class="sourceLine" id="cb5-18" title="18">        <span class="kw">&lt;/activity&gt;</span></a>
<a class="sourceLine" id="cb5-19" title="19"></a>
<a class="sourceLine" id="cb5-20" title="20">    <span class="kw">&lt;/application&gt;</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="kw">&lt;/manifest&gt;</span></a></code></pre></div>
<p>We have now established a relationship from the Android application to the website. It is helpful to debug this part of the relationship without creating the website to application validation.</p>
<p>Here’s how to test this on a development device:</p>
<h3 id="enable-debug-mode-debugging">Enable debug mode {: #debugging }</h3>
<ol type="1">
<li>Open Chrome on the development device, navigate to <code>chrome://flags</code>, search for an item called <em>Enable command line on non-rooted devices</em> and change it to <strong>ENABLED</strong> and then restart the browser.</li>
<li>Next, on the Terminal application of your operating system, use the <a href="https://developer.android.com/studio/command-line/adb">Android Debug Bridge</a> (installed with Android Studio), and run the following command:</li>
</ol>
<pre class="devsite-terminal devsite-click-to-copy">
adb shell "echo '_ --disable-digital-asset-link-verification-for-url=\"https://airhorner.com\"' > /data/local/tmp/chrome-command-line"
</pre>
<p>Close Chrome and re-launch your application from Android Studio. The application should now be shown in full-screen.</p>
<p>Note: It may needed to force close Chrome so it restarts with the correct command line. Go to <em>Android Settings &gt; Apps &amp; notifications &gt; Chrome</em>, and click on <em>Force stop</em>.</p>
<h2 id="establish-an-association-from-the-website-to-the-app-link-site-to-app">Establish an association from the website to the app {: #link-site-to-app }</h2>
<p>{% YouTube id=‘3bAQPnxLd4c’ %}</p>
<p>There are 2 pieces of information that the developer needs to collect from the app in order to create the association:</p>
<ul>
<li><strong>Package Name:</strong> The first information is the package name for the app. This is the same package name generated when creating the app. It can also be found inside the <strong>Module</strong> <code>build.gradle</code>, under <em>Gradle Scripts &gt; build.gradle (Module: app)</em>, and is the value of the <code>applicationId</code> attribute.</li>
<li><strong>SHA-256 Fingerprint:</strong> Android applications must be signed in order to be uploaded to the Play Store. The same signature is used to establish the connection between the website and the app through the SHA-256 fingerprint of the upload key.</li>
</ul>
<p>The Android documentation <a href="https://developer.android.com/studio/publish/app-signing#generate-key">explains in detail how to generate a key using Android Studio</a>. Make sure to take note the <em>path</em>, <em>alias</em> and <em>passwords</em> for the key store, as you will need it for the next step.</p>
<p>Extract the SHA-256 fingerprint using the <a href="https://docs.oracle.com/javase/6/docs/technotes/tools/windows/keytool.html">keytool</a>, with the following command:</p>
<pre class="devsite-terminal devsite-click-to-copy">
keytool -list -v -keystore [path] -alias [alias] -storepass [password] -keypass [password]
</pre>
<p>The value for the <em>SHA-256 fingerprint</em> is printed under the <em>Certificate</em> fingerprints section. Here’s an example output:</p>
<pre>
<code class="devsite-terminal">keytool -list -v -keystore ./mykeystore.ks -alias test -storepass password -keypass password</code>

Alias name: key0
Creation date: 28 Jan 2019
Entry type: PrivateKeyEntry
Certificate chain length: 1
Certificate[1]:
Owner: CN=Test Test, OU=Test, O=Test, L=London, ST=London, C=GB
Issuer: CN=Test Test, OU=Test, O=Test, L=London, ST=London, C=GB
Serial number: ea67d3d
Valid from: Mon Jan 28 14:58:00 GMT 2019 until: Fri Jan 22 14:58:00 GMT 2044
Certificate fingerprints:
   SHA1: 38:03:D6:95:91:7C:9C:EE:4A:A0:58:43:A7:43:A5:D2:76:52:EF:9B
   SHA256: F5:08:9F:8A:D4:C8:4A:15:6D:0A:B1:3F:61:96:BE:C7:87:8C:DE:05:59:92:B2:A3:2D:05:05:A5:62:A5:2F:34
Signature algorithm name: SHA256withRSA
Subject Public Key Algorithm: 2048-bit RSA key
Version: 3
</pre>
<p>With both pieces of information at hand, head over to the <a href="/digital-asset-links/tools/generator">assetlinks generator</a>, fill-in the fields and hit <em>Generate Statement</em>. Copy the generated statement and serve it from your domain, from the URL <code>/.well-known/assetlinks.json</code>.</p>
<p>Note: The <code>AssetLinks</code> file must be under <code>/.well-known/assetlinks.json</code>, at the root of the domain, as that’s only the place Chrome will look for it.</p>
<h3 id="creating-an-icon-create-icon">Creating an Icon {: #create-icon}</h3>
<p>When Android Studio creates a new project, it will come with a default Icon. As a developer, you will want to create your own icon and differentiate your application from others on the Android Launcher.</p>
<p>Android Studio contains the <a href="https://developer.android.com/studio/write/image-asset-studio">Image Asset Studio</a>, which provides the tools necessary to create the correct icons, for every resolution and shape your application needs.</p>
<p>Inside Android Studio, navigate to <code>File &gt; New &gt; Image Asset</code>, select <code>Launcher Icons (Adaptative and Legacy)</code> and follow the steps from the Wizard. to create a custom icon for the application.</p>
<h3 id="generating-a-signed-apk-create-signed-apk">Generating a signed APK {: #create-signed-apk }</h3>
<p>With the <code>assetlinks</code> file in place in your domain and the <code>asset_statements</code> tag configured in the Android application, the next step is generating a signed app. Again, the steps for this are widely <a href="https://developer.android.com/studio/publish/app-signing#sign-apk">documented</a>.</p>
<p>The output APK can be installed into a test device, using adb:</p>
<pre class="devsite-terminal devsite-click-to-copy">
adb install app-release.apk
</pre>
<p>If the verification step fails it is possible to check for error messages using the Android Debug Bridge, from your OS’s terminal and with the test device connected.</p>
<pre class="devsite-terminal devsite-click-to-copy">
adb logcat | grep -e OriginVerifier -e digital_asset_links
</pre>
<p>With the upload APK generated, you can now <a href="https://developer.android.com/studio/publish/upload-bundle">upload the app to the Play Store</a>.</p>
<h2 id="adding-a-splash-screen-making-a-splash">Adding a Splash Screen {: #making-a-splash }</h2>
<p>Starting on <strong>Chrome 75</strong>, Trusted Web Activities have support for Splash Screens. The Splash Screen can be set up by adding a few new image files and configurations to the project.</p>
<p>Make sure to update to <strong>Chrome 75 or above</strong> and use the <a href="https://github.com/GoogleChrome/android-browser-helper/">latest version of Trusted Web Activity Support Library</a>.</p>
<h3 id="generating-the-images-for-the-splash-screen-create-images">Generating the images for the Splash Screen {: #create-images }</h3>
<p>Android devices can have different <a href="https://developer.android.com/training/multiscreen/screensizes">screen sizes</a> and <a href="https://developer.android.com/training/multiscreen/screendensities">pixel densities</a>. To ensure the Splash Screen looks good on all devices, you will need to generate the image for each pixel density.</p>
<p>A full explanation of <a href="https://developer.android.com/training/multiscreen/screendensities#TaskUseDP">display-independent pixels (dp or dip)</a> is beyond the scope of this article, but one example would be to create an image that is 320x320dp, which represents a square of 2x2 inches on a device screen of any density and is equivalent to 320x320 <strong>pixels</strong> at the <em>mdpi</em> density.</p>
<p>From there we can derive the sizes needed for other pixel densities. Below is a list with the pixel densities, the multiplier applied to the base size (320x320dp), the resulting size in pixels and the location where the image should be added in the Android Studio project.</p>
<table>
<thead>
<tr class="header">
<th>Density</th>
<th>Multiplier</th>
<th>Size</th>
<th>Project Location</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mdpi (baseline)</td>
<td>1.0x</td>
<td>320x320 px</td>
<td>/res/drawable-mdpi/</td>
</tr>
<tr class="even">
<td>ldpi</td>
<td>0.75x</td>
<td>240x240 px</td>
<td>/res/drawable-ldpi/</td>
</tr>
<tr class="odd">
<td>hdpi</td>
<td>1.5x</td>
<td>480x480 px</td>
<td>/res/drawable-hdpi/</td>
</tr>
<tr class="even">
<td>xhdpi</td>
<td>2.0x</td>
<td>640x640 px</td>
<td>/res/drawable-xhdpi/</td>
</tr>
<tr class="odd">
<td>xxhdpi</td>
<td>3.0x</td>
<td>960x960 px</td>
<td>/res/drawable-xxhdpi/</td>
</tr>
<tr class="even">
<td>xxxhdpi</td>
<td>4.0x</td>
<td>1280x1280 px</td>
<td>/res/drawable-xxxhdpi/</td>
</tr>
</tbody>
</table>
<p>Note: An alternative to creating all the images sizes is to use one <a href="https://developer.android.com/reference/android/graphics/drawable/VectorDrawable">Vector Drawable</a>. The <a href="https://developer.android.com/studio/write/vector-asset-studio">Vector Asset Studio</a> offers tools to help developers to transform SVGs into Android Vector Drawables.</p>
<h3 id="updating-the-application-add-splash-markup">Updating the application {: #add-splash-markup }</h3>
<p>With the images for the splash screen generated, it’s time to add the necessary configurations to the project.</p>
<p>First, add a <a href="https://developer.android.com/guide/topics/providers/content-provider-basics">content-provider</a> to the Android Manifest (<code>AndroidManifest.xml</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">&lt;application&gt;</span></a>
<a class="sourceLine" id="cb6-2" title="2">    ...</a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="kw">&lt;provider</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="ot">        android:name=</span><span class="st">&quot;androidx.core.content.FileProvider&quot;</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="ot">        android:authorities=</span><span class="st">&quot;com.example.twa.myapplication.fileprovider&quot;</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="ot">        android:grantUriPermissions=</span><span class="st">&quot;true&quot;</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="ot">        android:exported=</span><span class="st">&quot;false&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb6-8" title="8">        <span class="kw">&lt;meta-data</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="ot">            android:name=</span><span class="st">&quot;android.support.FILE_PROVIDER_PATHS&quot;</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="ot">            android:resource=</span><span class="st">&quot;@xml/filepaths&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb6-11" title="11">    <span class="kw">&lt;/provider&gt;</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="kw">&lt;/application&gt;</span></a></code></pre></div>
<p>Note: Make sure to change the <code>android:authorities</code> attribute when creating the provider, as two applications cannot have the same authority on a device.</p>
<p>Then, add <code>res/xml/filepaths.xml</code> resource, and specify the path to the twa splash screen:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">&lt;paths&gt;</span></a>
<a class="sourceLine" id="cb7-2" title="2">    <span class="kw">&lt;files-path</span><span class="ot"> path=</span><span class="st">&quot;twa_splash/&quot;</span><span class="ot"> name=</span><span class="st">&quot;twa_splash&quot;</span> <span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">&lt;/paths&gt;</span></a></code></pre></div>
<p>Finally, add <code>meta-tags</code> to the Android Manifest to customize the LauncherActivity:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">&lt;activity</span><span class="ot"> android:name=</span><span class="st">&quot;com.google.androidbrowserhelper.trusted.LauncherActivity&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb8-2" title="2">    ...</a>
<a class="sourceLine" id="cb8-3" title="3">    <span class="kw">&lt;meta-data</span><span class="ot"> android:name=</span><span class="st">&quot;android.support.customtabs.trusted.SPLASH_IMAGE_DRAWABLE&quot;</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="ot">               android:resource=</span><span class="st">&quot;@drawable/splash&quot;</span><span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb8-5" title="5">    <span class="kw">&lt;meta-data</span><span class="ot"> android:name=</span><span class="st">&quot;android.support.customtabs.trusted.SPLASH_SCREEN_BACKGROUND_COLOR&quot;</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="ot">               android:resource=</span><span class="st">&quot;@color/colorPrimary&quot;</span><span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb8-7" title="7">    <span class="kw">&lt;meta-data</span><span class="ot"> android:name=</span><span class="st">&quot;android.support.customtabs.trusted.SPLASH_SCREEN_FADE_OUT_DURATION&quot;</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="ot">               android:value=</span><span class="st">&quot;300&quot;</span><span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb8-9" title="9">    <span class="kw">&lt;meta-data</span><span class="ot"> android:name=</span><span class="st">&quot;android.support.customtabs.trusted.FILE_PROVIDER_AUTHORITY&quot;</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="ot">               android:value=</span><span class="st">&quot;com.example.twa.myapplication.fileprovider&quot;</span><span class="kw">/&gt;</span></a>
<a class="sourceLine" id="cb8-11" title="11">    ...</a>
<a class="sourceLine" id="cb8-12" title="12"><span class="kw">&lt;/activity&gt;</span></a></code></pre></div>
<p>Ensure that the value of the <code>android.support.customtabs.trusted.FILE_PROVIDER_AUTHORITY</code> tag matches the value defined of the <code>android:authorities</code> attribute inside the <code>provider</code> tag.</p>
<h3 id="making-the-launcheractivity-transparent-transparent-launcher">Making the LauncherActivity transparent {: #transparent-launcher }</h3>
<p>Additionally, make sure the LauncherActivity is transparent to avoid a white screen showing before the splash by setting a translucent theme for the LauncherActivity:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">&lt;application&gt;</span></a>
<a class="sourceLine" id="cb9-2" title="2">    ...</a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="kw">&lt;activity</span><span class="ot"> android:name=</span><span class="st">&quot;com.google.androidbrowserhelper.trusted.LauncherActivity&quot;</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="ot">              android:theme=</span><span class="st">&quot;@android:style/Theme.Translucent.NoTitleBar&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb9-5" title="5">    ...</a>
<a class="sourceLine" id="cb9-6" title="6">    <span class="kw">&lt;/activity&gt;</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">&lt;/application&gt;</span></a></code></pre></div>
<p>We are looking forward to see what developers build with Trusted Web Activities. To drop any feedback, reach out to us at <span class="citation" data-cites="ChromiumDev">[@ChromiumDev]</span>(https://twitter.com/ChromiumDev).</p>
</body>
</html>
