<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2012-09-21" />
  <title>The activeTab permission</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">The activeTab permission</h1>
<p class="date">2012-09-21</p>
</header>
<p>The <code>activeTab</code> permission gives an extension temporary access to the currently active tab when the user <em>invokes</em> the extension - for example by clicking its <a href="/docs/extensions/reference/action">action</a>. Access to the tab lasts while the user is on that page, and is revoked when the user navigates away or closes the tab.</p>
<p>This serves as an alternative for many uses of <code>&lt;all_urls&gt;</code>, but displays <em>no warning message</em> during installation:</p>
<p><strong>Note:</strong> From M72 onwards, the <code>activeTab</code> permission will be granted until the user navigates to a different origin. That is, if the user invokes the extension on https://example.com and then navigates to https://example.com/foo, the extension will continue to have access to the page. If the user navigates to https://chromium.org, access is revoked.</p>
<p>Without <code>activeTab</code>:</p>
<p>{% Img src=“image/BrQidfK9jaQyIHwdw91aVpkPiib2/yNt7dAfXO9RlkRjr0rMV.png”, alt=“Without activeTab”, height=“190”, width=“490” %}</p>
<p>With <code>activeTab</code>:</p>
<p>{% Img src=“image/BrQidfK9jaQyIHwdw91aVpkPiib2/rejIX68BPQrssxbh98BH.png”, alt=“With activeTab”, height=“190”, width=“490” %}</p>
<h2 id="example-example">Example {: #example }</h2>
<p>See the <a href="https://github.com/GoogleChrome/chrome-extensions-samples/tree/main/examples/page-redder">Page Redder</a> sample extension:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb1-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Page Redder&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;2.0&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">&quot;permissions&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="st">&quot;activeTab&quot;</span></a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="dt">&quot;background&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-8" title="8">    <span class="dt">&quot;service_worker&quot;</span><span class="fu">:</span> <span class="st">&quot;background.js&quot;</span></a>
<a class="sourceLine" id="cb1-9" title="9">  <span class="fu">},</span></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="dt">&quot;action&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="dt">&quot;default_title&quot;</span><span class="fu">:</span> <span class="st">&quot;Make this page red&quot;</span></a>
<a class="sourceLine" id="cb1-12" title="12">  <span class="fu">},</span></a>
<a class="sourceLine" id="cb1-13" title="13">  <span class="dt">&quot;manifest_version&quot;</span><span class="fu">:</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="fu">}</span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="co">// Called when the user clicks on the action.</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="va">chrome</span>.<span class="va">action</span>.<span class="va">onClicked</span>.<span class="at">addListener</span>(<span class="kw">function</span>(tab) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="co">// No tabs or host permissions needed!</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Turning &#39;</span> <span class="op">+</span> <span class="va">tab</span>.<span class="at">url</span> <span class="op">+</span> <span class="st">&#39; red!&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="va">chrome</span>.<span class="va">scripting</span>.<span class="at">executeScript</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="dt">code</span><span class="op">:</span> <span class="st">&#39;document.body.style.backgroundColor=&quot;red&quot;&#39;</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="motivation-motivation">Motivation {: #motivation }</h2>
<p>Consider a web clipping extension that has a <a href="/docs/extensions/reference/action">action</a> and <a href="/docs/extensions/reference/contextMenus">context menu item</a>. This extension may only really need to access tabs when its browser action is clicked, or when its context menu item is executed.</p>
<p>Without <code>activeTab</code>, this extension would need to request full, persistent access to every web site, just so that it could do its work if it happened to be called upon by the user. This is a lot of power to entrust to such a simple extension. And if the extension is ever compromised, the attacker gets access to everything the extension had.</p>
<p>In contrast, an extension with the <code>activeTab</code> permission only obtains access to a tab in response to an explicit user gesture. If the extension is compromised the attacker would need to wait for the user to invoke the extension before obtaining access. And that access only lasts until the tab is navigated or is closed.</p>
<h2 id="what-activetab-allows-what-activetab-allows">What activeTab allows {: #what-activeTab-allows }</h2>
<p>While the <code>activeTab</code> permission is enabled for a tab, an extension can:</p>
<ul>
<li>Call <a href="/docs/extensions/reference/scripting#method-insertCSS"><code>scripting.insertCSS</code></a> on that tab.</li>
<li>Get the URL, title, and favicon for that tab via an API that returns a <a href="/docs/extensions/reference/tabs#type-Tab"><code>tabs.Tab</code></a> object (essentially, <code>activeTab</code> grants the <a href="/docs/extensions/reference/tabs#manifest"><code>tabs</code></a> permission temporarily).</li>
<li>Intercept network requests in the tab to the tab’s main frame origin using the <a href="/docs/extensions/reference/webRequest">webRequest</a> API. The extension temporarily gets host permissions for the tab’s main frame origin.</li>
</ul>
<h2 id="invoking-activetab-invoking-activetab">Invoking activeTab {: #invoking-activeTab }</h2>
<p>The following user gestures enable <code>activeTab</code>:</p>
<ul>
<li>Executing a <a href="/docs/extensions/reference/action">action</a></li>
<li>Executing a <a href="/docs/extensions/reference/contextMenus">context menu item</a></li>
<li>Executing a keyboard shortcut from the <a href="/docs/extensions/reference/commands">commands API</a></li>
<li>Accepting a suggestion from the <a href="/docs/extensions/reference/omnibox">omnibox API</a></li>
</ul>
</body>
</html>
