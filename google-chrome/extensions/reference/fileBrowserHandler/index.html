<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>index</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<p>The Chrome OS file browser comes up when the user either presses Alt+Shift+M or connects an external storage device, such as an SD card, USB key, external drive, or digital camera. Besides showing the files on external devices, the file browser can also display files that the user has previously saved to the system.</p>
<p>When the user selects one or more files, the file browser adds buttons representing the valid handlers for those files. For example, in the following screenshot, selecting a file with a “.png” suffix results in an “Save to Gallery” button that the user can click.</p>
<figure>
<img src="filebrowserhandler.png" alt="File browser screenshot" /><figcaption>File browser screenshot</figcaption>
</figure>
<h2 id="manifest">Manifest</h2>
<p>You must declare the “fileBrowserHandler” permission in the <a href="/extensions/manifest">extension manifest</a>, and you must use the “file_browser_handlers” field to register the extension as a handler of at least one file type. You should also provide a 16x16 icon to be displayed on the button. For example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb1-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;My extension&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="er">...</span></a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">&quot;file_browser_handlers&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-6" title="6">      <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;upload&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-7" title="7">      <span class="dt">&quot;default_title&quot;</span><span class="fu">:</span> <span class="st">&quot;Save to Gallery&quot;</span><span class="fu">,</span> <span class="er">//</span> <span class="er">What</span> <span class="er">the</span> <span class="er">button</span> <span class="er">will</span> <span class="er">display</span></a>
<a class="sourceLine" id="cb1-8" title="8">      <span class="dt">&quot;file_filters&quot;</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb1-9" title="9">        <span class="st">&quot;filesystem:*.jpg&quot;</span><span class="ot">,</span>  <span class="er">//</span> <span class="er">To</span> <span class="er">match</span> <span class="er">all</span> <span class="er">files</span><span class="ot">,</span> <span class="er">use</span> <span class="st">&quot;filesystem:*.*&quot;</span></a>
<a class="sourceLine" id="cb1-10" title="10">        <span class="st">&quot;filesystem:*.jpeg&quot;</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb1-11" title="11">        <span class="st">&quot;filesystem:*.png&quot;</span></a>
<a class="sourceLine" id="cb1-12" title="12">      <span class="ot">]</span></a>
<a class="sourceLine" id="cb1-13" title="13">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb1-14" title="14">  <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-15" title="15">  <span class="dt">&quot;permissions&quot;</span> <span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb1-16" title="16">    <span class="st">&quot;fileBrowserHandler&quot;</span></a>
<a class="sourceLine" id="cb1-17" title="17">  <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-18" title="18">  <span class="dt">&quot;icons&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-19" title="19">    <span class="dt">&quot;16&quot;</span><span class="fu">:</span> <span class="st">&quot;icon16.png&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-20" title="20">    <span class="dt">&quot;48&quot;</span><span class="fu">:</span> <span class="st">&quot;icon48.png&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-21" title="21">    <span class="dt">&quot;128&quot;</span><span class="fu">:</span> <span class="st">&quot;icon128.png&quot;</span></a>
<a class="sourceLine" id="cb1-22" title="22">  <span class="fu">},</span></a>
<a class="sourceLine" id="cb1-23" title="23">  <span class="er">...</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="fu">}</span></a></code></pre></div>
<p>{% Aside %}</p>
<p><strong>Note:</strong> You can specify locale-specific strings for the value of “default_title”. See <a href="/extensions/i18n">Internationalization (i18n)</a> for details.</p>
<p>{% endAside %}</p>
<h2 id="implementing-a-file-browser-handler">Implementing a file browser handler</h2>
<p>To use this API, you must implement a function that handles the <code>onExecute</code> event of <code>chrome.fileBrowserHandler</code>. Your function will be called whenever the user clicks the button that represents your file browser handler. In your function, use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystemFileEntry">File System API</a> to get access to the file contents. Here is an example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="va">chrome</span>.<span class="va">fileBrowserHandler</span>.<span class="va">onExecute</span>.<span class="at">addListener</span>(<span class="kw">async</span> (id<span class="op">,</span> details) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="cf">if</span> (id <span class="op">!==</span> <span class="st">&#39;upload&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="cf">return</span><span class="op">;</span>  <span class="co">// check if you have multiple file_browser_handlers</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="op">}</span></a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="cf">for</span> (<span class="kw">const</span> entry <span class="kw">of</span> <span class="va">detail</span>.<span class="at">entries</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-7" title="7">    <span class="co">// the FileSystemFileEntry doesn&#39;t have a Promise API, wrap in one</span></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="kw">const</span> file <span class="op">=</span> <span class="cf">await</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-9" title="9">      <span class="va">entry</span>.<span class="at">file</span>(resolve<span class="op">,</span> reject)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-10" title="10">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="kw">const</span> buffer <span class="op">=</span> <span class="cf">await</span> <span class="va">file</span>.<span class="at">arrayBuffer</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="co">// do something with buffer</span></a>
<a class="sourceLine" id="cb2-13" title="13">  <span class="op">}</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Your event handler is passed two arguments:</p>
<dl>
<dt>id</dt>
<dd><p>The “id” value from the manifest file. If your extension implements multiple handlers, you can check the id value to see which handler has been triggered.</p>
</dd>
<dt>details</dt>
<dd><p>An object describing the event. You can get the file or files that the user has selected from the <code>entries</code> field of this object, which is an array of <code>FileSystemFileEntry</code> objects.</p>
</dd>
</dl>
</body>
</html>
