<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>index</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<p>You can use the <code>chrome.action</code> API to control the toolbar button for your extension in Chrome’s UI. The action icons are displayed in the browser toolbar, to the right of the omnibox (on left-to-right devices). After installation, by default, these appear in the extensions menu (the puzzle piece). Users can choose to pin your extension icon to the toolbar.</p>
<p>Note that every extension will have an icon in the toolbar in Chrome, even if the <code>action</code> key is not specified.</p>
<h2 id="manifest">Manifest</h2>
<p>In order to use the <code>chrome.action</code> API, you need to specify a <code>"manifest_version"</code> of <code>3</code> or higher and include the <code>action</code> key in your <a href="/docs/extensions/mv3/manifest">manifest file</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb1-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Action Extension&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="er">...</span></a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">&quot;action&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="dt">&quot;default_icon&quot;</span><span class="fu">:</span> <span class="fu">{</span>              <span class="er">//</span> <span class="er">optional</span></a>
<a class="sourceLine" id="cb1-6" title="6">      <span class="dt">&quot;16&quot;</span><span class="fu">:</span> <span class="st">&quot;images/icon16.png&quot;</span><span class="fu">,</span>   <span class="er">//</span> <span class="er">optional</span></a>
<a class="sourceLine" id="cb1-7" title="7">      <span class="dt">&quot;24&quot;</span><span class="fu">:</span> <span class="st">&quot;images/icon24.png&quot;</span><span class="fu">,</span>   <span class="er">//</span> <span class="er">optional</span></a>
<a class="sourceLine" id="cb1-8" title="8">      <span class="dt">&quot;32&quot;</span><span class="fu">:</span> <span class="st">&quot;images/icon32.png&quot;</span>    <span class="er">//</span> <span class="er">optional</span></a>
<a class="sourceLine" id="cb1-9" title="9">    <span class="fu">},</span></a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="dt">&quot;default_title&quot;</span><span class="fu">:</span> <span class="st">&quot;Click Me&quot;</span><span class="fu">,</span>   <span class="er">//</span> <span class="er">optional</span><span class="fu">,</span> <span class="er">shown</span> <span class="er">in</span> <span class="er">tooltip</span></a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="dt">&quot;default_popup&quot;</span><span class="fu">:</span> <span class="st">&quot;popup.html&quot;</span>  <span class="er">//</span> <span class="er">optional</span></a>
<a class="sourceLine" id="cb1-12" title="12">  <span class="fu">},</span></a>
<a class="sourceLine" id="cb1-13" title="13">  <span class="er">...</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="fu">}</span></a></code></pre></div>
<p>Each of these values is optional; an empty dictionary is technically allowed.</p>
<p>These properties are described more below.</p>
<h2 id="parts-of-the-ui">Parts of the UI</h2>
<h3 id="icon">Icon</h3>
<p>The icon is the main image used in the toolbar button. Icons are 16 DIPs (device-independent pixels) wide and tall. The icon is initially set by the <code>default_icon</code> key in the <code>action</code> entry in the <code>manifest.json</code> file. This key is a dictionary of sizes to image paths. Chrome will use these icons to choose which image scale to use. If an exact match is not found, Chrome will select the closest available and scale it to fit the image. However, this scaling can cause the icon to lose detail or look fuzzy.</p>
<p>Since devices with less-common scale factors like 1.5x or 1.2x are becoming more common, you are encouraged to provide multiple sizes for your icons. This also ensures that if the icon display size is ever changed, you don’t need to do any more work to provide different icons.</p>
<p>The icon can also be set programmatically using the <code>action.setIcon()</code> method. This can be used to specify a different image path or to provide a dynamically-generated icon using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement">HTML canvas element</a>, or, if setting from an extension service worker, the <a href="https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas">offscreen canvas</a> API.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">const</span> canvas <span class="op">=</span> <span class="kw">new</span> <span class="at">OffscreenCanvas</span>(<span class="dv">16</span><span class="op">,</span> <span class="dv">16</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">const</span> context <span class="op">=</span> <span class="va">canvas</span>.<span class="at">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="va">context</span>.<span class="at">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">16</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="va">context</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&#39;#00FF00&#39;</span><span class="op">;</span>  <span class="co">// Green</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="va">context</span>.<span class="at">fillRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">16</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">const</span> imageData <span class="op">=</span> <span class="va">context</span>.<span class="at">getImageData</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">16</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="va">chrome</span>.<span class="va">action</span>.<span class="at">setIcon</span>(<span class="op">{</span><span class="dt">imageData</span><span class="op">:</span> imageData<span class="op">},</span> () <span class="kw">=&gt;</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>{% Aside %}</p>
<p>The <code>action.setIcon()</code> API is intended to set a static image. It should not be used to simulate animation.</p>
<p>{% endAside %}</p>
<h4 id="formats">Formats</h4>
<p>For packed extensions (installed from a .crx file), images can be in most formats that the Blink rendering engine can display, including PNG, JPEG, BMP, ICO, and others (SVG is not supported). Unpacked extensions must use images in the PNG format.</p>
<h3 id="tooltip-title">Tooltip (title)</h3>
<p>The tooltip, or title, appears when the user hovers the mouse on the extension’s icon in the toolbar. It is also included in the accessible text spoken by screenreaders when the button gets focus.</p>
<p>The default tooltip is set from the <code>default_title</code> field of the <code>action</code> object in <code>manifest.json</code>. You can also set it programmatically with the <code>action.setTitle()</code> method.</p>
<h3 id="badge">Badge</h3>
<p>Actions can optionally display a “badge” — a bit of text layered over the icon. This makes it easy to update the action to display a small amount of information about the state of the extension, such as a counter. The badge has a text component and a background color.</p>
<p>Note that the badge has limited space, and should typically use four characters or fewer.</p>
<p>The badge does not have a default taken from the manifest; you can set it programmatically with <code>action.setBadgeBackgroundColor()</code> and <code>action.setBadgeText()</code>. When setting the color, the values can be either an array of four integers between 0 and 255 that make up the RGBA color of the badge or a string with a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color">CSS color</a> value.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="va">chrome</span>.<span class="va">action</span>.<span class="at">setBadgeBackgroundColor</span>(</a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="op">{</span><span class="dt">color</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">255</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">},</span>  <span class="co">// Green</span></a>
<a class="sourceLine" id="cb3-3" title="3">  () <span class="kw">=&gt;</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb3-4" title="4">)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="va">chrome</span>.<span class="va">action</span>.<span class="at">setBadgeBackgroundColor</span>(</a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="op">{</span><span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#00FF00&#39;</span><span class="op">,</span>  <span class="co">// Also green</span></a>
<a class="sourceLine" id="cb3-8" title="8">  () <span class="kw">=&gt;</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb3-9" title="9">)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-10" title="10"></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="va">chrome</span>.<span class="va">action</span>.<span class="at">setBadgeBackgroundColor</span>(</a>
<a class="sourceLine" id="cb3-12" title="12">  <span class="op">{</span><span class="dt">color</span><span class="op">:</span> <span class="st">&#39;green&#39;</span><span class="op">},</span>  <span class="co">// Also, also green</span></a>
<a class="sourceLine" id="cb3-13" title="13">  () <span class="kw">=&gt;</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb3-14" title="14">)<span class="op">;</span></a></code></pre></div>
<h3 id="popup">Popup</h3>
<p>An action’s popup will be shown when the user clicks on the extension’s action button in the toolbar. The popup can contain any HTML contents you like, and will be automatically sized to fit its contents. The popup cannot be smaller than 25x25 and cannot be larger than 800x600.</p>
<p>The popup is initially set from the <code>default_popup</code> property in the <code>action</code> key in the <code>manifest.json</code> file. If present, this should point to a relative path within the extension directory. It can also be updated dynamically to point to a different relative path using the <code>action.setPopup()</code> method.</p>
<p>{% Aside %}</p>
<p>The <code>action.onClicked</code> event will not be dispatched if the extension action has specified a popup to show on click on the current tab.</p>
<p>{% endAside %}</p>
<h2 id="per-tab-state">Per-tab state</h2>
<p>Extension actions can have different states for each tab. For instance, you could set the badge text to be different on each tab (to show tab-specific state). You can set the value for an individual tab using the <code>tabId</code> property in the various setting methods on the <code>action</code> API. For instance, to set the badge text on a specific tab, you would do something like the following:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">function</span> <span class="at">getTabId</span>() <span class="op">{</span> <span class="co">/* ... */</span><span class="op">}</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">function</span> <span class="at">getTabBadge</span>() <span class="op">{</span> <span class="co">/* ... */</span><span class="op">}</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="va">chrome</span>.<span class="va">action</span>.<span class="at">setBadgeText</span>(</a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="op">{</span></a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="dt">text</span><span class="op">:</span> <span class="at">getTabBadge</span>(tabId)<span class="op">,</span></a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="dt">tabId</span><span class="op">:</span> <span class="at">getTabId</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="op">},</span></a>
<a class="sourceLine" id="cb4-9" title="9">  () <span class="kw">=&gt;</span> <span class="op">{</span> ... <span class="op">}</span></a>
<a class="sourceLine" id="cb4-10" title="10">)<span class="op">;</span></a></code></pre></div>
<p>If the <code>tabId</code> property is omitted, the setting is treated as a global setting. Tab-specific settings take priority over any global settings.</p>
<h2 id="enabled-state">Enabled state</h2>
<p>By default, toolbar actions are enabled (clickable) on every tab. You can control this using the <code>action.enable()</code> and <code>action.disable()</code> methods. This only affects whether the popup (if any) or <code>action.onClicked</code> event is dispatched to your extension; it does not affect the action’s presence in the toolbar.</p>
<h2 id="examples">Examples</h2>
<p>The following examples show some common ways that actions are used in extensions. For a more robust demonstration of action capabilities, see the <a href="https://github.com/GoogleChrome/chrome-extensions-samples/tree/main/api/action">Action API example</a> in the <a href="https://github.com/GoogleChrome/chrome-extensions-samples">chrome-extension-samples</a> repository.</p>
<h3 id="show-a-popup">Show a popup</h3>
<p>It’s common for an extension to display a popup when the user clicks the extension’s action. To implement this in your own extension, declare the popup in your <code>manifest.json</code> and specify the content that Chrome should display in the popup.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb5-1" title="1"><span class="er">//</span> <span class="er">manifest.json</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="fu">{</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Action popup demo&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.0&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="dt">&quot;manifest_version&quot;</span><span class="fu">:</span> <span class="dv">3</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-6" title="6">  <span class="dt">&quot;action&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb5-7" title="7">    <span class="dt">&quot;default_title&quot;</span><span class="fu">:</span> <span class="st">&quot;Click to view a popup&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb5-8" title="8">    <span class="dt">&quot;default_popup&quot;</span><span class="fu">:</span> <span class="st">&quot;popup.html&quot;</span></a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="fu">}</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb6-1" title="1"><span class="co">&lt;!-- popup.html --&gt;</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="kw">&lt;style&gt;</span></a>
<a class="sourceLine" id="cb6-6" title="6">    html {</a>
<a class="sourceLine" id="cb6-7" title="7">      <span class="kw">min-height</span>: <span class="dv">5</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-8" title="8">      <span class="kw">min-width</span>: <span class="dv">10</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-9" title="9">      <span class="kw">background</span>: <span class="cn">salmon</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-10" title="10">    }</a>
<a class="sourceLine" id="cb6-11" title="11">  <span class="kw">&lt;/style&gt;</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb6-14" title="14">  <span class="kw">&lt;p&gt;</span>Hello, world!<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<h3 id="injecting-a-content-script-on-click">Injecting a content script on click</h3>
<p>A common pattern for extensions is to expose their primary functionality using the extension’s action. The example below demonstrates this pattern. When the user clicks the action, the extension injects a content script into the current page. The content script then displays an alert to verify that everything worked as expected.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb7-1" title="1"><span class="er">//</span> <span class="er">manifest.json</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="fu">{</span></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Action script injection demo&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.0&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb7-5" title="5">  <span class="dt">&quot;manifest_version&quot;</span><span class="fu">:</span> <span class="dv">3</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb7-6" title="6">  <span class="dt">&quot;action&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb7-7" title="7">    <span class="dt">&quot;default_title&quot;</span><span class="fu">:</span> <span class="st">&quot;Click to show an alert&quot;</span></a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="fu">},</span></a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="dt">&quot;permissions&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;activeTab&quot;</span><span class="ot">,</span> <span class="st">&quot;scripting&quot;</span><span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb7-10" title="10">  <span class="dt">&quot;background&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb7-11" title="11">    <span class="dt">&quot;service_worker&quot;</span><span class="fu">:</span> <span class="st">&quot;background.js&quot;</span></a>
<a class="sourceLine" id="cb7-12" title="12">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="fu">}</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="co">// background.js</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="va">chrome</span>.<span class="va">action</span>.<span class="va">onClicked</span>.<span class="at">addListener</span>((tab) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="va">chrome</span>.<span class="va">scripting</span>.<span class="at">executeScript</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb8-4" title="4">    <span class="dt">target</span><span class="op">:</span> <span class="op">{</span><span class="dt">tabId</span><span class="op">:</span> <span class="va">tab</span>.<span class="at">id</span><span class="op">},</span></a>
<a class="sourceLine" id="cb8-5" title="5">    <span class="dt">files</span><span class="op">:</span> [<span class="st">&#39;content.js&#39;</span>]</a>
<a class="sourceLine" id="cb8-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="co">// content.js</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="at">alert</span>(<span class="st">&#39;Hello, world!&#39;</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="emulating-pageactions-with-declarativecontent">Emulating pageActions with declarativeContent</h3>
<p>The chrome.action API replaced the <a href="/docs/extensions/reference/browserAction/">browserAction</a> and <a href="/docs/extensions/reference/pageAction/">pageAction</a> APIs in Manifest V3. By default, actions are similar to browser actions, but it is possible to emulate the behavior of a page action using the action API.</p>
<p>This example shows how an extension’s background logic can (a) disable the action by default and (b) use <a href="/docs/extensions/reference/declarativeContent/">declarativeContent</a> to enable the action on specific sites.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="co">// background.js</span></a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">// Wrap in an onInstalled callback in order to avoid unnecessary work</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">// every time the background script is run</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="va">chrome</span>.<span class="va">runtime</span>.<span class="va">onInstalled</span>.<span class="at">addListener</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="co">// Page actions are disabled by default and enabled on select tabs</span></a>
<a class="sourceLine" id="cb10-7" title="7">  <span class="va">chrome</span>.<span class="va">action</span>.<span class="at">disable</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9">  <span class="co">// Clear all rules to ensure only our expected rules are set</span></a>
<a class="sourceLine" id="cb10-10" title="10">  <span class="va">chrome</span>.<span class="va">declarativeContent</span>.<span class="va">onPageChanged</span>.<span class="at">removeRules</span>(<span class="kw">undefined</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-11" title="11">    <span class="co">// Declare a rule to enable the action on example.com pages</span></a>
<a class="sourceLine" id="cb10-12" title="12">    <span class="kw">let</span> exampleRule <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-13" title="13">      <span class="dt">conditions</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb10-14" title="14">        <span class="kw">new</span> <span class="va">chrome</span>.<span class="va">declarativeContent</span>.<span class="at">PageStateMatcher</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb10-15" title="15">          <span class="dt">pageUrl</span><span class="op">:</span> <span class="op">{</span><span class="dt">hostSuffix</span><span class="op">:</span> <span class="st">&#39;.example.com&#39;</span><span class="op">},</span></a>
<a class="sourceLine" id="cb10-16" title="16">        <span class="op">}</span>)</a>
<a class="sourceLine" id="cb10-17" title="17">      ]<span class="op">,</span></a>
<a class="sourceLine" id="cb10-18" title="18">      <span class="dt">actions</span><span class="op">:</span> [<span class="kw">new</span> <span class="va">chrome</span>.<span class="va">declarativeContent</span>.<span class="at">ShowAction</span>()]<span class="op">,</span></a>
<a class="sourceLine" id="cb10-19" title="19">    <span class="op">};</span></a>
<a class="sourceLine" id="cb10-20" title="20"></a>
<a class="sourceLine" id="cb10-21" title="21">    <span class="co">// Finally, apply our new array of rules</span></a>
<a class="sourceLine" id="cb10-22" title="22">    <span class="kw">let</span> rules <span class="op">=</span> [exampleRule]<span class="op">;</span></a>
<a class="sourceLine" id="cb10-23" title="23">    <span class="va">chrome</span>.<span class="va">declarativeContent</span>.<span class="va">onPageChanged</span>.<span class="at">addRules</span>(rules)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-24" title="24">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-25" title="25"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
</body>
</html>
