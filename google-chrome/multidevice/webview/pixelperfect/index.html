<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2014-02-28" />
  <title>Pixel-Perfect UI in the WebView</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Pixel-Perfect UI in the WebView</h1>
<p class="date">2014-02-28</p>
</header>
<p>There are a number of options you can use to create the perfect UI, this article will outline some of the best practices for the mobile web in general and then some specific tricks you could use for hybrid applications.</p>
<h2 id="viewport">Viewport</h2>
<p>The viewport meta tag is of the most important tags you need to add to your web app. Without it, the WebView may act as if your site is designed for desktop browsers. This causes your web page to be given a larger width (typically 980px) and scales it to fit the WebView’s width. In most cases, the result is a tiny overview version of the page that requires the user to pan and zoom to actually read content, like the image on the left.</p>
<p>{% Img src=“image/BrQidfK9jaQyIHwdw91aVpkPiib2/1604544745761.jpg”, alt=“Screenshots of a page before and after using the viewport meta tag.”, width=“656”, height=“613” %}</p>
<p>If you want the width of your site to be 100% of the WebView’s width, as shown on the right, you need to set the viewport meta tag:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">&quot;viewport&quot;</span><span class="ot"> content=</span><span class="st">&quot;width=device-width, initial-scale=1&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>Setting width to the special value device-width will give you more control over the page layout.</p>
<p>By default the WebView will set the viewport to device-width, rather than defaulting to a desktop viewport. However, for reliable and controlled behaviour it’s good practice to include the viewport meta tag.</p>
<h3 id="desktop-sites">Desktop Sites</h3>
<p>In some cases, you may need to display content that isn’t designed for mobile devices–for example, if you’re displaying content you don’t control. In this case, you need to force the WebView to use a desktop-size viewport:</p>
<ul>
<li><a href="http://developer.android.com/reference/android/webkit/WebSettings.html#setUseWideViewPort(boolean)">setUseWideViewPort(true)</a></li>
<li><a href="http://developer.android.com/reference/android/webkit/WebSettings.html#setLoadWithOverviewMode(boolean)">setLoadWithOverviewMode(true)</a></li>
</ul>
<p>If these methods are not set <em>and</em> no viewport is specified, the WebView will try and set the viewport width based on the content size.</p>
<p>In addition to doing this, you may want to use the new layout algorithm <code>TEXT_AUTOSIZING</code> introduced in Android 4.4, which increases the font size to make it more readable on a mobile device. See <a href="http://developer.android.com/reference/android/webkit/WebSettings.html#setLayoutAlgorithm(android.webkit.WebSettings.LayoutAlgorithm)">setLayoutAlgorithm</a>.</p>
<p>{% Img src=“image/BrQidfK9jaQyIHwdw91aVpkPiib2/1604544955630.jpg”, alt=“An example of how a page looks before and after text autosizing.”, width=“656”, height=“616” %}</p>
<h2 id="responsive-design">Responsive Design</h2>
<p>Responsive design is the notion of changing your UI depending on the dimensions of the screen size. Here we will look at some simple examples of how you can adapt your UI and images, but if you want to dig in to other topics then this article on <a href="http://www.html5rocks.com/en/mobile/responsivedesign/">HTML5Rocks</a> is a good point of reference.</p>
<p>One of the main CSS features you’ll want to use is media queries.</p>
<p>A media query is a way of applying CSS to elements based on a device’s characteristics. For example, suppose you wanted to go from a vertical layout to a horizontal layout based on orientation.</p>
<p>First, set CSS properties to default to portrait:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb2-1" title="1"><span class="fu">.page-container</span> {</a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="kw">display</span>: -webkit-box<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="kw">display</span>: flex<span class="op">;</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="kw">-webkit-box-orient</span>: vertical<span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="kw">flex-direction</span>: column<span class="op">;</span></a>
<a class="sourceLine" id="cb2-7" title="7"></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="kw">padding</span>: <span class="dv">20</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-9" title="9">    <span class="kw">box-sizing</span>: <span class="dv">border-box</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-10" title="10">}</a></code></pre></div>
<p>Then to switch to a horizontal layout you just need to switch the flex-direction property based on the orientation:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb3-1" title="1"><span class="im">@media</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">orientation</span>: <span class="dv">landscape</span>) {</a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="fu">.page-container.notification-opened</span> {</a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="kw">-webkit-box-orient</span>: horizontal<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">flex-direction</span>: row<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5">  }</a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="fu">.page-container.notification-opened</span> <span class="op">&gt;</span> <span class="fu">.notification-arrow</span> {</a>
<a class="sourceLine" id="cb3-8" title="8">    <span class="kw">margin-right</span>: <span class="dv">20</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-9" title="9">  }</a>
<a class="sourceLine" id="cb3-10" title="10">}</a></code></pre></div>
<p>{% Img src=“image/BrQidfK9jaQyIHwdw91aVpkPiib2/1604545057377.jpg”, alt=“A page that has different presentations in landscape and portrait modes.”, width=“656”, height=“488” %}</p>
<p>This technique can be used to change layout based on the width of the screen.</p>
<p>For example, adjusting the size of the button from being 100% to something smaller as the physical screen size gets larger.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb4-1" title="1">button {</a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="kw">display</span>: <span class="dv">block</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="fu">...</span></a>
<a class="sourceLine" id="cb4-5" title="5">}</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="im">@media</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">min-width</span>: <span class="dv">500</span><span class="dt">px</span>) {</a>
<a class="sourceLine" id="cb4-8" title="8">  button {</a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="kw">width</span>: <span class="dv">60</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-10" title="10">  }</a>
<a class="sourceLine" id="cb4-11" title="11">}</a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="im">@media</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">min-width</span>: <span class="dv">750</span><span class="dt">px</span>) {</a>
<a class="sourceLine" id="cb4-14" title="14">  button {</a>
<a class="sourceLine" id="cb4-15" title="15">    <span class="kw">width</span>: <span class="dv">40</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-16" title="16">    <span class="kw">max-width</span>: <span class="dv">400</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-17" title="17">  }</a>
<a class="sourceLine" id="cb4-18" title="18">}</a></code></pre></div>
<p>{% Img src=“image/BrQidfK9jaQyIHwdw91aVpkPiib2/1604545130107.jpg”, alt=“Adjusting button size for different screen sizes.”, width=“656”, height=“769” %}</p>
<p>These are minor changes, but depending on your UI, media queries can help you to make much larger changes to appearance of your application, while keeping the same HTML.</p>
<p><strong>Tip:</strong> Try to change the UI based on width as a component starts to look out of place, rather than focusing on device sizes. By doing this, your app will look great on a range of devices, not just the ones you test on. An easy way to do this is play around with the size of a browser window. But remember that actual devices have different screen densities than your monitor, so always test on a range of devices.</p>
<p>For more on designing for mobile devices, see <a href="http://www.html5rocks.com/en/mobile/">HTML5Rocks</a>.</p>
<h2 id="images">Images</h2>
<p>The variety of screens sizes and densities also presents challenges for images. Smaller images require less memory and are faster to load, but blur if you scale them up.</p>
<p>The images below show the blurring that occurs when you scale a low-density image up for a high-denity screen, compared with the crisp display of an appropriately-sized image.</p>
<p>{% Img src=“image/BrQidfK9jaQyIHwdw91aVpkPiib2/1604545182932.png”, alt=“Low-density and high-density versions of an image.”, width=“656”, height=“320” %}</p>
<p>Here are a few tips and tricks to make sure your images look crisp and clear on any screen:</p>
<ul>
<li>Use CSS for scalable effects.</li>
<li>Use vector graphics.</li>
<li>Provide high-resolution photos.</li>
</ul>
<h3 id="use-css-for-scalable-effects">Use CSS for scalable effects</h3>
<p>Make use of CSS3 where you can for borders, drop shadows, border-radius, and so on instead of images. These features can scale easily. However, some combinations of CSS properties can be expensive to render, so you should always test the specific combinations you’re using. (For some sample data on fast and slow CSS properties, see: <a href="http://www.html5rocks.com/en/tutorials/speed/css-paint-times/">CSS Paint Times and Page Render Weight</a> on HTML5Rocks.)</p>
<h3 id="use-vector-graphics">Use vector graphics</h3>
<p>Scalable Vector Graphics (SVGs) are a great way of providing scalable version of images. For images that are well-suited to vector graphics, SVG provides high quality images with very small file sizes. For more information, see <a href="http://www.html5rocks.com/en/tutorials/svg/mobile_fundamentals/">Splash Vector Graphics on your Responsive Site</a> on HTML5Rocks.</p>
<h3 id="provide-high-resolution-photos">Provide high-resolution photos</h3>
<p>Use a version suitable for a high-DPI device and scale the image using CSS. This way the image has a high quality across devices. If you use high compression (low quality setting) when generating the image, you may be able to acheive good visual results with a reasonable file size.</p>
<p>This approach is simple, but has a couple of potential downsides: highly-compressed images may show some visual artifacts, so you need to experiment to determine what level of compression you find acceptable. And resizing the image in CSS can be an expensive operation.</p>
<p>If high compression is not suitable for your needs, try the WebP format, which gives a high quality image with relatively small file size. See <a href="http://developers.google.com/speed/webp/">the official WebP site</a> for details. Don’t forget that you’ll need to provide a fallback for older versions of Android where WebP isn’t supported.</p>
<p>For more information on this topic:</p>
<ul>
<li><a href="http://www.html5rocks.com/en/mobile/high-dpi/">High DPI Images for Variable Pixel Densities</a> on HTML5Rocks.</li>
<li><a href="https://developers.google.com/events/io/sessions/350992350">Seeing the World Through High DPI</a> video from Google I/O 2013.</li>
</ul>
<h3 id="fine-grained-control">Fine grained control</h3>
<p>In many cases, you can’t use a single image for all devices. In this case, you can select different images based on the screen size and density. You can use media queries to select background images by screen size and density. You can also use JavaScript to control how images load.</p>
<h4 id="media-queries-and-screen-density">Media queries and screen density</h4>
<p>To select an image based on the screen density, you need to use <code>dpi</code> or <code>dppx</code> units in your media query. The <code>dpi</code> unit represents dots per CSS inch, while <code>dppx</code> represents dots per CSS pixel.</p>
<p>Looking at the table below you can see the relation between <code>dpi</code> and <code>dppx</code>. 1<code>dppx</code> is equivalent to 96<code>dpi</code>, 2<code>dppx</code> == 192<code>dpi</code> == 2 x 96<code>dpi</code>, and so on.</p>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 27%" />
<col style="width: 26%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="header">
<th>Device pixel ratio</th>
<th>Generalized screen density</th>
<th>Dots per CSS inch (<code>dpi</code>)</th>
<th>Dots per CSS pixel (<code>dppx</code>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1x</td>
<td>MDPI</td>
<td>96<code>dpi</code></td>
<td>1<code>dppx</code></td>
</tr>
<tr class="even">
<td>1.5x</td>
<td>HDPI</td>
<td>144<code>dpi</code></td>
<td>1.5<code>dppx</code></td>
</tr>
<tr class="odd">
<td>2</td>
<td>XHDPI</td>
<td>192<code>dpi</code></td>
<td>2<code>dppx</code></td>
</tr>
</tbody>
</table>
<p>The generalized screen density buckets are defined by the Android native platform and are used in other places to express screen density (for example, <a href="http://screensiz.es/phone">http://screensiz.es</a>).</p>
<h4 id="background-images">Background Images</h4>
<p>You can use media queries to assign background images to elements. For example, if you have a logo image with 256px x 256px size on a device with a pixel ratio of 1.0, you might use the following CSS rules:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb5-1" title="1"><span class="fu">.welcome-header</span> <span class="op">&gt;</span> h1 {</a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="kw">flex</span>: <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6">  <span class="kw">max-height</span>: <span class="dv">256</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="kw">max-width</span>: <span class="dv">256</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-8" title="8"></a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="kw">background-image</span>: <span class="fu">url(</span><span class="st">&#39;../images/html5_256x256.png&#39;</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-10" title="10">  <span class="kw">background-repeat</span>: <span class="dv">no-repeat</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-11" title="11">  <span class="kw">background-position</span>: <span class="dv">center</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-12" title="12">  <span class="kw">background-size</span>: <span class="dv">contain</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-13" title="13">}</a></code></pre></div>
<p>To swap this out for a larger image on devices with device pixel ratio of 1.5 (hdpi) and 2.0 (xhdpi), you can add the following rules:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb6-1" title="1"><span class="im">@media</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">min-resolution</span>: <span class="dv">1.5</span>dppx) {</a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="fu">.welcome-header</span> <span class="op">&gt;</span> h1{</a>
<a class="sourceLine" id="cb6-3" title="3">      <span class="kw">background-image</span>: <span class="fu">url(</span><span class="st">&#39;../images/html5_384x384.png&#39;</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4">  }</a>
<a class="sourceLine" id="cb6-5" title="5">}</a>
<a class="sourceLine" id="cb6-6" title="6"></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="im">@media</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">min-resolution</span>: <span class="dv">2</span>dppx) {</a>
<a class="sourceLine" id="cb6-8" title="8">  <span class="fu">.welcome-header</span> <span class="op">&gt;</span> h1{</a>
<a class="sourceLine" id="cb6-9" title="9">      <span class="kw">background-image</span>: <span class="fu">url(</span><span class="st">&#39;../images/html5_512x512.png&#39;</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-10" title="10">  }</a>
<a class="sourceLine" id="cb6-11" title="11">}</a></code></pre></div>
<p>{% Img src=“image/BrQidfK9jaQyIHwdw91aVpkPiib2/1604545224766.png”, alt=“Using different images for different device pixel ratios.”, width=“656”, height=“619” %}</p>
<p>You can then merge this technique with other media queries like <code>min-width</code>, which is useful as you start to account for different form factors.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb7-1" title="1"><span class="im">@media</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">min-resolution</span>: <span class="dv">2</span>dppx) {</a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="fu">.welcome-header</span> <span class="op">&gt;</span> h1{</a>
<a class="sourceLine" id="cb7-3" title="3">          <span class="kw">background-image</span>: <span class="fu">url(</span><span class="st">&#39;../images/html5_512x512.png&#39;</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4">  }</a>
<a class="sourceLine" id="cb7-5" title="5">}</a>
<a class="sourceLine" id="cb7-6" title="6"></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="im">@media</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">min-resolution</span>: <span class="dv">2</span>dppx) <span class="kw">and</span> (<span class="kw">min-width</span>: <span class="dv">1000</span><span class="dt">px</span>) {</a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="fu">.welcome-header</span> <span class="op">&gt;</span> h1{</a>
<a class="sourceLine" id="cb7-9" title="9">          <span class="kw">background-image</span>: <span class="fu">url(</span><span class="st">&#39;../images/html5_1024x1024.png&#39;</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-10" title="10"></a>
<a class="sourceLine" id="cb7-11" title="11">          <span class="kw">max-height</span>: <span class="dv">512</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-12" title="12">      <span class="kw">max-width</span>: <span class="dv">512</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-13" title="13">  }</a>
<a class="sourceLine" id="cb7-14" title="14">}</a></code></pre></div>
<p>You might notice that the <code>max-height</code> and <code>max-width</code> are set to 512px for 2<code>ddpx</code> resolution, with an image of 1024x1024px. this is because a CSS “pixel” actually takes into account the device pixel ratio (512px * 2 = 1024px).</p>
<h4 id="what-about-img">What About <code>&lt;img/&gt;</code>?</h4>
<p>The web today doesn’t have a solution for this. There are some proposals in the works, but they aren’t available in current browsers or in the WebView.</p>
<p>In the mean time, if you generate your DOM in JavaScript, you can create multiple image resources in a sane directory structure:</p>
<pre class="text"><code>images/
    mdpi/
        imagename.png
    hdpi/
        imagename.png
    xhdpi/
        imagename.png</code></pre>
<p>Then use the pixel ratio to try and pull the most appropriate image:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">function</span> <span class="at">getDensityDirectoryName</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="cf">if</span>(<span class="op">!</span><span class="va">window</span>.<span class="at">devicePixelRatio</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="cf">return</span> <span class="st">&#39;mdpi&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="op">}</span></a>
<a class="sourceLine" id="cb9-5" title="5"></a>
<a class="sourceLine" id="cb9-6" title="6">  <span class="cf">if</span>(<span class="va">window</span>.<span class="at">devicePixelRatio</span> <span class="op">&gt;</span> <span class="fl">1.5</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb9-7" title="7">    <span class="cf">return</span> <span class="st">&#39;xhdpi&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb9-8" title="8">  <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span>(<span class="va">window</span>.<span class="at">devicePixelRatio</span> <span class="op">&gt;</span> <span class="fl">1.0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb9-9" title="9">    <span class="cf">return</span> <span class="st">&#39;hdpi&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb9-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb9-11" title="11"></a>
<a class="sourceLine" id="cb9-12" title="12">  <span class="cf">return</span> <span class="st">&#39;mdpi&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="op">}</span></a></code></pre></div>
<p>The alternative to implementing the above in JS, is to alter the base URL of the page to define the relative URLs for images.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb10-1" title="1"><span class="dt">&lt;!doctype </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">&lt;html</span><span class="ot"> class=</span><span class="st">&quot;no-js&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb10-4" title="4">  <span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb10-5" title="5">    <span class="kw">function</span> <span class="at">getDensityDirectoryName</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb10-6" title="6">      <span class="cf">if</span>(<span class="op">!</span><span class="va">window</span>.<span class="at">devicePixelRatio</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-7" title="7">          <span class="cf">return</span> <span class="st">&#39;mdpi&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-8" title="8">      <span class="op">}</span></a>
<a class="sourceLine" id="cb10-9" title="9"></a>
<a class="sourceLine" id="cb10-10" title="10">      <span class="cf">if</span>(<span class="va">window</span>.<span class="at">devicePixelRatio</span> <span class="op">&gt;</span> <span class="fl">1.5</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-11" title="11">          <span class="cf">return</span> <span class="st">&#39;xhdpi&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-12" title="12">      <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span>(<span class="va">window</span>.<span class="at">devicePixelRatio</span> <span class="op">&gt;</span> <span class="fl">1.0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-13" title="13">          <span class="cf">return</span> <span class="st">&#39;hdpi&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-14" title="14">      <span class="op">}</span></a>
<a class="sourceLine" id="cb10-15" title="15"></a>
<a class="sourceLine" id="cb10-16" title="16">      <span class="cf">return</span> <span class="st">&#39;mdpi&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-17" title="17">    <span class="op">}</span></a>
<a class="sourceLine" id="cb10-18" title="18"></a>
<a class="sourceLine" id="cb10-19" title="19">    <span class="kw">var</span> baseUrl <span class="op">=</span></a>
<a class="sourceLine" id="cb10-20" title="20">        <span class="st">&#39;file:///android_asset/www/img-js-diff/ratiores/&#39;</span><span class="op">+</span><span class="at">getDensityDirectoryName</span>()<span class="op">+</span><span class="st">&#39;/&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-21" title="21">    <span class="va">document</span>.<span class="at">write</span>(<span class="st">&#39;&lt;base href=&quot;&#39;</span><span class="op">+</span>baseUrl<span class="op">+</span><span class="st">&#39;&quot;&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-22" title="22">  <span class="kw">&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb10-23" title="23"></a>
<a class="sourceLine" id="cb10-24" title="24">    ...</a>
<a class="sourceLine" id="cb10-25" title="25"><span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb10-26" title="26"></a>
<a class="sourceLine" id="cb10-27" title="27"><span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb10-28" title="28">    ...</a>
<a class="sourceLine" id="cb10-29" title="29"><span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb10-30" title="30"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>The major downsides to this are that it blocks the page load and forces you to use absolute paths for scripts, CSS files, links and so on, since the base URL points to a density-specific directory.</p>
</body>
</html>
