http-equiv="content-type" content="text/html;charset=UTF-8"

<a href="#main" class="skipToContent_1oUP">Skip to main content</a>

Menu

<a href="../../index.html" class="navbar__brand"><img src="../../../d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo" /><img src="../../../d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo" /><strong>Redux</strong></a>

<a href="../../introduction/getting-started.html" class="navbar__item navbar__link">Getting Started</a><a href="part-1-overview-concepts.html" class="navbar__item navbar__link">Tutorial</a><a href="../../api/api-reference.html" class="navbar__item navbar__link">API</a><a href="../../faq.html" class="navbar__item navbar__link">FAQ</a><a href="../../style-guide/style-guide.html" class="navbar__item navbar__link">Best Practices</a><a href="../../../github.com/reduxjs/redux.html" class="navbar__item navbar__link">GitHub</a><a href="../../introduction/getting-started.html#help-and-discussion" class="navbar__item navbar__link">Need help?</a>

<span class="toggle_71bT">🌜</span>

<span class="toggle_71bT">🌞</span>

<span class="DocSearch-Button-Placeholder">Search</span>

<a href="../../index.html" class="navbar__brand"><img src="../../../d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo" /><img src="../../../d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo" /><strong>Redux</strong></a>

- <a href="../../introduction/getting-started.html" class="menu__link">Getting Started</a>
- <a href="part-1-overview-concepts.html" class="menu__link">Tutorial</a>
- <a href="../../api/api-reference.html" class="menu__link">API</a>
- <a href="../../faq.html" class="menu__link">FAQ</a>
- <a href="../../style-guide/style-guide.html" class="menu__link">Best Practices</a>
- <a href="../../../github.com/reduxjs/redux.html" class="menu__link">GitHub</a>
- <a href="../../introduction/getting-started.html#help-and-discussion" class="menu__link">Need help?</a>

Menu

- <a href="#!" class="menu__link menu__link--sublist">Introduction</a>
  - <a href="../../introduction/getting-started.html" class="menu__link">Getting Started with Redux</a>
  - <a href="../../introduction/installation.html" class="menu__link">Installation</a>
  - <a href="../../introduction/core-concepts.html" class="menu__link">Core Concepts</a>
  - <a href="../../introduction/learning-resources.html" class="menu__link">Learning Resources</a>
  - <a href="../../introduction/ecosystem.html" class="menu__link">Ecosystem</a>
  - <a href="../../introduction/examples.html" class="menu__link">Examples</a>
- <a href="#!" class="menu__link menu__link--sublist menu__link--active">Tutorials</a>
  - <a href="../index.html" class="menu__link">Tutorials Index</a>
  - <a href="../quick-start.html" class="menu__link">Quick Start</a>
  - <a href="../typescript-quick-start.html" class="menu__link">TypeScript Quick Start</a>
  - <a href="#!" class="menu__link menu__link--sublist menu__link--active">Redux Essentials</a>
    - <a href="part-1-overview-concepts.html" class="menu__link">Redux Overview and Concepts</a>
    - <a href="part-2-app-structure.html" class="menu__link menu__link--active active">Redux App Structure</a>
    - <a href="part-3-data-flow.html" class="menu__link">Basic Redux Data Flow</a>
    - <a href="part-4-using-data.html" class="menu__link">Using Redux Data</a>
    - <a href="part-5-async-logic.html" class="menu__link">Async Logic and Data Fetching</a>
    - <a href="part-6-performance-normalization.html" class="menu__link">Performance and Normalizing Data</a>
  - <a href="#!" class="menu__link menu__link--sublist">Redux Fundamentals</a>
    - <a href="../fundamentals/part-1-overview.html" class="menu__link">Redux Overview</a>
    - <a href="../fundamentals/part-2-concepts-data-flow.html" class="menu__link">Redux Concepts and Data Flow</a>
    - <a href="../fundamentals/part-3-state-actions-reducers.html" class="menu__link">State, Actions, and Reducers</a>
    - <a href="../fundamentals/part-4-store.html" class="menu__link">Store</a>
    - <a href="../fundamentals/part-5-ui-react.html" class="menu__link">UI and React</a>
    - <a href="../fundamentals/part-6-async-logic.html" class="menu__link">Async Logic and Data Fetching</a>
    - <a href="../fundamentals/part-7-standard-patterns.html" class="menu__link">Standard Redux Patterns</a>
    - <a href="../fundamentals/part-8-modern-redux.html" class="menu__link">Modern Redux with Redux Toolkit</a>
- <a href="#!" class="menu__link menu__link--sublist">Recipes</a>
  - <a href="../../recipes/recipe-index.html" class="menu__link">Recipes: Index</a>
  - <a href="../../recipes/configuring-your-store.html" class="menu__link">Configuring Your Store</a>
  - <a href="../../recipes/usage-with-typescript.html" class="menu__link">Usage With TypeScript</a>
  - <a href="../../recipes/migrating-to-redux.html" class="menu__link">Migrating to Redux</a>
  - <a href="../../recipes/using-object-spread-operator.html" class="menu__link">Using Object Spread Operator</a>
  - <a href="../../recipes/reducing-boilerplate.html" class="menu__link">Reducing Boilerplate</a>
  - <a href="../../recipes/server-rendering.html" class="menu__link">Server Rendering</a>
  - <a href="../../recipes/writing-tests.html" class="menu__link">Writing Tests</a>
  - <a href="../../recipes/computing-derived-data.html" class="menu__link">Computing Derived Data</a>
  - <a href="../../recipes/implementing-undo-history.html" class="menu__link">Implementing Undo History</a>
  - <a href="../../recipes/isolating-redux-sub-apps.html" class="menu__link">Isolating Redux Sub-Apps</a>
  - <a href="../../recipes/code-splitting.html" class="menu__link">Code Splitting</a>
  - <a href="../../recipes/troubleshooting.html" class="menu__link">Troubleshooting</a>
  - <a href="#!" class="menu__link menu__link--sublist">Structuring Reducers</a>
    - <a href="../../recipes/structuring-reducers/structuring-reducers.html" class="menu__link">Structuring Reducers</a>
    - <a href="../../recipes/structuring-reducers/prerequisite-concepts.html" class="menu__link">Prerequisite Concepts</a>
    - <a href="../../recipes/structuring-reducers/basic-reducer-structure.html" class="menu__link">Basic Reducer Structure</a>
    - <a href="../../recipes/structuring-reducers/splitting-reducer-logic.html" class="menu__link">Splitting Reducer Logic</a>
    - <a href="../../recipes/structuring-reducers/refactoring-reducer-example.html" class="menu__link">Refactoring Reducers Example</a>
    - <a href="../../recipes/structuring-reducers/using-combinereducers.html" class="menu__link">Using combineReducers</a>
    - <a href="../../recipes/structuring-reducers/beyond-combinereducers.html" class="menu__link">Beyond combineReducers</a>
    - <a href="../../recipes/structuring-reducers/normalizing-state-shape.html" class="menu__link">Normalizing State Shape</a>
    - <a href="../../recipes/structuring-reducers/updating-normalized-data.html" class="menu__link">Updating Normalized Data</a>
    - <a href="../../recipes/structuring-reducers/reusing-reducer-logic.html" class="menu__link">Reusing Reducer Logic</a>
    - <a href="../../recipes/structuring-reducers/immutable-update-patterns.html" class="menu__link">Immutable Update Patterns</a>
    - <a href="../../recipes/structuring-reducers/initializing-state.html" class="menu__link">Initializing State</a>
- <a href="#!" class="menu__link menu__link--sublist">Understanding Redux</a>
  - <a href="#!" class="menu__link menu__link--sublist">Thinking in Redux</a>
    - <a href="../../understanding/thinking-in-redux/motivation.html" class="menu__link">Motivation</a>
    - <a href="../../understanding/thinking-in-redux/three-principles.html" class="menu__link">Three Principles</a>
    - <a href="../../understanding/thinking-in-redux/glossary.html" class="menu__link">Glossary</a>
  - <a href="#!" class="menu__link menu__link--sublist">History and Design</a>
    - <a href="../../understanding/history-and-design/prior-art.html" class="menu__link">Prior Art</a>
    - <a href="../../understanding/history-and-design/middleware.html" class="menu__link">Middleware</a>
- <a href="#!" class="menu__link menu__link--sublist">FAQ</a>
  - <a href="../../faq.html" class="menu__link">FAQ Index</a>
  - <a href="../../faq/general.html" class="menu__link">General</a>
  - <a href="../../faq/reducers.html" class="menu__link">Reducers</a>
  - <a href="../../faq/organizing-state.html" class="menu__link">Organizing State</a>
  - <a href="../../faq/store-setup.html" class="menu__link">Store Setup</a>
  - <a href="../../faq/actions.html" class="menu__link">Actions</a>
  - <a href="../../faq/immutable-data.html" class="menu__link">Immutable Data</a>
  - <a href="../../faq/code-structure.html" class="menu__link">Code Structure</a>
  - <a href="../../faq/performance.html" class="menu__link">Performance</a>
  - <a href="../../faq/design-decisions.html" class="menu__link">Design Decisions</a>
  - <a href="../../faq/react-redux.html" class="menu__link">React Redux</a>
  - <a href="../../faq/miscellaneous.html" class="menu__link">Miscellaneous</a>
- <a href="#!" class="menu__link menu__link--sublist">Style Guide</a>
  - <a href="../../style-guide/style-guide.html" class="menu__link">Style Guide: Best Practices</a>
- <a href="#!" class="menu__link menu__link--sublist">API Reference</a>
  - <a href="../../api/api-reference.html" class="menu__link">API Reference</a>
  - <a href="../../api/createstore.html" class="menu__link">createStore</a>
  - <a href="../../api/store.html" class="menu__link">Store</a>
  - <a href="../../api/combinereducers.html" class="menu__link">combineReducers</a>
  - <a href="../../api/applymiddleware.html" class="menu__link">applyMiddleware</a>
  - <a href="../../api/bindactioncreators.html" class="menu__link">bindActionCreators</a>
  - <a href="../../api/compose.html" class="menu__link">compose</a>
- <a href="#!" class="menu__link menu__link--sublist">Redux Toolkit</a>
  - <a href="../../redux-toolkit/overview.html" class="menu__link">Redux Toolkit: Overview</a>

# <span id="redux-essentials-part-2-redux-app-structure" class="anchor enhancedAnchor_2LWZ"></span>Redux Essentials, Part 2: Redux App Structure<a href="#redux-essentials-part-2-redux-app-structure" class="hash-link" title="Direct link to heading">#</a>

##### <span class="admonition-icon"> </span>What You'll Learn

- The structure of a typical React + Redux app
- How to view state changes in the Redux DevTools Extension

## <span id="introduction" class="anchor enhancedAnchor_2LWZ"></span>Introduction<a href="#introduction" class="hash-link" title="Direct link to heading">#</a>

In [Part 1: Redux Overview and Concepts](part-1-overview-concepts.html), we looked at why Redux is useful, the terms and concepts used to describe different parts of Redux code, and how data flows through a Redux app.

Now, let's look at a real working example to see how these pieces fit together.

## <span id="the-counter-example-app" class="anchor enhancedAnchor_2LWZ"></span>The Counter Example App<a href="#the-counter-example-app" class="hash-link" title="Direct link to heading">#</a>

The sample project we'll look at is a small counter application that lets us add or subtract from a number as we click buttons. It may not be very exciting, but it shows all the important pieces of a React+Redux application in action.

The project has been created using [the official Redux template for Create-React-App](../../../github.com/reduxjs/cra-template-redux.html). Out of the box, it has already been configured with a standard Redux application structure, using [Redux Toolkit](../../../redux-toolkit.js.org/index.html) to create the Redux store and logic, and [React-Redux](../../../react-redux.js.org/index.html) to connect together the Redux store and the React components.

Here's the live version of the project. You can play around with it by clicking the buttons in the app preview on the right, and browse through the source files on the left.

If you'd like to try create this project on your own computer, you can [start a new Create-React-App project](../../../create-react-app.dev/docs/getting-started/index.html#selecting-a-template) using our Redux template:

<span class="token plain">npx create-react-app redux-essentials-example --template redux</span>

Copy

### <span id="using-the-counter-app" class="anchor enhancedAnchor_2LWZ"></span>Using the Counter App<a href="#using-the-counter-app" class="hash-link" title="Direct link to heading">#</a>

The counter app has already been set up to let us watch what happens inside as we use it.

Open up your browser's DevTools. Then, choose the "Redux" tab in the DevTools, and click the "State" button in the upper-right toolbar. You should see something that looks like this:

![Redux DevTools: initial app state](../../../d33wubrfki0l68.cloudfront.net/d022445258f43bdd1c8438d1af81f1442d071998/0b19a/assets/images/devtools-initial-3b52cedcebd74c327ee3b9b2342d69db.203)

On the right, we can see that our Redux store is starting off with an app state value that looks like this:

<span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> counter</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> value</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">0</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

The DevTools will show us how the store state changes as we use the app.

Let's play with the app first to see what it does. Click the "+" button in the app, then look at the "Diff" tab in the Redux DevTools:

![Redux DevTools: first dispatched action](../../../d33wubrfki0l68.cloudfront.net/95e2b81c8e83d2fcaf343bcebece19f273359694/c7183/assets/images/devtools-first-action-c9d4378ec1ec3e1c8f93b1e8e4a1d03)

We can see two important things here:

- When we clicked the "+" button, an action with a type of `"counter/increment"` was dispatched to the store
- When that action was dispatched, the `state.counter.value` field changed from `0` to `1`

Now try these steps:

- Click the "+" button again. The displayed value should now be 2.
- Click the "-" button once. The displayed value should now be 1.
- Click the "Add Amount" button. The displayed value should now be 3.
- Change the number "2" in the textbox to a "3"
- Click the "Add Async" button. You should see a progress bar fill the button, and after a couple seconds, the displayed value should change to 6.

Go back to the Redux DevTools. You should see a total of five actions dispatched, one for each time we clicked a button . Now select the last `"counter/incrementByAmount"` entry from the list on the left, and click the "Action" tab on the right side:

![Redux DevTools: done clicking buttons](../../../d33wubrfki0l68.cloudfront.net/e61a3b0a0233817bbeb4a6b15909583bf7cda6ca/465f1/assets/images/devtools-done-clicking-8826e622b87734ea2a0044233a2a64)

We can see that this action object looked like this:

<span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> type</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'counter/incrementByAmount'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> payload</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">3</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

And if you click the "Diff" tab, you can see that the `state.counter.value` field changed from a `3` to a `6` in response to that action.

The ability to see what is happening inside of our app and how our state is changing over time is very powerful!

The DevTools have several more commands and options to help you debug your app. Try clicking the "Trace" tab in the upper right. You should see a JavaScript function stack trace in the panel, with several sections of source code showing the lines that were executing when the action reached the store. One line in particular should be highlighted: the line of code where we dispatched this action from the `<Counter>` component:

![Redux DevTools: action stack traces](../../../d33wubrfki0l68.cloudfront.net/e147d6d500a5dc1017f2a956e76cf4077123c532/1c52c/assets/images/devtools-action-stacktrace-8ee180838c97840a749b9209e8)

This makes it easier to trace what part of the code dispatched a specific action.

## <span id="application-contents" class="anchor enhancedAnchor_2LWZ"></span>Application Contents<a href="#application-contents" class="hash-link" title="Direct link to heading">#</a>

Now that you know what the app does, let's look at how it works.

Here are the key files that make up this application:

- `/src`
  - `index.js`: the starting point for the app
  - `App.js`: the top-level React component
  - `/app`
    - `store.js`: creates the Redux store instance
  - `/features`
    - `/counter`
      - `Counter.js`: a React component that shows the UI for the counter feature
      - `counterSlice.js`: the Redux logic for the counter feature

Let's start by looking at how the Redux store is created.

### <span id="creating-the-redux-store" class="anchor enhancedAnchor_2LWZ"></span>Creating the Redux Store<a href="#creating-the-redux-store" class="hash-link" title="Direct link to heading">#</a>

Open up `app/store.js`, which should look like this:

app/store.js

<span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: #f8f8f2">{</span><span class="token imports"> configureStore </span><span class="token imports punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'@reduxjs/toolkit'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports">counterReducer</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'../features/counter/counterSlice'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">default</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">configureStore</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> reducer</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> counter</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> counterReducer</span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

The Redux store is created using the `configureStore` function from Redux Toolkit. `configureStore` requires that we pass in a `reducer` argument.

Our application might be made up of many different features, and each of those features might have its own reducer function. When we call `configureStore`, we can pass in all of the different reducers in an object. The key names in the object will define the keys in our final state value.

We have a file named `features/counter/counterSlice.js` that exports a reducer function for the counter logic. We can import that `counterReducer` function here, and include it when we create the store.

When we pass in an object like `{counter: counterReducer}`, that says that we want to have a `state.counter` section of our Redux state object, and that we want the `counterReducer` function to be in charge of deciding if and how to update the `state.counter` section whenever an action is dispatched.

Redux allows store setup to be customized with different kinds of plugins ("middleware" and "enhancers"). `configureStore` automatically adds several middleware to the store setup by default to provide a good developer experience, and also sets up the store so that the Redux DevTools Extension can inspect its contents.

#### <span id="redux-slices" class="anchor enhancedAnchor_2LWZ"></span>Redux Slices<a href="#redux-slices" class="hash-link" title="Direct link to heading">#</a>

**A "slice" is a collection of Redux reducer logic and actions for a single feature in your app**, typically defined together in a single file. The name comes from splitting up the root Redux state object into multiple "slices" of state.

For example, in a blogging app, our store setup might look like:

<span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: #f8f8f2">{</span><span class="token imports"> configureStore </span><span class="token imports punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'@reduxjs/toolkit'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports">usersReducer</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'../features/users/usersSlice'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports">postsReducer</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'../features/posts/postsSlice'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports">commentsReducer</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'../features/comments/commentsSlice'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">default</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">configureStore</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> reducer</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> users</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> usersReducer</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> posts</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> postsReducer</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> comments</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> commentsReducer</span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

In that example, `state.users`, `state.posts`, and `state.comments` are each a separate "slice" of the Redux state. Since `usersReducer` is responsible for updating the `state.users` slice, we refer to it as a "slice reducer" function.

#### Detailed Explanation: Reducers and State Structure

A Redux store needs to have a single "root reducer" function passed in when it's created. So if we have many different slice reducer functions, how do we get a single root reducer instead, and how does this define the contents of the Redux store state?

If we tried calling all of the slice reducers by hand, it might look like this:

<span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">rootReducer</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">state </span><span class="token parameter operator" style="color: #f8f8f2">=</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color: #f8f8f2">{</span><span class="token parameter punctuation" style="color: #f8f8f2">}</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> users</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">usersReducer</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">users</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> posts</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">postsReducer</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> comments</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">commentsReducer</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">comments</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

That calls each slice reducer individually, passes in the specific slice of the Redux state, and includes each return value in the final new Redux state object.

Redux has a function called [`combineReducers`](../../api/combinereducers.html) that does this for us automatically. It accepts an object full of slice reducers as its argument, and returns a function that calls each slice reducer whenever an action is dispatched. The result from each slice reducer are all combined together into a single object as the final result. We can do the same thing as the previous example using `combineReducers`:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> rootReducer </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">combineReducers</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> users</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> usersReducer</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> posts</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> postsReducer</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> comments</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> commentsReducer</span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

When we pass an object of slice reducers to `configureStore`, it passes those to `combineReducers` for us to generate the root reducer.

As we saw earlier, you can also pass a reducer function directly as the `reducer` argument:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> store </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">configureStore</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> reducer</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> rootReducer</span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

### <span id="creating-slice-reducers-and-actions" class="anchor enhancedAnchor_2LWZ"></span>Creating Slice Reducers and Actions<a href="#creating-slice-reducers-and-actions" class="hash-link" title="Direct link to heading">#</a>

Since we know that the `counterReducer` function is coming from `features/counter/counterSlice.js`, let's see what's in that file, piece by piece.

features/counter/counterSlice.js

<span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: #f8f8f2">{</span><span class="token imports"> createSlice </span><span class="token imports punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'@reduxjs/toolkit'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> counterSlice </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">createSlice</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> name</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'counter'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> initialState</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> value</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">0</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> reducers</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">increment</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// Redux Toolkit allows us to write "mutating" logic in reducers. It</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// doesn't actually mutate the state because it uses the immer library,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// which detects changes to a "draft state" and produces a brand new</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// immutable state based off those changes</span><span class="token plain"></span>

<span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">+=</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">1</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">decrement</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">-=</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">1</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">incrementByAmount</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">+=</span><span class="token plain"> action</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">payload</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"> increment</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> decrement</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> incrementByAmount </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> counterSlice</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">actions</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">default</span><span class="token plain"> counterSlice</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">reducer</span>

Copy

Earlier, we saw that clicking the different buttons in the UI dispatched three different Redux action types:

- `{type: "counter/increment"}`
- `{type: "counter/decrement"}`
- `{type: "counter/incrementByAmount"}`

We know that actions are plain objects with a `type` field, the `type` field is always a string, and we typically have "action creator" functions that create and return the action objects. So where are those action objects, type strings, and action creators defined?

We _could_ write those all by hand, every time. But, that would be tedious. Besides, what's _really_ important in Redux is the reducer functions, and the logic they have for calculating new state.

Redux Toolkit has a function called `createSlice`, which takes care of the work of generating action type strings, action creator functions, and action objects. All you have to do is define a name for this slice, write an object that has some reducer functions in it, and it generates the corresponding action code automatically. The string from the `name` option is used as the first part of each action type, and the key name of each reducer function is used as the second part. So, the `"counter"` name + the `"increment"` reducer function generated an action type of `{type: "counter/increment"}`. (After all, why write this by hand if the computer can do it for us!)

In addition to the `name` field, `createSlice` needs us to pass in the initial state value for the reducers, so that there is a `state` the first time it gets called. In this case, we're providing an object with a `value` field that starts off at 0.

We can see here that there are three reducer functions, and that corresponds to the three different action types that were dispatched by clicking the different buttons.

`createSlice` automatically generates action creators with the same names as the reducer functions we wrote. We can check that by calling one of them and seeing what it returns:

<span class="token console class-name">console</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">log</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">counterSlice</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">actions</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">increment</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// {type: "counter/increment"}</span>

Copy

It also generates the slice reducer function that knows how to respond to all these action types:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> newState </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> counterSlice</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">reducer</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"> value</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">10</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> counterSlice</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">actions</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">increment</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">log</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">newState</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// {value: 11}</span>

Copy

### <span id="rules-of-reducers" class="anchor enhancedAnchor_2LWZ"></span>Rules of Reducers<a href="#rules-of-reducers" class="hash-link" title="Direct link to heading">#</a>

We said earlier that reducers must **always** follow some special rules:

- They should only calculate the new state value based on the `state` and `action` arguments
- They are not allowed to modify the existing `state`. Instead, they must make _immutable updates_, by copying the existing `state` and making changes to the copied values.
- They must not do any asynchronous logic or other "side effects"

But why are these rules important? There's a few different reasons:

- One of the goals of Redux is to make your code predictable. When a function's output is only calculated from the input arguments, it's easier to understand how that code works, and to test it.
- On the other hand, if a function depends on variables outside itself, or behaves randomly, you never know what will happen when you run it.
- If a function modifies other values, including its arguments, that can change the way the application works unexpectedly. This can be a common source of bugs, such as "I updated my state, but now my UI isn't updating when it should!"
- Some of the Redux DevTools capabilities depend on having your reducers follow these rules correctly

The rule about "immutable updates" is particularly important, and worth talking about further.

### <span id="reducers-and-immutable-updates" class="anchor enhancedAnchor_2LWZ"></span>Reducers and Immutable Updates<a href="#reducers-and-immutable-updates" class="hash-link" title="Direct link to heading">#</a>

Earlier, we talked about "mutation" (modifying existing object/array values) and "immutability" (treating values as something that cannot be changed).

In Redux, **our reducers are _never_ allowed to mutate the original / current state values!**

<span class="token comment" style="color: #c6cad2">// ❌ Illegal - by default, this will mutate the state!</span><span class="token plain"></span>

<span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">123</span>

Copy

:::

There are several reasons why you must not mutate state in Redux:

- It causes bugs, such as the UI not updating properly to show the latest values
- It makes it harder to understand why and how the state has been updated
- It makes it harder to write tests
- It breaks the ability to use "time-travel debugging" correctly
- It goes against the intended spirit and usage patterns for Redux

So if we can't change the originals, how do we return an updated state?

##### <span class="admonition-icon"> </span>tip

**Reducers can only make _copies_ of the original values, and then they can mutate the copies.**

<span class="token comment" style="color: #c6cad2">// ✅ This is safe, because we made a copy</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token spread operator" style="color: #f8f8f2">...</span><span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> value</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">123</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

We already saw that we can [write immutable updates by hand](part-1-overview-concepts.html#immutability), by using JavaScript's array / object spread operators and other functions that return copies of the original values. However, if you're thinking that "writing immutable updates by hand this way looks hard to remember and do correctly"... yeah, you're right! :)

Writing immutable update logic by hand _is_ hard, and accidentally mutating state in reducers is the single most common mistake Redux users make.

**That's why Redux Toolkit's `createSlice` function lets you write immutable updates an easier way!**

`createSlice` uses a library called [Immer](../../../immerjs.github.io/immer/index.html) inside. Immer uses a special JS tool called a `Proxy` to wrap the data you provide, and lets you write code that "mutates" that wrapped data. But, **Immer tracks all the changes you've tried to make, and then uses that list of changes to return a safely immutably updated value**, as if you'd written all the immutable update logic by hand.

So, instead of this:

<span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">handwrittenReducer</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token spread operator" style="color: #f8f8f2">...</span><span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> first</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token spread operator" style="color: #f8f8f2">...</span><span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">first</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> second</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token spread operator" style="color: #f8f8f2">...</span><span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">first</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">second</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token plain">action</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">someId</span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token spread operator" style="color: #f8f8f2">...</span><span class="token plain">state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">first</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">second</span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token plain">action</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">someId</span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> fourth</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> action</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">someValue</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

You can write code that looks like this:

<span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">reducerWithImmer</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">first</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">second</span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token plain">action</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">someId</span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">fourth</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">someValue</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

That's a lot easier to read!

But, here's something _very_ important to remember:

##### <span class="admonition-icon"> </span>warning

**You can _only_ write "mutating" logic in Redux Toolkit's `createSlice` and `createReducer` because they use Immer inside! If you write mutating logic in reducers without Immer, it _will_ mutate the state and cause bugs!**

With that in mind, let's go back and look at the actual reducers from the counter slice.

features/counter/counterSlice.js

<span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> counterSlice </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">createSlice</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> name</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'counter'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> initialState</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> value</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">0</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> reducers</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">increment</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// Redux Toolkit allows us to write "mutating" logic in reducers. It</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// doesn't actually mutate the state because it uses the immer library,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// which detects changes to a "draft state" and produces a brand new</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// immutable state based off those changes</span><span class="token plain"></span>

<span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">+=</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">1</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">decrement</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">-=</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">1</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">incrementByAmount</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">+=</span><span class="token plain"> action</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">payload</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

We can see that the `increment` reducer will always add 1 to `state.value`. Because Immer knows we've made changes to the draft `state` object, we don't have to actually return anything here. In the same way, the `decrement` reducer subtracts 1.

In both of those reducers, we don't actually need to have our code look at the `action` object. It will be passed in anyway, but since we don't need it, we can skip declaring `action` as a parameter for the reducers.

On the other hand, the `incrementByAmount` reducer _does_ need to know something: how much it should be adding to the counter value. So, we declare the reducer as having both `state` and `action` arguments. In this case, we know that the amount we typed into the textbox is being put into the `action.payload` field, so we can add that to `state.value`.

##### <span class="admonition-icon"> </span>Want to Know More?

For more information on immutability and writing immutable updates, see [the "Immutable Update Patterns" docs page](../../recipes/structuring-reducers/immutable-update-patterns.html) and [The Complete Guide to Immutability in React and Redux](../../../daveceddia.com/react-redux-immutability-guide/index.html).

### <span id="writing-async-logic-with-thunks" class="anchor enhancedAnchor_2LWZ"></span>Writing Async Logic with Thunks<a href="#writing-async-logic-with-thunks" class="hash-link" title="Direct link to heading">#</a>

So far, all the logic in our application has been synchronous. Actions are dispatched, the store runs the reducers and calculates the new state, and the dispatch function finishes. But, the JavaScript language has many ways to write code that is asynchronous, and our apps normally have async logic for things like fetching data from an API. We need a place to put that async logic in our Redux apps.

A **thunk** is a specific kind of Redux function that can contain asynchronous logic. Thunks are written using two functions:

- An inside thunk function, which gets `dispatch` and `getState` as arguments
- The outside creator function, which creates and returns the thunk function

The next function that's exported from `counterSlice` is an example of a thunk action creator:

features/counter/counterSlice.js

<span class="token comment" style="color: #c6cad2">// The function below is called a thunk and allows us to perform async logic.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// It can be dispatched like a regular action: \`dispatch(incrementAsync(10))\`.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// This will call the thunk with the \`dispatch\` function as the first argument.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// Async code can then be executed and other actions can be dispatched</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">incrementAsync</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token parameter">amount</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token parameter">dispatch</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">setTimeout</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">incrementByAmount</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">amount</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">1000</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

We can use them the same way we use a typical Redux action creator:

<span class="token plain">store</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">incrementAsync</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token number" style="color: #ae81ff">5</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

However, using thunks requires that the `redux-thunk` _middleware_ (a type of plugin for Redux) be added to the Redux store when it's created. Fortunately, Redux Toolkit's `configureStore` function already sets that up for us automatically, so we can go ahead and use thunks here.

When you need to make AJAX calls to fetch data from the server, you can put that call in a thunk. Here's an example that's written a bit longer, so you can see how it's defined:

features/counter/counterSlice.js

<span class="token comment" style="color: #c6cad2">// the outside "thunk creator" function</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">fetchUserById</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token parameter">userId</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// the inside "thunk function"</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">dispatch</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> getState</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// make an async call in the thunk</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> user </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">await</span><span class="token plain"> userAPI</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">fetchById</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">userId</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// dispatch an action when we get the response back</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">userLoaded</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">user</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">err</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// If something went wrong, handle it here</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

We'll see thunks being used in [Part 5: Async Logic and Data Fetching](part-5-async-logic.html)

#### Detailed Explanation: Thunks and Async Logic

We know that we're not allowed to put any kind of async logic in reducers. But, that logic has to live somewhere.

If we have access to the Redux store, we could write some async code and call `store.dispatch()` when we're done:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> store </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">configureStore</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"> reducer</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> counterReducer </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token function" style="color: #e6d874">setTimeout</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> store</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">increment</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">250</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

But, in a real Redux app, we're not allowed to import the store into other files, especially in our React components, because it makes that code harder to test and reuse.

In addition, we often need to write some async logic that we know will be used with _some_ store, eventually, but we don't know _which_ store.

The Redux store can be extended with "middleware", which are a kind of add-on or plugin that can add extra abilities. The most common reason to use middleware is to let you write code that can have async logic, but still talk to the store at the same time. They can also modify the store so that we can call `dispatch()` and pass in values that are _not_ plain action objects, like functions or Promises.

The Redux Thunk middleware modifies the store to let you pass functions into `dispatch`. In fact, it's short enough we can paste it here:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">thunkMiddleware</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter punctuation" style="color: #f8f8f2">{</span><span class="token parameter"> dispatch</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> getState </span><span class="token parameter punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token keyword" style="color: #f92672">typeof</span><span class="token plain"> action </span><span class="token operator" style="color: #f8f8f2">===</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'function'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">action</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">dispatch</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> getState</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">next</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

It looks to see if the "action" that was passed into `dispatch` is actually a function instead of a plain action object. If it's actually a function, it calls the function, and returns the result. Otherwise, since this must be an action object, it passes the action forward to the store.

This gives us a way to write whatever sync or async code we want, while still having access to `dispatch` and `getState`.

There's one more function in this file, but we'll talk about that in a minute when we look at the `<Counter>` UI component.

##### <span class="admonition-icon"> </span>Want to Know More?

See [the Redux Thunk docs](../../../github.com/reduxjs/redux-thunk.html), the post [What the heck is a thunk?](../../../daveceddia.com/what-is-a-thunk/index.html) and the [Redux FAQ entry on "why do we use middleware for async?"](../../faq/actions.html#how-can-i-represent-side-effects-such-as-ajax-calls-why-do-we-need-things-like-action-creators-thunks-and-middleware-to-do-async-behavior) for more information.

### <span id="the-react-counter-component" class="anchor enhancedAnchor_2LWZ"></span>The React Counter Component<a href="#the-react-counter-component" class="hash-link" title="Direct link to heading">#</a>

Earlier, we saw what a standalone React `<Counter>` component looks like. Our React+Redux app has a similar `<Counter>` component, but it does a few things differently.

We'll start by looking at the `Counter.js` component file:

features/counter/Counter.js

<span class="token keyword" style="color: #f92672">import</span><span class="token plain"> React</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"> useState </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'react'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"> useSelector</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> useDispatch </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'react-redux'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> decrement</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> increment</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> incrementByAmount</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> incrementAsync</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> selectCount</span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'./counterSlice'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> styles </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'./Counter.module.css'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">Counter</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> count </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">useSelector</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">selectCount</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">useDispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token plain">incrementAmount</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> setIncrementAmount</span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">useState</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'2'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"> </span><span class="token keyword" style="color: #f92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">div</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">div</span><span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">row</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">button</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">button</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">aria-label</span><span class="token tag attr-value punctuation attr-equals" style="color: #f8f8f2">=</span><span class="token tag attr-value punctuation" style="color: #f8f8f2">"</span><span class="token tag attr-value" style="color: #e6d874">Increment value</span><span class="token tag attr-value punctuation" style="color: #f8f8f2">"</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript operator" style="color: #f8f8f2">=&gt;</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript function" style="color: #e6d874">dispatch</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript function" style="color: #e6d874">increment</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">+</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">button</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">span</span><span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">value</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain">count</span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">span</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">button</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">button</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">aria-label</span><span class="token tag attr-value punctuation attr-equals" style="color: #f8f8f2">=</span><span class="token tag attr-value punctuation" style="color: #f8f8f2">"</span><span class="token tag attr-value" style="color: #e6d874">Decrement value</span><span class="token tag attr-value punctuation" style="color: #f8f8f2">"</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript operator" style="color: #f8f8f2">=&gt;</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript function" style="color: #e6d874">dispatch</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript function" style="color: #e6d874">decrement</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">-</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">button</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">div</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token comment" style="color: #c6cad2">/\* omit additional rendering output here \*/</span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">div</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span>

Copy

Like with the earlier plain React example, we have a function component called `Counter`, that stores some data in a `useState` hook.

However, in our component, it doesn't look like we're storing the actual current counter value as state. There _is_ a variable called `count`, but it's not coming from a `useState` hook.

While React includes several built-in hooks like `useState` and `useEffect`, other libraries can create their own [custom hooks](../../../reactjs.org/docs/hooks-custom.html) that use React's hooks to build custom logic.

The [React-Redux library](../../../react-redux.js.org/index.html) has [a set of custom hooks that allow your React component to interact with a Redux store](../../../react-redux.js.org/api/hooks.html).

#### <span id="reading-data-with-useselector" class="anchor enhancedAnchor_2LWZ"></span>Reading Data with `useSelector`<a href="#reading-data-with-useselector" class="hash-link" title="Direct link to heading">#</a>

First, the `useSelector` hook lets our component extract whatever pieces of data it needs from the Redux store state.

Earlier, we saw that we can write "selector" functions, which take `state` as an argument and return some part of the state value.

Our `counterSlice.js` has this selector function at the bottom:

features/counter/counterSlice.js

<span class="token comment" style="color: #c6cad2">// The function below is called a selector and allows us to select a value from</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// the state. Selectors can also be defined inline where they're used instead of</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// in the slice file. For example: \`useSelector((state) =&gt; state.counter.value)\`</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color: #e6d874">selectCount</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">counter</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span>

Copy

If we had access to a Redux store, we could retrieve the current counter value as:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> count </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">selectCount</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">store</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">getState</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">log</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">count</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// 0</span>

Copy

Our components can't talk to the Redux store directly, because we're not allowed to import it into component files. But, `useSelector` takes care of talking to the Redux store behind the scenes for us. If we pass in a selector function, it calls `someSelector(store.getState())` for us, and returns the result.

So, we can get the current store counter value by doing:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> count </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">useSelector</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">selectCount</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

We don't have to _only_ use selectors that have already been exported, either. For example, we could write a selector function as an inline argument to `useSelector`:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> countPlusTwo </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">useSelector</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">counter</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">+</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">2</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

Any time an action has been dispatched and the Redux store has been updated, `useSelector` will re-run our selector function. If the selector returns a different value than last time, `useSelector` will make sure our component re-renders with the new value.

#### <span id="dispatching-actions-with-usedispatch" class="anchor enhancedAnchor_2LWZ"></span>Dispatching Actions with `useDispatch`<a href="#dispatching-actions-with-usedispatch" class="hash-link" title="Direct link to heading">#</a>

Similarly, we know that if we had access to a Redux store, we could dispatch actions using action creators, like `store.dispatch(increment())`. Since we don't have access to the store itself, we need some way to have access to just the `dispatch` method.

The `useDispatch` hook does that for us, and gives us the actual `dispatch` method from the Redux store:

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">useDispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

From there, we can dispatch actions when the user does something like clicking on a button:

features/counter/Counter.js

<span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">button</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">button</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">aria-label</span><span class="token tag attr-value punctuation attr-equals" style="color: #f8f8f2">=</span><span class="token tag attr-value punctuation" style="color: #f8f8f2">"</span><span class="token tag attr-value" style="color: #e6d874">Increment value</span><span class="token tag attr-value punctuation" style="color: #f8f8f2">"</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript operator" style="color: #f8f8f2">=&gt;</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript function" style="color: #e6d874">dispatch</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript function" style="color: #e6d874">increment</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"></span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">+</span><span class="token plain"></span>

<span class="token plain"></span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">button</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span>

Copy

### <span id="component-state-and-forms" class="anchor enhancedAnchor_2LWZ"></span>Component State and Forms<a href="#component-state-and-forms" class="hash-link" title="Direct link to heading">#</a>

By now you might be wondering, "Do I always have to put all my app's state into the Redux store?"

The answer is **NO. Global state that is needed across the app should go in the Redux store. State that's only needed in one place should be kept in component state.**

In this example, we have an input textbox where the user can type in the next number to be added to the counter:

features/counter/Counter.js

<span class="token keyword" style="color: #f92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token plain">incrementAmount</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> setIncrementAmount</span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">useState</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'2'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// later</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">div</span><span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">row</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">input</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">textbox</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">aria-label</span><span class="token tag attr-value punctuation attr-equals" style="color: #f8f8f2">=</span><span class="token tag attr-value punctuation" style="color: #f8f8f2">"</span><span class="token tag attr-value" style="color: #e6d874">Set increment amount</span><span class="token tag attr-value punctuation" style="color: #f8f8f2">"</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">value</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">incrementAmount</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">onChange</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript parameter" style="color: #f92672">e</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript operator" style="color: #f8f8f2">=&gt;</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript function" style="color: #e6d874">setIncrementAmount</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript" style="color: #f92672">e</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">target</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">value</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag punctuation" style="color: #f8f8f2">/&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">button</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">button</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript operator" style="color: #f8f8f2">=&gt;</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript function" style="color: #e6d874">dispatch</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript function" style="color: #e6d874">incrementByAmount</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript function" style="color: #e6d874">Number</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript" style="color: #f92672">incrementAmount</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript operator" style="color: #f8f8f2">||</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript number" style="color: #ae81ff">0</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> Add Amount</span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">button</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag" style="color: #f92672">button</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">styles</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">.</span><span class="token tag script language-javascript" style="color: #f92672">asyncButton</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript operator" style="color: #f8f8f2">=&gt;</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript function" style="color: #e6d874">dispatch</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript function" style="color: #e6d874">incrementAsync</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript function" style="color: #e6d874">Number</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">(</span><span class="token tag script language-javascript" style="color: #f92672">incrementAmount</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript operator" style="color: #f8f8f2">||</span><span class="token tag script language-javascript" style="color: #f92672"> </span><span class="token tag script language-javascript number" style="color: #ae81ff">0</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">)</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag" style="color: #f92672"></span>

<span class="token tag" style="color: #f92672"> </span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> Add Async</span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">button</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag" style="color: #f92672">div</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

We _could_ keep the current number string in the Redux store, by dispatching an action in the input's `onChange` handler and keeping it in our reducer. But, that doesn't give us any benefit. The only place that text string is used is here, in the `<Counter>` component. (Sure, there's only one other component in this example: `<App>`. But even if we had a larger application with many components, only `<Counter>` cares about this input value.)

So, it makes sense to keep that value in a `useState` hook here in the `<Counter>` component.

Similarly, if we had a boolean flag called `isDropdownOpen`, no other components in the app would care about that - it should really stay local to this component.

**In a React + Redux app, your global state should go in the Redux store, and your local state should stay in React components.**

If you're not sure where to put something, here are some common rules of thumb for determining what kind of data should be put into Redux:

- Do other parts of the application care about this data?
- Do you need to be able to create further derived data based on this original data?
- Is the same data being used to drive multiple components?
- Is there value to you in being able to restore this state to a given point in time (ie, time travel debugging)?
- Do you want to cache the data (ie, use what's in state if it's already there instead of re-requesting it)?
- Do you want to keep this data consistent while hot-reloading UI components (which may lose their internal state when swapped)?

This is also a good example of how to think about forms in Redux in general. **Most form state probably shouldn't be kept in Redux.** Instead, keep the data in your form components as you're editing it, and then dispatch Redux actions to update the store when the user is done.

One other thing to note before we move on: remember that `incrementAsync` thunk from `counterSlice.js`? We're using it here in this component. Notice that we use it the same way we dispatch the other normal action creators. This component doesn't care whether we're dispatching a normal action or starting some async logic. It only knows that when you click that button, it dispatches something.

### <span id="providing-the-store" class="anchor enhancedAnchor_2LWZ"></span>Providing the Store<a href="#providing-the-store" class="hash-link" title="Direct link to heading">#</a>

We've seen that our components can use the `useSelector` and `useDispatch` hooks to talk to the Redux store. But, since we didn't import the store, how do those hooks know what Redux store to talk to?

Now that we've seen all the different pieces of this application, it's time to circle back to the starting point of this application and see how the last pieces of the puzzle fit together.

index.js

<span class="token keyword" style="color: #f92672">import</span><span class="token plain"> React </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'react'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> ReactDOM </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'react-dom'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'./index.css'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> App </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'./App'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> store </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'./app/store'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"> Provider </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'react-redux'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">import</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">\*</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">as</span><span class="token plain"> serviceWorker </span><span class="token keyword" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'./serviceWorker'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain">ReactDOM</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token function" style="color: #e6d874">render</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag class-name" style="color: #f92672">Provider</span><span class="token tag" style="color: #f92672"> </span><span class="token tag attr-name" style="color: #a6e22e">store</span><span class="token tag script language-javascript script-punctuation punctuation" style="color: #f8f8f2">=</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">{</span><span class="token tag script language-javascript" style="color: #f92672">store</span><span class="token tag script language-javascript punctuation" style="color: #f8f8f2">}</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;</span><span class="token tag class-name" style="color: #f92672">App</span><span class="token tag" style="color: #f92672"> </span><span class="token tag punctuation" style="color: #f8f8f2">/&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token tag punctuation" style="color: #f8f8f2">&lt;/</span><span class="token tag class-name" style="color: #f92672">Provider</span><span class="token tag punctuation" style="color: #f8f8f2">&gt;</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> document</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token function" style="color: #e6d874">getElementById</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'root'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

We always have to call `ReactDOM.render(<App />)` to tell React to start rendering our root `<App>` component. In order for our hooks like `useSelector` to work right, we need to use a component called `<Provider>` to pass down the Redux store behind the scenes so they can access it.

We already created our store in `app/store.js`, so we can import it here. Then, we put our `<Provider>` component around the whole `<App>`, and pass in the store: `<Provider store={store}>`.

Now, any React components that call `useSelector` or `useDispatch` will be talking to the Redux store we gave to the `<Provider>`.

## <span id="what-youve-learned" class="anchor enhancedAnchor_2LWZ"></span>What You've Learned<a href="#what-youve-learned" class="hash-link" title="Direct link to heading">#</a>

Even though the counter example app is pretty small, it showed all the key pieces of a React + Redux app working together. Here's what we covered:

##### <span class="admonition-icon"> </span>Summary

- **We can create a Redux store using the Redux Toolkit `configureStore` API**
  - `configureStore` accepts a `reducer` function as a named argument
  - `configureStore` automatically sets up the store with good default settings
- **Redux logic is typically organized into files called "slices"**
  - A "slice" contains the reducer logic and actions related to a specific feature / section of the Redux state
  - Redux Toolkit's `createSlice` API generates action creators and action types for each individual reducer function you provide
- **Redux reducers must follow specific rules**
  - Should only calculate a new state value based on the `state` and `action` arguments
  - Must make _immutable updates_ by copying the existing state
  - Cannot contain any asynchronous logic or other "side effects"
  - Redux Toolkit's `createSlice` API uses Immer to allow "mutating" immutable updates
- **Async logic is typically written in special functions called "thunks"**
  - Thunks receive `dispatch` and `getState` as arguments
  - Redux Toolkit enables the `redux-thunk` middleware by default
- **React-Redux allows React components to interact with a Redux store**
  - Wrapping the app with `<Provider store={store}>` enables all components to use the store
  - Global state should go in the Redux store, local state should stay in React components

## <span id="whats-next" class="anchor enhancedAnchor_2LWZ"></span>What's Next?<a href="#whats-next" class="hash-link" title="Direct link to heading">#</a>

Now that you've seen all the pieces of a Redux app in action, it's time to write your own! For the rest of this tutorial, you'll be building a larger example app that uses Redux. Along the way, we'll cover all the key ideas you need to know to use Redux the right way.

Continue on to [Part 3: Basic Redux Data Flow](part-3-data-flow.html) to get started building the example app.

<a href="part-1-overview-concepts.html" class="pagination-nav__link"></a>

Previous

« Redux Essentials, Part 1: Redux Overview and Concepts

<a href="part-3-data-flow.html" class="pagination-nav__link"></a>

Next

Redux Essentials, Part 3: Basic Redux Data Flow »

- <a href="#introduction" class="table-of-contents__link">Introduction</a>
- <a href="#the-counter-example-app" class="table-of-contents__link">The Counter Example App</a>
  - <a href="#using-the-counter-app" class="table-of-contents__link">Using the Counter App</a>
- <a href="#application-contents" class="table-of-contents__link">Application Contents</a>
  - <a href="#creating-the-redux-store" class="table-of-contents__link">Creating the Redux Store</a>
  - <a href="#creating-slice-reducers-and-actions" class="table-of-contents__link">Creating Slice Reducers and Actions</a>
  - <a href="#rules-of-reducers" class="table-of-contents__link">Rules of Reducers</a>
  - <a href="#reducers-and-immutable-updates" class="table-of-contents__link">Reducers and Immutable Updates</a>
  - <a href="#writing-async-logic-with-thunks" class="table-of-contents__link">Writing Async Logic with Thunks</a>
  - <a href="#the-react-counter-component" class="table-of-contents__link">The React Counter Component</a>
  - <a href="#component-state-and-forms" class="table-of-contents__link">Component State and Forms</a>
  - <a href="#providing-the-store" class="table-of-contents__link">Providing the Store</a>
- <a href="#what-youve-learned" class="table-of-contents__link">What You've Learned</a>
- <a href="#whats-next" class="table-of-contents__link">What's Next?</a>

#### Docs

- <a href="../../introduction/getting-started.html" class="footer__link-item">Getting Started</a>
- <a href="part-1-overview-concepts.html" class="footer__link-item">Tutorial</a>
- <a href="../../faq.html" class="footer__link-item">FAQ</a>
- <a href="../../api/api-reference.html" class="footer__link-item">API Reference</a>

#### Community

- <a href="../../../discord.com/invite/0ZcbPKXt5bZ6au5t.html" class="footer__link-item">Reactiflux Discord</a>
- <a href="../../../stackoverflow.com/questions/tagged/redux.html" class="footer__link-item">Stack Overflow</a>
- <a href="../../introduction/getting-started.html#help-and-discussion" class="footer__link-item">Feedback</a>

#### More

- <a href="../../../github.com/reduxjs/redux.html" class="footer__link-item">GitHub</a>
- [![Deploys by Netlify](../../../www.netlify.com/img/global/badges/netlify-color-accent.svg)](../../../www.netlify.com/index.html)

<a href="../../index.html" class="footerLogoLink_MyFc"><img src="../../../d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo" /><img src="../../../d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo" /></a>
