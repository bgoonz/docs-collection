<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>Using Hermes</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <header id="title-block-header">
      <h1 class="title">Using Hermes</h1>
    </header>
    <p>
      <a href="https://hermesengine.dev">
        &lt;img width={300} height={300} style={{float: ‘right’, margin: ‘-30px
        4px 0’}} src=“/docs/assets/HermesLogo.svg” /&gt;
      </a>
    </p>
    <p>
      <a href="https://hermesengine.dev">Hermes</a> is an open-source JavaScript
      engine optimized for React Native. For many apps, enabling Hermes will
      result in improved start-up time, decreased memory usage, and smaller app
      size. At this time Hermes is an <strong>opt-in</strong> React Native
      feature, and this guide explains how to enable it.
    </p>
    <p>First, ensure you’re using at least version 0.60.4 of React Native.</p>
    <p>
      If you have an existing app based on an earlier version of React Native,
      you will have to upgrade it first. See
      <a href="/docs/upgrading">Upgrading to new React Native Versions</a> for
      how to do this. After upgrading the app, make sure everything works before
      trying to switch to Hermes.
    </p>
    <blockquote>
      <h2 id="note-for-rn-compatibility.">Note for RN compatibility.</h2>
      <p>
        Each Hermes release is aimed at a specific RN version. The rule of thumb
        is to always follow
        <a href="https://github.com/facebook/hermes/releases"
          >Hermes releases</a
        >
        strictly. Version mismatch can result in instant crash of your apps in
        the worst case scenario.
      </p>
    </blockquote>
    <blockquote>
      <h2 id="note-for-windows-users.">Note for Windows users.</h2>
      <p>
        Hermes requires
        <a href="https://www.microsoft.com/en-us/download/details.aspx?id=48145"
          >Microsoft Visual C++ 2015 Redistributable</a
        >
      </p>
    </blockquote>
    <h2 id="enabling-hermes">Enabling Hermes</h2>
    <h3 id="android">Android</h3>
    <p>
      Edit your <code>android/app/build.gradle</code> file and make the change
      illustrated below:
    </p>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode diff"
      ><code class="sourceCode diff"><a class="sourceLine" id="cb1-1" title="1">  project.ext.react = [</a>
<a class="sourceLine" id="cb1-2" title="2">      entryFile: &quot;index.js&quot;,</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="st">-     enableHermes: false  // clean and rebuild if changing</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="va">+     enableHermes: true  // clean and rebuild if changing</span></a>
<a class="sourceLine" id="cb1-5" title="5">  ]</a></code></pre>
    </div>
    <p>
      Also, if you’re using ProGuard, you will need to add these rules in
      <code>proguard-rules.pro</code> :
    </p>
    <pre><code>-keep class com.facebook.hermes.unicode.** { *; }
-keep class com.facebook.jni.** { *; }</code></pre>
    <p>
      Next, if you’ve already built your app at least once, clean the build:
    </p>
    <pre
      class="shell"
    ><code>$ cd android &amp;&amp; ./gradlew clean</code></pre>
    <p>
      That’s it! You should now be able to develop and deploy your app as usual:
    </p>
    <pre class="shell"><code>$ npx react-native run-android</code></pre>
    <blockquote>
      <h2 id="note-about-android-app-bundles">
        Note about Android App Bundles
      </h2>
      <p>Android app bundles are supported from react-native 0.62.0 and up.</p>
    </blockquote>
    <h3 id="ios">iOS</h3>
    <p>
      Since React Native 0.64, Hermes also runs on iOS. To enable Hermes for
      iOS, edit your <code>ios/Podfile</code> file and make the change
      illustrated below:
    </p>
    <div class="sourceCode" id="cb5">
      <pre
        class="sourceCode diff"
      ><code class="sourceCode diff"><a class="sourceLine" id="cb5-1" title="1">   use_react_native!(</a>
<a class="sourceLine" id="cb5-2" title="2">     :path =&gt; config[:reactNativePath],</a>
<a class="sourceLine" id="cb5-3" title="3">     # to enable hermes on iOS, change `false` to `true` and then install pods</a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">-    :hermes_enabled =&gt; false</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="va">+    :hermes_enabled =&gt; true</span></a>
<a class="sourceLine" id="cb5-6" title="6">   )</a></code></pre>
    </div>
    <p>Next, install the Hermes pods:</p>
    <pre class="shell"><code>$ cd ios &amp;&amp; pod install</code></pre>
    <p>
      That’s it! You should now be able to develop and deploy your app as usual:
    </p>
    <pre class="shell"><code>$ npx react-native run-ios</code></pre>
    <h2 id="confirming-hermes-is-in-use">Confirming Hermes is in use</h2>
    <p>
      If you’ve recently created a new app from scratch, you should see if
      Hermes is enabled in the welcome view:
    </p>
    <figure>
      <img
        src="/docs/assets/HermesApp.jpg"
        alt="Where to find JS engine status in AwesomeProject"
      />
      <figcaption>Where to find JS engine status in AwesomeProject</figcaption>
    </figure>
    <p>
      A <code>HermesInternal</code> global variable will be available in
      JavaScript that can be used to verify that Hermes is in use:
    </p>
    <pre
      class="jsx"
    ><code>const isHermes = () =&gt; !!global.HermesInternal;</code></pre>
    <p>
      To see the benefits of Hermes, try making a release build/deployment of
      your app to compare. For example:
    </p>
    <pre
      class="shell"
    ><code>$ npx react-native run-android --variant release</code></pre>
    <p>or for iOS:</p>
    <pre
      class="shell"
    ><code>$ npx react-native run-ios --configuration Release</code></pre>
    <p>
      This will compile JavaScript to bytecode during build time which will
      improve your app’s startup speed on device.
    </p>
    <h2 id="debugging-js-on-hermes-using-google-chromes-devtools">
      Debugging JS on Hermes using Google Chrome’s DevTools
    </h2>
    <p>
      Hermes supports the Chrome debugger by implementing the Chrome inspector
      protocol. This means Chrome’s tools can be used to directly debug
      JavaScript running on Hermes, on an emulator or on a real, physical,
      device.
    </p>
    <blockquote>
      <p>
        Note that this is very different with the “Remote JS Debugging” from the
        In-App Developer Menu documented in the
        <a href="debugging#debugging-using-a-custom-javascript-debugger"
          >Debugging</a
        >
        section, which actually runs the JS code on Chrome’s V8 on your
        development machine (laptop or desktop).
      </p>
    </blockquote>
    <p>
      Chrome connects to Hermes running on device via Metro, so you’ll need to
      know where Metro is listening. Typically this will be on
      <code>localhost:8081</code>, but this is
      <a href="https://facebook.github.io/metro/docs/configuration"
        >configurable</a
      >. When running <code>yarn start</code> the address is written to stdout
      on startup.
    </p>
    <p>
      Once you know where the Metro server is listening, you can connect with
      Chrome using the following steps:
    </p>
    <ol type="1">
      <li>
        <p>
          Navigate to <code>chrome://inspect</code> in a Chrome browser
          instance.
        </p>
      </li>
      <li>
        <p>
          Use the <code>Configure...</code> button to add the Metro server
          address (typically <code>localhost:8081</code> as described above).
        </p>
      </li>
    </ol>
    <figure>
      <img
        src="/docs/assets/HermesDebugChromeConfig.png"
        alt="Configure button in Chrome DevTools devices page"
      />
      <figcaption>Configure button in Chrome DevTools devices page</figcaption>
    </figure>
    <figure>
      <img
        src="/docs/assets/HermesDebugChromeMetroAddress.png"
        alt="Dialog for adding Chrome DevTools network targets"
      />
      <figcaption>Dialog for adding Chrome DevTools network targets</figcaption>
    </figure>
    <ol start="3" type="1">
      <li>
        <p>
          You should now see a “Hermes React Native” target with an “inspect”
          link which can be used to bring up debugger. If you don’t see the
          “inspect” link, make sure the Metro server is running.
          <img
            src="/docs/assets/HermesDebugChromeInspect.png"
            alt="Target inspect link"
          />
        </p>
      </li>
      <li>
        <p>
          You can now use the Chrome debug tools. For example, to breakpoint the
          next time some JavaScript is run, click on the pause button and
          trigger an action in your app which would cause JavaScript to execute.
          <img
            src="/docs/assets/HermesDebugChromePause.png"
            alt="Pause button in debug tools"
          />
        </p>
      </li>
    </ol>
  </body>
</html>
