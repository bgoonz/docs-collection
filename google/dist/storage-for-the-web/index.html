
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=fca133e9ed35b">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Storage for the web</title>
<meta name="description" content="There are many different options for storing data in the browser. Which one is best for your needs?" />

<link rel="canonical" href="https://web.dev/storage-for-the-web/" />

<meta itemprop="name" content="Storage for the web" />
<meta itemprop="description" content="There are many different options for storing data in the browser. Which one is best for your needs?" />
<meta itemprop="image" content="https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/storage-for-the-web/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Storage for the web" />
<meta property="og:description" content="There are many different options for storing data in the browser. Which one is best for your needs?" />
<meta property="og:image" content="https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="Stack of shipping containers" />
<meta property="tag" content="progressive-web-apps" />
<meta property="tag" content="storage" />
<meta property="tag" content="indexeddb" />
<meta property="tag" content="cachestorage" />
<meta property="tag" content="memory" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Storage for the web" />
<meta name="twitter:description" content="There are many different options for storing data in the browser. Which one is best for your needs?" />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>








<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=728205b0d854c', 'module');




  loadScript('/js/content.js?v=a4549454efca', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="30" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
      
    
    


<div class="guide-landing-page">
  
  

  
    <img     alt="Stack of shipping containers"     class="w-hero w-hero--cover"     decoding="auto"     height="480"               sizes="100vw"     src="https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/c8u2hKEFoFfgTsmcKeuK.jpg?auto=format&w=1600 1600w"          width="1600"   />
  

  <web-table-of-contents>
    <h2 class="w-toc__header">
      <a href="#storage-for-the-web" class="w-toc__header--link">
        Storage for the web
      </a>
    </h2>
    <div class="w-toc__list">
        <ul><li><a href="#recommendation">What should I use?</a></li><li><a href="#other">What about other storage mechanisms?</a></li><li><a href="#how-much">How much can I store?</a></li><li><a href="#check">How can I check how much storage is available?</a></li><li><a href="#inspect">Inspect</a></li><li><a href="#over-quota">How to handle going over quota?</a></li><li><a href="#indexeddb">IndexedDB</a></li><li><a href="#cache-api">Cache API</a></li><li><a href="#eviction">How does eviction work?</a></li><li><a href="#bonus:-why-use-a-wrapper-for-indexeddb">Bonus: Why use a wrapper for IndexedDB</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#additional-resources">Additional resources</a></li><li><a href="#thanks">Thanks</a></li></ul></div>
  </web-table-of-contents>
  <web-table-of-contents-button></web-table-of-contents-button>

  
  <div class="w-actions">
    <share-action authors="@petele"
      class="gc-analytics-event w-actions__fab w-actions__fab--share"
      data-category="web.dev"
      data-label="share"
      data-action="click"
      data-icon="share"
      tabindex="0"
      role="button"
    >
      <span>Share</span>
    </share-action>
    <a class="w-actions__fab w-actions__fab--subscribe gc-analytics-event" data-category="web.dev" data-label="view-subscribe" data-action="click" href="/newsletter/">
  <span>subscribe</span>
</a>

  </div>

  <div class="w-layout-container--narrow w-post-content">
    <header class="w-article-header">
      
        <div class="w-post-breadcrumbs">
          <ul class="w-breadcrumbs">
  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link w-breadcrumbs__link--left-justify gc-analytics-event"
      data-category="web.dev"
      data-label="post, home breadcrumb"
      data-action="click"
      href="/"
    >
      Home
    </a>
  </li>

  <svg
    class="w-breadcrumbs__icon"
    xmlns="http://www.w3.org/2000/svg"
    height="24"
    viewBox="0 0 24 24"
    width="24"
    aria-hidden="true"
  >
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z" />
  </svg>

  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link gc-analytics-event"
      data-category="web.dev"
      data-label="post, path breadcrumb"
      data-action="click"
      href=/blog
    >
      All articles
    </a>
  </li>
</ul>
        </div>
      

      <h1 id="storage-for-the-web" class="w-article-header__headline">Storage for the web</h1>
      
        <p class="w-article-header__subhead w-mb--non">
          There are many different options for storing data in the browser. Which one is best for your needs?
        </p>
      

      
        <div class="w-author__published">
          <time>Apr 27, 2020</time>
           <span class="w-author__separator">â€¢</span> Updated <time>Feb 11, 2021</time> 
        </div>
      
      

      
        <div class="w-authors w-mt--xl w-pt--sm">
          
            <div class="w-author">
  <a href="/authors/petelepage/"><img     alt="Pete LePage"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/3rFbsLsMMk1VveHfBRSu.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/3rFbsLsMMk1VveHfBRSu.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/3rFbsLsMMk1VveHfBRSu.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/3rFbsLsMMk1VveHfBRSu.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/3rFbsLsMMk1VveHfBRSu.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/3rFbsLsMMk1VveHfBRSu.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/petelepage/">Pete LePage</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/petele"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/petele">GitHub</a>
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://glitch.com/@petele"
          >Glitch</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://petelepage.com">Blog</a>
      </li>
    </ul>
  </div>
</div>
          
        </div>
      
    </header>

    

    <p>Internet connections can be flakey or non-existent on the go, which is why
offline support and reliable performance are common features in
<a href="/progressive-web-apps/">progressive web apps</a>. Even in perfect wireless
environments, judicious use of caching and other storage techniques can
substantially improve the user experience. There are several ways to cache
your static application resources (HTML, JavaScript, CSS, images, etc.), and
data (user data, news articles, etc.). But which is the best solution? How
much can you store? How do you prevent it from being evicted?</p>
<h2 id="recommendation">What should I use? <a class="w-headline-link" href="#recommendation">#</a></h2>
<p>Here's a general recommendation for storing resources:</p>
<ul>
<li>For the network resources necessary to load your app and file-based content,
use the <a href="https://developers.google.com/web/fundamentals/instant-and-offline/web-storage/cache-api" rel="noopener"><strong>Cache Storage API</strong></a> (part of
<a href="https://developers.google.com/web/fundamentals/primers/service-workers" rel="noopener">service workers</a>).</li>
<li>For other data, use <a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API" rel="noopener"><strong>IndexedDB</strong></a> (with a
<a href="https://www.npmjs.com/package/idb" rel="noopener">promises wrapper</a>).</li>
</ul>
<p>IndexedDB and the Cache Storage API are supported in every modern browser.
They're both asynchronous, and will not block the main thread. They're
accessible from the <code>window</code> object, web workers, and service workers, making
it easy to use them anywhere in your code.</p>
<h2 id="other">What about other storage mechanisms? <a class="w-headline-link" href="#other">#</a></h2>
<p>There are several other storage mechanisms available in the browser, but they
have limited use and may cause significant performance issues.</p>
<p><a href="https://developer.mozilla.org/en/docs/Web/API/Window/sessionStorage" rel="noopener">SessionStorage</a> is tab specific, and scoped to the
lifetime of the tab. It may be useful for storing small amounts of session
specific information, for example an IndexedDB key. It should be used with
caution because it is synchronous and will block the main thread. It is
limited to about 5MB and can contain only strings. Because it is tab specific,
it is not accessible from web workers or service workers.</p>
<p><a href="https://developer.mozilla.org/en/docs/Web/API/Window/localStorage" rel="noopener">LocalStorage</a> should be avoided because it is synchronous
and will block the main thread. It is limited to about 5MB and can contain
only strings. LocalStorage is not accessible from web workers or service
workers.</p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies" rel="noopener">Cookies</a> have their uses, but should not be used for storage.
Cookies are sent with every HTTP request, so storing anything more than a
small amount of data will significantly increase the size of every web request.
They are synchronous, and are not accessible from web workers. Like
LocalStorage and SessionStorage, cookies are limited to only strings.</p>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/File_and_Directory_Entries_API/Introduction" rel="noopener">File System API</a> and FileWriter API provide methods for
reading and writing files to a sandboxed file system. While it is asynchronous,
it is not recommended because it is
<a href="https://caniuse.com/#feat=filesystem" rel="noopener">only available in Chromium-based browsers</a>.</p>
<p>The <a href="/file-system-access/">File System Access API</a> was designed to make it
easy for users to read and edit files on their local file system. The user
must grant permission before a page can read or write to any local file, and
permissions are not persisted across sessions.</p>
<p>WebSQL should <strong>not</strong> be used, and existing usage should be migrated to
IndexedDB. Support has <a href="https://caniuse.com/#feat=sql-storage" rel="noopener">been removed</a> from almost all major
browsers. The W3C <a href="https://www.w3.org/TR/webdatabase/" rel="noopener">stopped maintaining the Web SQL spec</a> in 2010,
with no plans to further updates planned.</p>
<p>Application Cache should <strong>not</strong> be used, and existing usage should be
migrated to service workers and the Cache API. It has been
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/applicationCache" rel="noopener">deprecated</a> and support will be removed from browsers in
the future.</p>
<h2 id="how-much">How much can I store? <a class="w-headline-link" href="#how-much">#</a></h2>
<p>In short, <strong>a lot</strong>, at least a couple of hundred megabytes, and potentially
hundreds of gigabytes or more. Browser implementations vary, but the amount
of storage available is usually based on the amount of storage available on the
device.</p>
<ul>
<li>Chrome allows the browser to use up to 80% of total disk space. An origin can
use up to 60% of the total disk space. You can use the <a href="#check">StorageManager
API</a> to determine the maximum quota available. Other Chromium-based
browsers may allow the browser to use more storage. See
<a href="https://github.com/GoogleChrome/web.dev/pull/3896" rel="noopener">PR #3896</a> for details about
Chrome's implementation.</li>
<li>Internet Explorer 10 and later can store up to 250MB and will prompt the
user when more than 10MB has been used.</li>
<li>Firefox allows the browser to use up to 50% of free disk space. An
<a href="https://godoc.org/golang.org/x/net/publicsuffix" rel="noopener">eTLD+1</a>
group (e.g., <code>example.com</code>, <code>www.example.com</code> and <code>foo.bar.example.com</code>)
<a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API/Browser_storage_limits_and_eviction_criteria#Storage_limits" rel="noopener">may use up to 2GB</a>. You can use the
<a href="#check-available">StorageManager API</a> to determine how much space is still
available.</li>
<li>Safari (both desktop and mobile) appears to allow about 1GB. When the limit
is reached, Safari will prompt the user, increasing the limit in 200MB
increments. I was unable to find any official documentation on this.
<ul>
<li>If a PWA is added to the home screen on mobile Safari, it appears to
create a new storage container, and nothing is shared between the PWA
and mobile Safari. Once the quota has been hit for an installed PWA, there
doesn't appear to be any way to request additional storage.</li>
</ul>
</li>
</ul>
<p>In the past, if a site exceeded a certain threshold of data stored, the
browser would prompt the user to grant permission to use more data. For
example, if the origin used more than 50MB, the browser would prompt the user
to allow it to store up to 100MB, then ask again at 50MB increments.</p>
<p>Today, most modern browsers will not prompt the user, and will allow a site
to use up to its allotted quota. The exception appears to be Safari, which
prompts at 750MB, asking permission to store up to 1.1GB. If an origin
attempts to use more than its allotted quota, further attempts to write data
will fail.</p>
<h2 id="check">How can I check how much storage is available? <a class="w-headline-link" href="#check">#</a></h2>
<p>In <a href="https://caniuse.com/#feat=mdn-api_storagemanager" rel="noopener">many browsers</a>, you can use the
<a href="https://developer.mozilla.org/en-US/docs/Web/API/StorageManager/estimate" rel="noopener">StorageManager API</a> to determine the amount of storage
available to the origin, and how much storage it's using. It reports the total
number of bytes used by IndexedDB and the Cache API, and makes it possible
to calculate the approximate remaining storage space available.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>storage <span class="token operator">&amp;&amp;</span> navigator<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>estimate<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> quota <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token function">estimate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// quota.usage -> Number of bytes used.</span><br>  <span class="token comment">// quota.quota -> Maximum number of bytes available.</span><br>  <span class="token keyword">const</span> percentageUsed <span class="token operator">=</span> <span class="token punctuation">(</span>quota<span class="token punctuation">.</span>usage <span class="token operator">/</span> quota<span class="token punctuation">.</span>quota<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You've used </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>percentageUsed<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">% of the available storage.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> remaining <span class="token operator">=</span> quota<span class="token punctuation">.</span>quota <span class="token operator">-</span> quota<span class="token punctuation">.</span>usage<span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You can write up to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>remaining<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> more bytes.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>The StorageManager isn't <a href="https://caniuse.com/#feat=mdn-api_storagemanager" rel="noopener">implemented</a> in all browsers yet, so you
must feature detect it before using it. Even when it is available, you must
still catch over-quota errors (see below). In some cases, it's possible for
the available quota to exceed the actual amount of storage available.</p>
<div class="w-aside w-aside--note">
<p>Other Chromium-based browsers may factor in the amount of free space when
reporting the available quota. Chrome does not, and will always report 60% of
the actual disk size. This helps to reduce the ability to determine the size
of stored cross origin resources.</p>
</div>
<h3 id="inspect">Inspect <a class="w-headline-link" href="#inspect">#</a></h3>
<p>During development, you can use your browser's DevTools to inspect the
different storage types, and easily clear all stored data.</p>
<p>A new feature was added in Chrome 88 that lets you override the site's storage
quota in the Storage Pane. This feature gives you the ability to simulate
different devices and test the behavior of your apps in low disk availability
scenarios. Go to <strong>Application</strong> then <strong>Storage</strong>, enable the
<strong>Simulate custom storage quota</strong> checkbox, and enter any valid number to
simulate the storage quota.</p>
<img     alt="DevTools Storage pane."          decoding="async"     height="567"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format"     srcset="https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/tYlbklNwF6DFKNV2cY0D.png?auto=format&w=1600 1600w"          width="800"   />
<p>While working on this article, I wrote a <a href="https://storage-quota.glitch.me/" rel="noopener">simple tool</a> to
attempt to quickly use as much storage as possible. It's a quick and easy way
to experiment with different storage mechanisms, and see what happens when
you use all of your quota.</p>
<h2 id="over-quota">How to handle going over quota? <a class="w-headline-link" href="#over-quota">#</a></h2>
<p>What should you do when you go over quota? Most importantly, you should
always catch and handle write errors, whether it's a <code>QuotaExceededError</code> or
something else. Then, depending on your app design, decide how to handle it.
For example delete content that hasn't been accessed in a long time, remove
data based on size, or provide a way for users to choose what they want to delete.</p>
<p>Both IndexedDB and the Cache API both throw a <code>DOMError</code> named
<code>QuotaExceededError</code> when you've exceeded the quota available.</p>
<h3 id="indexeddb">IndexedDB <a class="w-headline-link" href="#indexeddb">#</a></h3>
<p>If the origin has exceeded its quota, attempts to write to IndexedDB will
fail. The transaction's <code>onabort()</code> handler will be called, passing an event.
The event will include a <code>DOMException</code> in the error property. Checking the
error <code>name</code> will return <code>QuotaExceededError</code>.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> transaction <span class="token operator">=</span> idb<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'entries'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'readwrite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>transaction<span class="token punctuation">.</span><span class="token function-variable function">onabort</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> error <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>error<span class="token punctuation">;</span> <span class="token comment">// DOMException</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'QuotaExceededError'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Fallback code goes here</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><h3 id="cache-api">Cache API <a class="w-headline-link" href="#cache-api">#</a></h3>
<p>If the origin has exceeded its quota, attempts to write to the Cache API
will reject with a <code>QuotaExceededError</code> <code>DOMException</code>.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'my-cache'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">await</span> cache<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token string">'/sample1.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'QuotaExceededError'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Fallback code goes here</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h2 id="eviction">How does eviction work? <a class="w-headline-link" href="#eviction">#</a></h2>
<p>Web storage is categorized into two buckets, &quot;Best Effort&quot; and &quot;Persistent&quot;.
Best effort means the storage can be cleared by the browser without
interrupting the user, but is less durable for long-term or critical data.
Persistent storage is not automatically cleared when storage is low. The user
needs to manually clear this storage (via browser settings).</p>
<p>By default, a site's data (including IndexedDB, Cache API, etc) falls into
the best effort category, which means unless a site has
<a href="https://developers.google.com/web/updates/2016/06/persistent-storage" rel="noopener">requested persistent storage</a>, the browser may evict
site data at its discretion, for example, when device storage is low.</p>
<p>The eviction policy for best effort is:</p>
<ul>
<li>Chromium-based browsers will begin to evict data when the browser runs out
of space, clearing all site data from the least recently used origin first,
then the next, until the browser is no longer over the limit.</li>
<li>Internet Explorer 10+ will not evict data, but will prevent the origin from
writing any more.</li>
<li>Firefox will begin to evict data when the available disk space is filled up,
clearing all site data from the least recently used origin first, then the
next, until the browser is no longer over the limit.</li>
<li>Safari previously did not evict data, but recently implemented a new
seven-day cap on all writable storage (see below).</li>
</ul>
<p>Starting in iOS and iPadOS 13.4 and Safari 13.1 on macOS, there is a
seven-day cap on all script writable storage, including IndexedDB, service
worker registration, and the Cache API. This means Safari will evict all
content from the cache after seven days of Safari use if the user does not
interact with the site. This eviction policy <strong>does not apply to installed
PWAs</strong> that have been added to the home screen. See
<a href="https://webkit.org/blog/10218/full-third-party-cookie-blocking-and-more/" rel="noopener">Full Third-Party Cookie Blocking and More</a> on the WebKit
blog for complete details.</p>
<div class="w-aside w-aside--note">
<p>You can request <a href="/persistent-storage/">persistent storage</a> for your site to
protect critical user or application data.</p>
</div>
<h2 id="bonus:-why-use-a-wrapper-for-indexeddb">Bonus: Why use a wrapper for IndexedDB <a class="w-headline-link" href="#bonus:-why-use-a-wrapper-for-indexeddb">#</a></h2>
<p>IndexedDB is a low level API that requires significant setup before use,
which can be particularly painful for storing simple data.  Unlike most modern
promise-based APIs, it is event based. Promise wrappers like
<a href="https://www.npmjs.com/package/idb" rel="noopener">idb</a> for IndexedDB hide some of the powerful features but more
importantly, hide the complex machinery (e.g. transactions, schema versioning)
that comes with the IndexedDB library.</p>
<h2 id="conclusion">Conclusion <a class="w-headline-link" href="#conclusion">#</a></h2>
<p>Gone are the days of limited storage and prompting the user to store more and
more data. Sites can store effectively all of the resources and data they
need to run. Using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/StorageManager/estimate" rel="noopener">StorageManager API</a> you can
determine how much is available to you, and how much you've used. And with
<a href="https://developers.google.com/web/updates/2016/06/persistent-storage" rel="noopener">persistent storage</a>, unless the user removes it, you
can protect it from eviction.</p>
<h3 id="additional-resources">Additional resources <a class="w-headline-link" href="#additional-resources">#</a></h3>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/instant-and-offline/web-storage/indexeddb-best-practices" rel="noopener">IndexedDB Best Practices</a></li>
<li><a href="https://docs.google.com/document/d/19QemRTdIxYaJ4gkHYf2WWBNPbpuZQDNMpUVf8dQxj4U/preview" rel="noopener">Chrome Web Storage and Quota Concepts</a></li>
</ul>
<h3 id="thanks">Thanks <a class="w-headline-link" href="#thanks">#</a></h3>
<p>Special thanks to Jarryd Goodman, Phil Walton, Eiji Kitamura, Daniel Murphy,
Darwin Huang, Josh Bell, Marijn Kruisselbrink, and Victor Costan for reviewing
this article. Thanks to Eiji Kitamura, Addy Osmani, and Marc Cohen who wrote
the original articles that this is based on. Eiji wrote a helpful tool
called <a href="http://demo.agektmr.com/storage/" rel="noopener">Browser Storage Abuser</a> that was useful in validating
current behavior. It allows you to store as much data as possible and see the
storage limits on your browser. Thanks to Francois Beaufort who did the digging
into Safari to figure out its storage limits.</p>
<p>The hero image is by Guillaume Bolduc on
<a href="https://unsplash.com/photos/uBe2mknURG4" rel="noopener">Unsplash</a>.</p>


    

    
  <div class="w-chips ">
    
      
    
      
    
      
        
        <a class="w-chip" href="/tags/progressive-web-apps/">Progressive Web Apps</a>
      
    
      
        
        <a class="w-chip" href="/tags/storage/">Storage</a>
      
    
      
    
      
    
      
        
        <a class="w-chip" href="/tags/memory/">Memory</a>
      
    
  </div>


    <div class="w-post-github-link w-mt--l w-mb--l">
      <span class="w-mr--sm">
        
        Last updated: <time>Feb 11, 2021</time>
        
      </span>
      <a
        href="https://github.com/GoogleChrome/web.dev/blob/master/src/site/content/en/blog/storage-for-the-web/index.md"
      >
        Improve article
      </a>
       
    </div>

    
    <web-feedback additional-questions="api"></web-feedback>
  </div>

  
    
    <nav class="w-article-navigation">
  <a
    class="w-article-navigation__link w-article-navigation__link--back
      w-article-navigation__link--single gc-analytics-event"
    data-category="web.dev"
    data-label="navigation, go back"
    data-action="click"
    href="/blog"
  >
    Return to all articles
  </a>
</nav>
  
</div>

  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://devwebfeed.appspot.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">
              DevWeb Content Firehose
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/@ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/home"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
