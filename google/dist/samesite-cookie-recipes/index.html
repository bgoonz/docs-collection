
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=0080e63ee28fd">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>SameSite cookie recipes</title>
<meta name="description" content="With the introduction of the new SameSite=None attribute value, sites can now explicitly mark their cookies for cross-site usage. Browsers are moving to make cookies without a SameSite attribute act as first-party by default, a safer and more privacy preserving option than the current open behavior. Learn how to mark up your cookies to ensure your first-party and third-party cookies continue to work once this change comes into effect. " />

<link rel="canonical" href="https://web.dev/samesite-cookie-recipes/" />

<meta itemprop="name" content="SameSite cookie recipes" />
<meta itemprop="description" content="With the introduction of the new SameSite=None attribute value, sites can now explicitly mark their cookies for cross-site usage. Browsers are moving to make cookies without a SameSite attribute act as first-party by default, a safer and more privacy preserving option than the current open behavior. Learn how to mark up your cookies to ensure your first-party and third-party cookies continue to work once this change comes into effect. " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/samesite-cookie-recipes/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="SameSite cookie recipes" />
<meta property="og:description" content="With the introduction of the new SameSite=None attribute value, sites can now explicitly mark their cookies for cross-site usage. Browsers are moving to make cookies without a SameSite attribute act as first-party by default, a safer and more privacy preserving option than the current open behavior. Learn how to mark up your cookies to ensure your first-party and third-party cookies continue to work once this change comes into effect. " />
<meta property="og:image" content="https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="" />
<meta property="tag" content="security" />
<meta property="tag" content="cookies" />
<meta property="tag" content="chrome80" />
<meta property="tag" content="test-post" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="SameSite cookie recipes" />
<meta name="twitter:description" content="With the introduction of the new SameSite=None attribute value, sites can now explicitly mark their cookies for cross-site usage. Browsers are moving to make cookies without a SameSite attribute act as first-party by default, a safer and more privacy preserving option than the current open behavior. Learn how to mark up your cookies to ensure your first-party and third-party cookies continue to work once this change comes into effect. " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>








<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=3b141c44447dc', 'module');




  loadScript('/js/content.js?v=66c532baa3aa', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="30" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
      
    
    


<div class="guide-landing-page">
  
  

  
    <img     alt="Hero Image"     class="w-hero w-hero--cover"     decoding="auto"     height="480"               sizes="100vw"     src="https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/V0dgwWTA61NTc55CAhSD.jpg?auto=format&w=1600 1600w"          width="1600"   />
  

  <web-table-of-contents>
    <h2 class="w-toc__header">
      <a href="#samesite-cookie-recipes" class="w-toc__header--link">
        SameSite cookie recipes
      </a>
    </h2>
    <div class="w-toc__list">
        <ul><li><a href="#cross-browser-support">Cross-browser support</a></li><li><a href="#use-cases-for-cross-site-or-third-party-cookies">Use cases for cross-site or third-party cookies</a></li><li><a href="#content-within-an-lessiframegreater">Content within an &lt;iframe&gt;</a></li><li><a href="#"unsafe"-requests-across-sites">&quot;Unsafe&quot; requests across sites</a></li><li><a href="#remote-resources">Remote resources</a></li><li><a href="#content-within-a-webview">Content within a WebView</a></li><li><a href="#how-to-implement-samesite-today">How to implement SameSite today</a></li><li><a href="#handling-incompatible-clients">Handling incompatible clients</a></li><li><a href="#support-for-samesitenone-in-languages-libraries-and-frameworks">Support for SameSite=None in languages, libraries, and frameworks</a></li><li><a href="#getting-help">Getting help</a></li></ul></div>
  </web-table-of-contents>
  <web-table-of-contents-button></web-table-of-contents-button>

  
  <div class="w-actions">
    <share-action authors="@rowan_m"
      class="gc-analytics-event w-actions__fab w-actions__fab--share"
      data-category="web.dev"
      data-label="share"
      data-action="click"
      data-icon="share"
      tabindex="0"
      role="button"
    >
      <span>Share</span>
    </share-action>
    <a class="w-actions__fab w-actions__fab--subscribe gc-analytics-event" data-category="web.dev" data-label="view-subscribe" data-action="click" href="/newsletter/">
  <span>subscribe</span>
</a>

  </div>

  <div class="w-layout-container--narrow w-post-content">
    <header class="w-article-header">
      
        <div class="w-post-breadcrumbs">
          <ul class="w-breadcrumbs">
  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link w-breadcrumbs__link--left-justify gc-analytics-event"
      data-category="web.dev"
      data-label="post, home breadcrumb"
      data-action="click"
      href="/"
    >
      Home
    </a>
  </li>

  <svg
    class="w-breadcrumbs__icon"
    xmlns="http://www.w3.org/2000/svg"
    height="24"
    viewBox="0 0 24 24"
    width="24"
    aria-hidden="true"
  >
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z" />
  </svg>

  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link gc-analytics-event"
      data-category="web.dev"
      data-label="post, path breadcrumb"
      data-action="click"
      href=/blog
    >
      All articles
    </a>
  </li>
</ul>
        </div>
      

      <h1 id="samesite-cookie-recipes" class="w-article-header__headline">SameSite cookie recipes</h1>
      
        <p class="w-article-header__subhead w-mb--non">
          Update your site's cookies to prepare for the upcoming changes to the SameSite attribute's behavior.
        </p>
      

      
        <div class="w-author__published">
          <time>Oct 30, 2019</time>
           <span class="w-author__separator">â€¢</span> Updated <time>May 28, 2020</time> 
        </div>
      
      <div class="w-layout-container--narrow w-post-signpost">
  <span class="w-post-signpost__title">Appears in:</span>
  <a
          class="w-post-signpost__link"
          href="/secure"
          >Safe and secure</a
        >
</div>

      
        <div class="w-authors w-mt--xl w-pt--sm">
          
            <div class="w-author">
  <a href="/authors/rowan_m/"><img     alt="Rowan Merewood"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/rowan_m/">Rowan Merewood</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/rowan_m"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/rowan-m">GitHub</a>
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://glitch.com/@rowan-m"
          >Glitch</a
        >
      </li>
      
    </ul>
  </div>
</div>
          
        </div>
      
    </header>

    

    <div class="w-aside w-aside--note">
<p>This article is part of a series on the <code>SameSite</code> cookie attribute changes:</p>
<ul>
<li><a href="/samesite-cookies-explained/">SameSite cookies explained</a></li>
<li><a href="/samesite-cookie-recipes/">SameSite cookies recipes</a></li>
<li><a href="/schemeful-samesite">Schemeful Same-Site</a></li>
</ul>
</div>
<p><a href="https://www.chromium.org/updates/same-site" rel="noopener">Chrome</a>,
<a href="https://groups.google.com/d/msg/mozilla.dev.platform/nx2uP0CzA9k/BNVPWDHsAQAJ" rel="noopener">Firefox</a>,
<a href="https://groups.google.com/a/chromium.org/d/msg/blink-dev/AknSSyQTGYs/8lMmI5DwEAAJ" rel="noopener">Edge</a>,
and others will be changing their default behavior in line with the IETF
proposal,
<a href="https://tools.ietf.org/html/draft-west-cookie-incrementalism-00" rel="noopener">Incrementally Better Cookies</a>
so that:</p>
<ul>
<li>Cookies without a <code>SameSite</code> attribute will be treated as <code>SameSite=Lax</code>,
meaning the default behavior will be to restrict cookies to first party
contexts <strong>only</strong>.</li>
<li>Cookies for cross-site usage <strong>must</strong> specify <code>SameSite=None; Secure</code> to
enable inclusion in third party context.</li>
</ul>
<p>This feature is the <a href="https://blog.chromium.org/2020/05/resuming-samesite-cookie-changes-in-july.html" rel="noopener">default behavior from Chrome 84 stable
onward</a>.
If you have not already done so, you should update the attributes for your
third-party cookies so they will not be blocked in the future.</p>
<h2 id="cross-browser-support">Cross-browser support <a class="w-headline-link" href="#cross-browser-support">#</a></h2>
<p>See the
<a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie#Browser_compatibility" rel="noopener">Browser compatibility</a>
section of MDN's <a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie" rel="noopener"><code>Set-Cookie</code></a>
page.</p>
<h2 id="use-cases-for-cross-site-or-third-party-cookies">Use cases for cross-site or third-party cookies <a class="w-headline-link" href="#use-cases-for-cross-site-or-third-party-cookies">#</a></h2>
<p>There are a number of common use cases and patterns where cookies need to be
sent in a third-party context. If you provide or depend on one of these use
cases, ensure that either you or the provider are updating their cookies to
ensure the service continues to function correctly.</p>
<h3 id="content-within-an-lessiframegreater">Content within an <code>&lt;iframe&gt;</code> <a class="w-headline-link" href="#content-within-an-lessiframegreater">#</a></h3>
<p>Content from a different site displayed in an <code>&lt;iframe&gt;</code> is in a third-party
context. Standard use cases here are:</p>
<ul>
<li>Embedded content shared from other sites, such as videos, maps, code samples,
and social posts.</li>
<li>Widgets from external services such as payments, calendars, booking, and
reservation functionality.</li>
<li>Widgets such as social buttons or anti-fraud services that create less obvious
<code>&lt;iframes&gt;</code>.</li>
</ul>
<p>Cookies may be used here to, among other things, maintain session state, store
general preferences, enable statistics, or personalize content for users with
existing accounts.</p>
<figure class="w-figure">
  <img     alt="Diagram of a browser window where the URL of embedded content does not match the URL of the page."          decoding="async"     height="383"          loading="lazy"     sizes="(min-width: 468px) 468px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format"     srcset="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/fTUQP4SffHHcexSipvlz.png?auto=format&w=936 936w"     style="max-width: 35vw;"     width="468"   />
  <figcaption class="w-figcaption">
    If the embedded content doesn't come from the same site as the top-level
    browsing context, it's third-party content.
  </figcaption>
</figure>
<p>Additionally, as the web is inherently composable, <code>&lt;iframes&gt;</code> are used to embed
content that is also viewed in a top-level or first-party context. Any cookies
used by that site will be considered as third-party cookies when the site is
displayed within the frame. If you're creating sites that you intend to be
easily embedded by others while also relying on cookies to function, you will
also need to ensure those are marked for cross-site usage or that you can
gracefully fallback without them.</p>
<h3 id="&quot;unsafe&quot;-requests-across-sites">&quot;Unsafe&quot; requests across sites <a class="w-headline-link" href="#&quot;unsafe&quot;-requests-across-sites">#</a></h3>
<p>While &quot;unsafe&quot; may sound slightly concerning here, this refers to any request
that may be intended to change state. On the web that's primarily POST requests.
Cookies marked as <code>SameSite=Lax</code> will be sent on safe top-level navigations,
e.g. clicking a link to go to a different site. However something like a
<code>&lt;form&gt;</code> submission via POST to a different site would not include cookies.</p>
<figure class="w-figure">
  <img     alt="Diagram of a request moving from one page to another."          decoding="async"     height="382"          loading="lazy"     sizes="(min-width: 719px) 719px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format"     srcset="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vddDg7f9Gp93OgaqWwHu.png?auto=format&w=1438 1438w"     style="max-width: 35vw;"     width="719"   />
  <figcaption class="w-figcaption">
    If the incoming request uses a "safe" method then the cookies will be sent.
  </figcaption>
</figure>
<p>This pattern is used for sites that may redirect the user out to a remote
service to perform some operation before returning, for example redirecting to a
third-party identity provider. Before the user leaves the site, a cookie is set
containing a single use token with the expectation that this token can be
checked on the returning request to mitigate
<a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" rel="noopener">Cross Site Request Forgery (CSRF)</a>
attacks. If that returning request comes via POST then it will be necessary to
mark the cookies as <code>SameSite=None; Secure</code>.</p>
<h3 id="remote-resources">Remote resources <a class="w-headline-link" href="#remote-resources">#</a></h3>
<p>Any remote resource on a page may be relying on cookies to be sent with a
request, from <code>&lt;img&gt;</code> tags, <code>&lt;script&gt;</code> tags, and so on. Common use cases include
tracking pixels and personalizing content.</p>
<p>This also applies to requests initiated from your JavaScript by <code>fetch</code> or
<code>XMLHttpRequest</code>. If <code>fetch()</code> is called with the
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch#Sending_a_request_with_credentials_included" rel="noopener"><code>credentials: 'include'</code> option</a>
this is a good indication that cookies may well be expected on those requests.
For <code>XMLHttpRequest</code> you should look for instances of the
<a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials" rel="noopener"><code>withCredentials</code> property</a>
being set to <code>true</code>. This is a good indication that cookies may well be expected
on those requests. Those cookies will need to be appropriately marked to be
included in cross-site requests.</p>
<h3 id="content-within-a-webview">Content within a WebView <a class="w-headline-link" href="#content-within-a-webview">#</a></h3>
<p>A WebView in a platform-specific app is powered by a browser and you will need to test if
the same restrictions or issues apply. In Android, if the WebView is powered by
Chrome the new defaults <strong>will not</strong> immediately be applied with Chrome 84.
However the intent is to apply them in the future, so you should still test and
prepare for this. Additionally, Android allows its platform-specific apps to set cookies
directly via the
<a href="https://developer.android.com/reference/android/webkit/CookieManager" rel="noopener">CookieManager API</a>.
As with cookies set via headers or JavaScript, consider including
<code>SameSite=None; Secure</code> if they are intended for cross-site use.</p>
<h2 id="how-to-implement-samesite-today">How to implement <code>SameSite</code> today <a class="w-headline-link" href="#how-to-implement-samesite-today">#</a></h2>
<p>For cookies where they are only needed in a first-party context you should
ideally mark them as <code>SameSite=Lax</code> or <code>SameSite=Strict</code> depending on your
needs. You can also choose to do nothing and just allow the browser to enforce
its default, but this comes with the risk of inconsistent behavior across
browsers and potential console warnings for each cookie.</p>
<web-copy-code><pre class="language-text"><code class="language-text">Set-Cookie: first_party_var=value; SameSite=Lax</code></pre>
</web-copy-code><p>For cookies needed in a third-party context, you will need to ensure they are
marked as <code>SameSite=None; Secure</code>. Note that you need both attributes together.
If you just specify <code>None</code> without <code>Secure</code> the cookie will be rejected. There
are some mutually incompatible differences in browser implementations though, so
you may need to use some of the mitigating strategies described in
<a href="#handling-incompatible-clients">Handling incompatible clients</a> below.</p>
<web-copy-code><pre class="language-text"><code class="language-text">Set-Cookie: third_party_var=value; SameSite=None; Secure</code></pre>
</web-copy-code><h3 id="handling-incompatible-clients">Handling incompatible clients <a class="w-headline-link" href="#handling-incompatible-clients">#</a></h3>
<p>As these changes to include <code>None</code> and update default behavior are still
relatively new, there are inconsistencies amongst browsers as to how these
changes are handled. You can refer to the
<a href="https://www.chromium.org/updates/same-site/incompatible-clients" rel="noopener">updates page on chromium.org</a>
for the issues currently known, however it's not possible to say if this is
exhaustive. While this is not ideal, there are workarounds you can employ during
this transitionary phase. The general rule though is to treat incompatible
clients as the special case. Do not create an exception for browsers
implementing the newer rules.</p>
<p>The first option is to set both the new and old style cookies:</p>
<web-copy-code><pre class="language-text"><code class="language-text">Set-cookie: 3pcookie=value; SameSite=None; Secure<br>Set-cookie: 3pcookie-legacy=value; Secure</code></pre>
</web-copy-code><p>Browsers implementing the newer behavior will set the cookie with the <code>SameSite</code>
value, while other browsers may ignore or incorrectly set it. However, those
same browsers will set the <code>3pcookie-legacy</code> cookie. When processing included
cookies, the site should first check for the presence of the new style cookie
and if it's not found, then fallback to the legacy cookie.</p>
<p>The example below shows how to do this in Node.js, making use of the
<a href="https://expressjs.com" rel="noopener">Express framework</a> and its
<a href="https://www.npmjs.com/package/cookie-parser" rel="noopener">cookie-parser</a> middleware.</p>
<web-copy-code><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> cp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cookie-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/set'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">// Set the new style cookie</span><br>  res<span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">'3pcookie'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> sameSite<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span> secure<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// And set the same value in the legacy cookie</span><br>  res<span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">'3pcookie-legacy'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> secure<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">let</span> cookieVal <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span><span class="token string">'3pcookie'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// check the new style cookie first</span><br>    cookieVal <span class="token operator">=</span> req<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span><span class="token string">'3pcookie'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span><span class="token string">'3pcookie-legacy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// otherwise fall back to the legacy cookie</span><br>    cookieVal <span class="token operator">=</span> req<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span><span class="token string">'3pcookie-legacy'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>The downside is that this involves setting redundant cookies to cover all
browsers and requires making changes both at the point of setting and reading
the cookie. However, this approach should cover all browsers regardless of their
behavior and ensure third-party cookies continue to function as before.</p>
<p>Alternatively at the point of sending the <code>Set-Cookie</code> header, you can choose to
detect the client via the user agent string. Refer to the
<a href="https://www.chromium.org/updates/same-site/incompatible-clients" rel="noopener">list of incompatible clients</a>
and then make use of an appropriate library for your platform, for example
<a href="https://www.npmjs.com/package/ua-parser-js" rel="noopener">ua-parser-js</a> library on Node.js.
It's advisable to find a library to handle user agent detection as you most
probably don't want to write those regular expressions yourself.</p>
<p>The benefit of this approach is that it only requires making one change at the
point of setting the cookie. However, the necessary warning here is that user
agent sniffing is inherently fragile and may not catch all of the affected
users.</p>
<div class="w-aside w-aside--note">
<p>Regardless of what option you choose, it's advisable to ensure you have a way of
logging the levels of traffic that are going through the legacy route. Make sure
you have a reminder or alert to remove this workaround once those levels drop
below an acceptable threshold for your site.</p>
</div>
<h2 id="support-for-samesitenone-in-languages-libraries-and-frameworks">Support for <code>SameSite=None</code> in languages, libraries, and frameworks <a class="w-headline-link" href="#support-for-samesitenone-in-languages-libraries-and-frameworks">#</a></h2>
<p>The majority of languages and libraries support the <code>SameSite</code> attribute for
cookies, however the addition of <code>SameSite=None</code> is still relatively new which
means that you may need to work around some of the standard behavior for now.
These are documented in the
<a href="https://github.com/GoogleChromeLabs/samesite-examples" rel="noopener"><code>SameSite</code> examples repo on GitHub</a>.</p>
<h2 id="getting-help">Getting help <a class="w-headline-link" href="#getting-help">#</a></h2>
<p>Cookies are all over the place and it's rare for any site to have completely
audited where they're set and used, especially once you throw cross-site use
cases in the mix. When you encounter an issue, it may well be the first time
anyone has encountered it - so don't hesitate to reach out:</p>
<ul>
<li>Raise an issue on the
<a href="https://github.com/GoogleChromeLabs/samesite-examples" rel="noopener"><code>SameSite</code> examples repo on GitHub</a>.</li>
<li>blog a question on the
<a href="https://stackoverflow.com/questions/tagged/samesite" rel="noopener">&quot;samesite&quot; tag on StackOverflow</a>.</li>
<li>For issues with Chromium's behavior, raise a bug via the
<a href="https://bit.ly/2lJMd5c" rel="noopener">[SameSite cookies] issue template</a>.</li>
<li>Follow Chrome's progress on the
<a href="https://www.chromium.org/updates/same-site" rel="noopener"><code>SameSite</code> updates page</a>.</li>
</ul>
<p><em>Cookie hero image by
<a href="https://unsplash.com/@calya1?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener">Cayla1</a>
on
<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener">Unsplash</a></em></p>


    

    
  <div class="w-chips ">
    
      
    
      
    
      
        
        <a class="w-chip" href="/tags/security/">Security</a>
      
    
      
        
        <a class="w-chip" href="/tags/cookies/">Cookies</a>
      
    
      
    
      
    
  </div>


    <div class="w-post-github-link w-mt--l w-mb--l">
      <span class="w-mr--sm">
        
        Last updated: <time>May 28, 2020</time>
        
      </span>
      <a
        href="https://github.com/GoogleChrome/web.dev/blob/master/src/site/content/en/blog/samesite-cookie-recipes/index.md"
      >
        Improve article
      </a>
       
    </div>

    
    <web-feedback additional-questions="api"></web-feedback>
  </div>

  
    
    <nav class="w-article-navigation">
  <a
    class="w-article-navigation__link w-article-navigation__link--back
      w-article-navigation__link--single gc-analytics-event"
    data-category="web.dev"
    data-label="navigation, go back"
    data-action="click"
    href="/blog"
  >
    Return to all articles
  </a>
</nav>
  
</div>

  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://devwebfeed.appspot.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">
              DevWeb Content Firehose
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/@ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/home"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
