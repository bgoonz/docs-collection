
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=fc36351e89aaa">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Referer and Referrer-Policy best practices</title>
<meta name="description" content="Consider setting a referrer policy of strict-origin-when-cross-origin. It retains much of the referrer's usefulness, while mitigating the risk of leaking data cross-origins. " />

<link rel="canonical" href="https://web.dev/referrer-best-practices/" />

<meta itemprop="name" content="Referer and Referrer-Policy best practices" />
<meta itemprop="description" content="Consider setting a referrer policy of strict-origin-when-cross-origin. It retains much of the referrer's usefulness, while mitigating the risk of leaking data cross-origins. " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/referrer-best-practices/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Referer and Referrer-Policy best practices" />
<meta property="og:description" content="Consider setting a referrer policy of strict-origin-when-cross-origin. It retains much of the referrer's usefulness, while mitigating the risk of leaking data cross-origins. " />
<meta property="og:image" content="https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="" />
<meta property="tag" content="security" />
<meta property="tag" content="privacy" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Referer and Referrer-Policy best practices" />
<meta name="twitter:description" content="Consider setting a referrer policy of strict-origin-when-cross-origin. It retains much of the referrer's usefulness, while mitigating the risk of leaking data cross-origins. " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>








<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=cc4a03d1813c', 'module');




  loadScript('/js/content.js?v=8633556c9ef75', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="30" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
      
    
    


<div class="guide-landing-page">
  
  

  
    <img     alt="Hero Image"     class="w-hero w-hero--cover"     decoding="auto"     height="480"               sizes="100vw"     src="https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/kh2IMJFSJ3Cj6Zo8jEv5.jpg?auto=format&w=1600 1600w"          width="1600"   />
  

  <web-table-of-contents>
    <h2 class="w-toc__header">
      <a href="#referer-and-referrer-policy-best-practices" class="w-toc__header--link">
        Referer and Referrer-Policy best practices
      </a>
    </h2>
    <div class="w-toc__list">
        <ul><li><a href="#summary">Summary</a></li><li><a href="#referer-and-referrer-policy-101">Referer and Referrer-Policy 101</a></li><li><a href="#what-policies-are-available-and-how-do-they-differ">What policies are available and how do they differ?</a></li><li><a href="#default-referrer-policies-in-browsers">Default referrer policies in browsers</a></li><li><a href="#setting-your-referrer-policy:-best-practices">Setting your referrer policy: best practices</a></li><li><a href="#how-to-see-the-referrer-policy">How to see the referrer policy?</a></li><li><a href="#which-policy-should-you-set-for-your-website">Which policy should you set for your website?</a></li><li><a href="#why-"explicitly"">Why &quot;explicitly&quot;?</a></li><li><a href="#why-strict-origin-when-cross-origin-(or-stricter)">Why strict-origin-when-cross-origin (or stricter)?</a></li><li><a href="#what-if-strict-origin-when-cross-origin-(or-stricter)-doesn't-accommodate-all-your-use-cases">What if strict-origin-when-cross-origin (or stricter) doesn't accommodate all your use cases?</a></li><li><a href="#example:-element-level-policy">Example: element-level policy</a></li><li><a href="#example:-request-level-policy">Example: request-level policy</a></li><li><a href="#what-else-should-you-consider">What else should you consider?</a></li><li><a href="#using-the-referrer-from-incoming-requests:-best-practices">Using the referrer from incoming requests: best practices</a></li><li><a href="#what-to-do-if-your-site's-functionality-uses-the-referrer-url-of-incoming-requests">What to do if your site's functionality uses the referrer URL of incoming requests?</a></li><li><a href="#cross-site-request-forgery-(csrf)-protection">Cross-Site Request Forgery (CSRF) protection</a></li><li><a href="#logging">Logging</a></li><li><a href="#payments">Payments</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#resources">Resources</a></li></ul></div>
  </web-table-of-contents>
  <web-table-of-contents-button></web-table-of-contents-button>

  
  <div class="w-actions">
    <share-action authors="@maudnals"
      class="gc-analytics-event w-actions__fab w-actions__fab--share"
      data-category="web.dev"
      data-label="share"
      data-action="click"
      data-icon="share"
      tabindex="0"
      role="button"
    >
      <span>Share</span>
    </share-action>
    <a class="w-actions__fab w-actions__fab--subscribe gc-analytics-event" data-category="web.dev" data-label="view-subscribe" data-action="click" href="/newsletter/">
  <span>subscribe</span>
</a>

  </div>

  <div class="w-layout-container--narrow w-post-content">
    <header class="w-article-header">
      
        <div class="w-post-breadcrumbs">
          <ul class="w-breadcrumbs">
  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link w-breadcrumbs__link--left-justify gc-analytics-event"
      data-category="web.dev"
      data-label="post, home breadcrumb"
      data-action="click"
      href="/"
    >
      Home
    </a>
  </li>

  <svg
    class="w-breadcrumbs__icon"
    xmlns="http://www.w3.org/2000/svg"
    height="24"
    viewBox="0 0 24 24"
    width="24"
    aria-hidden="true"
  >
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z" />
  </svg>

  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link gc-analytics-event"
      data-category="web.dev"
      data-label="post, path breadcrumb"
      data-action="click"
      href=/blog
    >
      All articles
    </a>
  </li>
</ul>
        </div>
      

      <h1 id="referer-and-referrer-policy-best-practices" class="w-article-header__headline">Referer and Referrer-Policy best practices</h1>
      
        <p class="w-article-header__subhead w-mb--non">
          Best practices to set your Referrer-Policy and use the referrer in incoming requests.
        </p>
      

      
        <div class="w-author__published">
          <time>Jul 30, 2020</time>
           <span class="w-author__separator">•</span> Updated <time>Sep 23, 2020</time> 
        </div>
      
      <div class="w-layout-container--narrow w-post-signpost">
  <span class="w-post-signpost__title">Appears in:</span>
  <a
          class="w-post-signpost__link"
          href="/secure"
          >Safe and secure</a
        >
</div>

      
        <div class="w-authors w-mt--xl w-pt--sm">
          
            <div class="w-author">
  <a href="/authors/maudn/"><img     alt="Maud Nalpas"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/F620GZorjY0JjKas3p3J.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/F620GZorjY0JjKas3p3J.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/F620GZorjY0JjKas3p3J.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/F620GZorjY0JjKas3p3J.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/F620GZorjY0JjKas3p3J.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/F620GZorjY0JjKas3p3J.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/maudn/">Maud Nalpas</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/maudnals"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/maudnals">GitHub</a>
      </li>
      
      
    </ul>
  </div>
</div>
          
        </div>
      
    </header>

    

    <h2 id="summary">Summary <a class="w-headline-link" href="#summary">#</a></h2>
<ul>
<li>Unexpected cross-origin information leakage hinders web users' privacy. A protective referrer
policy can help.</li>
<li>Consider setting a referrer policy of <code>strict-origin-when-cross-origin</code>. It retains much of the
referrer's usefulness, while mitigating the risk of leaking data cross-origins.</li>
<li>Don't use referrers for Cross-Site Request Forgery (CSRF) protection. Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html#token-based-mitigation" rel="noopener">CSRF
tokens</a>
instead, and other headers as an extra layer of security.</li>
</ul>
<div class="w-aside w-aside--note">
<p>Before we start:</p>
<ul>
<li>If you're unsure of the difference between &quot;site&quot; and &quot;origin&quot;, check out <a href="/same-site-same-origin/">Understanding
&quot;same-site&quot; and &quot;same-origin&quot;</a>.</li>
<li>The <code>Referer</code> header is missing an R, due to an original misspelling in the spec. The
<code>Referrer-Policy</code> header and <code>referrer</code> in JavaScript and the DOM are spelled correctly. </div></li>
</ul>
<h2 id="referer-and-referrer-policy-101">Referer and Referrer-Policy 101 <a class="w-headline-link" href="#referer-and-referrer-policy-101">#</a></h2>
<p>HTTP requests may include the optional <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer" rel="noopener"><code>Referer</code>
header</a>, which indicates the
origin or web page URL the request was made from. The <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy" rel="noopener"><code>Referrer-Policy</code>
header</a> defines what data
is made available in the <code>Referer</code> header.</p>
<p>In the example below, the <code>Referer</code> header includes the complete URL of the page on <code>site-one</code> from
which the request was made.</p>
<figure class="w-figure">
  <img     alt="HTTP request including a Referer header."          decoding="async"     height="573"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/cXgqJfmD5OPdzqXl9RNt.jpg?auto=format&w=1600 1600w"          width="800"   />
</figure>
<p>The <code>Referer</code> header might be present in different types of requests:</p>
<ul>
<li>Navigation requests, when a user clicks a link</li>
<li>Subresource requests, when a browser requests images, iframes, scripts, and other resources that a
page needs.</li>
</ul>
<p>For navigations and iframes, this data can also be accessed via JavaScript using
<code>document.referrer</code>.</p>
<p>The <code>Referer</code> value can be insightful. For example, an analytics service might use the value to
determine that 50% of the visitors on <code>site-two.example</code> came from <code>social-network.example</code>.</p>
<p>But when the full URL including the path and query string is sent in the <code>Referer</code> <strong>across
origins</strong>, this can be <strong>privacy-hindering</strong> and pose <strong>security risks</strong> as well. Take a look at
these URLs:</p>
<figure class="w-figure">
  <img     alt="URLs with paths, mapped to different privacy and security risks."          decoding="async"     height="370"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/oTUtfrwaGYYjlOJ6KRs6.jpg?auto=format&w=1600 1600w"          width="800"   />
</figure>
<p>URLs #1 to #5 contain private information—sometimes even identifying or sensitive. Leaking these
silently across origins can compromise web users' privacy.</p>
<p>URL #6 is a <a href="https://www.w3.org/TR/capability-urls/" rel="noopener">capability URL</a>. You don't want it to fall in
the hands of anyone other than the intended user. If this were to happen, a malicious actor could
hijack this user's account.</p>
<p><strong>In order to restrict what referrer data is made available for requests from your site, you can set
a referrer policy.</strong></p>
<h2 id="what-policies-are-available-and-how-do-they-differ">What policies are available and how do they differ? <a class="w-headline-link" href="#what-policies-are-available-and-how-do-they-differ">#</a></h2>
<p>You can select one of eight policies. Depending on the policy, the data available from the <code>Referer</code>
header (and <code>document.referrer</code>) can be:</p>
<ul>
<li>No data (no <code>Referer</code> header is present)</li>
<li>Only the <a href="/same-site-same-origin/#origin">origin</a></li>
<li>The full URL: origin, path, and query string</li>
</ul>
<figure class="w-figure">
  <img     alt="Data that can be contained in the Referer header and document.referrer."          decoding="async"     height="255"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/UR1U0HRP0BOF1e0XnyWA.jpg?auto=format&w=1600 1600w"          width="800"   />
</figure>
<p>Some policies are designed to behave differently depending on the <strong>context</strong>: cross-origin or
same-origin request, security (whether the request destination is as secure as the origin), or both.
This is useful to limit the amount of information shared across origins or to less secure
origins—while maintaining the richness of the referrer within your own site.</p>
<p>Here is an overview showing how referrer policies restrict the URL data available from the Referer
header and <code>document.referrer</code>:</p>
<figure class="w-figure">
  <img     alt="Different referrer policies and their behaviour, depending on the security and cross-origin context."          decoding="async"     height="537"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/BIHWDY60CI317O7IzmQs.jpg?auto=format&w=1600 1600w"          width="800"   />
</figure>
<p>MDN provides a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy#Directives" rel="noopener">full list of policies and behavior
examples</a>.</p>
<p>Things to note:</p>
<ul>
<li>All policies that take the scheme (HTTPS vs. HTTP) into account (<code>strict-origin</code>,
<code>no-referrer-when-downgrade</code> and <code>strict-origin-when-cross-origin</code>) treat requests from an HTTP
origin to another HTTP origin the same way as requests from an HTTPS origin to another HTTPS
origin—even if HTTP is less secure. That's because for these policies, what matters is whether a
security <strong>downgrade</strong> takes place, i.e. if the request can expose data from an encrypted origin
to an unencrypted one. An HTTP → HTTP request is unencrypted all along, so there is no downgrade.
HTTPS → HTTP requests, on the contrary, present a downgrade.</li>
<li>If a request is <strong>same-origin</strong>, this means that the scheme (HTTPS or HTTP) is the same; hence
there is no security downgrade.</li>
</ul>
<h2 id="default-referrer-policies-in-browsers">Default referrer policies in browsers <a class="w-headline-link" href="#default-referrer-policies-in-browsers">#</a></h2>
<p><em>As of July 2020</em></p>
<p><strong>If no referrer policy is set, the browser's default policy will be used.</strong></p>
<div class="w-table-wrapper">
  <table>
    <thead>
      <tr>
        <th>Browser</th>
        <th>Default <code>Referrer-Policy</code> / Behavior</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Chrome</td>
        <td>
          Planning to switch to <code>strict-origin-when-cross-origin</code> in <a href="https://developers.google.com/web/updates/2020/07/referrer-policy-new-chrome-default">version 85</a> (previously <code>no-referrer-when-downgrade</code>)
        </td>
      </tr>
      <tr>
        <td>Firefox</td>
        <td>
          <ul>
            <li><code>strict-origin-when-cross-origin</code> (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1589074">see closed bug</a>)</li>
            <li><code>strict-origin-when-cross-origin</code> in Private Browsing and for trackers</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>Edge</td>
        <td>
          <ul>
            <li><code>no-referrer-when-downgrade</code></li>
            <li><a href="https://github.com/privacycg/proposals/issues/13">Experimenting</a> with <code>strict-origin-when-cross-origin</code>
            </li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>Safari</td>
        <td>
          Similar to <code>strict-origin-when-cross-origin</code>. See
          <a href="https://webkit.org/blog/9661/preventing-tracking-prevention-tracking/">Preventing Tracking Prevention Tracking</a> for details.
        </td>
      </tr>
    </tbody>
  </table>
</div>
<h2 id="setting-your-referrer-policy:-best-practices">Setting your referrer policy: best practices <a class="w-headline-link" href="#setting-your-referrer-policy:-best-practices">#</a></h2>
<div class="w-aside w-aside--objective">
<p><strong>Objective</strong>:  Explicitly set a privacy-enhancing policy, such as
<code>strict-origin-when-cross-origin</code>(or stricter). </div></p>
<p>There are different ways to set referrer policies for your site:</p>
<ul>
<li>As an HTTP header</li>
<li>Within your
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy#Integration_with_HTML" rel="noopener">HTML</a></li>
<li>From JavaScript on a <a href="https://javascript.info/fetch-api#referrer-referrerpolicy" rel="noopener">per-request
basis</a></li>
</ul>
<p>You can set different policies for different pages, requests or elements.</p>
<p>The HTTP header and the meta element are both page-level. The precedence order when determining an
element's effective policy is:</p>
<ol>
<li>Element-level policy</li>
<li>Page-level policy</li>
<li>Browser default</li>
</ol>
<p><strong>Example:</strong></p>
<p><code>index.html</code>:</p>
<web-copy-code><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>referrer<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>strict-origin-when-cross-origin<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span> <span class="token attr-name">referrerpolicy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no-referrer-when-downgrade<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre>
</web-copy-code><p>The image will be requested with a <code>no-referrer-when-downgrade</code> policy, while all other subresource
requests from this page will follow the <code>strict-origin-when-cross-origin</code> policy.</p>
<h2 id="how-to-see-the-referrer-policy">How to see the referrer policy? <a class="w-headline-link" href="#how-to-see-the-referrer-policy">#</a></h2>
<p><a href="https://securityheaders.com/" rel="noopener">securityheaders.com</a> is handy to determine the policy a specific site
or page is using.</p>
<p>You can also use the developer tools of Chrome, Edge, or Firefox to see the referrer policy used for
a specific request. At the time of this writing, Safari doesn't show the <code>Referrer-Policy</code> header
but does show the <code>Referer</code> that was sent.</p>
<figure class="w-figure">
  <img     alt="A screenshot of the Network panel of Chrome DevTools, showing Referer and Referrer-Policy."          decoding="async"     height="416"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/8Qlu6ZzSVgL2f9iYIplJ.jpg?auto=format&w=1600 1600w"          width="800"   />
  <figcaption class="w-figcaption">
    Chrome DevTools, <b>Network</b> panel with a request selected.
  </figcaption>
</figure>
<h2 id="which-policy-should-you-set-for-your-website">Which policy should you set for your website? <a class="w-headline-link" href="#which-policy-should-you-set-for-your-website">#</a></h2>
<p>Summary: Explicitly set a privacy-enhancing policy such as <code>strict-origin-when-cross-origin</code> (or
stricter).</p>
<h3 id="why-&quot;explicitly&quot;">Why &quot;explicitly&quot;? <a class="w-headline-link" href="#why-&quot;explicitly&quot;">#</a></h3>
<p>If no referrer policy is set, the browser's default policy will be used—in fact, websites often
defer to the browser's default. But this is not ideal, because:</p>
<ul>
<li>Browser default policies are either <code>no-referrer-when-downgrade</code>,
<code>strict-origin-when-cross-origin</code>, or stricter—depending on the browser and mode
(private/incognito). So your website won't behave predictably across browsers.</li>
<li>Browsers are adopting stricter defaults such as <code>strict-origin-when-cross-origin</code> and mechanisms
such as <a href="https://github.com/privacycg/proposals/issues/13" rel="noopener">referrer trimming</a> for cross-origin
requests. Explicitly opting into a privacy-enhancing policy before browser defaults change gives
you control and helps you run tests as you see fit.</li>
</ul>
<h3 id="why-strict-origin-when-cross-origin-(or-stricter)">Why <code>strict-origin-when-cross-origin</code> (or stricter)? <a class="w-headline-link" href="#why-strict-origin-when-cross-origin-(or-stricter)">#</a></h3>
<p>You need a policy that is secure, privacy-enhancing, and useful—what &quot;useful&quot; means depends on what
you want from the referrer:</p>
<ul>
<li><strong>Secure</strong>: if your website uses HTTPS (<a href="/why-https-matters/">if not, make it a
priority</a>), you don't want your website's URLs to leak in
non-HTTPS requests. Since anyone on the network can see these, this would expose your users to
person-in-the-middle-attacks. The policies <code>no-referrer-when-downgrade</code>,
<code>strict-origin-when-cross-origin</code>, <code>no-referrer</code> and <code>strict-origin</code> solve this problem.</li>
<li><strong>Privacy-enhancing</strong>: for a cross-origin request, <code>no-referrer-when-downgrade</code> shares the full
URL—this is not privacy-enhancing. <code>strict-origin-when-cross-origin</code> and <code>strict-origin</code> only
share the origin, and <code>no-referrer</code> shares nothing at all. This leaves you with
<code>strict-origin-when-cross-origin</code>, <code>strict-origin</code>, and <code>no-referrer</code> as privacy-enhancing
options.</li>
<li><strong>Useful</strong>: <code>no-referrer</code> and <code>strict-origin</code> never share the full URL, even for same-origin
requests—so if you need this, <code>strict-origin-when-cross-origin</code> is a better option.</li>
</ul>
<p>All of this means that <strong><code>strict-origin-when-cross-origin</code></strong> is generally a sensible choice.</p>
<p><strong>Example: Setting a <code>strict-origin-when-cross-origin</code> policy:</strong></p>
<p><code>index.html</code>:</p>
<web-copy-code><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>referrer<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>strict-origin-when-cross-origin<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre>
</web-copy-code><p>Or server-side, for example in Express:</p>
<web-copy-code><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> helmet <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'helmet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">referrerPolicy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>policy<span class="token operator">:</span> <span class="token string">'strict-origin-when-cross-origin'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><h3 id="what-if-strict-origin-when-cross-origin-(or-stricter)-doesn't-accommodate-all-your-use-cases">What if <code>strict-origin-when-cross-origin</code> (or stricter) doesn't accommodate all your use cases? <a class="w-headline-link" href="#what-if-strict-origin-when-cross-origin-(or-stricter)-doesn't-accommodate-all-your-use-cases">#</a></h3>
<p>In this case, take a <strong>progressive approach</strong>: set a protective policy like
<code>strict-origin-when-cross-origin</code> for your website and if need be, a more permissive policy for
specific requests or HTML elements.</p>
<h3 id="example:-element-level-policy">Example: element-level policy <a class="w-headline-link" href="#example:-element-level-policy">#</a></h3>
<p><code>index.html</code>:</p>
<web-copy-code><pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">  <span class="token comment">&lt;!-- document-level policy: strict-origin-when-cross-origin --></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>referrer<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>strict-origin-when-cross-origin<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">      <span class="token comment">&lt;!-- policy on this &lt;a> element: no-referrer-when-downgrade --></span></span><br><mark class="highlight-line highlight-line-active">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…<span class="token punctuation">"</span></span> <span class="token attr-name">referrerpolicy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no-referrer-when-downgrade<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></mark><br><span class="highlight-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span><br><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span></code></pre>
</web-copy-code><p>Note that Safari/WebKit may cap <code>document.referrer</code> or the <code>Referer</code> header for
<a href="/same-site-same-origin/#same-site-cross-site">cross-site</a> requests.
See <a href="https://webkit.org/blog/10218/full-third-party-cookie-blocking-and-more/" rel="noopener">details</a>.</p>
<h3 id="example:-request-level-policy">Example: request-level policy <a class="w-headline-link" href="#example:-request-level-policy">#</a></h3>
<p><code>script.js</code>:</p>
<web-copy-code><pre class="language-javascript"><code class="language-javascript"><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>referrerPolicy<span class="token operator">:</span> <span class="token string">'no-referrer-when-downgrade'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><h3 id="what-else-should-you-consider">What else should you consider? <a class="w-headline-link" href="#what-else-should-you-consider">#</a></h3>
<p>Your policy should depend on your website and use cases—this is up to you, your team, and your
company. If some URLs contain identifying or sensitive data, set a protective policy.</p>
<div class="w-aside w-aside--warning">
<p><strong>Warning</strong>:  Data that might not look sensitive to you can be sensitive for your users, or
is simply not data they want or expect to silently leak cross-origin. </div></p>
<h2 id="using-the-referrer-from-incoming-requests:-best-practices">Using the referrer from incoming requests: best practices <a class="w-headline-link" href="#using-the-referrer-from-incoming-requests:-best-practices">#</a></h2>
<h3 id="what-to-do-if-your-site's-functionality-uses-the-referrer-url-of-incoming-requests">What to do if your site's functionality uses the referrer URL of incoming requests? <a class="w-headline-link" href="#what-to-do-if-your-site's-functionality-uses-the-referrer-url-of-incoming-requests">#</a></h3>
<h4 id="protect-users'-data">Protect users' data <a class="w-headline-link" href="#protect-users'-data">#</a></h4>
<p>The <code>Referer</code> may contain private, personal, or identifying data—so make sure you treat it as such.</p>
<h4 id="keep-in-mind-that-the-referer-you-receive-may-change">Keep in mind that the <code>Referer</code> you receive may change <a class="w-headline-link" href="#keep-in-mind-that-the-referer-you-receive-may-change">#</a></h4>
<p>Using the referrer from incoming cross-origin requests has a few limitations:</p>
<ul>
<li>If you have no control over the request emitter's implementation, you can't make assumptions about
the <code>Referer</code> header (and <code>document.referrer</code>) you receive. The request emitter may decide anytime
to switch to a <code>no-referrer</code> policy, or more generally to a stricter policy than what they used
before—meaning you'll get less data via the <code>Referer</code> than you used to.</li>
<li>Browsers are increasingly using the Referrer-Policy <code>strict-origin-when-cross-origin</code> by default.
This means that you may now receive only the origin (instead of full referrer URL) in incoming
cross-origin requests, if the site that sends these has no policy set.</li>
<li>Browsers may change the way they manage <code>Referer</code>; for example, in the future, they may decide to
always trim referrers to origins in cross-origin subresource requests, in order to protect user
privacy.</li>
<li>The <code>Referer</code> header (and <code>document.referrer</code>) may contain more data than you need, for example a
full URL when you only want to know if the request is cross-origin.</li>
</ul>
<h4 id="alternatives-to-referer">Alternatives to <code>Referer</code> <a class="w-headline-link" href="#alternatives-to-referer">#</a></h4>
<p>You may need to consider alternatives if:</p>
<ul>
<li>An essential functionality of your site uses the referrer URL of incoming cross-origin requests;</li>
<li>And/or if your site is not receiving anymore the part of the referrer URL it needs in a
cross-origin request. This happens when the request emitter changed their policy or when they have
no policy set and the browser default's policy changed (like in <a href="https://developers.google.com/web/updates/2020/07/referrer-policy-new-chrome-default" rel="noopener">Chrome
85</a>).</li>
</ul>
<p>To define alternatives, analyze first what part of the referrer you're using.</p>
<p><strong>If you only need the origin (<code>https://site-one.example</code>):</strong></p>
<ul>
<li>If you're using the referrer in a script that has top-level access to the page,
<code>window.location.origin</code> is an alternative.</li>
<li>If available, headers like
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin" rel="noopener"><code>Origin</code></a> and
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Site" rel="noopener"><code>Sec-Fetch-Site</code></a> give
you the <code>Origin</code> or describe whether the request is cross-origin, which may be exactly what you need.</li>
</ul>
<p><strong>If you need other elements of the URL (path, query parameters…):</strong></p>
<ul>
<li>Request parameters may address your use case and this saves you the work of parsing the
referrer.</li>
<li>If you're using the referrer in a script that has top-level access to the page,
<code>window.location.pathname</code> may be an alternative. Extract only the path section of the URL and
pass it on as an argument, so any potentially sensitive information in the URL parameters isn't
passed on.</li>
</ul>
<p><strong>If you can't use these alternatives:</strong></p>
<ul>
<li>Check if your systems can be changed to expect the request emitter (<code>site-one.example</code>) to
explicitly set the information you need in a configuration of some sort. Pro: more explicit, more
privacy-preserving for <code>site-one.example</code> users, more future-proof. Con: potentially more work
from your side or for your system's users.</li>
<li>Check whether the site that emits the requests may agree to set a per-element or per-request
Referrer-Policy of <code>no-referrer-when-downgrade</code>. Con: potentially less privacy-preserving for
<code>site-one.example</code> users, potentially not supported in all browsers.</li>
</ul>
<h3 id="cross-site-request-forgery-(csrf)-protection">Cross-Site Request Forgery (CSRF) protection <a class="w-headline-link" href="#cross-site-request-forgery-(csrf)-protection">#</a></h3>
<p>Note that a request emitter can always decide not to send the referrer by setting a <code>no-referrer</code>
policy (and a malicious actor could even spoof the referrer).</p>
<p>Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html#token-based-mitigation" rel="noopener">CSRF
tokens</a>
as your primary protection. For extra protection, use
<a href="/samesite-cookie-recipes/#%22unsafe%22-requests-across-sites">SameSite</a>—and instead
of <code>Referer</code>, use headers such as
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin" rel="noopener"><code>Origin</code></a> (available on POST and
CORS requests) and
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Site" rel="noopener"><code>Sec-Fetch-Site</code></a> (if
available).</p>
<h3 id="logging">Logging <a class="w-headline-link" href="#logging">#</a></h3>
<p>Make sure to protect users' personal or sensitive data that may be in the <code>Referer</code>.</p>
<p>If you're only using the origin, check if the
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin" rel="noopener"><code>Origin</code></a> header could be an
alternative. This may give you the information that you need for debugging purposes in a simpler way
and without needing to parse the referrer.</p>
<h3 id="payments">Payments <a class="w-headline-link" href="#payments">#</a></h3>
<p>Payment providers may rely on the <code>Referer</code> header of incoming requests for security checks.</p>
<p>For example:</p>
<ul>
<li>The user clicks a <strong>Buy</strong> button on <code>online-shop.example/cart/checkout</code>.</li>
<li><code>online-shop.example</code> redirects to <code>payment-provider.example</code> to manage the transaction.</li>
<li><code>payment-provider.example</code> checks the <code>Referer</code> of this request against a list of allowed
<code>Referer</code> values set up by the merchants. If it doesn't match any entry in the list,
<code>payment-provider.example</code> rejects the request. If it does match, the user can proceed to the
transaction.</li>
</ul>
<h4 id="best-practices-for-payment-flow-security-checks">Best practices for payment flow security checks <a class="w-headline-link" href="#best-practices-for-payment-flow-security-checks">#</a></h4>
<p><strong>Summary: as a payment provider, you can use the <code>Referer</code> as a basic check
against naive attacks—but you should absolutely have another, more
reliable verification method in place.</strong></p>
<p>The <code>Referer</code> header alone isn't a reliable basis for a check: the requesting site, whether they're
a legitimate merchant or not, can set a <code>no-referrer</code> policy which will make the <code>Referer</code>
information unavailable to the payment provider. However, as a payment provider, looking at the
<code>Referer</code> may help you catch naive attackers who did not set a <code>no-referrer</code> policy. So you can
decide to use the <code>Referer</code> as a first basic check. If you do so:</p>
<ul>
<li><strong>Do not expect the <code>Referer</code> to always be present; and if it's present, only check against the
piece of data it will include at the minimum: the origin</strong>. When setting the list of allowed
<code>Referer</code> values, make sure that no path is included, but only the origin. Example: the allowed
<code>Referer</code> values for <code>online-shop.example</code> should be <code>online-shop.example</code>, not
<code>online-shop.example/cart/checkout</code>. Why? Because by expecting either no <code>Referer</code> at all or a
<code>Referer</code> value that is the origin of the requesting website, you prevent unexpected errors since
you're <strong>not making assumptions about the <code>Referrer-Policy</code></strong> your merchant has set or about the
browser's behavior if the merchant has no policy set. Both the site and the browser could strip
the <code>Referer</code> sent in the incoming request to only the origin or not send the <code>Referer</code> at all.</li>
<li>If the <code>Referer</code> is absent or if it's present and your basic <code>Referer</code> origin check was
successful: you can move onto your other, more reliable verification method (see below).</li>
</ul>
<p><strong>What is a more reliable verification method?</strong></p>
<p>One reliable verification method is to let the requester <strong>hash the request parameters</strong> together
with a unique key. As a payment provider, you can then <strong>calculate the same hash on your side</strong> and
only accept the request if it matches your calculation.</p>
<p><strong>What happens to the <code>Referer</code> when an HTTP merchant site with no referrer policy redirects to an
HTTPS payment provider?</strong></p>
<p>No <code>Referer</code> will be visible in the request to the HTTPS payment provider, because <a href="#default-referrer-policies-in-browsers">most
browsers</a> use <code>strict-origin-when-cross-origin</code> or
<code>no-referrer-when-downgrade</code> by default when a website has no policy set. Also note that <a href="https://developers.google.com/web/updates/2020/07/referrer-policy-new-chrome-default" rel="noopener">Chrome's
change to a new default
policy</a> won't
change this behaviour.</p>
<div class="w-aside w-aside--note">
<p>If your website uses HTTP, <a href="/why-https-matters/">migrate to HTTPS</a>.</p>
</div>
<h2 id="conclusion">Conclusion <a class="w-headline-link" href="#conclusion">#</a></h2>
<p>A protective referrer policy is a great way to give your users more privacy.</p>
<p>To learn more about different techniques to protect your users, check out web.dev's <a href="/secure/">Safe and
secure</a> collection!</p>
<p><em>With many thanks for contributions and feedback to all reviewers - especially Kaustubha Govind,
David Van Cleve, Mike West, Sam Dutton, Rowan Merewood, Jxck and Kayce Basques.</em></p>
<h2 id="resources">Resources <a class="w-headline-link" href="#resources">#</a></h2>
<ul>
<li><a href="/same-site-same-origin/">Understanding &quot;same-site&quot; and &quot;same-origin&quot;</a></li>
<li><a href="https://scotthelme.co.uk/a-new-security-header-referrer-policy/" rel="noopener">A new security header: Referrer Policy
(2017)</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy" rel="noopener">Referrer-Policy on
MDN</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns" rel="noopener">Referer header: privacy and security concerns on
MDN</a></li>
<li><a href="https://groups.google.com/a/chromium.org/d/msg/blink-dev/aBtuQUga1Tk/n4BLwof4DgAJ" rel="noopener">Chrome change: Blink intent to
implement</a></li>
<li><a href="https://groups.google.com/a/chromium.org/forum/#!topic/blink-dev/lqFuqwZDDR8" rel="noopener">Chrome change: Blink intent to
ship</a></li>
<li><a href="https://www.chromestatus.com/feature/6251880185331712" rel="noopener">Chrome change: status entry</a></li>
<li><a href="https://blog.chromium.org/2020/07/chrome-85-upload-streaming-human.html" rel="noopener">Chrome change: 85 beta
blogpost</a></li>
<li><a href="https://github.com/privacycg/proposals/issues/13" rel="noopener">Referrer trimming GitHub thread: what different browsers
do</a></li>
<li><a href="https://w3c.github.io/webappsec-referrer-policy/#referrer-policy-delivery" rel="noopener">Referrer-Policy Spec</a></li>
</ul>


    

    
  <div class="w-chips ">
    
      
    
      
    
      
        
        <a class="w-chip" href="/tags/security/">Security</a>
      
    
      
        
        <a class="w-chip" href="/tags/privacy/">Privacy</a>
      
    
  </div>


    <div class="w-post-github-link w-mt--l w-mb--l">
      <span class="w-mr--sm">
        
        Last updated: <time>Sep 23, 2020</time>
        
      </span>
      <a
        href="https://github.com/GoogleChrome/web.dev/blob/master/src/site/content/en/blog/referrer-best-practices/index.md"
      >
        Improve article
      </a>
       
    </div>

    
    <web-feedback additional-questions="api"></web-feedback>
  </div>

  
    
    <nav class="w-article-navigation">
  <a
    class="w-article-navigation__link w-article-navigation__link--back
      w-article-navigation__link--single gc-analytics-event"
    data-category="web.dev"
    data-label="navigation, go back"
    data-action="click"
    href="/blog"
  >
    Return to all articles
  </a>
</nav>
  
</div>

  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://devwebfeed.appspot.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">
              DevWeb Content Firehose
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/@ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/home"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
