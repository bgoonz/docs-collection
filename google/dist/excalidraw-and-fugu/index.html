
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=3ab86c13cf027">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Excalidraw and Fugu: Improving Core User Journeys </title>
<meta name="description" content="A write-up of Thomas Steiner's Google I/O 2021 talk titled Excalidraw and Fugu: Improving Core User Journeys " />

<link rel="canonical" href="https://web.dev/excalidraw-and-fugu/" />

<meta itemprop="name" content="Excalidraw and Fugu: Improving Core User Journeys " />
<meta itemprop="description" content="A write-up of Thomas Steiner's Google I/O 2021 talk titled Excalidraw and Fugu: Improving Core User Journeys " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/excalidraw-and-fugu/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Excalidraw and Fugu: Improving Core User Journeys " />
<meta property="og:description" content="A write-up of Thomas Steiner's Google I/O 2021 talk titled Excalidraw and Fugu: Improving Core User Journeys " />
<meta property="og:image" content="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="Dropping a file from the macOS Finder onto the Excalidraw application." />
<meta property="tag" content="capabilities" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Excalidraw and Fugu: Improving Core User Journeys " />
<meta name="twitter:description" content="A write-up of Thomas Steiner's Google I/O 2021 talk titled Excalidraw and Fugu: Improving Core User Journeys " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>








<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=611114498c582', 'module');




  loadScript('/js/content.js?v=955e3f9deed41', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="30" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
      
    
    


<div class="guide-landing-page">
  
  

  
    <img     alt="Dropping a file from the macOS Finder onto the Excalidraw application."     class="w-hero w-hero--cover"     decoding="auto"     height="480"               sizes="100vw"     src="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format"     srcset="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/FcDeDjh1bW8zAHIzA2BF.png?auto=format&w=1600 1600w"          width="1600"   />
  

  <web-table-of-contents>
    <h2 class="w-toc__header">
      <a href="#excalidraw-and-fugu:-improving-core-user-journeys" class="w-toc__header--link">
        Excalidraw and Fugu: Improving Core User Journeys
      </a>
    </h2>
    <div class="w-toc__list">
        <ul><li><a href="#how-i-came-to-excalidraw">How I came to Excalidraw</a></li><li><a href="#lipis-on-why-he-dedicates-so-much-of-his-time-to-excalidraw">Lipis on why he dedicates so much of his time to Excalidraw</a></li><li><a href="#excalidraw-in-action">Excalidraw in action</a></li><li><a href="#working-with-files">Working with files</a></li><li><a href="#opening-files">Opening files</a></li><li><a href="#saving-files">Saving files</a></li><li><a href="#drag-and-drop">Drag and drop</a></li><li><a href="#sharing-files">Sharing files</a></li><li><a href="#lipis-on-the-deprecated-electron-version">Lipis on the deprecated Electron version</a></li><li><a href="#file-handling">File handling</a></li><li><a href="#clipboard-integration">Clipboard integration</a></li><li><a href="#collaborating-with-others">Collaborating with others</a></li><li><a href="#sharing-a-session-url">Sharing a session URL</a></li><li><a href="#live-collaboration">Live collaboration</a></li><li><a href="#seeing-collaborator-statuses">Seeing collaborator statuses</a></li><li><a href="#lipis-on-what-is-holding-back-excalidraw">Lipis on what is holding back Excalidraw</a></li><li><a href="#tabbed-application-mode">Tabbed application mode</a></li><li><a href="#closing">Closing</a></li></ul></div>
  </web-table-of-contents>
  <web-table-of-contents-button></web-table-of-contents-button>

  
  <div class="w-actions">
    <share-action authors="@tomayac"
      class="gc-analytics-event w-actions__fab w-actions__fab--share"
      data-category="web.dev"
      data-label="share"
      data-action="click"
      data-icon="share"
      tabindex="0"
      role="button"
    >
      <span>Share</span>
    </share-action>
    <a class="w-actions__fab w-actions__fab--subscribe gc-analytics-event" data-category="web.dev" data-label="view-subscribe" data-action="click" href="/newsletter/">
  <span>subscribe</span>
</a>

  </div>

  <div class="w-layout-container--narrow w-post-content">
    <header class="w-article-header">
      
        <div class="w-post-breadcrumbs">
          <ul class="w-breadcrumbs">
  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link w-breadcrumbs__link--left-justify gc-analytics-event"
      data-category="web.dev"
      data-label="post, home breadcrumb"
      data-action="click"
      href="/"
    >
      Home
    </a>
  </li>

  <svg
    class="w-breadcrumbs__icon"
    xmlns="http://www.w3.org/2000/svg"
    height="24"
    viewBox="0 0 24 24"
    width="24"
    aria-hidden="true"
  >
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z" />
  </svg>

  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link gc-analytics-event"
      data-category="web.dev"
      data-label="post, path breadcrumb"
      data-action="click"
      href=/blog
    >
      All articles
    </a>
  </li>
</ul>
        </div>
      

      <h1 id="excalidraw-and-fugu:-improving-core-user-journeys" class="w-article-header__headline">Excalidraw and Fugu: Improving Core User Journeys</h1>
      
        <p class="w-article-header__subhead w-mb--non">
          <p>Any sufficiently advanced technology is indistinguishable from magic. Unless you understand it. My
name is Thomas Steiner, I work in Developer Relations at Google and in this write-up of my Google I/O talk, I will look at
some of the new Fugu APIs and how they improve core user journeys in the Excalidraw PWA, so you can
take inspiration from these ideas and apply them to your own apps.</p>

        </p>
      

      
        <div class="w-author__published">
          <time>May 18, 2021</time>
           <span class="w-author__separator">•</span> Updated <time>May 19, 2021</time> 
        </div>
      
      

      
        <div class="w-authors w-mt--xl w-pt--sm">
          
            <div class="w-author">
  <a href="/authors/thomassteiner/"><img     alt="Thomas Steiner"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/8PLpVmFef6mj72MVWeiN.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/8PLpVmFef6mj72MVWeiN.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/8PLpVmFef6mj72MVWeiN.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/8PLpVmFef6mj72MVWeiN.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/8PLpVmFef6mj72MVWeiN.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/8PLpVmFef6mj72MVWeiN.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/thomassteiner/">Thomas Steiner</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/tomayac"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/tomayac">GitHub</a>
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://glitch.com/@tomayac"
          >Glitch</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://blog.tomayac.com/">Blog</a>
      </li>
    </ul>
  </div>
</div>
          
        </div>
      
    </header>

    

    <div class="w-aside w-aside--note">
<p>This is a write-up of my Google I/O talk. If you prefer watching it, see the video below.</p>
</div>
<div class="youtube">  <lite-youtube    videoid="EK1AkxgQwro"      >  </lite-youtube></div>
<h2 id="how-i-came-to-excalidraw">How I came to Excalidraw <a class="w-headline-link" href="#how-i-came-to-excalidraw">#</a></h2>
<p>I want to start with a story. On January 1st, 2020,
<a href="https://twitter.com/vjeux" rel="noopener">Christopher Chedeau</a>, a software engineer at Facebook,
<a href="https://twitter.com/Vjeux/status/1212503324982792193" rel="noopener">tweeted</a> about a small drawing app he had
started to work on. With this tool, you could draw boxes and arrows that feel cartoony and
hand-drawn. The next day, you could also draw ellipses and text, as well as select objects and move
them around. On January 3, the app had gotten its name, Excalidraw, and, like with every good side
project, buying the <a href="https://excalidraw.com/" rel="noopener">domain name</a> was one of Christopher's first acts. By
now, you could use colors and export the whole drawing as a PNG.</p>
<img     alt="Screenshot of the Excalidraw prototype application showing that it supported rectangles, arrows, ellipses, and text."          decoding="async"     height="600"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format"     srcset="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/VbicbA7xj5azVcDUBSKt.png?auto=format&w=1600 1600w"          width="800"   />
<p>On January 15, Christopher put out a
<a href="https://blog.vjeux.com/2020/uncategorized/reflections-on-excalidraw.html" rel="noopener">blog post</a> that drew a
lot of attention on Twitter, including mine. The post started with some impressive stats:</p>
<ul>
<li>12K unique active users</li>
<li>1.5K stars on GitHub</li>
<li>26 contributors</li>
</ul>
<p>For a project that started a mere two weeks ago, that's not bad at all. But the thing that truly
spiked my interest was further down in the post. Christopher wrote that he tried something new this
time: <em>giving everyone who landed a pull request unconditional commit access.</em> The same day of
reading the blog post, I had a <a href="https://github.com/excalidraw/excalidraw/pull/388" rel="noopener">pull request</a> up
that added File System Access API support to Excalidraw, fixing a
<a href="https://github.com/excalidraw/excalidraw/issues/169" rel="noopener">feature request</a> that someone had filed.</p>
<img     alt="Screenshot of the tweet where I announce my PR."          decoding="async"     height="424"          loading="lazy"     sizes="(min-width: 550px) 550px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format"     srcset="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9VJ9EqPzKdzUpxFeM5wH.png?auto=format&w=1100 1100w"          width="550"   />
<p>My pull request was merged a day later and from thereon, I had full commit access. Needless to say,
I didn't abuse my power. And nor did anybody else from the 149 contributors so far.</p>
<p>Today, <a href="https://excalidraw.com/" rel="noopener">Excalidraw</a> is a full-fledged installable progressive web app with
offline support, a stunning dark mode, and yes, the ability to open and save files thanks to the
File System Access API.</p>
<img     alt="Screenshot of the Excalidraw PWA in today&#x27;s state."          decoding="async"     height="537"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format"     srcset="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/Wzz6UELRpcvkKZQtmVmc.png?auto=format&w=1600 1600w"          width="800"   />
<h2 id="lipis-on-why-he-dedicates-so-much-of-his-time-to-excalidraw">Lipis on why he dedicates so much of his time to Excalidraw <a class="w-headline-link" href="#lipis-on-why-he-dedicates-so-much-of-his-time-to-excalidraw">#</a></h2>
<p>So this marks the end of my &quot;how I came to Excalidraw&quot; story, but before I dive into some of
Excalidraw's amazing features, I have the pleasure to introduce Panayiotis. Panayiotis Lipiridis, on
the Internet simply known as <a href="https://github.com/lipis" rel="noopener">lipis</a>, is the most prolific contributor to
Excalidraw. I asked lipis what motivates him to dedicate so much of his time to Excalidraw:</p>
<blockquote>
<p>Like everyone else I learned about this project from Christopher's tweet. My first contribution
was to add the <a href="https://yeun.github.io/open-color/" rel="noopener">Open Color library</a>, the colors that are still
part of Excalidraw today. As the project grew and we had quite many requests, my next big
contribution was to build a backend for storing drawings so users could share them. But what
really drives me to contribute is that whoever tried Excalidraw is looking to find excuses to use
it again.</p>
</blockquote>
<p>I fully agree with lipis. Whoever tried Excalidraw is looking to find excuses to use it again.</p>
<h2 id="excalidraw-in-action">Excalidraw in action <a class="w-headline-link" href="#excalidraw-in-action">#</a></h2>
<p>I want to show you now how you can use Excalidraw in practice. I'm not a great artist, but the
Google I/O logo is simple enough, so let me give it a try. A box is the &quot;i&quot;, a line can be the
slash, and the &quot;o&quot; is a circle. I hold down <kbd>shift</kbd>, so I get a perfect circle. Let me move
the slash a little, so it looks better. Now some color for the &quot;i&quot; and the &quot;o&quot;. Blue is good. Maybe
a different fill style? All solid, or cross-hatch? Nah, hachure looks great. It's not perfect, but
that's the idea of Excalidraw, so let me save it.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/wK9jDdHG7A7qT5ViOuEQ.mp4" type="video/mp4" />    </video></p>
<p>I click the save icon and enter a file name in the file save dialog. In Chrome, a browser that
supports the File System Access API, this is not a download, but a true save operation, where I can
choose the location and name of the file, and where, if I make edits, I can just save them to the
same file.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/HvKcKNk8Q3bbaVe36E3T.mp4" type="video/mp4" />    </video></p>
<p>Let me change the logo and make the &quot;i&quot; red. If I now click save again, my modification is saved to
the same file as before. As a proof, let me clear the canvas and reopen the file. As you can see,
the modified red-blue logo is there again.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/XzlUi88cPDYl8YFAH1J8.mp4" type="video/mp4" />    </video></p>
<h2 id="working-with-files">Working with files <a class="w-headline-link" href="#working-with-files">#</a></h2>
<p>On browsers that currently don't support the File System Access API, each save operation is a
download, so when I make changes, I end up with multiple files with an incrementing number in the
filename that fill up my Downloads folder. But despite this downside, I can still save the file.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/1oVPIESBNhoL4AhOSNli.mp4" type="video/mp4" />    </video></p>
<h3 id="opening-files">Opening files <a class="w-headline-link" href="#opening-files">#</a></h3>
<p>So what's the secret? How can opening and saving work on different browsers that may or may not
support the File System Access API? Opening a file in Excalidraw happens in a function called
<code>loadFromJSON)(</code>), which in turn calls a function called <code>fileOpen()</code>.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">loadFromJSON</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">localAppState<span class="token operator">:</span> AppState</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fileOpen</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>    description<span class="token operator">:</span> <span class="token string">'Excalidraw files'</span><span class="token punctuation">,</span><br>    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">'.excalidraw'</span><span class="token punctuation">,</span> <span class="token string">'.png'</span><span class="token punctuation">,</span> <span class="token string">'.svg'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    mimeTypes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'application/json'</span><span class="token punctuation">,</span> <span class="token string">'image/png'</span><span class="token punctuation">,</span> <span class="token string">'image/svg+xml'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token function">loadFromBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> localAppState<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>The <code>fileOpen()</code> function that comes from a small library I wrote called
<a href="https://github.com/GoogleChromeLabs/browser-fs-access" rel="noopener">browser-fs-access</a> that we use in
Excalidraw. This library provides file system access through the
<a href="/file-system-access/">File System Access API</a> with a legacy fallback, so it can be used in any
browser.</p>
<p>Let me first show you the implementation for when the API is supported. After negotiating the
accepted MIME types and file extensions, the central piece is calling the File System Access API's
function <code>showOpenFilePicker()</code>. This function returns an array of files or a single file, dependent
on whether multiple files are selected. All that's left then is to put the file handle on the file
object, so it can be retrieved again.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> accept <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <span class="token comment">// Not shown: deal with extensions and MIME types.</span><br>  <span class="token keyword">const</span> handleOrHandles <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span><span class="token function">showOpenFilePicker</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>    types<span class="token operator">:</span> <span class="token punctuation">[</span><br>      <span class="token punctuation">{</span><br>        description<span class="token operator">:</span> options<span class="token punctuation">.</span>description <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">,</span><br>        accept<span class="token operator">:</span> accept<span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">]</span><span class="token punctuation">,</span><br>    multiple<span class="token operator">:</span> options<span class="token punctuation">.</span>multiple <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>handleOrHandles<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>getFileWithHandle<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>multiple<span class="token punctuation">)</span> <span class="token keyword">return</span> files<span class="token punctuation">;</span><br>  <span class="token keyword">return</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> <span class="token function-variable function">getFileWithHandle</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">handle</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">await</span> handle<span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    file<span class="token punctuation">.</span>handle <span class="token operator">=</span> handle<span class="token punctuation">;</span><br>    <span class="token keyword">return</span> file<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>The fallback implementation relies on an <code>input</code> element of type <code>&quot;file&quot;</code>. After the negotiation of
the to-be-accepted MIME types and extensions, the next step is to programmatically click the input
element so the file open dialog shows. On change, that is, when the user has selected one or
multiple files, the promise resolves.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    input<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'file'</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> accept <span class="token operator">=</span> <span class="token punctuation">[</span><br>      <span class="token operator">...</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>mimeTypes <span class="token operator">?</span> options<span class="token punctuation">.</span>mimeTypes <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>      options<span class="token punctuation">.</span>extensions <span class="token operator">?</span> options<span class="token punctuation">.</span>extensions <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    input<span class="token punctuation">.</span>multiple <span class="token operator">=</span> options<span class="token punctuation">.</span>multiple <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>    input<span class="token punctuation">.</span>accept <span class="token operator">=</span> accept <span class="token operator">||</span> <span class="token string">'*/*'</span><span class="token punctuation">;</span><br>    input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token function">resolve</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>multiple <span class="token operator">?</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>files<span class="token punctuation">)</span> <span class="token operator">:</span> input<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    input<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><h3 id="saving-files">Saving files <a class="w-headline-link" href="#saving-files">#</a></h3>
<p>Now to saving. In Excalidraw, saving happens in a function called <code>saveAsJSON()</code>. It first
serializes the Excalidraw elements array to JSON, converts the JSON to a blob, and then calls a
function called <code>fileSave()</code>. This function is likewise provided by the
<a href="https://github.com/GoogleChromeLabs/browser-fs-access" rel="noopener">browser-fs-access</a> library.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">saveAsJSON</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><br>  <span class="token parameter">elements<span class="token operator">:</span> readonly ExcalidrawElement<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>  appState<span class="token operator">:</span> AppState<span class="token punctuation">,</span></span><br><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> serialized <span class="token operator">=</span> <span class="token function">serializeAsJSON</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> appState<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>serialized<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    type<span class="token operator">:</span> <span class="token string">'application/vnd.excalidraw+json'</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> fileHandle <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fileSave</span><span class="token punctuation">(</span><br>    blob<span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      fileName<span class="token operator">:</span> appState<span class="token punctuation">.</span>name<span class="token punctuation">,</span><br>      description<span class="token operator">:</span> <span class="token string">'Excalidraw file'</span><span class="token punctuation">,</span><br>      extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.excalidraw'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    appState<span class="token punctuation">.</span>fileHandle<span class="token punctuation">,</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span> fileHandle <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>Again let me first look at the implementation for browsers with File System Access API support. The
first couple of lines look a little involved, but all they do is negotiate the MIME types and file
extensions. When I have saved before and already have a file handle, no save dialog needs to be
shown. But if this is the first save, a file dialog gets displayed and the app gets a file handle
back for future use. The rest is then just writing to the file, which happens through a
<a href="/streams/">writable stream</a>.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">blob<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> handle <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  options<span class="token punctuation">.</span>fileName <span class="token operator">=</span> options<span class="token punctuation">.</span>fileName <span class="token operator">||</span> <span class="token string">'Untitled'</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> accept <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <span class="token comment">// Not shown: deal with extensions and MIME types.</span><br>  handle <span class="token operator">=</span><br>    handle <span class="token operator">||</span><br>    <span class="token punctuation">(</span><span class="token keyword">await</span> window<span class="token punctuation">.</span><span class="token function">showSaveFilePicker</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>      suggestedName<span class="token operator">:</span> options<span class="token punctuation">.</span>fileName<span class="token punctuation">,</span><br>      types<span class="token operator">:</span> <span class="token punctuation">[</span><br>        <span class="token punctuation">{</span><br>          description<span class="token operator">:</span> options<span class="token punctuation">.</span>description <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">,</span><br>          accept<span class="token operator">:</span> accept<span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> writable <span class="token operator">=</span> <span class="token keyword">await</span> handle<span class="token punctuation">.</span><span class="token function">createWritable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">await</span> writable<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">await</span> writable<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> handle<span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><h4 id="the-&quot;save-as&quot;-feature">The &quot;save as&quot; feature <a class="w-headline-link" href="#the-&quot;save-as&quot;-feature">#</a></h4>
<p>If I decide to ignore an already existing file handle, I can implement a &quot;save as&quot; feature to create
a new file based on an existing file. To show this, let me open an existing file, make some
modification, and then not overwrite the existing file, but create a new file by using the save-as
feature. This leaves the original file intact.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/oTNuosQmoMBP2G7XR8Wb.mp4" type="video/mp4" />    </video></p>
<p>The implementation for browsers that don't support the File System Access API is short, since all it
does is create an anchor element with a <code>download</code> attribute whose value is the desired filename and
a blob URL as its <code>href</code> attribute value.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">blob<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  a<span class="token punctuation">.</span>download <span class="token operator">=</span> options<span class="token punctuation">.</span>fileName <span class="token operator">||</span> <span class="token string">'Untitled'</span><span class="token punctuation">;</span><br>  a<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  a<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  a<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>The anchor element then gets clicked programmatically. To prevent memory leaks, the blob URL needs
to be revoked after use. As this is just a download, no file save dialog gets shown ever, and all
files land in the default <code>Downloads</code> folder.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/1oVPIESBNhoL4AhOSNli.mp4" type="video/mp4" />    </video></p>
<h2 id="drag-and-drop">Drag and drop <a class="w-headline-link" href="#drag-and-drop">#</a></h2>
<p>One of my favorite system integrations on desktop is drag and drop. In Excalidraw, when I drop an
<code>.excalidraw</code> file onto the application, it opens right away and I can start editing. On browsers
that support the File System Access API, I can then even immediately save my changes. No need to go
through a file save dialog since the required file handle has been obtained from the drag and drop
operation.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/aOPKhOOe20od8uOzehdy.mp4" type="video/mp4" />    </video></p>
<p>The secret for making this happen is by calling <code>getAsFileSystemHandle()</code> on the
<a href="/datatransfer/">data transfer</a> item when the File System Access API is supported. I then pass this
file handle to <code>loadFromBlob()</code>, which you may remember from a couple paragraphs above. So many
things you can do with files: opening, saving, over-saving, dragging, dropping. My colleague Pete
and I have documented all these tricks and more in <a href="/file-system-access/">our article</a> so you can
catch up in case all this went a little too fast.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> file <span class="token operator">=</span> event<span class="token punctuation">.</span>dataTransfer<span class="token operator">?.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token operator">?.</span>type <span class="token operator">===</span> <span class="token string">'application/json'</span> <span class="token operator">||</span> file<span class="token operator">?.</span>name<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'.excalidraw'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isLoading<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Provided by browser-fs-access.</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>supported<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> item <span class="token operator">=</span> event<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span>items<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>      file <span class="token keyword">as</span> any<span class="token punctuation">.</span>handle <span class="token operator">=</span> <span class="token keyword">await</span> item <span class="token keyword">as</span> any<br>        <span class="token punctuation">.</span><span class="token function">getAsFileSystemHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>name<span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br>  <span class="token function">loadFromBlob</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> elements<span class="token punctuation">,</span> appState <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span><br>    <span class="token comment">// Load from blob</span><br>  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isLoading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> errorMessage<span class="token operator">:</span> error<span class="token punctuation">.</span>message <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h2 id="sharing-files">Sharing files <a class="w-headline-link" href="#sharing-files">#</a></h2>
<p>Another system integration currently on Android, Chrome OS, and Windows is through the
<a href="/web-share-target/">Web Share Target API</a>. Here I am in the Files app in my <code>Downloads</code> folder. I
can see two files, one of them with the non-descript name <code>untitled</code> and a timestamp. To check what
it contains, I click on the three dots, then share, and one of the options that appears is
Excalidraw. When I tap the icon, I can then see that the file just contains the I/O logo again.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/x93JgKGcp1o8at5P7exv.mp4" type="video/mp4" />    </video></p>
<h2 id="lipis-on-the-deprecated-electron-version">Lipis on the deprecated Electron version <a class="w-headline-link" href="#lipis-on-the-deprecated-electron-version">#</a></h2>
<p>One thing you can do with files that I haven't talked about yet is doubleclick them. What typically
happens when you doubleclick a file is that the app that's associated with the file's MIME type
opens. For example for <code>.docx</code> this would be Microsoft Word.</p>
<p>Excalidraw <a href="/deprecating-excalidraw-electron/">used to have an Electron version</a> of the app that
supported such file type associations, so when you double-clicked an <code>.excalidraw</code> file, the
Excalidraw Electron app would open. Lipis, whom you have already met before, was both the creator
and the deprecator of Excalidraw Electron. I asked him why he felt it was possible to deprecate the
Electron version:</p>
<blockquote>
<p>People have been asking for an Electron app since the beginning, mainly because they wanted to
open files by double-clicking. We also intended to put the app in app stores. In parallel, someone
suggested creating a PWA instead, so we just did both. Luckily we were introduced to Project Fugu
APIs like file system access, clipboard access, file handling, and more. With a sole click you can
install the app on your desktop or mobile, without the extra weight of Electron. It was an easy
decision to deprecate the Electron version, concentrate just on the web app, and make it the
best-possible PWA. On top, we're now able to publish PWAs to the Play Store and the Microsoft
Store! That's huge!</p>
</blockquote>
<p>One could say Excalidraw for Electron was not deprecated because Electron is bad, not at all, but
because the web has become good enough. I like this!</p>
<h2 id="file-handling">File handling <a class="w-headline-link" href="#file-handling">#</a></h2>
<p>When I say &quot;the web has become good enough&quot;, it's because of features like the upcoming File
Handling.</p>
<p>This is a regular macOS Big Sur installation. Now check out what happens when I right-click an
Excalidraw file. I can choose to open it with Excalidraw, the installed PWA. Of course
double-clicking would work, too, it's just less dramatic to demonstrate in a screencast.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/Gz1w0Gey1XerN86sIF01.mp4" type="video/mp4" />    </video></p>
<p>So how does this work? The first step is to make the file types my application can handle known to
the operating system. I do this in a new field called <code>file_handlers</code> in the web app manifest. Its
value is an array of objects with an action and an <code>accept</code> property. The action determines the URL
path the operating system launches your app at and the accept object are key value pairs of MIME
types and the associated file extensions.</p>
<web-copy-code><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Excalidraw"</span><span class="token punctuation">,</span><br>  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Excalidraw is a whiteboard tool..."</span><span class="token punctuation">,</span><br>  <span class="token property">"start_url"</span><span class="token operator">:</span> <span class="token string">"/"</span><span class="token punctuation">,</span><br>  <span class="token property">"display"</span><span class="token operator">:</span> <span class="token string">"standalone"</span><span class="token punctuation">,</span><br>  <span class="token property">"theme_color"</span><span class="token operator">:</span> <span class="token string">"#000000"</span><span class="token punctuation">,</span><br>  <span class="token property">"background_color"</span><span class="token operator">:</span> <span class="token string">"#ffffff"</span><span class="token punctuation">,</span><br>  <span class="token property">"file_handlers"</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>    <span class="token punctuation">{</span><br>      <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"/"</span><span class="token punctuation">,</span><br>      <span class="token property">"accept"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token property">"application/vnd.excalidraw+json"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".excalidraw"</span><span class="token punctuation">]</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">]</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>The next step is to handle the file when the application launches. This happens in the <code>launchQueue</code>
interface where I need to set a consumer by calling, well, <code>setConsumer()</code>. The parameter to this
function is an asynchronous function that receives the <code>launchParams</code>. This <code>launchParams</code> object
has a field called files that gets me an array of file handles to work with. I only care for the
first one and from this file handle I get a blob that I then pass to our old friend
<code>loadFromBlob()</code>.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'launchQueue'</span> <span class="token keyword">in</span> window <span class="token operator">&amp;&amp;</span> <span class="token string">'LaunchParams'</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  window <span class="token keyword">as</span> any<span class="token punctuation">.</span>launchQueue<br>    <span class="token punctuation">.</span><span class="token function">setConsumer</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">launchParams<span class="token operator">:</span> <span class="token punctuation">{</span> files<span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>launchParams<span class="token punctuation">.</span>files<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> fileHandle <span class="token operator">=</span> launchParams<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> blob<span class="token operator">:</span> Blob <span class="token operator">=</span> <span class="token keyword">await</span> fileHandle<span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      blob<span class="token punctuation">.</span>handle <span class="token operator">=</span> fileHandle<span class="token punctuation">;</span><br>      <span class="token function">loadFromBlob</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> elements<span class="token punctuation">,</span> appState <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span><br>        <span class="token comment">// Initialize app state.</span><br>      <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isLoading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> errorMessage<span class="token operator">:</span> error<span class="token punctuation">.</span>message <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>Again, if this went too fast, you can read more about the File Handling API in
<a href="/file-handling/">my article</a>. You can enable file handling by setting the experimental web platform
features flag. It's scheduled to land in Chrome later this year.</p>
<h2 id="clipboard-integration">Clipboard integration <a class="w-headline-link" href="#clipboard-integration">#</a></h2>
<p>Another cool feature of Excalidraw is the clipboard integration. I can copy my entire drawing or
just parts of it into the clipboard, maybe adding a watermark if I feel like, and then paste it into
another app. This is a web version of the Windows 95 Paint app by the way.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/EHHQS78y6RJf21J1wD7y.mp4" type="video/mp4" />    </video></p>
<p>The way this works is surprisingly simple. All I need is the canvas as a blob, which I then write
onto the clipboard by passing a one-element array with a <code>ClipboardItem</code> with the blob to the
<code>navigator.clipboard.write()</code> function. For more information on what you can do with the clipboard
API, See Jason's and <a href="/async-clipboard/">my article</a>.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">copyCanvasToClipboardAsPng</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">canvas<span class="token operator">:</span> HTMLCanvasElement</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">canvasToBlob</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><br>    <span class="token keyword">new</span> <span class="token class-name">window<span class="token punctuation">.</span>ClipboardItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>      <span class="token string">'image/png'</span><span class="token operator">:</span> blob<span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">const</span> canvasToBlob <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>canvas<span class="token operator">:</span> HTMLCanvasElement<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>Blob<span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>      canvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>blob<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CanvasError</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'canvasError.canvasTooBig'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'CANVAS_POSSIBLY_TOO_BIG'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token function">resolve</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><h2 id="collaborating-with-others">Collaborating with others <a class="w-headline-link" href="#collaborating-with-others">#</a></h2>
<h3 id="sharing-a-session-url">Sharing a session URL <a class="w-headline-link" href="#sharing-a-session-url">#</a></h3>
<p>Did you know that Excalidraw also has a collaborative mode? Different people can work together on
the same document. To start a new session, I click on the live collaboration button and then start a
session. I can share the session URL with my collaborators easily thanks to the
<a href="/web-share/">Web Share API</a> that Excalidraw has integrated.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/7tbl5j0jrVZd3ffxhpoX.mp4" type="video/mp4" />    </video></p>
<h3 id="live-collaboration">Live collaboration <a class="w-headline-link" href="#live-collaboration">#</a></h3>
<p>I have simulated a collaboration session locally by working on the Google I/O logo on my Pixelbook,
my Pixel 3a phone, and my iPad Pro. You can see that changes I make on one device are reflected on
all other devices.</p>
<p>I can even see all cursors move around. The Pixelbook's cursor moves steadily, since it's controlled
by a trackpad, but the Pixel 3a phone's cursor and the iPad Pro's tablet cursor jump around, since I
control these devices by tapping with my finger.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/7muh13F0CjvKBntVrUTp.mp4" type="video/mp4" />    </video></p>
<h3 id="seeing-collaborator-statuses">Seeing collaborator statuses <a class="w-headline-link" href="#seeing-collaborator-statuses">#</a></h3>
<p>To improve the realtime collaboration experience, there is even an idle detection system running.
The cursor of the iPad Pro shows a green dot when I use it. The dot turns black when I switch to a
different browser tab or app. And when I'm in the Excalidraw app, but just not doing anything, the
cursor shows me as idle, symbolized by the three zZZs.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/Y7vEI1qHTDJpHNdXjteS.mp4" type="video/mp4" />    </video></p>
<p>Avid readers of our publications might be inclined to think that idle detection is realized through
the <a href="/idle-detection/">Idle Detection API</a>, an early stage proposal that's been worked on in the
context of Project Fugu. Spoiler alert: it's not. While we had an implementation based on this API
in Excalidraw, in the end, we decided to go for a more traditional approach based on measuring
pointer movement and page visibility.</p>
<img     alt="Screenshot of the Idle Detection feedback filed on the WICG Idle Detection repo."          decoding="async"     height="685"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format"     srcset="https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/SudM7tqa3ZooUJYx7aBB.png?auto=format&w=1600 1600w"          width="800"   />
<p>We filed <a href="https://github.com/WICG/idle-detection/issues/36" rel="noopener">feedback</a> on why the Idle Detection API
wasn't solving the use case we had. All Project Fugu APIs are being developed in the open, so
everyone can chime in and have their voice heard!</p>
<h2 id="lipis-on-what-is-holding-back-excalidraw">Lipis on what is holding back Excalidraw <a class="w-headline-link" href="#lipis-on-what-is-holding-back-excalidraw">#</a></h2>
<p>Talking of which, I asked lipis one last question regarding what he thinks is missing from the web
platform that holds back Excalidraw:</p>
<blockquote>
<p>The File System Access API is great, but you know what? Most files that I care about these days
live in my Dropbox or Google Drive, not on my hard disk. I wish the File System Access API would
include an abstraction layer for remote file systems providers like Dropbox or Google to integrate
with and that developers could code against. Users could then relax and know their files are safe
with the cloud provider they trust.</p>
</blockquote>
<p>I fully agree with lipis, I live in the cloud, too. Here's hoping that this will be implemented
soon.</p>
<h2 id="tabbed-application-mode">Tabbed application mode <a class="w-headline-link" href="#tabbed-application-mode">#</a></h2>
<p>Wow! We have seen a lot of really great API integrations in Excalidraw.
<a href="/file-system-access/">File system</a>, <a href="/file-handling/">file handling</a>,
<a href="%5Casync-clipboard/">clipboard</a>, <a href="%5Cweb-share/">web share</a>, and
<a href="/web-share-target/">web share target</a>. But here is one more thing. Up until now, I could only ever
edit one document at a given time. Not anymore. Please enjoy for the first time an early version of
tabbed application mode in Excalidraw. This is how it looks.</p>
<p><video      autoplay                                          loop      muted      playsinline                      >      <source src="https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/h8zrwaB8jBXVnQuxglpS.mp4" type="video/mp4" />    </video></p>
<p>I have an existing file open in the installed Excalidraw PWA that's running in standalone mode. Now
I open a new tab in the standalone window. This is not a regular browser tab, but a PWA tab. In this
new tab I can then open a secondary file, and work on them independently from the same app window.</p>
<p>Tabbed application mode is in its early stages and not everything is set in stone. If you're
interested, be sure to read up on the current status of this feature in
<a href="/tabbed-application-mode/">my article</a>.</p>
<h2 id="closing">Closing <a class="w-headline-link" href="#closing">#</a></h2>
<p>To stay in the loop on this and other features, be sure to watch our
<a href="https://fugu-tracker.web.app/" rel="noopener">Fugu API tracker</a>. We're super excited to push the web forward and
allow you to do more on the platform. Here's to an ever improving Excalidraw, and here's to all the
amazing applications that you will build. Go start creating at
<a href="https://excalidraw.com/" rel="noopener">excalidraw.com</a>.</p>
<p>I can't wait to see some of the APIs that I have shown today pop up in your apps. My name is Tom,
you can find me as <a href="https://twitter.com/tomayac" rel="noopener">@tomayac</a> on Twitter and the internet in general.
Thank you very much for watching, and enjoy the rest of Google I/O.</p>


    

    
  <div class="w-chips ">
    
      
    
      
    
      
        
        <a class="w-chip" href="/tags/capabilities/">Capabilities</a>
      
    
  </div>


    <div class="w-post-github-link w-mt--l w-mb--l">
      <span class="w-mr--sm">
        
        Last updated: <time>May 19, 2021</time>
        
      </span>
      <a
        href="https://github.com/GoogleChrome/web.dev/blob/master/src/site/content/en/blog/excalidraw-and-fugu/index.md"
      >
        Improve article
      </a>
       
    </div>

    
    <web-feedback additional-questions=""></web-feedback>
  </div>

  
    
    <nav class="w-article-navigation">
  <a
    class="w-article-navigation__link w-article-navigation__link--back
      w-article-navigation__link--single gc-analytics-event"
    data-category="web.dev"
    data-label="navigation, go back"
    data-action="click"
    href="/blog"
  >
    Return to all articles
  </a>
</nav>
  
</div>

  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://devwebfeed.appspot.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">
              DevWeb Content Firehose
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/@ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/home"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
