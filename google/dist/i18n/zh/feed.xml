<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>web.dev</title>
  <subtitle>Let&#39;s build the future of the web.</subtitle>
  <link href="https://web.dev/feed.xml" rel="self"/>
  <link href="https://web.dev"/>
  <updated>2021-08-05T09:57:24Z</updated>
  <id>https://web.dev/</id>
  <author>
    <name>Google Developers</name>
  </author>
  <icon>https://web.dev/images/social.png</icon>
  <logo>https://web.dev/images/shared/rss-banner.png</logo>
  
    
    
    <entry>
      <title>User preference media features client hints headers</title>
      <link href="https://web.dev/user-preference-media-features-headers/"/>
      <updated>2021-08-02T00:00:00Z</updated>
      <id>https://web.dev/user-preference-media-features-headers/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;CSS media queries, and specifically
&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#mf-user-preferences&quot; rel=&quot;noopener&quot;&gt;user preference media features&lt;/a&gt; like
&lt;a href=&quot;https://web.dev/prefers-color-scheme/&quot;&gt;&lt;code&gt;prefers-color-scheme&lt;/code&gt;&lt;/a&gt; or
&lt;a href=&quot;https://web.dev/prefers-reduced-motion/&quot;&gt;&lt;code&gt;prefers-reduced-motion&lt;/code&gt;&lt;/a&gt;, have a potentially
&lt;a href=&quot;https://webkit.org/blog/8892/dark-mode-in-web-inspector/#:~:text=Implementing%20Dark%20Mode%20took%20over%201%2C000%20lines%20of%20CSS.&quot; rel=&quot;noopener&quot;&gt;significant impact&lt;/a&gt;
on the amount of CSS that needs to be delivered by a page, and on the experience the user is going
to have when the page loads.&lt;/p&gt;
&lt;p&gt;Focusing on &lt;code&gt;prefers-color-scheme&lt;/code&gt;—but highlighting that the reasoning applies to other user
preference media features as well—it is a best practice to not load CSS for the particular
non-matching color scheme in the critical rendering path, and instead to initially only load the
currently relevant CSS. One way of doing so is
&lt;a href=&quot;https://web.dev/prefers-color-scheme/#loading-strategy&quot;&gt;via &lt;code&gt;&amp;lt;link media&amp;gt;&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;However, high-traffic sites like &lt;a href=&quot;https://www.google.com/&quot; rel=&quot;noopener&quot;&gt;Google Search&lt;/a&gt; that wish to honor user
preference media features like &lt;code&gt;prefers-color-scheme&lt;/code&gt; and that inline CSS for performance reasons,
need to know about the preferred color scheme (or other user preference media features respectively)
ideally at request time, so that the initial HTML payload already has the right CSS inlined.&lt;/p&gt;
&lt;p&gt;Additionally, and specifically for &lt;code&gt;prefers-color-scheme&lt;/code&gt;, sites by all means want to avoid a
&lt;a href=&quot;https://css-tricks.com/flash-of-inaccurate-color-theme-fart/&quot; rel=&quot;noopener&quot;&gt;flash of inaccurate color theme&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt; client hint header is the first of a
&lt;a href=&quot;https://wicg.github.io/user-preference-media-features-headers/&quot; rel=&quot;noopener&quot;&gt;series of user preference media features client hints headers&lt;/a&gt;
that aims to solve this issue.&lt;/p&gt;
&lt;h3 id=&quot;background-on-client-hints&quot;&gt;Background on client hints &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#background-on-client-hints&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc8942&quot; rel=&quot;noopener&quot;&gt;HTTP Client Hints&lt;/a&gt; defines an &lt;code&gt;Accept-CH&lt;/code&gt; response
header that servers can use to advertise their use of request headers for proactive content
negotiation, colloquially referred to as client hints. The
&lt;a href=&quot;https://wicg.github.io/user-preference-media-features-headers/&quot; rel=&quot;noopener&quot;&gt;User Preference Media Features Client Hints Headers&lt;/a&gt;
proposal defines a set of client hints aimed at conveying user preference media features. These
client hints are named after the corresponding user preference media feature that they report on.
For example, the currently preferred color scheme as per &lt;code&gt;prefers-color-scheme&lt;/code&gt; is reported via the
aptly named &lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt; client hint.&lt;/p&gt;
&lt;h3 id=&quot;background-on-critical-client-hints&quot;&gt;Background on critical client hints &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#background-on-critical-client-hints&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The client hints proposed in
&lt;a href=&quot;https://wicg.github.io/user-preference-media-features-headers/&quot; rel=&quot;noopener&quot;&gt;User Preference Media Features Client Hints Headers&lt;/a&gt;
will presumably most commonly be used as
&lt;a href=&quot;https://tools.ietf.org/html/draft-davidben-http-client-hint-reliability-02&quot; rel=&quot;noopener&quot;&gt;Critical Client Hints&lt;/a&gt;.
Critical Client Hints are Client Hints which meaningfully change the resulting resource. Such a
resource should be fetched consistently across page loads (including the &lt;em&gt;initial&lt;/em&gt; page load) to
avoid jarring user-visible switches.&lt;/p&gt;
&lt;h3 id=&quot;client-hint-syntax&quot;&gt;Client hint syntax &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#client-hint-syntax&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;User preference media features consist of a name (like &lt;code&gt;prefers-reduced-motion&lt;/code&gt;) and allowed values
(like &lt;code&gt;no-preference&lt;/code&gt; or &lt;code&gt;reduce&lt;/code&gt;. Each client hint header field is represented as
&lt;a href=&quot;https://tools.ietf.org/html/draft-ietf-httpbis-header-structure-15&quot; rel=&quot;noopener&quot;&gt;Structured Headers for HTTP&lt;/a&gt;
object containing an
&lt;a href=&quot;https://tools.ietf.org/html/draft-ietf-httpbis-header-structure-15#section-3.3&quot; rel=&quot;noopener&quot;&gt;item&lt;/a&gt; whose value
is a &lt;a href=&quot;https://tools.ietf.org/html/draft-ietf-httpbis-header-structure-15#section-3.3.3&quot; rel=&quot;noopener&quot;&gt;string&lt;/a&gt;. For
example, to convey that the user prefers a dark theme and reduced motion, the client hints look like
in the example below.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;GET / HTTP/2&lt;br /&gt;Host: example.com&lt;br /&gt;Sec-CH-Prefers-Color-Scheme: &lt;span class=&quot;token string&quot;&gt;&quot;dark&quot;&lt;/span&gt;&lt;br /&gt;Sec-CH-Prefers-Reduced-Motion: &lt;span class=&quot;token string&quot;&gt;&quot;reduce&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The CSS equivalent of the information conveyed in the above client hints is
&lt;code&gt;@media (prefers-color-scheme: dark) {}&lt;/code&gt; and &lt;code&gt;@media (prefers-reduced-motion: reduce) {}&lt;/code&gt;
respectively.&lt;/p&gt;
&lt;h2 id=&quot;complete-list-of-the-client-hints&quot;&gt;Complete list of the client hints &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#complete-list-of-the-client-hints&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;While the
&lt;a href=&quot;https://wicg.github.io/user-preference-media-features-headers/&quot; rel=&quot;noopener&quot;&gt;User Preference Media Features Client Hints Headers&lt;/a&gt;
proposal defines a set of client hints, Chromium at the time of writing only supports
&lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt;. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The list of the client hints is modeled after the
&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#mf-user-preferences&quot; rel=&quot;noopener&quot;&gt;user preference media features&lt;/a&gt; in
&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#descdef-media-prefers-color-scheme&quot; rel=&quot;noopener&quot;&gt;Media Queries Level 5&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Client Hint&lt;/th&gt;
&lt;th&gt;Allowed Values&lt;/th&gt;
&lt;th&gt;Corresponding User Preference Media Feature&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Sec-CH-Prefers-Reduced-Motion&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-motion-no-preference&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;no-preference&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-motion-reduce&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;reduce&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#prefers-reduced-motion&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;prefers-reduced-motion&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Sec-CH-Prefers-Reduced-Transparency&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-transparency-no-preference&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;no-preference&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-transparency-reduce&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;reduce&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#prefers-reduced-transparency&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;prefers-reduced-transparency&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Sec-CH-Prefers-Contrast&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-contrast-no-preference&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;no-preference&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-contrast-less&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;less&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-contrast-more&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;more&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-contrast-custom&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;custom&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#prefers-contrast&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;prefers-contrast&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Sec-CH-Forced-Colors&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-forced-colors-active&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;active&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-forced-colors-none&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;none&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#forced-colors&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;forced-colors&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-color-scheme-light&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;light&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-color-scheme-dark&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;dark&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#prefers-color-scheme&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;prefers-color-scheme&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;Sec-CH-Prefers-Reduced-Data&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-data-no-preference&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;no-preference&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-data-reduce&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;reduce&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#prefers-reduced-data&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;prefers-reduced-data&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;h2 id=&quot;browser-support&quot;&gt;Browser support &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#browser-support&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt; client hint header is supported on Chromium 93.
Other vendors&#39; feedback, namely &lt;a href=&quot;https://lists.webkit.org/pipermail/webkit-dev/2021-May/031856.html&quot; rel=&quot;noopener&quot;&gt;WebKit&#39;s&lt;/a&gt;
and &lt;a href=&quot;https://github.com/mozilla/standards-positions/issues/526&quot; rel=&quot;noopener&quot;&gt;Mozilla&#39;s&lt;/a&gt;, is pending.&lt;/p&gt;
&lt;h2 id=&quot;demo-of-sec-ch-prefers-color-scheme&quot;&gt;Demo of &lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#demo-of-sec-ch-prefers-color-scheme&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Try the &lt;a href=&quot;https://sec-ch-prefers-color-scheme.glitch.me/&quot; rel=&quot;noopener&quot;&gt;demo&lt;/a&gt; in Chromium 93 and notice how
the inlined CSS changes according to the user&#39;s preferred color scheme.&lt;/p&gt;
&lt;img alt=&quot;Sec-CH-Prefers-Color-Scheme: dark&quot; decoding=&quot;async&quot; height=&quot;541&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/pKAKyrN18CjhAYUNpJyk.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;img alt=&quot;Sec-CH-Prefers-Color-Scheme: light&quot; decoding=&quot;async&quot; height=&quot;541&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/6Xujcgyveo0QY0E3LQOF.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;how-it-works&quot;&gt;How it works &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#how-it-works&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;The client makes an initial request to the server.&lt;div&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;GET / HTTP/2&lt;br /&gt;Host: example.com&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;The server responds, telling the client via &lt;code&gt;Accept-CH&lt;/code&gt; that it accepts the
&lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt; and the &lt;code&gt;Sec-CH-Prefers-Contrast&lt;/code&gt; Client Hints, out of which as per
&lt;code&gt;Critical-CH&lt;/code&gt; it considers &lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt; a Critical Client Hint that it also
varies the response on as conveyed by &lt;code&gt;Vary&lt;/code&gt;.&lt;div&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;HTTP/2 &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt; OK&lt;br /&gt;Content-Type: text/html&lt;br /&gt;Accept-CH: Sec-CH-Prefers-Color-Scheme, Sec-CH-Prefers-Contrast&lt;br /&gt;Vary: Sec-CH-Prefers-Color-Scheme&lt;br /&gt;Critical-CH: Sec-CH-Prefers-Color-Scheme&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;The client then retries the request, telling the server via &lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt; that it
has a user preference for dark-schemed content.&lt;div&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;GET / HTTP/2&lt;br /&gt;Host: example.com&lt;br /&gt;Sec-CH-Prefers-Color-Scheme: &lt;span class=&quot;token string&quot;&gt;&quot;dark&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;The server can then tailor the response to the client&#39;s preferences accordingly and, for example,
inline the CSS responsible for the dark theme into the response body.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;node.js-example&quot;&gt;Node.js example &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#node.js-example&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Node.js example below, written for the popular Express.js framework, shows how
dealing with the &lt;code&gt;Sec-CH-Prefers-Color-Scheme&lt;/code&gt; client hint header could look like in practice.
This code is what actually powers the &lt;a href=&quot;https://web.dev/user-preference-media-features-headers/#demo-of-sec-ch-prefers-color-scheme&quot;&gt;demo&lt;/a&gt; above.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;req&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; res&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Tell the client the server accepts the `Sec-CH-Prefers-Color-Scheme` client hint…&lt;/span&gt;&lt;br /&gt;  res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Accept-CH&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Sec-CH-Prefers-Color-Scheme&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// …and that the server&#39;s response will vary based on its value…&lt;/span&gt;&lt;br /&gt;  res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Vary&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Sec-CH-Prefers-Color-Scheme&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// …and that the server considers this client hint a _critical_ client hint.&lt;/span&gt;&lt;br /&gt;  res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Critical-CH&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Sec-CH-Prefers-Color-Scheme&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Read the user&#39;s preferred color scheme from the headers…&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; prefersColorScheme &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; req&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;sec-ch-prefers-color-scheme&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// …and send the adequate HTML response with the right CSS inlined.&lt;/span&gt;&lt;br /&gt;  res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getHTML&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prefersColorScheme&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;privacy-and-security-considerations&quot;&gt;Privacy and security considerations &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#privacy-and-security-considerations&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Chromium team has designed and implemented User Preference Media Features Client Hints Headers
using the core principles defined in &lt;a href=&quot;https://chromium.googlesource.com/chromium/src/+/lkgr/docs/security/permissions-for-powerful-web-platform-features.md&quot; rel=&quot;noopener&quot;&gt;Controlling Access to Powerful Web Platform
Features&lt;/a&gt;, including user control, transparency, and ergonomics.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc8942#section-4&quot; rel=&quot;noopener&quot;&gt;Security Considerations&lt;/a&gt; of HTTP
Client Hints and the
&lt;a href=&quot;https://tools.ietf.org/html/draft-davidben-http-client-hint-reliability-02#section-5&quot; rel=&quot;noopener&quot;&gt;Security Considerations&lt;/a&gt;
of Client Hint Reliability likewise apply to this proposal.&lt;/p&gt;
&lt;h2 id=&quot;references&quot;&gt;References &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#references&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://wicg.github.io/user-preference-media-features-headers/&quot; rel=&quot;noopener&quot;&gt;Spec draft&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/WICG/user-preference-media-features-headers#readme&quot; rel=&quot;noopener&quot;&gt;Explainer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://chromestatus.com/feature/5642300464037888&quot; rel=&quot;noopener&quot;&gt;Chrome Status entry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://crbug.com/1207897&quot; rel=&quot;noopener&quot;&gt;Chromium bug&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://lists.webkit.org/pipermail/webkit-dev/2021-May/031856.html&quot; rel=&quot;noopener&quot;&gt;WebKit thread&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/mozilla/standards-positions/issues/526&quot; rel=&quot;noopener&quot;&gt;Mozilla Standards Position&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc8942&quot; rel=&quot;noopener&quot;&gt;Client Hints&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tools.ietf.org/html/draft-davidben-http-client-hint-reliability-02&quot; rel=&quot;noopener&quot;&gt;Client Hint Reliability&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#descdef-media-prefers-color-scheme&quot; rel=&quot;noopener&quot;&gt;Media Queries Level 5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tools.ietf.org/html/draft-ietf-httpbis-header-structure-19&quot; rel=&quot;noopener&quot;&gt;Structured Headers for HTTP&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/user-preference-media-features-headers/#acknowledgements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Many thanks for valuable feedback and advice from
&lt;a href=&quot;https://github.com/yoavweiss&quot; rel=&quot;noopener&quot;&gt;Yoav Weiss&lt;/a&gt;.
Hero image by &lt;a href=&quot;https://commons.wikimedia.org/wiki/User:Tdadamemd&quot; rel=&quot;noopener&quot;&gt;Tdadamemd&lt;/a&gt; on
&lt;a href=&quot;https://commons.wikimedia.org/wiki/File:Sun%26Moon_apparent_sizes_(min-max_halved).jpg&quot; rel=&quot;noopener&quot;&gt;Wikimedia Commons&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Thomas Steiner</name>
        </author><author>
          <name>François Beaufort</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>2021 Scroll Survey Report</title>
      <link href="https://web.dev/2021-scroll-survey-report/"/>
      <updated>2021-08-02T00:00:00Z</updated>
      <id>https://web.dev/2021-scroll-survey-report/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;In April, the Chrome team &lt;a href=&quot;https://web.dev/2021-scroll-survey/&quot;&gt;released a scroll and touch-action
survey&lt;/a&gt; based on top reported issues from
the &lt;a href=&quot;https://mdn-web-dna.s3-us-west-2.amazonaws.com/MDN-Web-DNA-Report-2019.pdf&quot; rel=&quot;noopener&quot;&gt;2019 MDN Web DNA
Report&lt;/a&gt;.
The &lt;a href=&quot;https://storage.googleapis.com/web-dev-uploads/file/vS06HQ1YTsbMKSFTIPl2iogUQP73/QZopyELSk8T7IpsgOnRU.pdf&quot; rel=&quot;noopener&quot;&gt;2021 Scroll Survey
Report&lt;/a&gt;
is ready, and the Chrome team would like to share some thoughts and action items
we&#39;ve gleaned from the survey results. We hope these results will help browser
vendors and standards groups understand how to improve web scrolling.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;View the &lt;a href=&quot;https://storage.googleapis.com/web-dev-uploads/file/vS06HQ1YTsbMKSFTIPl2iogUQP73/QZopyELSk8T7IpsgOnRU.pdf&quot; rel=&quot;noopener&quot;&gt;2021 Scroll Survey
Report&lt;/a&gt;.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;noteworthy-results&quot;&gt;Noteworthy results &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#noteworthy-results&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The survey anonymously collected 880 submissions, with 366 answering every
question.&lt;/p&gt;
&lt;p&gt;While getting started with scrolling is one line of CSS, like &lt;code&gt;overflow-x: scroll;&lt;/code&gt;, the surface area of scroll APIs and options is large, spanning JavaScript to
CSS. The following results help to highlight the issues web developers are
encountering.&lt;/p&gt;
&lt;h3 id=&quot;overall-satisfaction-with-web-scrolling&quot;&gt;Overall satisfaction with web scrolling &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#overall-satisfaction-with-web-scrolling&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 27&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;45&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      are &lt;b&gt;somewhat&lt;/b&gt; or &lt;b&gt;extremely dissatisfied overall&lt;/b&gt; &lt;br /&gt;
      with &lt;b&gt;web scrolling&lt;/b&gt;.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;This question was placed near the end of the survey intentionally, after
questions on 26 scroll use cases and features. From the response, it&#39;s clear that
the web community struggles with scroll. Almost half of the respondents report a
level of overall dissatisfaction.&lt;/p&gt;
&lt;p&gt;We believe overall sentiment about working with scroll should not be this low.
This metric needs to be changed; it&#39;s a clear signal there&#39;s work to be done.&lt;/p&gt;
&lt;h3 id=&quot;difficulty-working-with-scroll&quot;&gt;Difficulty working with scroll &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#difficulty-working-with-scroll&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 2&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;43&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      reported it&#39;s &lt;b&gt;somewhat&lt;/b&gt; or &lt;br /&gt;
      &lt;b&gt;extremely difficult &lt;br /&gt;
      to  work with scrolling&lt;/b&gt;.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;From our research, these difficulties come from the multitude of use cases for
scroll. When we talk about scrolling, that might include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://elad.medium.com/css-position-sticky-how-it-really-works-54cd01dc2d46&quot; rel=&quot;noopener&quot;&gt;Positioning elements within scrollable areas&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.logrocket.com/infinite-scroll-techniques-in-react-adcfd7ff32bd/&quot; rel=&quot;noopener&quot;&gt;Infinite scroll&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://greensock.com/scrolltrigger/&quot; rel=&quot;noopener&quot;&gt;Scroll linked animation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://css-tricks.com/css-only-carousel/&quot; rel=&quot;noopener&quot;&gt;Carousels&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.alexandergottlieb.com/overflow-scroll-and-the-right-padding-problem-a-css-only-solution-6d442915b3f4&quot; rel=&quot;noopener&quot;&gt;Scrollview padding&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.magictoolbox.com/magicscroll/integration/&quot; rel=&quot;noopener&quot;&gt;Cyclical scroll&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/tbranyen/hyperlist&quot; rel=&quot;noopener&quot;&gt;Virtualized scroll&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Missing browser features,
complex JavaScript, and the need to support input modes including touch,
keyboard, and gamepads, make all of these things harder.&lt;/p&gt;
&lt;h3 id=&quot;importance-of-touch-interactions&quot;&gt;Importance of touch interactions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#importance-of-touch-interactions&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 3&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;51&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      report &lt;b&gt;touch interactions&lt;/b&gt; as &lt;br /&gt;
      &lt;b&gt;very&lt;/b&gt; or &lt;b&gt;extremely important&lt;/b&gt; &lt;br /&gt;
      to their work.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;With &lt;a href=&quot;https://twitter.com/TheRealNooshu/status/1399676709125906432?s=20&quot; rel=&quot;noopener&quot;&gt;mobile web users still on the rise in visit
statistics&lt;/a&gt;,
it wasn&#39;t surprising to see half of the respondents report that touch is very
important to their work on the web. This signaled that web features like CSS
scroll snap and &lt;code&gt;touch-action&lt;/code&gt; need extra attention so the web can deliver on
high-quality touch interaction.&lt;/p&gt;
&lt;h3 id=&quot;difficulty-of-tab-key-or-gamepad-navigation&quot;&gt;Difficulty of tab key or gamepad navigation &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#difficulty-of-tab-key-or-gamepad-navigation&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 5a&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;44&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      report &lt;b&gt;somewhat&lt;/b&gt; or &lt;b&gt;extremely difficult&lt;/b&gt; &lt;br /&gt;
      to do &lt;b&gt;gamepad&lt;/b&gt; and &lt;b&gt;tab navigation&lt;/b&gt;.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Scrolling includes navigation methods such as keyboard arrows, tab keys,
spacebar presses, and gamepads, and it can be difficult to include these when doing
custom scroll work. Almost half of the respondents report it&#39;s
somewhat or extremely difficult to include these inputs.&lt;/p&gt;
&lt;h3 id=&quot;learning-touch-action&quot;&gt;Learning &lt;code&gt;touch-action&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#learning-touch-action&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 9&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;50&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      report &lt;b&gt;learning&lt;/b&gt; about &lt;br /&gt;
      &lt;b&gt;`touch-action: manipulation`&lt;/b&gt; &lt;br /&gt;
      from the survey.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Some of the survey questions asked about using certain APIs with a possible
answer of Yes, No, or &amp;quot;today I learned.&amp;quot; One notable piece of feedback was the
number of people who reported learning about &lt;code&gt;touch-action&lt;/code&gt; from the survey, as
it&#39;s a critical property when building custom touch gestures that need to
interact within scroll.&lt;/p&gt;
&lt;h3 id=&quot;cyclical-scrolling&quot;&gt;Cyclical scrolling &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#cyclical-scrolling&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 27&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;58&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      report &lt;b&gt;sometimes, often&lt;/b&gt; or on &lt;b&gt;every project&lt;/b&gt; &lt;br /&gt;
      using &lt;b&gt;cyclical scrolling&lt;/b&gt;.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; width=&quot;380&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/xLwqQ6xGBIdI0uxFx566.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    The video shows cyclical seconds scrolling, &lt;br /&gt;
    after 60 seconds it begins at 0 again.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Those numbers are high for a scrolling feature with little or no support provided by the web platform.
The feature often incurs high amounts of technical
debt because of this, with duplication or JavaScript injected to force the
effect. It&#39;s popular for product carousels and when selecting time in seconds or minutes to
offer cyclical scrolling.&lt;/p&gt;
&lt;h3 id=&quot;are-scrollable-areas-important&quot;&gt;Are scrollable areas important &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#are-scrollable-areas-important&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 2&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;55&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      &lt;b&gt;very&lt;/b&gt; or &lt;br /&gt;
      &lt;b&gt;extremely important&lt;/b&gt;
    &lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;16&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      report &lt;b&gt;not at all&lt;/b&gt; &lt;br /&gt;
      or &lt;b&gt;slightly important&lt;/b&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Respondents felt strongly about the importance of scrollable areas,
giving another signal about the struggles required to deliver high-quality scrolling.&lt;/p&gt;
&lt;h3 id=&quot;carousels&quot;&gt;Carousels &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#carousels&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 20&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;87&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      &lt;b&gt;have used&lt;/b&gt; carousels.
    &lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;24&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      report they&#39;re &lt;br /&gt;
      &lt;b&gt;easy&lt;/b&gt; to manage.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Nearly every respondent delivers carousels in their web work, while only 25% find
them easy to manage. Off-the-shelf carousels were popular during our
research, but this statistic surprised us, as it doesn&#39;t sound very solved.&lt;/p&gt;
&lt;h3 id=&quot;infinite-scroll&quot;&gt;Infinite scroll &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#infinite-scroll&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 22&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;65&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      use it &lt;b&gt;sometimes&lt;/b&gt; &lt;br /&gt;
      to &lt;b&gt;every project&lt;/b&gt;
    &lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;60&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      &lt;b&gt;somewhat&lt;/b&gt; or &lt;br /&gt;
      &lt;b&gt;extremely difficult&lt;/b&gt;.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Two-thirds of respondents deliver infinite scroll in their web work, and an equal
amount report it&#39;s difficult to do. Another example of high usage paired with
high difficulty, which indicates to us an area needing attention.&lt;/p&gt;
&lt;p&gt;While &lt;a href=&quot;https://web.dev/content-visibility/&quot;&gt;&lt;code&gt;content-visibility&lt;/code&gt;&lt;/a&gt; and
&lt;code&gt;contain-intrinsic-size&lt;/code&gt; can be combined to reduce render costs for long
scrollable areas, it doesn&#39;t seem to be helping with &amp;quot;load more&amp;quot; infinite scroll
UX.&lt;/p&gt;
&lt;h3 id=&quot;scroll-linked-or-scroll-triggered-animations&quot;&gt;Scroll-linked or scroll-triggered animations &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#scroll-linked-or-scroll-triggered-animations&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 24&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;47&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      use it &lt;b&gt;sometimes&lt;/b&gt;&lt;br /&gt;
      to &lt;b&gt;every project&lt;/b&gt;
    &lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;56&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      report &lt;b&gt;somewhat&lt;/b&gt; or &lt;br /&gt;
      &lt;b&gt;extremely difficult&lt;/b&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Almost half of all respondents use scroll-orchestrated animations and half the
respondents find it difficult, once again linking high usage with difficulty.&lt;/p&gt;
&lt;h3 id=&quot;compete-with-built-in-scrolling&quot;&gt;Compete with built-in scrolling &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#compete-with-built-in-scrolling&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 26&lt;/small&gt;&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;32&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      &lt;b&gt;always&lt;/b&gt; or &lt;br /&gt;
      &lt;b&gt;most of the time&lt;/b&gt;
    &lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;50&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;
      &lt;b&gt;sometimes&lt;/b&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;The built-in scroll and touch interactions of phone and tablet applications are
often touted as a clear place where the web can catch up. The features include
scroll-linked animations, programmatic interfaces, voice integration, scroll
hints, and pull-to-refresh APIs.&lt;/p&gt;
&lt;p&gt;Just half of the respondents felt it was only sometimes possible to match the
experience of built-in scrolling.&lt;/p&gt;
&lt;h3 id=&quot;overall-satisfaction-building-scroll-interactions-on-the-web&quot;&gt;Overall satisfaction building scroll interactions on the web &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#overall-satisfaction-building-scroll-interactions-on-the-web&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;small&gt;Question 27&lt;/small&gt;&lt;/p&gt;
&lt;img alt=&quot;A pie chart showing 5 sections: 6.3% extremely dissatisfied, 2.7% extremely satisfied, 23.4% somewhat satisfied, 28.8% neither satisfied nor dissatisfied, 38.7% somewhat dissatisfied.&quot; decoding=&quot;async&quot; height=&quot;400&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/ycHj33nZb1KfUFxNBdH5.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;survey-takeaways&quot;&gt;Survey Takeaways &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#survey-takeaways&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The survey results are segmented into four categories:
&lt;a href=&quot;https://web.dev/2021-scroll-survey-report/#compatibility&quot;&gt;compatibility&lt;/a&gt;,
&lt;a href=&quot;https://web.dev/2021-scroll-survey-report/#education&quot;&gt;education&lt;/a&gt;,
&lt;a href=&quot;https://web.dev/2021-scroll-survey-report/#apis&quot;&gt;APIs&lt;/a&gt;,
and &lt;a href=&quot;https://web.dev/2021-scroll-survey-report/#features&quot;&gt;features&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;compatibility&quot;&gt;Compatibility &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#compatibility&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The Chrome team has &lt;a href=&quot;https://web.dev/compat2021&quot;&gt;declared a goal&lt;/a&gt; to decrease
the number of web compatibility issues, including scroll compatibility.&lt;/p&gt;
&lt;p&gt;The first three compatibility issues to focus on:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Horizontal scrolling compatibility.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;overscroll-behavior&lt;/code&gt; cross browser.&lt;/li&gt;
&lt;li&gt;Removing prefixes from &lt;code&gt;-webkit-scrollbar&lt;/code&gt; and following the standard.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;education&quot;&gt;Education &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#education&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The survey results showed that there needs to be more education around
&lt;code&gt;touch-action&lt;/code&gt; and &lt;a href=&quot;https://web.dev/logical-property-shorthands/&quot;&gt;logical
properties&lt;/a&gt;. The browser is at the
forefront of international layout, and it&#39;s apparent it&#39;s underutilized or
misunderstood.&lt;/p&gt;
&lt;p&gt;Areas to focus on:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;touch-action&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://web.dev/learn/css/logical-properties/&quot;&gt;Logical properties&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;apis&quot;&gt;APIs &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#apis&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Usage of scroll snapping is growing, and developers have responded that they
want to use features interoperably with popular libraries and
plugins. Shrinking this gap between CSS and plugin libraries will help the
satisfaction of scroll snap developer and user experience.&lt;/p&gt;
&lt;p&gt;We&#39;ll focus API work on &lt;code&gt;scroll-snap&lt;/code&gt;:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;API availability and compatibility across browsers.&lt;/li&gt;
&lt;li&gt;Begin work on &lt;a href=&quot;https://github.com/argyleink/ScrollSnapExplainers&quot; rel=&quot;noopener&quot;&gt;new CSS
APIs&lt;/a&gt; like &lt;code&gt;scroll-start&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Begin work on &lt;a href=&quot;https://github.com/argyleink/ScrollSnapExplainers&quot; rel=&quot;noopener&quot;&gt;new JS
events&lt;/a&gt; like
&lt;code&gt;snapChanged()&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;features&quot;&gt;Features &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#features&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The survey results showed that users struggle with some specific types of
scroll-related components on the web, as the platform doesn&#39;t provide the
primitives they need to build them without plugins or a high level of effort.
This is an area that we hope to explore more deeply.&lt;/p&gt;
&lt;p&gt;The features developers struggle to build include:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Carousels&lt;/li&gt;
&lt;li&gt;Virtual scroll&lt;/li&gt;
&lt;li&gt;Infinite scroll&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;resources&quot;&gt;Resources &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/2021-scroll-survey-report/#resources&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://drive.google.com/file/d/10WXTJHCZmH0rXEh3J7z3ki96-f9SHs_R/view?usp=sharing&amp;amp;resourcekey=0-5b1y_6rZDhyt6Tkbz3FCzA&quot; rel=&quot;noopener&quot;&gt;Scroll Survey
Report&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://web.dev/2021-scroll-survey/&quot;&gt;Survey Announcement&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://insights.developer.mozilla.org/&quot; rel=&quot;noopener&quot;&gt;Mozilla DNA Reports&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://web.dev/compat2021/&quot;&gt;Compat2021: Eliminating five top compatibility pain points on the
web&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://groups.google.com/a/google.com/g/blink-interactions-team/search?q=Igalia%20work%20update&quot; rel=&quot;noopener&quot;&gt;2020-2021 Scroll Compatibility Igalia
Work&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Thumbnail image: photo by &lt;a href=&quot;https://unsplash.com/@taypaigey&quot; rel=&quot;noopener&quot;&gt;Taylor Wilcox&lt;/a&gt; on &lt;a href=&quot;https://unsplash.com/photos/aXeVH4FcS1k&quot; rel=&quot;noopener&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Adam Argyle</name>
        </author><author>
          <name>Sam Dutton</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Best practices for tags and tag managers</title>
      <link href="https://web.dev/tag-best-practices/"/>
      <updated>2021-07-29T00:00:00Z</updated>
      <id>https://web.dev/tag-best-practices/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;&lt;a href=&quot;https://support.google.com/tagmanager/answer/3281060?hl=en&quot; rel=&quot;noopener&quot;&gt;Tags&lt;/a&gt; are snippets
of third-party code that are inserted into a site, typically via a tag manager.
Tags are most commonly used for marketing and analytics.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Although tags and third-party scripts are often fundamentally the exact same
thing, the separate terminology reflects the different ways that these scripts
are used: &amp;quot;tags&amp;quot; are typically owned by marketing departments and added via tag
managers; whereas &amp;quot;third-party scripts&amp;quot; more commonly refer to resources added
through code changes made by engineering departments.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The performance impact of tags and tag managers varies wildly from site to site.
Tag managers can be compared to an envelope: the tag manager provides a
vessel—but what you fill it with and how you use it is mostly up to you.&lt;/p&gt;
&lt;p&gt;This article discusses techniques for optimizing tags and tag managers for
performance and Web Vitals. Although this article references Google Tag Manager,
many of the ideas discussed are also applicable to other tag managers.&lt;/p&gt;
&lt;h2 id=&quot;tag-types&quot;&gt;Tag types &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#tag-types&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The impact of tags on performance varies by tag type. Generally speaking, image
tags (&amp;quot;pixels&amp;quot;) are the most performant, followed by custom templates, and
lastly, custom HTML tags.&lt;/p&gt;
&lt;p&gt;However, keep in mind that how you use a tag greatly influences its performance
impact. &amp;quot;Pixels&amp;quot; are highly performant largely because the nature of this tag
type imposes tight restrictions on how they can be used; custom HTML tags aren&#39;t
necessarily always bad for performance, but due to the level of freedom they
offer users, they can be easy to misuse in a way that is bad for performance.&lt;/p&gt;
&lt;p&gt;When thinking about tags, keep scale in mind: the performance impact of any
single tag may be negligible—but can become significant when tens or hundreds of
tags are used on the same page.&lt;/p&gt;
&lt;h3 id=&quot;not-all-scripts-should-be-loaded-using-a-tag-manager&quot;&gt;Not all scripts should be loaded using a tag manager &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#not-all-scripts-should-be-loaded-using-a-tag-manager&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Tag managers are typically not a good mechanism for loading resources that
implement immediate visual or functional aspects of the user experience—for
example, cookie notices, hero images, or site features. Using a tag manager to
load these resources typically delays their delivery. This is bad for the user
experience and can also increase metrics like LCP and CLS.  In addition, keep in
mind that some users block tag managers. Using a tag manager to implement UX
features may result in a broken website for some of your users.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Resources requested via tag manager will typically load later than resources
requested directly. This is not always a bad thing. If a tag manager is
primarily used to deliver non-essential resources, this delay can be used
constructively by providing a mechanism for delaying non-essential requests.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;be-careful-with-custom-html-tags&quot;&gt;Be careful with Custom HTML tags &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#be-careful-with-custom-html-tags&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://support.google.com/tagmanager/answer/6107167/custom-tags?hl=en#CustomHTML&quot; rel=&quot;noopener&quot;&gt;Custom HTML
tags&lt;/a&gt;
have been around for many years and are heavily used on most sites. Custom HTML
tags allow you to enter your own code with few restrictions. As a result, Custom
HTML tags can be used in a wide variety of ways and their performance impact
varies significantly. When measuring the performance of your site, be aware that
most tools will attribute the performance impact of a Custom HTML tag to the tag
manager that injected it—rather than the tag itself.&lt;/p&gt;
&lt;img alt=&quot;Screenshot of creating a custom tag in Google Tag Manager&quot; class=&quot;screenshot&quot; decoding=&quot;async&quot; height=&quot;470&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/cjLFJStmZvkQkr4DYPlk.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Custom HTML tags work by inserting an element into the surrounding page. The act
of inserting elements into the page can be a source of performance issues, and
in some cases, also cause layout shifts.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;In most situations, if an element is inserted into the page, the browser
must recalculate the size and position of each item on the page—this process
is known as
&lt;a href=&quot;https://developers.google.com/web/updates/2018/09/inside-browser-part3#layout&quot; rel=&quot;noopener&quot;&gt;layout&lt;/a&gt;.
The performance impact of a single layout is minimal, but when it occurs
excessively it can become a source of performance issues. The impact of this
phenomenon is larger on lower-end devices and pages with a high number of
DOM elements.&lt;/li&gt;
&lt;li&gt;If a visible page element is inserted into the DOM after the surrounding
area has already been rendered, it can cause a layout shift. This phenomenon
is not unique to tag managers—however, because tags typically load later
than other parts of the page, it&#39;s common for them to be inserted into the
DOM after the surrounding page has already been rendered.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;If you&#39;re adding or changing visible content on a page, keep in mind that search
engines will need to be able to fetch and process the JavaScript used. For
Google, you can &lt;a href=&quot;https://developers.google.com/search/docs/advanced/javascript/dynamic-rendering#verify&quot; rel=&quot;noopener&quot;&gt;verify rendering of a
page&lt;/a&gt;
for Search; other search engines may have similar testing tools available.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;consider-using-custom-templates&quot;&gt;Consider using Custom Templates &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#consider-using-custom-templates&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://developers.google.com/tag-manager/templates&quot; rel=&quot;noopener&quot;&gt;Custom templates&lt;/a&gt; support
some of the same operations as Custom HTML tags but are built upon a sandboxed
version of JavaScript that provides
&lt;a href=&quot;https://developers.google.com/tag-manager/templates/api&quot; rel=&quot;noopener&quot;&gt;APIs&lt;/a&gt; for common use
cases like script injection and pixel injection. Due to the greater restrictions
imposed on custom templates, these tags are much less likely to exhibit
performance or security issues; however, for these same reasons, custom
templates will not work for all use cases.&lt;/p&gt;
&lt;img alt=&quot;Screenshot of using a custom template in Google Tag Manager&quot; class=&quot;screenshot&quot; decoding=&quot;async&quot; height=&quot;388&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QRz6pn83YE6plVivynA7.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;inject-scripts-correctly&quot;&gt;Inject scripts correctly &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#inject-scripts-correctly&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Using a tag manager to inject a script is a very common use case. The
recommended way to do this is to use a Custom Template and the
&lt;a href=&quot;https://developers.google.com/tag-manager/templates/api#injectscript&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;injectScript&lt;/code&gt;&lt;/a&gt;
API.&lt;/p&gt;
&lt;p&gt;For information on using the injectScript API to convert an existing Custom HTML
tag, see &lt;a href=&quot;https://developers.google.com/tag-manager/templates/convert-existing-tag&quot; rel=&quot;noopener&quot;&gt;Convert an existing
tag&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If you must you use a Custom HTML tag, here are some things to keep in mind:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Libraries and large third-party scripts should be loaded via a script tag
that downloads an external file (for example, &lt;code&gt;&amp;lt;script src=&amp;quot;external-scripts.js&amp;quot;&amp;gt;&lt;/code&gt;), rather than directly copy-pasting the script&#39;s
contents into the tag. Although forgoing use of the &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag
eliminates a separate round-trip to download the script&#39;s contents, this
practice increases container size and prevents the script from being cached
separately by the browser.&lt;/li&gt;
&lt;li&gt;Many vendors recommend placing their &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag at the top of the
&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;. However, for scripts loaded via tag manager, this recommendation
is usually unnecessary: in most situations, the browser has already finished
parsing the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; by the time that the tag manager executes.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;use-pixels&quot;&gt;Use pixels &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#use-pixels&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In some situations third-party scripts can be replaced with image or iframe
&amp;quot;pixels&amp;quot;. Compared to their script-based counterparts, these pixels may support
less functionality; however, because there is no JavaScript execution, they are
also the most performant and secure type of tag. Pixels have a very small
resource size (less than 1 KB) and do not cause layout shifts.&lt;/p&gt;
&lt;p&gt;Check with your third-party provider for more information on their support for
pixels. Additionally, you can try inspecting their code for a &lt;code&gt;&amp;lt;noscript&amp;gt;&lt;/code&gt; tag.
If a vendor supports pixels, they will often include them within the
&lt;code&gt;&amp;lt;noscript&amp;gt;&lt;/code&gt; tag.&lt;/p&gt;
&lt;img alt=&quot;Screenshot of custom image tag in Google Tag Manager&quot; decoding=&quot;async&quot; height=&quot;295&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 512px) 512px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/QMdKBiA8UYcX4V06Lt8V.png?auto=format&amp;w=1024 1024w&quot; width=&quot;512&quot; /&gt;
&lt;h4 id=&quot;alternatives-to-pixels&quot;&gt;Alternatives to pixels &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#alternatives-to-pixels&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Pixels became popular largely because at one time they were one of the cheapest
and most reliable ways to make a HTTP request in situations where the server
response is not relevant ( for example, when sending data to analytics
providers). The
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;navigator.sendBeacon()&lt;/code&gt;&lt;/a&gt;
and &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;fetch() keepalive&lt;/code&gt;&lt;/a&gt;
APIs are designed to address this same use case but are arguably more reliable
than pixels.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The &lt;code&gt;sendBeacon()&lt;/code&gt; and &lt;code&gt;fetch() keepalive&lt;/code&gt; APIs will both still work in
situations where the browser is
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Window/unload_event&quot; rel=&quot;noopener&quot;&gt;unloading&lt;/a&gt;
the page: for example, both of these APIs can be used to track outbound link
clicks. By contrast, techniques like pixels and
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt;&lt;/a&gt;
would likely fail in those cases.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;There is nothing wrong with continuing to use pixels—they are well supported and
have minimal performance impact. However, if you are building your own beacons,
it is worth considering using one of these APIs.&lt;/p&gt;
&lt;h5 id=&quot;sendbeacon()&quot;&gt;&lt;code&gt;sendBeacon()&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#sendbeacon()&quot;&gt;#&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;The
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;navigator.sendBeacon()&lt;/code&gt;&lt;/a&gt;
API is designed for sending small amounts of data to web servers in situations
where the server response does not matter.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://example.com/analytics&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    event&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;checkout&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    time&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; performance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;navigator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sendBeacon&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;sendBeacon()&lt;/code&gt; has a limited API: it only supports making POST requests and does
not support setting custom headers. It is
&lt;a href=&quot;https://caniuse.com/beacon&quot; rel=&quot;noopener&quot;&gt;supported&lt;/a&gt; by all modern browsers.&lt;/p&gt;
&lt;h5 id=&quot;fetch()-keepalive&quot;&gt;&lt;code&gt;fetch() keepalive&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#fetch()-keepalive&quot;&gt;#&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;keepalive&lt;/code&gt;&lt;/a&gt;
is a flag that allows the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch&quot; rel=&quot;noopener&quot;&gt;Fetch
API&lt;/a&gt; to
be used to make non-blocking requests like event reporting and analytics. It is
used by including &lt;code&gt;keepalive: true&lt;/code&gt; in the parameters passed to &lt;code&gt;fetch()&lt;/code&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://example.com/analytics&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  event&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;checkout&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  time&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; performance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    method&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;POST&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    body&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    keepalive&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;If &lt;code&gt;fetch() keepalive&lt;/code&gt; and &lt;code&gt;sendBeacon()&lt;/code&gt; seem very similar, it&#39;s because they
are. In fact, in Chromium browsers, &lt;code&gt;sendBeacon()&lt;/code&gt; is now built upon &lt;code&gt;fetch() keepalive&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;When choosing between &lt;code&gt;fetch() keepalive&lt;/code&gt; and &lt;code&gt;sendBeacon()&lt;/code&gt;, it&#39;s important to
consider the features and browser support that you need. The fetch() API is
significantly more flexible; however, &lt;code&gt;keepalive&lt;/code&gt; has less browser
&lt;a href=&quot;https://caniuse.com/?search=keepalive&quot; rel=&quot;noopener&quot;&gt;support&lt;/a&gt; than &lt;code&gt;sendBeacon()&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;get-clarification&quot;&gt;Get clarification &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#get-clarification&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Tags are often created by following guidance provided by a third-party vendor.
If it is unclear what a vendor&#39;s code does—consider asking someone who knows.
Getting a second opinion can help identify if a tag has the potential to create
performance or security issues.&lt;/p&gt;
&lt;h2 id=&quot;triggers&quot;&gt;Triggers &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#triggers&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;At a high-level, optimizing &lt;a href=&quot;https://support.google.com/tagmanager/topic/7679108?hl=en&amp;amp;ref_topic=7679384&quot; rel=&quot;noopener&quot;&gt;tag
triggers&lt;/a&gt;
generally consists of making sure to not trigger tags more than necessary and
choosing a trigger that balances business needs with performance costs.&lt;/p&gt;
&lt;h3 id=&quot;choose-an-appropriate-trigger-event&quot;&gt;Choose an appropriate trigger event &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#choose-an-appropriate-trigger-event&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The performance impact of a tag is not fixed: generally speaking, the earlier
that a tag fires, the greater its impact on performance. Resources are typically
constrained during the initial page load and therefore loading or executing a
particular resource (or tag) takes resources away from something else.&lt;/p&gt;
&lt;p&gt;Although it is important to choose appropriate triggers for all tags, it is
particularly important for tags that load large resources or execute long
scripts.&lt;/p&gt;
&lt;h3 id=&quot;use-custom-events&quot;&gt;Use custom events &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#use-custom-events&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://support.google.com/tagmanager/answer/7679219?hl=en&quot; rel=&quot;noopener&quot;&gt;Custom events&lt;/a&gt;
allow you to fire triggers in response to page events that aren&#39;t covered by
Google Tag Manager&#39;s built-in triggers. For example, many tags use &lt;a href=&quot;https://support.google.com/tagmanager/answer/7679319?hl=en&quot; rel=&quot;noopener&quot;&gt;page view
triggers&lt;/a&gt;; however,
the time period between &lt;code&gt;DOM Ready&lt;/code&gt; and &lt;code&gt;Window Loaded&lt;/code&gt; can be lengthy on many
pages and this can make it difficult to fine-tune when a tag fires. Custom
events provide a solution to this problem.&lt;/p&gt;
&lt;p&gt;To use custom events, first create a custom event trigger and update your tags
to use this trigger.&lt;/p&gt;
&lt;img alt=&quot;Screenshot of a Custom Event trigger in Google Tag Manager&quot; decoding=&quot;async&quot; height=&quot;286&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 512px) 512px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/BvkKSJi7PeAONrdKfIXq.png?auto=format&amp;w=1024 1024w&quot; width=&quot;512&quot; /&gt;
&lt;p&gt;To fire the trigger, push the corresponding event to the data layer.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Custom event trigger that fires after 2 seconds&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  dataLayer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;event&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;my-custom-event&#39;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;use-specific-trigger-conditions&quot;&gt;Use specific trigger conditions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#use-specific-trigger-conditions&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Using specific trigger conditions helps avoid firing a tag unnecessarily.
Although there are many ways to apply this concept, one of the simplest yet most
useful things you can do is ensure that a tag only fires on pages where it is
actually used.&lt;/p&gt;
&lt;img alt=&quot;Screenshot showing trigger conditions in Google Tag Manager&quot; decoding=&quot;async&quot; height=&quot;288&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 512px) 512px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/G3MVBTGhNr560S6zEQu4.png?auto=format&amp;w=1024 1024w&quot; width=&quot;512&quot; /&gt;
&lt;p&gt;&lt;a href=&quot;https://support.google.com/tagmanager/answer/7182738&quot; rel=&quot;noopener&quot;&gt;Built-in variables&lt;/a&gt; can
also be incorporated into trigger conditions to limit tag firing.&lt;/p&gt;
&lt;h3 id=&quot;load-your-tag-manager-at-an-appropriate-time&quot;&gt;Load your tag manager at an appropriate time &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#load-your-tag-manager-at-an-appropriate-time&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Adjusting when you tag manager loads can have a significant impact on
performance. Triggers, regardless of how they are configured, can&#39;t fire until
after a tag manager loads. Although it is important to choose good triggers for
individual tags (as explained above), experimenting with when you load your tag
manager can often have an equal or greater impact given that this single
decision will impact all tags on a page.&lt;/p&gt;
&lt;h2 id=&quot;tag-management&quot;&gt;Tag Management &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#tag-management&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;use-the-data-layer&quot;&gt;Use the data layer &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#use-the-data-layer&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;a href=&quot;https://developers.google.com/tag-manager/devguide&quot; rel=&quot;noopener&quot;&gt;data layer&lt;/a&gt; &amp;quot;contains
all of the information that you want to pass to Google Tag Manager&amp;quot;. More
concretely, it is a JavaScript array of objects that contain information about
the page. It can also be used to trigger tags.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Contents of the data layer&lt;/span&gt;&lt;br /&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dataLayer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;pageCategory&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;signup&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;visitorType&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;high-value&#39;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// Pushing a variable to the data layer&lt;/span&gt;&lt;br /&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dataLayer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;variable\_name&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;variable\_value&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// Pushing an event to the data layer&lt;/span&gt;&lt;br /&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dataLayer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;event&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;event\_name&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Although Google Tag Manager can be used without the data layer, its use is
strongly recommended. The data layer provides a way to consolidate the data
being accessed by third-party scripts into a single place thereby providing
better visibility into its usage. Amongst other things, this can help reduce
redundant variable calculations and script execution.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The performance benefits of the data layer might seem non-intuitive given that
updating the data layer causes Google Tag Manager to reevaluate all container
variables and potentially trigger tags—all of which entails JavaScript
execution. Although it is possible to misuse the data layer, generally speaking,
if working with the data layer is a source of performance issues, it probably
indicates that the container itself has performance issues—the data layer is
merely making these issues more apparent.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;remove-duplicate-and-unused-tags&quot;&gt;Remove duplicate and unused tags &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#remove-duplicate-and-unused-tags&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Duplicate tags can occur when a tag is included in a page&#39;s HTML markup in
addition to being injected through a tag manager.&lt;/p&gt;
&lt;p&gt;Unused tags should be paused or removed rather than blocked through use of a
&lt;a href=&quot;https://support.google.com/tagmanager/answer/7679318?hl=en&quot; rel=&quot;noopener&quot;&gt;trigger exception&lt;/a&gt;.
Pausing or removing a tag removes the code from the container; blocking does
not.&lt;/p&gt;
&lt;h3 id=&quot;use-allow-and-deny-lists&quot;&gt;Use allow and deny lists &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#use-allow-and-deny-lists&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://developers.google.com/tag-manager/web/restrict&quot; rel=&quot;noopener&quot;&gt;Allow and deny lists&lt;/a&gt;
allow you to configure highly granular restrictions on the tags, triggers, and
variables allowed on a page. This can be used to help enforce performance best
practices and other policies.&lt;/p&gt;
&lt;p&gt;Allow and deny lists are configured through the data layer.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dataLayer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&#39;gtm.allowlist&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;&amp;amp;lt;id&gt;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&amp;amp;lt;id&gt;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&#39;gtm.blocklist&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;customScripts&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;consider-using-server-side-tagging&quot;&gt;Consider using server-side tagging &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#consider-using-server-side-tagging&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Switching to server-side tagging is not a trivial task, but it is worth
considering - particularly for larger sites that want more control over their
data. Server-side tagging removes vendor code from the client, and with it,
offloads processing from the client to the server.&lt;/p&gt;
&lt;p&gt;For example, when using client-side tagging, sending data to multiple analytics
accounts entails that the client initiates separate requests for each endpoint.
By contrast, with server-side tagging, a single request is made by the client to
the server-side container, and from there, this data is forwarded to different
analytics accounts.&lt;/p&gt;
&lt;p&gt;Keep in mind that server-side tagging only works with some tags; tag
compatibility varies depending on vendor.&lt;/p&gt;
&lt;p&gt;For more information, see &lt;a href=&quot;https://developers.google.com/tag-manager/serverside/intro&quot; rel=&quot;noopener&quot;&gt;An introduction to server-side
tagging&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;containers&quot;&gt;Containers &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#containers&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;use-only-one-container-per-page&quot;&gt;Use only one container per page &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#use-only-one-container-per-page&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Using multiple
&lt;a href=&quot;https://developers.google.com/tag-manager/api/v1/reference/accounts/containers&quot; rel=&quot;noopener&quot;&gt;containers&lt;/a&gt;
on a single page can create significant performance issues as it introduces
additional overhead and script execution. It is rare for multiple containers to
be used effectively.&lt;/p&gt;
&lt;p&gt;If you must use multiple containers per page, &lt;a href=&quot;https://developers.google.com/tag-manager/devguide#multiple-containers&quot; rel=&quot;noopener&quot;&gt;follow Google Tag manager
guidance for setting up multiple
containers&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;use-separate-containers-if-needed&quot;&gt;Use separate containers if needed &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#use-separate-containers-if-needed&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If you use a tag manager for multiple properties (for example, a web app and a
mobile app)—the number of containers you use can help or hurt your workflow
productivity. It can also impact performance.&lt;/p&gt;
&lt;p&gt;Generally speaking, a single container can effectively be used across multiple
sites if the sites are similar in use and structure. For example, although a
brand&#39;s mobile and web apps might serve similar functions, it&#39;s likely that the
apps will be structured differently, and therefore more effectively managed
through separate containers. Trying to reuse a single container too broadly
typically unnecessarily increases the complexity and size of the container by
forcing the adoption of complex logic to manage tags and triggers.&lt;/p&gt;
&lt;h3 id=&quot;keep-an-eye-on-container-size&quot;&gt;Keep an eye on container size &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#keep-an-eye-on-container-size&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The size of a container is determined by its tags, triggers, and variables.
Although a small container may negatively impact page performance, a large
container almost certainly will.&lt;/p&gt;
&lt;p&gt;Container size should not be your north-star metric when optimizing your tag
usage; however, a large container size is often a warning sign that a container
is not well maintained and possibly misused.&lt;/p&gt;
&lt;p&gt;Google Tag Manager
&lt;a href=&quot;https://support.google.com/tagmanager/answer/2772488?hl=en&quot; rel=&quot;noopener&quot;&gt;limits&lt;/a&gt; container
size to 200 KB and will warn about container size starting at 140 KB. However,
most sites should aim to keep their containers far smaller than this. For
perspective, the median site container is around 6 KB.&lt;/p&gt;
&lt;p&gt;To determine the size of your container, look at the size of the response
returned by &lt;code&gt;https://www.googletagmanager.com/gtag/js?id=YOUR_ID&lt;/code&gt;. This
response contains the Google Tag Manager library plus the contents of the
container. By itself, the Google Tag Manager library is around 33 KB.&lt;/p&gt;
&lt;h3 id=&quot;name-your-container-versions&quot;&gt;Name your container versions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#name-your-container-versions&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A &lt;a href=&quot;https://developers.google.com/tag-manager/api/v1/reference/accounts/containers/versions&quot; rel=&quot;noopener&quot;&gt;container
version&lt;/a&gt;
is a snapshot of a container&#39;s content at a particular point in time. Using a
meaningful name and along with including a short description of meaningful
changes within can go a long way in making it easier to debug future performance
issues.&lt;/p&gt;
&lt;h2 id=&quot;tagging-workflows&quot;&gt;Tagging workflows &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#tagging-workflows&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;test-tags-before-deploying&quot;&gt;Test tags before deploying &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#test-tags-before-deploying&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Testing your tags before deployment can help catch issues (performance and
otherwise) before they ship.&lt;/p&gt;
&lt;p&gt;Things to consider when testing a tag include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Is the tag working correctly?&lt;/li&gt;
&lt;li&gt;Does the tag cause any layout shifts?&lt;/li&gt;
&lt;li&gt;Does the tag load any resources? How large are these resources?&lt;/li&gt;
&lt;li&gt;Does the tag trigger a long-running script?&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;preview-mode&quot;&gt;Preview mode &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#preview-mode&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://support.google.com/tagmanager/answer/6107056&quot; rel=&quot;noopener&quot;&gt;Preview mode&lt;/a&gt; allows you
to test tag changes on your actual site without having to deploy them to the
public first. Preview mode includes a debugging console that provides
information about tags.&lt;/p&gt;
&lt;p&gt;The execution time of Google Tag Manager will be different (slightly slower)
when run in Preview mode due to the additional overhead required to expose
information in the debugging console. Thus, comparing Web Vitals measurements
collected in preview mode to those collected in production is not recommended.
However, this discrepancy should not affect the execution behavior of the tags
themselves.&lt;/p&gt;
&lt;h4 id=&quot;standalone-testing&quot;&gt;Standalone testing &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#standalone-testing&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;An alternative approach to testing tags is to set up an empty page containing a
container with a single tag—the tag you are testing. This testing setup is less
realistic and won&#39;t catch some issues (for example, whether a tag causes layout
shifts)—however it can make it easier to isolate and measure the impact of the
tag on things like script execution. Check out how &lt;a href=&quot;https://medium.com/the-telegraph-engineering/improving-third-party-web-performance-at-the-telegraph-a0a1000be5&quot; rel=&quot;noopener&quot;&gt;Telegraph uses this
isolation approach to improve
performance&lt;/a&gt;
of third-party code.&lt;/p&gt;
&lt;h3 id=&quot;monitor-tag-performance&quot;&gt;Monitor tag performance &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#monitor-tag-performance&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The Google Tag Manager &lt;a href=&quot;https://developers.google.com/tag-manager/templates/monitoring&quot; rel=&quot;noopener&quot;&gt;Monitoring
API&lt;/a&gt; can be used
to gather information about the &lt;a href=&quot;https://developers.google.com/tag-manager/templates/monitoring#execution_times&quot; rel=&quot;noopener&quot;&gt;execution
time&lt;/a&gt;
of a particular tag. This information is reported to an endpoint of your
choosing.&lt;/p&gt;
&lt;p&gt;For more information, see &lt;a href=&quot;https://www.simoahava.com/analytics/google-tag-manager-monitor/&quot; rel=&quot;noopener&quot;&gt;How to build a Google Tag Manager
Monitor&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;require-approval-for-container-changes&quot;&gt;Require approval for container changes &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#require-approval-for-container-changes&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;First-party code typically goes through review and testing before deployment -
treat your tags the same. Adding &lt;a href=&quot;https://support.google.com/tagmanager/answer/4525539/tag-manager-and-2-step-verification?hl=en&quot; rel=&quot;noopener&quot;&gt;two-step
verification&lt;/a&gt;,
which requires administrator approval for container changes, is one way to do
this. Alternatively, if you don&#39;t want to require two-step verification but
would still like to keep an eye on changes, you can set up &lt;a href=&quot;https://support.google.com/tagmanager/answer/9713667?hl=en&quot; rel=&quot;noopener&quot;&gt;container
notifications&lt;/a&gt; to
receive email alerts about container events of your choosing.&lt;/p&gt;
&lt;h3 id=&quot;periodically-audit-tag-usage&quot;&gt;Periodically audit tag usage &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/tag-best-practices/#periodically-audit-tag-usage&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;One of the challenges of working with tags is that they tend to accumulate over
time: tags get added but are rarely removed. Auditing tags periodically is one
way to reverse this trend. The ideal frequency for doing this will depend on how
often your site&#39;s tags are updated.&lt;/p&gt;
&lt;p&gt;For more information, see &lt;a href=&quot;https://web.dev/controlling-third-party-scripts/&quot;&gt;Keeping third-party scripts under
control&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Katie Hempenius</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Compat 2021 mid-year update: Flex gap everywhere</title>
      <link href="https://web.dev/compat2021-midyear/"/>
      <updated>2021-07-23T00:00:00Z</updated>
      <id>https://web.dev/compat2021-midyear/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;It&#39;s time for the mid-year update on Compat 2021—an effort to eliminate browser compatibility
problems in five key focus areas. For more details about the
&lt;a href=&quot;https://twitter.com/search?q=%23compat2021&quot; rel=&quot;noopener&quot;&gt;#compat2021&lt;/a&gt; work and how we decided on the
areas of focus, check out the &lt;a href=&quot;https://web.dev/compat2021&quot;&gt;March announcement&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Improvements to Chromium discussed in this post will reach Chrome, Edge and all Chromium-based
browsers.&lt;/p&gt;
&lt;h2 id=&quot;how-we-measure-progress&quot;&gt;How we measure progress &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compat2021-midyear/#how-we-measure-progress&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;You can check the &lt;a href=&quot;https://wpt.fyi/compat2021?feature=summary&quot; rel=&quot;noopener&quot;&gt;Compat 2021 dashboard&lt;/a&gt; for
&lt;a href=&quot;https://github.com/web-platform-tests/wpt#the-web-platform-tests-project&quot; rel=&quot;noopener&quot;&gt;web-platform-tests&lt;/a&gt;
to see the number of passing tests and the trending graphs for different browsers.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--key-term&quot;&gt;
&lt;p&gt;&lt;strong&gt;Key Term&lt;/strong&gt;:
The web-platform-tests project is a cross-browser test suite for the web platform. The tests are
run periodically across multiple browsers and results are available on the
&lt;a href=&quot;https://wpt.fyi/&quot; rel=&quot;noopener&quot;&gt;wpt.fyi&lt;/a&gt; dashboard.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;A simple &amp;quot;passed tests&amp;quot; number doesn&#39;t tell the entire story of browser compatibility, however it
is one of the signals we use to see the progress of our effort. Fewer differences between browsers
in test results means greater interoperability of a web feature across multiple browsers.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Caption: a snapshot of Compat 2021 Dashboard (experimental browsers)&quot; decoding=&quot;async&quot; height=&quot;538&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/CFL9C7UHKSrAgI5rLrvv.jpg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    A snapshot of &lt;a href=&quot;https://wpt.fyi/compat2021&quot;&gt;Compat 2021 Dashboard&lt;/a&gt; (experimental browsers).
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;css-flexbox&quot;&gt;CSS flexbox &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compat2021-midyear/#css-flexbox&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;All three browser engines saw
&lt;a href=&quot;https://wpt.fyi/compat2021?feature=css-flexbox&quot; rel=&quot;noopener&quot;&gt;improvements on flexbox&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Safari 14.1 shipped the
&lt;a href=&quot;https://blogs.igalia.com/svillar/2020/10/01/closing-the-gap-in-flexbox/&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;gap&lt;/code&gt; property for flexbox&lt;/a&gt;
. The &lt;code&gt;gap&lt;/code&gt; property is a convenient way to set spacing between items. This property is often used
in Grid layout, and support in flexbox layout was one of the most requested features in the
&lt;a href=&quot;https://insights.developer.mozilla.org/reports/mdn-browser-compatibility-report-2020.html&quot; rel=&quot;noopener&quot;&gt;MDN Browser Compatibility Report&lt;/a&gt;
. With this update, the &lt;code&gt;gap&lt;/code&gt; property in flex layouts is available in all major browsers and a top
compatibility challenge is resolved. Safari 14.1 also included many fixes for
&lt;a href=&quot;https://blogs.igalia.com/svillar/2021/01/20/flexbox-cats-a-k-a-fixing-images-in-flexbox/&quot; rel=&quot;noopener&quot;&gt;images in flexbox&lt;/a&gt;, removing the need for old workarounds.&lt;/p&gt;
&lt;p&gt;Firefox resolved rendering of
&lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1674302&quot; rel=&quot;noopener&quot;&gt;tables as flex items&lt;/a&gt;, bumping Firefox
closer to 100% passing tests (currently at 98.5%).&lt;/p&gt;
&lt;p&gt;Chromium fixed
&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1181403&quot; rel=&quot;noopener&quot;&gt;tables as flex items&lt;/a&gt; as well. In
Chromium 88, there was also a
&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1132627&quot; rel=&quot;noopener&quot;&gt;rewrite of images as flex items&lt;/a&gt;,
resolving a number of long-standing bugs. Finally, Chromium recently added
&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1011718&quot; rel=&quot;noopener&quot;&gt;support for new alignment keywords&lt;/a&gt;
: &lt;code&gt;start&lt;/code&gt;, &lt;code&gt;end&lt;/code&gt;, &lt;code&gt;self-start&lt;/code&gt;, &lt;code&gt;self-end&lt;/code&gt;, &lt;code&gt;left&lt;/code&gt;, and &lt;code&gt;right&lt;/code&gt;. These keywords are available to
try in &lt;a href=&quot;https://www.google.com/chrome/canary/&quot; rel=&quot;noopener&quot;&gt;Chrome Canary&lt;/a&gt; and
&lt;a href=&quot;https://www.microsoftedgeinsider.com/en-us/download/canary&quot; rel=&quot;noopener&quot;&gt;Edge Canary&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;css-grid&quot;&gt;CSS Grid &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compat2021-midyear/#css-grid&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;CSS Grid usage is
&lt;a href=&quot;https://www.chromestatus.com/metrics/feature/timeline/popularity/1693&quot; rel=&quot;noopener&quot;&gt;growing steadily&lt;/a&gt;,
currently at 9% of page views.  All three major browser engines implement CSS Grid and are passing
more than 89% of related web-platform-tests already. Closing the compatibility gap is important to
support steady growth of this feature.&lt;/p&gt;
&lt;p&gt;So far in 2021, Safari has improved from 89% to 93% passing tests, and Chromium is working on a new
architecture to resolve more CSS Grid issues, called GridNG. This is an effort led by the Microsoft
team, and led to the recent increase from 94% to 97% in the
&lt;a href=&quot;https://wpt.fyi/compat2021?feature=css-grid&quot; rel=&quot;noopener&quot;&gt;targeted Grid tests&lt;/a&gt;. You can expect an update on
GridNG on the &lt;a href=&quot;https://blogs.windows.com/msedgedev/&quot; rel=&quot;noopener&quot;&gt;Edge blog&lt;/a&gt; soon.&lt;/p&gt;
&lt;h2 id=&quot;css-position:-sticky&quot;&gt;CSS &lt;code&gt;position: sticky&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compat2021-midyear/#css-position:-sticky&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In Chromium,
&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=702927&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;position: sticky&lt;/code&gt; for table headers&lt;/a&gt;
got fixed with the launch of TablesNG—a multi-year effort to re-architect rendering of tables.
This change, together with a few
&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=841432&quot; rel=&quot;noopener&quot;&gt;final&lt;/a&gt;
&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=752022&quot; rel=&quot;noopener&quot;&gt;fixes&lt;/a&gt;, pushed the Chrome and Edge 93
developer channel to pass 100% of the
&lt;a href=&quot;https://wpt.fyi/compat2021?feature=position-sticky&quot; rel=&quot;noopener&quot;&gt;targeted tests&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Beyond &lt;code&gt;position: sticky&lt;/code&gt;,
&lt;a href=&quot;https://developer.chrome.com/blog/tablesng/&quot; rel=&quot;noopener&quot;&gt;TablesNG resolved 72 Chromium bugs&lt;/a&gt;!&lt;/p&gt;
&lt;h2 id=&quot;css-aspect-ratio-property&quot;&gt;CSS &lt;code&gt;aspect-ratio&lt;/code&gt; property &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compat2021-midyear/#css-aspect-ratio-property&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;aspect-ratio&lt;/code&gt; property, which makes it straightforward to set width-to-height ratio, is crucial
to responsive web design. It is also a solution to prevent
&lt;a href=&quot;https://web.dev/cls/&quot;&gt;cumulative layout shifts&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;aspect-ratio&lt;/code&gt; property is now supported in stable versions of Chrome, Edge, and Firefox, and
in
&lt;a href=&quot;https://developer.apple.com/documentation/safari-release-notes/safari-15-beta-release-notes&quot; rel=&quot;noopener&quot;&gt;Safari 15 beta&lt;/a&gt;
. As cross-browser support improves,
&lt;a href=&quot;https://www.chromestatus.com/metrics/css/timeline/popularity/657&quot; rel=&quot;noopener&quot;&gt;usage&lt;/a&gt; is increasing.&lt;/p&gt;
&lt;p&gt;Although no browser has 100% passing tests, the compatibility gap for &lt;code&gt;aspect-ratio&lt;/code&gt; is the smallest
of all five focus areas for Compat 2021. It has
&lt;a href=&quot;https://wpt.fyi/compat2021?feature=aspect-ratio&quot; rel=&quot;noopener&quot;&gt;more than 90% passing tests for all major browsers&lt;/a&gt;
. Moving forward, we&#39;ll keep monitoring the progress using this test suite to make it a rock-solid
feature.&lt;/p&gt;
&lt;p&gt;Learn more about the usage and benefits of the
&lt;a href=&quot;https://web.dev/aspect-ratio/&quot;&gt;&lt;code&gt;aspect-ratio&lt;/code&gt; property on web.dev&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;css-transforms&quot;&gt;CSS transforms &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compat2021-midyear/#css-transforms&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There has been a slow and steady improvement in the results of the &lt;a href=&quot;https://wpt.fyi/compat2021?feature=css-transforms&quot; rel=&quot;noopener&quot;&gt;targeted tests for CSS
transforms&lt;/a&gt;, due to both bug fixes, and
improvements to the tests themselves.&lt;/p&gt;
&lt;p&gt;The Chromium team is also working on improving the interoperability of &lt;code&gt;transform-style: preserve-3d&lt;/code&gt; and &lt;code&gt;transform :perspective()&lt;/code&gt;. We hope to have more progress to share in the next
update.&lt;/p&gt;
&lt;h2 id=&quot;overall-score-improvements&quot;&gt;Overall score improvements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compat2021-midyear/#overall-score-improvements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Since the announcement in March, all three browser engines have improved their Compat 2021 scores:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Chrome and Edge Dev went from 86 to 92.&lt;/li&gt;
&lt;li&gt;Firefox went from 83 to 86.&lt;/li&gt;
&lt;li&gt;Safari went from 64 to 82.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Notably, Safari has pushed to close the compatibility gap by 18 points, thanks to a lot of work from
WebKit contributors. In particular the team at
&lt;a href=&quot;https://www.igalia.com/2021/06/29/Igalia-Developments-in-WebKit-and-Safari-15.html&quot; rel=&quot;noopener&quot;&gt;Igalia contributed&lt;/a&gt;
to the &lt;code&gt;aspect-ratio&lt;/code&gt; property and many improvements to Flexbox and Grid, such as &lt;code&gt;gap&lt;/code&gt; for flexbox
and various bug fixes.&lt;/p&gt;
&lt;h2 id=&quot;follow-the-compat-2021-progress&quot;&gt;Follow the Compat 2021 progress &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compat2021-midyear/#follow-the-compat-2021-progress&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To follow the progress of Compat 2021, keep an eye on the
&lt;a href=&quot;https://wpt.fyi/compat2021?feature=summary&quot; rel=&quot;noopener&quot;&gt;dashboard&lt;/a&gt;, subscribe to
&lt;a href=&quot;https://groups.google.com/g/compat2021&quot; rel=&quot;noopener&quot;&gt;our mailing list&lt;/a&gt;, or reach out to usat
&lt;a href=&quot;https://twitter.com/chromiumdev&quot; rel=&quot;noopener&quot;&gt;@chromiumdev&lt;/a&gt;. If you experience any issues make sure to
&lt;a href=&quot;https://web.dev/how-to-file-a-good-bug/&quot;&gt;file a bug&lt;/a&gt; for the affected browser.&lt;/p&gt;
</content>
      <author>
          <name>Philip Jägenstedt</name>
        </author><author>
          <name>Mariko Kosaka</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>URLPattern brings routing to the web platform</title>
      <link href="https://web.dev/urlpattern/"/>
      <updated>2021-07-22T00:00:00Z</updated>
      <id>https://web.dev/urlpattern/</id>
      <content type="text/html" mode="escaped">&lt;h2 id=&quot;background&quot;&gt;Background &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#background&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Routing is a key piece of every web application. At its heart, routing involves
taking a URL, applying some pattern matching or other app-specific logic to it,
and then, usually, displaying web content based on the result. Routing might be
implemented in a number of ways: it&#39;s sometimes code running on a server that
maps a path to files on disk, or logic in a single-page app that waits for
changes to the current location and creates a corresponding piece of DOM to
display.&lt;/p&gt;
&lt;p&gt;While there is no one definitive standard, web developers have gravitated
towards a common syntax for expressing URL routing patterns that share a lot in
common with
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions&quot; rel=&quot;noopener&quot;&gt;regular expressions&lt;/a&gt;,
but with some domain-specific additions like tokens for matching path segments.
Popular server-side frameworks like
&lt;a href=&quot;https://expressjs.com/en/guide/routing.html&quot; rel=&quot;noopener&quot;&gt;Express&lt;/a&gt; and
&lt;a href=&quot;https://guides.rubyonrails.org/routing.html&quot; rel=&quot;noopener&quot;&gt;Ruby on Rails&lt;/a&gt; use this syntax (or
something very close to it), and JavaScript developers can use modules like
&lt;code&gt;&lt;a href=&quot;https://github.com/pillarjs/path-to-regexp&quot; rel=&quot;noopener&quot;&gt;path-to-regexp&lt;/a&gt;&lt;/code&gt; or
&lt;code&gt;&lt;a href=&quot;https://github.com/lukeed/regexparam&quot; rel=&quot;noopener&quot;&gt;regexpparam&lt;/a&gt;&lt;/code&gt; to add that
logic to their own code.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&lt;a href=&quot;https://github.com/WICG/urlpattern/blob/main/explainer.md#urlpattern&quot; rel=&quot;noopener&quot;&gt;URLPattern&lt;/a&gt;&lt;/code&gt;
is a proposed addition to the web platform that builds on the foundation created
by these frameworks. Its goal is to standardize a routing pattern syntax,
including support for wildcards, named token groups, regular expression groups,
and group modifiers. &lt;code&gt;URLPattern&lt;/code&gt; instances created with this syntax
can perform common routing tasks, like matching against full URLs or a URL
&lt;code&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/URL/pathname&quot; rel=&quot;noopener&quot;&gt;pathname&lt;/a&gt;&lt;/code&gt;,
and returning information about the token and group matches.&lt;/p&gt;
&lt;p&gt;Another benefit to providing URL matching directly in the web platform is that a
common syntax can then be shared with &lt;a href=&quot;https://web.dev/urlpattern/#future-features&quot;&gt;other APIs&lt;/a&gt; that also
need to match against URLs.&lt;/p&gt;
&lt;h2 id=&quot;syntax-compatibility&quot;&gt;Syntax compatibility &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#syntax-compatibility&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A guiding philosophy for &lt;code&gt;URLPattern&lt;/code&gt; is to avoid reinvention. If you&#39;re already
familiar with the routing syntax used in Express or Ruby on Rails, you shouldn&#39;t
have to learn anything new. But given the slight divergences
between syntaxes in popular routing libraries, something had to be chosen as the
base syntax, and the designers of &lt;code&gt;URLPattern&lt;/code&gt; decided to use the pattern syntax
from &lt;code&gt;path-to-regexp&lt;/code&gt; (though not its API surface) as the starting point.&lt;/p&gt;
&lt;p&gt;This decision was made after close consultation with the current maintainer of
&lt;code&gt;path-to-regexp&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The best way to familiarize yourself with the core of the supported syntax is to
refer to the
&lt;a href=&quot;https://github.com/pillarjs/path-to-regexp#parameters&quot; rel=&quot;noopener&quot;&gt;documentation&lt;/a&gt; for
&lt;code&gt;path-to-regexp&lt;/code&gt;. You can
&lt;a href=&quot;https://github.com/WICG/urlpattern/blob/main/mdn-drafts/QUICK-REFERENCE.md&quot; rel=&quot;noopener&quot;&gt;read the documentation&lt;/a&gt;
intended for publication on &lt;a href=&quot;https://developer.mozilla.org/&quot; rel=&quot;noopener&quot;&gt;MDN&lt;/a&gt; in its current
home on GitHub.&lt;/p&gt;
&lt;h3 id=&quot;additional-features&quot;&gt;Additional features &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#additional-features&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The syntax of &lt;code&gt;URLPattern&lt;/code&gt; is a superset of what &lt;code&gt;path-to-regexp&lt;/code&gt; supports, as
&lt;code&gt;URLPattern&lt;/code&gt; supports a uncommon feature among routing libraries: matching
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/URL/origin&quot; rel=&quot;noopener&quot;&gt;origins&lt;/a&gt;,
including wildcards in hostnames. Most other routing libraries just deal with
the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/URL/pathname&quot; rel=&quot;noopener&quot;&gt;pathname&lt;/a&gt;,
and occasionally the
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/URL/search&quot; rel=&quot;noopener&quot;&gt;search&lt;/a&gt; or
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/URL/hash&quot; rel=&quot;noopener&quot;&gt;hash&lt;/a&gt; portion of a
URL. They never have to check the origin portion of a URL, as they&#39;re only used
for same-origin routing within a self-contained web app.&lt;/p&gt;
&lt;p&gt;Taking origins into account opens the door for additional use cases, like
routing cross-origin requests inside of a
&lt;a href=&quot;https://developers.google.com/web/fundamentals/primers/service-workers&quot; rel=&quot;noopener&quot;&gt;service worker&lt;/a&gt;&#39;s
&lt;code&gt;fetch&lt;/code&gt; event handler. If you&#39;re only routing same-origin URLs, you can
effectively ignore this additional feature and use &lt;code&gt;URLPattern&lt;/code&gt; like
other libraries.&lt;/p&gt;
&lt;h2 id=&quot;examples&quot;&gt;Examples &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#examples&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;constructing-the-pattern&quot;&gt;Constructing the pattern &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#constructing-the-pattern&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To create a &lt;code&gt;URLPattern&lt;/code&gt;, pass its constructor either strings or an object whose
properties contain info about the pattern to match against.&lt;/p&gt;
&lt;p&gt;Passing an object offers the most explicit control over what pattern to use for
matching each URL component. At its most verbose, this can look like&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  protocol&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;https&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  username&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  password&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  hostname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;example.com&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  port&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo/:image.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  search&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;*&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  hash&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;*&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Providing an empty string for a property will only match if the corresponding
part of the URL is not set. The wildcard &lt;code&gt;*&lt;/code&gt; will match any value for a given
portion of the URL.&lt;/p&gt;
&lt;p&gt;The constructor offers several shortcuts for simpler usage. Completely omitting
&lt;code&gt;search&lt;/code&gt; and &lt;code&gt;hash&lt;/code&gt;, or any other properties, is equivalent to setting them to the
&lt;code&gt;&#39;*&#39;&lt;/code&gt; wildcard. The above example could be simplified to&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  protocol&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;https&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  username&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  password&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  hostname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;example.com&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  port&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo/:image.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;As an additional shortcut, all of the information about the origin can be
provided in a single property, &lt;code&gt;baseURL&lt;/code&gt;, leading to&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo/:image.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  baseURL&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;https://example.com&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;All of these examples assume that your use case involves matching origins. If
you&#39;re only interested in matching on the other portions of the URL, excluding
the origin (as is the case for many &amp;quot;traditional&amp;quot; single-origin routing
scenarios), then you can omit the origin information entirely, and just provide
some combination of the &lt;code&gt;pathname&lt;/code&gt;, &lt;code&gt;search&lt;/code&gt;, and &lt;code&gt;hash&lt;/code&gt; properties. As before,
omitted properties will be treated as if they were set to the &lt;code&gt;*&lt;/code&gt; wildcard
pattern.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo/:image.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;As an alternative to passing in an object to the constructor, you can provide
either one or two strings. If one string is provided, it should represent a full
URL pattern, including pattern information used to match the origin. If you
provide two strings, the second string is used as a &lt;code&gt;baseURL&lt;/code&gt;, and the first
string is considered relative to that base.&lt;/p&gt;
&lt;p&gt;Whether one string or two are provided, the &lt;code&gt;URLPattern&lt;/code&gt; constructor will parse
the full URL pattern, breaking it up into URL components, and map each portion
of the larger pattern to the corresponding component. This means that under the
hood, each &lt;code&gt;URLPattern&lt;/code&gt; created with strings ends up being represented
the same as an equivalent &lt;code&gt;URLPattern&lt;/code&gt; created with an object. The
strings constructor is just a shortcut, for those who prefer a less verbose
interface.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;https://example.com/foo/:image.jpg?*#*&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;When using strings to create a &lt;code&gt;URLPattern&lt;/code&gt;, there are a few caveats to keep in mind.&lt;/p&gt;
&lt;p&gt;Leaving a property out when using an object to construct &lt;code&gt;URLPattern&lt;/code&gt; is
equivalent to providing a &lt;code&gt;*&lt;/code&gt; wildcard for that property. When the full URL
string pattern is parsed, if one of the URL components is missing a value, it&#39;s
treated as if the component&#39;s property were set to &lt;code&gt;&#39;&#39;&lt;/code&gt;, which will only match
when that component is empty.&lt;/p&gt;
&lt;p&gt;When using strings, you need to explicitly include the wildcards if you want
them to be used in the constructed &lt;code&gt;URLPattern&lt;/code&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// p1 and p2 are equivalent.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;/foo&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; location&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;origin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  protocol&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; location&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;protocol&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  hostname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; location&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hostname&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  search&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  hash&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// p3 and p4 are equivalent.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;/foo?*#*&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; location&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;origin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p4 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  protocol&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; location&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;protocol&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  hostname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; location&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hostname&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;You should also be aware that parsing a string pattern into its components is
potentially ambiguous. There are characters, like &lt;code&gt;:&lt;/code&gt;, that are found in URLs
but also have special meaning in the pattern matching syntax. To avoid this
ambiguity, the &lt;code&gt;URLPattern&lt;/code&gt; constructor assumes that any of those special
characters are part of a pattern, not part of the URL. If you want an ambiguous
character to be interpreted as part of the URL, make sure to escape it with a
&lt;code&gt;\&lt;/code&gt; character. For example, the literal URL &lt;code&gt;about:blank&lt;/code&gt; should be escaped as
&lt;code&gt;&#39;about\\:blank&#39;&lt;/code&gt; when provided as a string.&lt;/p&gt;
&lt;h3 id=&quot;using-the-pattern&quot;&gt;Using the pattern &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#using-the-pattern&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;After constructing a &lt;code&gt;URLPattern&lt;/code&gt;, you have two options for using it. The
&lt;code&gt;test()&lt;/code&gt; and &lt;code&gt;exec()&lt;/code&gt; methods both take the same input and use the same
algorithm to check for a match, and only differ in their return value. &lt;code&gt;test()&lt;/code&gt;
returns &lt;code&gt;true&lt;/code&gt; when there&#39;s a match for the given input, and &lt;code&gt;false&lt;/code&gt; otherwise.
&lt;code&gt;exec()&lt;/code&gt; returns detailed information about the match along with capture groups,
or &lt;code&gt;null&lt;/code&gt; if there is no match. The following examples demonstrate using
&lt;code&gt;exec()&lt;/code&gt;, but you could swap in &lt;code&gt;test()&lt;/code&gt; for any of them if you only want a
simple boolean return value.&lt;/p&gt;
&lt;p&gt;One way to use the &lt;code&gt;test()&lt;/code&gt; and &lt;code&gt;exec()&lt;/code&gt; methods is by passing in strings.
Similar to what the constructor supports, if a single string is provided, it
should be a full URL, including the origin. If two strings are provided, the
second string is treated as a &lt;code&gt;baseURL&lt;/code&gt; value, and the first string is evaluated
as relative to that base.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo/:image.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  baseURL&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;https://example.com&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;https://example.com/foo/cat.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// result will contain info about the successful match.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// const result = p.exec(&#39;/foo/cat.jpg&#39;, &#39;https://example.com&#39;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// is equivalent, using the baseURL syntax.&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; noMatchResult &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;https://example.com/bar&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// noMatchResult will be null.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Alternatively, you can pass the same sort of object that the constructor
supports, with properties that are set to just the portions of the URL you care
about matching.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo/:image.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/foo/:image.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// result will contain info about the successful match.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;When using &lt;code&gt;exec()&lt;/code&gt; on a &lt;code&gt;URLPattern&lt;/code&gt; that contains wildcards or tokens, the
return value will give you information about what the corresponding values were
in the input URL. This can save you the trouble of having to parse out those
values yourself.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;URLPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  hostname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;:subdomain.example.com&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  pathname&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/*/:image.jpg&#39;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;https://imagecdn1.example.com/foo/cat.jpg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// result.hostname.groups.subdomain will be &#39;imagecdn1&#39;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// result.pathname.groups[0] will be &#39;foo&#39;, corresponding to *&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// result.pathname.groups.image will be &#39;cat&#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;anonymous-and-named-groups&quot;&gt;Anonymous and named groups &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#anonymous-and-named-groups&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;When you pass a URL string to &lt;code&gt;exec()&lt;/code&gt;, you get back a value telling your which portions matched all of the pattern&#39;s groups.&lt;/p&gt;
&lt;p&gt;The return value has properties that correspond to the components of the
&lt;code&gt;URLPattern&lt;/code&gt;, like &lt;code&gt;pathname&lt;/code&gt;. So if a group was defined as part of the
&lt;code&gt;pathname&lt;/code&gt; portion of the &lt;code&gt;URLPattern&lt;/code&gt;, then the matches can be found in the
return value&#39;s &lt;code&gt;pathname.groups&lt;/code&gt;. The matches are represented differently
depending on whether the corresponding pattern was an anonymous or named group.&lt;/p&gt;
&lt;p&gt;You can use array indices to access the values for an anonymous pattern match.
If there are multiple anonymous patterns, index &lt;code&gt;0&lt;/code&gt; will represent the matching
value for the left-most one, with &lt;code&gt;1&lt;/code&gt; and further indices used for subsequent
patterns.&lt;/p&gt;
&lt;p&gt;When using named groups in a pattern, the matches will exposed as properties
whose names correspond to each group name.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;If you&#39;re familiar with the
&lt;code&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec&quot; rel=&quot;noopener&quot;&gt;exec()&lt;/a&gt;&lt;/code&gt;
method of a
&lt;code&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions&quot; rel=&quot;noopener&quot;&gt;RegExp&lt;/a&gt;&lt;/code&gt;
object, then the return values from &lt;code&gt;URLPattern.exec()&lt;/code&gt;
method will look
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Groups_and_Ranges#examples&quot; rel=&quot;noopener&quot;&gt;very similar&lt;/a&gt;
when it comes to representing anonymous and named groups.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;unicode-support-and-normalization&quot;&gt;Unicode support and normalization &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#unicode-support-and-normalization&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;URLPattern&lt;/code&gt; supports Unicode characters in a few different ways.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Named groups, like &lt;code&gt;:café&lt;/code&gt;, can contain Unicode characters. The rules used for
valid
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Glossary/Identifier&quot; rel=&quot;noopener&quot;&gt;JavaScript identifiers&lt;/a&gt;
apply to named groups.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Text within a pattern will be automatically encoded according to the same
rules used for URL encoding of that particular component. Unicode characters
within &lt;code&gt;pathname&lt;/code&gt; will be
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Glossary/percent-encoding&quot; rel=&quot;noopener&quot;&gt;percent-encoded&lt;/a&gt;,
so a &lt;code&gt;pathname&lt;/code&gt; pattern like &lt;code&gt;/café&lt;/code&gt; is normalized to &lt;code&gt;/caf%C3%A9&lt;/code&gt;
automatically. Unicode characters in the &lt;code&gt;hostname&lt;/code&gt; are automatically encoded
using &lt;a href=&quot;https://en.wikipedia.org/wiki/Punycode&quot; rel=&quot;noopener&quot;&gt;Punycode&lt;/a&gt;, rather than
percent-encoding.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Regular expression groups must contain only ASCII characters. Regular
expression syntax makes it difficult and unsafe to automatically encode
Unicode characters in these groups. If you want to match a Unicode character
in a regular expression group,you need to percent encode it manually, like
&lt;code&gt;(caf%C3%A9)&lt;/code&gt; to match &lt;code&gt;café&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In addition to encoding Unicode characters, &lt;code&gt;URLPattern&lt;/code&gt; also performs URL
normalization. For example, &lt;code&gt;/foo/./bar&lt;/code&gt; in the &lt;code&gt;pathname&lt;/code&gt; component is
collapsed to the equivalent &lt;code&gt;/foo/bar&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;When in doubt about how a given input pattern has been normalized, inspect the
constructed &lt;code&gt;URLPattern&lt;/code&gt; instance using your browser&#39;s
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_are_browser_developer_tools&quot; rel=&quot;noopener&quot;&gt;DevTools&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;putting-it-all-together&quot;&gt;Putting it all together &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#putting-it-all-together&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Glitch demo embedded below illustrates a core use case of &lt;code&gt;URLPattern&lt;/code&gt;
inside of a service worker&#39;s
&lt;code&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers#custom_responses_to_requests&quot; rel=&quot;noopener&quot;&gt;fetch event handler&lt;/a&gt;&lt;/code&gt;,
mapping specific patterns to asynchronous functions that could generate a
response to network requests. The concepts in this example could be applied to
other routing scenarios as well, either server-side or client-side.&lt;/p&gt;
&lt;div class=&quot;glitch-embed-wrap&quot; style=&quot;height: 420px; width: 100%;&quot;&gt;
  &lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi&quot; loading=&quot;lazy&quot; src=&quot;https://glitch.com/embed/#!/embed/urlpattern-sw-routing?attributionHidden=true&amp;sidebarCollapsed=true&amp;path=service-worker.js&amp;previewSize=35&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;urlpattern-sw-routing on Glitch&quot;&gt;&lt;/iframe&gt;
&lt;/div&gt;
&lt;h2 id=&quot;browser-support-and-polyfills&quot;&gt;Browser support and polyfills &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#browser-support-and-polyfills&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We&#39;re letting developers know about &lt;code&gt;URLPattern&lt;/code&gt; early, and would appreciate any
&lt;a href=&quot;https://github.com/WICG/urlpattern/issues&quot; rel=&quot;noopener&quot;&gt;feedback&lt;/a&gt; based on the prerelease
interface. This article will be kept up to date with information about browser
support over time.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;URLPattern&lt;/code&gt; is not currently enabled by default in any browser, but Chrome and
Chromium-based browsers like Edge partially support &lt;code&gt;URLPattern&lt;/code&gt; starting with
version 93. You can try it out by enabling the
&lt;code&gt;#experimental-web-platform-features&lt;/code&gt; flag in &lt;code&gt;about://flags&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The
&lt;code&gt;&lt;a href=&quot;https://github.com/kenchris/urlpattern-polyfill&quot; rel=&quot;noopener&quot;&gt;urlpattern-polyfill&lt;/a&gt;&lt;/code&gt;
library provides a way to use the &lt;code&gt;URLPattern&lt;/code&gt; interface in browsers
or environments like &lt;a href=&quot;https://nodejs.org/&quot; rel=&quot;noopener&quot;&gt;Node&lt;/a&gt; which lack built-in support. If
you use the polyfill, make sure that you use feature detection to ensure that
you&#39;re only loading it if the current environment lacks support. Otherwise,
you&#39;ll lose one of the key benefits of &lt;code&gt;URLPattern&lt;/code&gt;: the fact that
support environments don&#39;t have to download and parse additional code in order
to use it.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;globalThis &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;URLPattern&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; globalThis&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// URLPattern is not available, so the polyfill is needed.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;feedback-and-future-plans&quot;&gt;Feedback and future plans &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#feedback-and-future-plans&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Some aspects of &lt;code&gt;URLPattern&lt;/code&gt; are &lt;a href=&quot;https://github.com/WICG/urlpattern/blob/main/202012-update.md#whats-still-left-to-do&quot; rel=&quot;noopener&quot;&gt;still being
developed&lt;/a&gt;,
and there are a number of
&lt;a href=&quot;https://github.com/WICG/urlpattern/blob/main/202012-update.md#open-questions&quot; rel=&quot;noopener&quot;&gt;open questions&lt;/a&gt;
about specific behaviors that may still be refined. We encourage you to try out
&lt;code&gt;URLPattern&lt;/code&gt; early and provide any feedback via the
&lt;a href=&quot;https://github.com/WICG/urlpattern/discussions&quot; rel=&quot;noopener&quot;&gt;Discussions&lt;/a&gt; feature in the
associated GitHub repo.&lt;/p&gt;
&lt;h3 id=&quot;support-for-templating&quot;&gt;Support for templating &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#support-for-templating&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;path-to-regexp&lt;/code&gt; library provides a
&lt;code&gt;&lt;a href=&quot;https://github.com/pillarjs/path-to-regexp#compile-reverse-path-to-regexp&quot; rel=&quot;noopener&quot;&gt;compile() function&lt;/a&gt;&lt;/code&gt;
that effectively reverses the routing behavior. &lt;code&gt;compile()&lt;/code&gt; takes a
pattern and values for the token placeholders, and returns a string for a URL
path with those values substituted in.&lt;/p&gt;
&lt;p&gt;We hope to
&lt;a href=&quot;https://github.com/WICG/urlpattern/discussions/41&quot; rel=&quot;noopener&quot;&gt;add this to URLPattern&lt;/a&gt; in
the future, but it&#39;s not within scope for the initial release.&lt;/p&gt;
&lt;h3 id=&quot;future-features&quot;&gt;Enabling future web platform features &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#future-features&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Assuming &lt;code&gt;URLPattern&lt;/code&gt; becomes an established part of the web platform, other
features that could benefit from routing or pattern matching can build on top of
it as a primitive.&lt;/p&gt;
&lt;p&gt;There are ongoing discussions about using &lt;code&gt;URLPattern&lt;/code&gt; for proposed features
like
&lt;a href=&quot;https://github.com/WICG/urlpattern/blob/main/explainer.md&quot; rel=&quot;noopener&quot;&gt;service worker scope pattern matching&lt;/a&gt;,
&lt;a href=&quot;https://web.dev/pwa-url-handler/#the-web-app-origin-association-file&quot;&gt;PWAs as file handlers&lt;/a&gt;,
and
&lt;a href=&quot;https://github.com/jeremyroman/alternate-loading-modes/blob/main/triggers.md&quot; rel=&quot;noopener&quot;&gt;speculative prefetching&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/urlpattern/#acknowledgements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;See the &lt;a href=&quot;https://github.com/WICG/urlpattern/blob/main/explainer.md#references--acknowledgements&quot; rel=&quot;noopener&quot;&gt;original explainer document&lt;/a&gt; for a full list of acknowledgements.&lt;/p&gt;
&lt;p&gt;The thumbnail image for this post is by &lt;a href=&quot;https://unsplash.com/@megindoors?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText&quot;&gt;Vic&lt;/a&gt; on &lt;a href=&quot;https://unsplash.com/s/photos/route-66?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Jeff Posnick</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>How committing to Core Web Vitals increased Netzwelt&#39;s advertising revenues by 18%</title>
      <link href="https://web.dev/netzwelt/"/>
      <updated>2021-07-19T00:00:00Z</updated>
      <id>https://web.dev/netzwelt/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;When Google announced the Core Web Vitals initiative,
German publisher &lt;a href=&quot;https://www.netzwelt.de/&quot; rel=&quot;noopener&quot;&gt;Netzwelt&lt;/a&gt; quickly realized the potential of these new metrics
towards a great page experience and improved advertising-based monetization.
They went on a journey to relaunch their website,
applying common performance best practices while optimizing ad tags and placements in parallel.
Committing to great UX and fast pages proved to be a path
for optimizing engagement and ad revenues hand in hand,
with page views up by 27%, ad viewability over 75%, and advertising revenues improving by 18%.&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;27&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;Increase in page views&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;18&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;Increase in ad revenue&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;75&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;Ad viewability&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;the-challenge&quot;&gt;The challenge &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#the-challenge&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Like many other news publishers,
Netzwelt struggled to find the right balance between optimizing user experience and page speed
while maintaining high ad revenues.
The main challenges they encountered were:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;High &lt;a href=&quot;https://web.dev/cls&quot;&gt;Cumulative Layout Shift&lt;/a&gt; (CLS) due to layout shifts triggered by ads,
especially from multisize slots and top banners.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://web.dev/lcp&quot;&gt;Largest Contentful Paint&lt;/a&gt; (LCP) coming in late due to ads being the largest paint
or by taking bandwidth from hero image loading.&lt;/li&gt;
&lt;li&gt;High &lt;a href=&quot;https://web.dev/fid&quot;&gt;First Input Delay&lt;/a&gt; (FID) caused by third-party JavaScript needed for advertising,
header bidding, and other purposes.&lt;/li&gt;
&lt;li&gt;Side effects on Core Web Vitals from consent dialogs controlled by third-party vendors,
which also added to layout shifts and might be detected as late largest paints.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;optimizing-a-news-website-for-core-web-vitals&quot;&gt;Optimizing a news website for Core Web Vitals &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#optimizing-a-news-website-for-core-web-vitals&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;When Netzwelt started working on core web vitals,
they quickly noticed that optimizing Core Web Vitals doesn&#39;t need to affect advertisement negatively
but can be used as an opportunity to improve ad viewability.
Therefore, the Netzwelt team optimized Core Web Vitals to lift ad viewability
above 75% to attract higher-value advertising
(the global average for display ads
&lt;a href=&quot;https://www.thinkwithgoogle.com/feature/viewability/state-of-viewability&quot; rel=&quot;noopener&quot;&gt;is less than 50%&lt;/a&gt;).&lt;/p&gt;
&lt;h3 id=&quot;optimizing-cls&quot;&gt;Optimizing CLS &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#optimizing-cls&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Advertisements often load late (sometimes consciously through lazy-loading),
and their real size is often not known in advance due to multisize and fluid ad placements.&lt;/p&gt;
&lt;p&gt;The problem can be divided into two—ads above and below the fold.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ads above the fold&lt;/strong&gt; can cause massive layout jumps due to loading late with unknown sizes.
Blocking the largest space they might need can lead to bad UX,
while asking advertisers for fixed sizes may reduce ad income.
Netzwelt solved this problem by making the top ad sticky and removing some of the bigger allowed banner sizes.
The overlaid ad avoids triggering layout jumps for ads of different sizes.
Although the reduced eligible sizes do impact ad sales, the better viewability offsets this easily.&lt;/p&gt;
&lt;p&gt;Historical data and A/B tests helped Netzwelt find the right size
and positioning for different devices and screen sizes,
and CSS media rules used to reserve space.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ads below the fold&lt;/strong&gt; offer room for significant improvement:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A banner that is not seen but loaded creates poor ad viewability and worsens the page experience.&lt;/li&gt;
&lt;li&gt;A banner that is loaded at the time a user scrolls over it can introduce additional content jumps.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To maintain a good page experience and high ad viewability,
Netzwelt implemented lazy-loading and reserved space for the size of the lowest common denominator.
In a multisize zone the banners requested in the sizes 300x250 to 300x600, reserved 250px in height.
This eliminated layout shifts for the smaller sizes; and reduced them massively for larger banners.
This approach is not optimal, but it is a start and a good compromise.&lt;/p&gt;
&lt;p&gt;To optimize further,
Netzwelt used
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API&quot; rel=&quot;noopener&quot;&gt;Intersection Observer&lt;/a&gt; and the
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Network_Information_API&quot; rel=&quot;noopener&quot;&gt;Network Information API&lt;/a&gt;
to control ad placements and reduce layout shifts.
Different ad positions and lazy loading strategies are used depending on
scroll position and network connection quality,
and ads may be changed from multiple to fixed sizes.
The aim of the algorithm is always to maximize ad viewability while minimizing layout shifts.
Browsers not supporting the NetworkInfo API use a proxy value based on a
combination of device and IP derived network type.
This
&lt;a href=&quot;https://addyosmani.com/blog/adaptive-loading/&quot; rel=&quot;noopener&quot;&gt;adaptive loading&lt;/a&gt;
strategy especially reduces CLS for users with slow internet connections.&lt;/p&gt;
&lt;h3 id=&quot;optimizing-fid&quot;&gt;Optimizing FID &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#optimizing-fid&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;First Input Delay might appear to be a problem for news publishers,
as advertisement often comes with many additional JavaScript libraries.
And there does seem to be a negative impact when looking at lab data like Lighthouse.
However, looking at field data in the
&lt;a href=&quot;https://almanac.httparchive.org/en/2020/performance#fid-by-device&quot; rel=&quot;noopener&quot;&gt;2020 Web Almanac&lt;/a&gt;,
many websites have sufficiently fast response.
Part of this is due to advertising JavaScript loading late (after first input),
caching well (for example getting the treatment of
&lt;a href=&quot;https://v8.dev/blog/code-caching-for-devs&quot; rel=&quot;noopener&quot;&gt;v8 code caching&lt;/a&gt;),
or being optimized well by the ad vendors.
Vendor viewability trackers make sure to avoid
long tasks—so even when the sum of the runtime is long
&lt;a href=&quot;https://web.dev/tbt/&quot;&gt;Total Blocking Time&lt;/a&gt; (TBT) and FID are not affected.
While FID was not a huge problem for Netzwelt, there were still some optimizations to make:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Reducing ad scripts and providers, concentrating on a single stack if possible.&lt;/li&gt;
&lt;li&gt;Loading all scripts with defer or async.&lt;/li&gt;
&lt;li&gt;Using webpack or similar technologies for treeshaking and unbundling.&lt;/li&gt;
&lt;li&gt;Using simple BEM-like CSS rules.&lt;/li&gt;
&lt;li&gt;Avoiding long-running tasks, and using the
&lt;a href=&quot;https://philipwalton.com/articles/idle-until-urgent/&quot; rel=&quot;noopener&quot;&gt;idle-until-urgent&lt;/a&gt; pattern.&lt;/li&gt;
&lt;li&gt;Working with
&lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/rendering/optimize-javascript-execution#use_requestanimationframe_for_visual_changes&quot; rel=&quot;noopener&quot;&gt;RequestAnimationFrame&lt;/a&gt;
wherever layout is affected.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;optimizing-lcp&quot;&gt;Optimizing LCP &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#optimizing-lcp&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The Largest Contentful Paint can be influenced by advertisements in
two ways—explicitly by recognizing an ad as the largest paint,
and indirectly by congesting network bandwidth or affecting critical path so that the actual largest paint
(for example a hero image) can&#39;t load in fast enough.&lt;/p&gt;
&lt;p&gt;Netzwelt had already removed medium rectangle ads from the top ad slots while optimizing for CLS.
This had the additional benefit of ads not becoming the largest element.&lt;/p&gt;
&lt;p&gt;Netzwelt follows a strict policy to prioritize content above ads.
Netzwelt prioritized the hero images and fonts used above the fold
and optimized the critical path to take precedence over advertising scripts and adverts.
This prioritization helped LCP to be unaffected by the ads.&lt;/p&gt;
&lt;p&gt;Besides these optimizations, Netzwelt followed other best practices:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Separated CSS for critical rendering path and put it in the header.&lt;/li&gt;
&lt;li&gt;Preloaded the most important fonts, scripts, and images.&lt;/li&gt;
&lt;li&gt;Avoided lazy-loading images above the fold.&lt;/li&gt;
&lt;li&gt;Used &lt;code&gt;font-display=&amp;quot;swap&amp;quot;&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;gdpr-consent-and-core-web-vitals&quot;&gt;GDPR Consent and Core Web Vitals &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#gdpr-consent-and-core-web-vitals&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Consent dialogs often negatively impact Core Web Vitals.
As with advertisements, there are two ways in which a consent dialog can influence CWV:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Explicitly if it is detected as the largest paint, or causes layout shifts.&lt;/li&gt;
&lt;li&gt;Implicitly, by stealing bandwidth from the actual largest paint,
blocking the critical path to the largest paint,
or delaying ads until consent is in, which can, in turn, trigger layout shifts.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Netzwelt works with a third-party consent provider,
which also implemented optimizations.
First Netzwelt made sure to avoid the straightforward pitfalls:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Consent scripts are loaded async, so as not to block critical resources.&lt;/li&gt;
&lt;li&gt;Consent is formatted so that large elements are not eligible as the largest element within LCP.&lt;/li&gt;
&lt;li&gt;Consent overlay uses &lt;code&gt;position: fixed&lt;/code&gt; to avoid shifts.&lt;/li&gt;
&lt;li&gt;While ads are shown only after consent is given,
adequate whitespace is preserved beforehand to avoid layout shifts when ads load in.&lt;/li&gt;
&lt;li&gt;Making sure the display and positioning of the consent dialog does not trigger layout shifts.
One problem found and fixed here was the scroll-lock option of the service provider,
which disabled scrolling while consent shows by moving the main content of the article on scroll,
causing layout shifts.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After this work, there were still large discrepancies between field and lab CLS.
While lab CLS was close to zero, field values were significantly above thresholds.
After investigation, the culprit was layout shifts within the consent iframe,
which currently are only correctly captured in field data.
Netzwelt continues to work with the third-party consent provider to improve this issue.&lt;/p&gt;
&lt;h3 id=&quot;news-subscription-models-and-core-web-vitals&quot;&gt;News Subscription Models and Core Web Vitals &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#news-subscription-models-and-core-web-vitals&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;News publishers are moving to subscription models to fund journalism.
This model is relevant for Core Web Vitals as people will not subscribe to websites with poor user experience.
In addition, subscribers do not expect to see ads in the paid content,
but hiding ads may cause layout shifts.
The website needs to check if users are entitled to view the content and whether to display ads.
These checks may cause additional latencies, leading to content shifts or a poor user experience.&lt;/p&gt;
&lt;p&gt;Netzwelt is using a model where content is always free,
but subscribers will not see ads.
They investigated different ways to query and store entitlements to reduce latencies and layout shifts.&lt;/p&gt;
&lt;p&gt;An initial query of entitlement always caused latencies,
and therefore if querying the entitlements takes too long, the site will display the last cached state.
For new subscribers, this means a small risk of a paying user seeing ads once.
Users just ending a subscription might see one load without ads before the locally stored entitlements update.
Once entitlements are known, they are stored locally using the LocalStorage API,
to avoid additional latencies and layout shifts during future navigation.&lt;/p&gt;
&lt;h2 id=&quot;optimization-results&quot;&gt;Optimization Results &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#optimization-results&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The results of Netzwelt&#39;s optimizations speak for themselves.
Their PageSpeed Insights score is unrivaled within news publishers worldwide:&lt;/p&gt;
&lt;figure class=&quot;w-figure w-screenshot&quot;&gt;
&lt;img alt=&quot;Screenshot of PageSpeed Insights for the Netzwelt.de site, showing a score of 100.&quot; decoding=&quot;async&quot; height=&quot;622&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/ErZNqWVYCAkOmEu1r7pd.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The optimizations improved the page experience
but were made with the business in mind and enhanced ad experience,
ad viewability, and revenue.
After relaunching the optimized page,
Netzwelt saw CPM increases of 20-30%,
with an ad viewability above 75%.
However, Netzwelt assumes the overall revenue uplift to be even higher.
Traffic increased since the relaunch, probably driven by higher user engagement
and lower bounce rates due to improved UX.
These effects are hard to quantify and set in causal relation to the relaunch,
as traffic naturally fluctuates, and there are also effects from the global pandemic.
These indirect effects are one of the reasons why Netzwelt always looks at all numbers when reviewing their site,
not just CPM, which may be misleading. Core Web Vitals and UX metrics,
in combination with all ad-related metrics, provide the real picture.&lt;/p&gt;
&lt;h2 id=&quot;looking-into-the-future&quot;&gt;Looking into the future &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/netzwelt/#looking-into-the-future&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Netzwelt believes that in a future without third-party cookies, contextual targeting via the content,
combined with good UX and page experience (including ad viewability), is the key to success as a news publisher.&lt;/p&gt;
&lt;p&gt;Therefore Netzwelt doesn&#39;t stop with Core Web Vitals
but goes the extra mile by implementing many modern web capabilities such as Progressive Web Apps (PWA),
offline content, dark mode, the Web Share API, and Trusted Web Activities (TWA) using the new
&lt;a href=&quot;https://developer.chrome.com/docs/android/trusted-web-activity/receive-payments-play-billing/&quot; rel=&quot;noopener&quot;&gt;Digital Goods API&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Martin Schierle</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>The performance effects of too much lazy-loading</title>
      <link href="https://web.dev/lcp-lazy-loading/"/>
      <updated>2021-07-15T00:00:00Z</updated>
      <id>https://web.dev/lcp-lazy-loading/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;Lazy-loading is a technique to defer downloading a resource until it&#39;s needed, which conserves data
and reduces network contention for critical assets. It became a web standard in
&lt;a href=&quot;https://web.dev/browser-level-image-lazy-loading/&quot;&gt;2019&lt;/a&gt; and today &lt;code&gt;loading=&amp;quot;lazy&amp;quot;&lt;/code&gt; for images is
&lt;a href=&quot;https://caniuse.com/loading-lazy-attr&quot; rel=&quot;noopener&quot;&gt;supported&lt;/a&gt; by most major browsers. That sounds great,
but is there such a thing as too much lazy loading?&lt;/p&gt;
&lt;p&gt;This post summarizes how we analyzed publicly available web transparency data and ad hoc A/B testing
to understand the adoption and performance characteristics of native image lazy-loading. What we
found is that lazy-loading can be an amazingly effective tool for reducing unneeded image bytes, but
overuse can negatively affect performance. Concretely, our analysis shows that more eagerly
loading images within the initial viewport—while liberally lazy-loading the rest—can give us the
best of both worlds: fewer bytes loaded and improved &lt;a href=&quot;https://web.dev/vitals/#core-web-vitals&quot;&gt;Core Web Vitals&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;adoption&quot;&gt;Adoption &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/lcp-lazy-loading/#adoption&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;According to the most recent data in &lt;a href=&quot;https://httparchive.org/&quot; rel=&quot;noopener&quot;&gt;HTTP Archive&lt;/a&gt;,
native image lazy-loading is used by &lt;a href=&quot;https://httparchive.org/reports/state-of-images?start=2020_01_01&amp;amp;end=2021_06_01#imgLazy&quot; rel=&quot;noopener&quot;&gt;17%&lt;/a&gt;
of websites and adoption is growing rapidly. This much of a foothold in the ecosystem is remarkable
for a relatively new API.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Pie chart showing WordPress making up 84.1% of lazy-loading adoption, other CMSs 2.3%, and non-CMSs 13.5%.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;491&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/9RDh3CEC9vb1jCjVAIIi.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Breakdown of the types of websites that make use of native image lazy-loading.
    &lt;em&gt;(&lt;a href=&quot;https://gist.github.com/rviscomi/44d80c1a0f4dec9cbafb37347c770278#file-lazy-loading-wp-cms-sql&quot;&gt;Source&lt;/a&gt;)&lt;/em&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://gist.github.com/rviscomi/44d80c1a0f4dec9cbafb37347c770278#file-lazy-loading-wp-cms-sql&quot; rel=&quot;noopener&quot;&gt;Querying&lt;/a&gt;
the raw data in the HTTP Archive project gives us a clearer understanding of what kinds of websites
are driving adoption: 84% of sites that use native image lazy-loading use WordPress, 2% use another
CMS, and the remaining 14% don&#39;t use a known CMS. These results make clear how
&lt;a href=&quot;https://make.wordpress.org/core/2020/07/14/lazy-loading-images-in-5-5/&quot; rel=&quot;noopener&quot;&gt;WordPress is leading the charge&lt;/a&gt;
in adoption.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Timeseries chart of lazy-loading adoption with WordPress being the predominant player compared to other CMSs and non-CMSs, with similar proportions to the previous chart. Total adoption is shown to have rapidly increased from 1% to 17% from July 2020 to June 2021.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;507&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/XgHvIF8JyybNZCNwXL35.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Breakdown of the types of websites that make use of native image lazy-loading.
    &lt;em&gt;(&lt;a href=&quot;https://gist.github.com/rviscomi/44d80c1a0f4dec9cbafb37347c770278#file-lazy-loading-wp-cms-timeseries-sql&quot;&gt;Source&lt;/a&gt;)&lt;/em&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The
&lt;a href=&quot;https://gist.github.com/rviscomi/44d80c1a0f4dec9cbafb37347c770278#file-lazy-loading-wp-cms-timeseries-sql&quot; rel=&quot;noopener&quot;&gt;rate of adoption&lt;/a&gt;
is also worth noting. One year ago in July 2020, WordPress sites that use lazy-loading made up tens
of thousands websites in the corpus of about 6 million (1% of total). Lazy-loading adoption in
WordPress alone has since grown to over 1 million websites (14% of total).&lt;/p&gt;
&lt;h2 id=&quot;correlational-performance&quot;&gt;Correlational performance &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/lcp-lazy-loading/#correlational-performance&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://gist.github.com/rviscomi/44d80c1a0f4dec9cbafb37347c770278#file-lazy-loading-crux-lcp-sql&quot; rel=&quot;noopener&quot;&gt;Digging deeper&lt;/a&gt;
into HTTP Archive, we can compare how pages with and without native image lazy loading perform with
the &lt;a href=&quot;https://web.dev/lcp/&quot;&gt;Largest Contentful Paint&lt;/a&gt; (LCP) metric. The LCP data comes from real-user
experiences from the &lt;a href=&quot;https://developers.google.com/web/tools/chrome-user-experience-report&quot; rel=&quot;noopener&quot;&gt;Chrome User Experience Report&lt;/a&gt; (CrUX) as opposed to synthetic testing in the lab. The chart
below uses a box-and-whisker plot to visualize the distributions of each pages&#39; 75th percentile LCP:
the lines represent the 10th and 90th percentiles and the boxes represent the 25th and 75th
percentiles.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Box and whisker chart showing the 10, 25, 75, and 90th percentiles for pages that do and do not use native image lazy-loading. Comparatively, the LCP distribution of pages that do not use it is faster than those that do.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;488&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/W8gsHQn1IjlRuAgnSizY.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Distribution of all pages&#39; 75th percentile LCP experience, broken down by whether they use native image lazy-loading.
    &lt;em&gt;(&lt;a href=&quot;https://gist.github.com/rviscomi/44d80c1a0f4dec9cbafb37347c770278#file-lazy-loading-crux-lcp-sql&quot;&gt;Source&lt;/a&gt;)&lt;/em&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The median page without lazy-loading has a 75th percentile LCP of 2,922 ms, compared to 3,546 ms for
the median page with lazy-loading. Overall, websites that use lazy-loading tend to have worse LCP
performance.&lt;/p&gt;
&lt;p&gt;It&#39;s important to point out that these are &lt;em&gt;correlational&lt;/em&gt; results and they don&#39;t necessarily point
to lazy-loading as being the &lt;em&gt;cause&lt;/em&gt; of the slower performance. Hypothetically, if WordPress sites
tend to be a bit slower, and given how much they make up the lazy-loading cohort, that could explain
the difference. So let&#39;s try to eliminate that variability by looking only at WordPress sites.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Box and whisker chart showing the 10, 25, 75, and 90th percentiles for WordPress pages that do and do not use native image lazy-loading. Comparatively, the LCP distribution of pages that do not use it is faster than those that do, similar to the previous chart.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;488&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/k1YlIULhqpx3CJV2OPYc.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Distribution of WordPress pages&#39; 75th percentile LCP experience, broken down by whether they use native image lazy-loading.
    &lt;em&gt;(&lt;a href=&quot;https://gist.github.com/rviscomi/44d80c1a0f4dec9cbafb37347c770278#file-lazy-loading-crux-lcp-wordpress-sql&quot;&gt;Source&lt;/a&gt;)&lt;/em&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Unfortunately, the same pattern emerges when we drill down into WordPress pages; those that use
lazy-loading tend to have slower LCP performance. The median WordPress page without lazy-loading has
a 75th percentile LCP of 3,495 ms, compared to 3,768 ms for the median page with lazy-loading.&lt;/p&gt;
&lt;p&gt;This still doesn&#39;t prove that lazy-loading &lt;em&gt;causes&lt;/em&gt; pages to get slower, but using it does coincide
with having slower performance. To try to answer the causality question, we set up a lab-based A/B
test.&lt;/p&gt;
&lt;h2 id=&quot;causal-performance&quot;&gt;Causal performance &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/lcp-lazy-loading/#causal-performance&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The goal for the A/B test was to prove or disprove the hypothesis that native image lazy-loading, as
implemented in WordPress core, resulted in slower LCP performance and fewer image bytes. The
methodology we used was to test a demo WordPress website with the &lt;a href=&quot;https://wordpress.org/themes/twentytwentyone/&quot; rel=&quot;noopener&quot;&gt;twentytwentyone&lt;/a&gt;
theme. We tested
both archive and single page types, which are like the home and article pages, on desktop and
emulated mobile devices using &lt;a href=&quot;https://webpagetest.org/&quot; rel=&quot;noopener&quot;&gt;WebPageTest&lt;/a&gt;. We tested each combination of
pages with and without lazy-loading enabled and ran each test nine times to get the median LCP value
and number of image bytes.&lt;/p&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Series&lt;/th&gt;
        &lt;th&gt;default&lt;/th&gt;
        &lt;th&gt;disabled&lt;/th&gt;
        &lt;th&gt;Difference from default&lt;/th&gt;
      &lt;/tr&gt;
      &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcQM_859caf47f070026732f4da3f70b8afe3-l:fix,210625_BiDcPT_2b89f12170b7180acf06cb35d3125d6a-l:disabled,210625_AiDc28_df202856ac4f0da4748c7a84a7a455a8-l:default&quot;&gt;twentytwentyone-archive-desktop&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;2,029&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,759&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #8fd1b1;&quot;&gt;-13%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcV5_003a2ee20d6ee7323fca102afe3ef511-l:fix,210625_BiDcET_810fe76322f8a6003c38f0bc901e4025-l:disabled,210625_BiDc99_44b0562e9077eb01e1e18dceec69bca9-l:default&quot;&gt;twentytwentyone-archive-mobile&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,657&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,403&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #7ecaa5;&quot;&gt;-15%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_AiDcR8_47e248c3211951b7af3bc9a87f205cc7-l:fix,210625_AiDcXB_3d9db18bf36397fcdc5d3db207d0d9e7-l:disabled,210625_AiDc2G_ee59429fac9a388b2184758078610b61-l:default&quot;&gt;twentytwentyone-single-desktop&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,655&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,726&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #fae3e1;&quot;&gt;4%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcR1_c349d38d4c7151772f2678fa7767ff42-l:fix,210625_AiDcD9_502bb504fc87aebafc5f8c9aaa70faa5-l:disabled,210625_BiDcPS_de2a3e5a526e470287d850d1dbc96fb7-l:default&quot;&gt;twentytwentyone-single-mobile&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,352&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,384&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #fdf0ef;&quot;&gt;2%&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;caption&gt;Change in LCP (ms) by disabling native image lazy-loading on sample WordPress pages.&lt;/caption&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;The results above compare the median LCP in milliseconds for tests on archive and single pages for
desktop and mobile. When we disabled lazy-loading on archive pages, we observed LCP improving by a
significant margin. On single pages, however, the difference was more neutral.&lt;/p&gt;
&lt;p&gt;It&#39;s worth noting that the effect of disabling lazy-loading actually appears to make the single
pages slightly faster. However, the difference in LCP is less than one standard deviation for both
desktop and mobile tests, so we attribute this to variance and consider the change neutral overall.
By comparison, the difference for archive pages is more like two to three standard deviations.&lt;/p&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Series&lt;/th&gt;
        &lt;th&gt;default&lt;/th&gt;
        &lt;th&gt;disabled&lt;/th&gt;
        &lt;th&gt;Difference from default&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcQM_859caf47f070026732f4da3f70b8afe3-l:fix,210625_BiDcPT_2b89f12170b7180acf06cb35d3125d6a-l:disabled,210625_AiDc28_df202856ac4f0da4748c7a84a7a455a8-l:default&quot;&gt;twentytwentyone-archive-desktop&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;577&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1173&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #e67c73;&quot;&gt;103%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcV5_003a2ee20d6ee7323fca102afe3ef511-l:fix,210625_BiDcET_810fe76322f8a6003c38f0bc901e4025-l:disabled,210625_BiDc99_44b0562e9077eb01e1e18dceec69bca9-l:default&quot;&gt;twentytwentyone-archive-mobile&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;172&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;378&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #e67c73;&quot;&gt;120%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_AiDcR8_47e248c3211951b7af3bc9a87f205cc7-l:fix,210625_AiDcXB_3d9db18bf36397fcdc5d3db207d0d9e7-l:disabled,210625_AiDc2G_ee59429fac9a388b2184758078610b61-l:default&quot;&gt;twentytwentyone-single-desktop&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;301&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;850&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #e67c73;&quot;&gt;183%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcR1_c349d38d4c7151772f2678fa7767ff42-l:fix,210625_AiDcD9_502bb504fc87aebafc5f8c9aaa70faa5-l:disabled,210625_BiDcPS_de2a3e5a526e470287d850d1dbc96fb7-l:default&quot;&gt;twentytwentyone-single-mobile&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;114&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;378&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #e67c73;&quot;&gt;233%&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;caption&gt;Change in the number of image bytes (KB) by disabling native image lazy-loading on sample WordPress pages.&lt;/caption&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;The results above compare the median number of image bytes (in KB) for each test. As expected,
lazy-loading has a very clear positive effect on reducing the number of image bytes. If a real user
were to scroll the entire page down, all images would load anyway as they cross into the viewport,
but these results show the improved performance of the initial page load.&lt;/p&gt;
&lt;p&gt;To summarize the results of the A/B test, the lazy-loading technique used by WordPress very clearly
helps reduce image bytes but at the cost of a delayed LCP.&lt;/p&gt;
&lt;h2 id=&quot;testing-a-fix&quot;&gt;Testing a fix &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/lcp-lazy-loading/#testing-a-fix&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Before we get into how the fix was implemented, let&#39;s look at how lazy-loading works in WordPress
today. The most important aspect of the current implementation is that it lazy-loads images above
the fold (within the viewport). The CMS blog post
&lt;a href=&quot;https://web.dev/browser-level-lazy-loading-for-cmss/#avoid-lazy-loading-above-the-fold-elements&quot;&gt;acknowledges&lt;/a&gt;
this as a pattern to avoid, but experimental data at the time indicated that the effect on LCP was
minimal and worth simplifying the implementation in WordPress core.&lt;/p&gt;
&lt;p&gt;Given this new data, we created an experimental fix that avoids lazy-loading images that are above
the fold and we tested it under the same conditions as the first A/B test.&lt;/p&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Series&lt;/th&gt;
        &lt;th&gt;default&lt;/th&gt;
        &lt;th&gt;disabled&lt;/th&gt;
        &lt;th&gt;fix&lt;/th&gt;
        &lt;th&gt;Difference from default&lt;/th&gt;
        &lt;th&gt;Difference from disabled&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcQM_859caf47f070026732f4da3f70b8afe3-l:fix,210625_BiDcPT_2b89f12170b7180acf06cb35d3125d6a-l:disabled,210625_AiDc28_df202856ac4f0da4748c7a84a7a455a8-l:default&quot;&gt;twentytwentyone-archive-desktop&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;2,029&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,759&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,749&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #8bd0ae;&quot;&gt;-14%&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #fafdfb;&quot;&gt;-1%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcV5_003a2ee20d6ee7323fca102afe3ef511-l:fix,210625_BiDcET_810fe76322f8a6003c38f0bc901e4025-l:disabled,210625_BiDc99_44b0562e9077eb01e1e18dceec69bca9-l:default&quot;&gt;twentytwentyone-archive-mobile&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,657&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,403&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,352&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #64c093;&quot;&gt;-18%&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #e0f2e9;&quot;&gt;-4%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_AiDcR8_47e248c3211951b7af3bc9a87f205cc7-l:fix,210625_AiDcXB_3d9db18bf36397fcdc5d3db207d0d9e7-l:disabled,210625_AiDc2G_ee59429fac9a388b2184758078610b61-l:default&quot;&gt;twentytwentyone-single-desktop&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,655&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,726&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,676&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #fef7f7;&quot;&gt;1%&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #e6f5ee;&quot;&gt;-3%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcR1_c349d38d4c7151772f2678fa7767ff42-l:fix,210625_AiDcD9_502bb504fc87aebafc5f8c9aaa70faa5-l:disabled,210625_BiDcPS_de2a3e5a526e470287d850d1dbc96fb7-l:default&quot;&gt;twentytwentyone-single-mobile&lt;/a&gt;&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,352&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,384&lt;/td&gt;
        &lt;td style=&quot;text-align: right;&quot;&gt;1,342&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #f8fcfa;&quot;&gt;-1%&lt;/td&gt;
        &lt;td style=&quot;text-align: right; background-color: #e6f5ee;&quot;&gt;-3%&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;caption&gt;Change in LCP (ms) by the proposed fix for native image lazy-loading on sample WordPress pages.&lt;/caption&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;These results are much more promising. Lazy-loading only the images below the fold results in a
complete reversal of the LCP regression and possibly even a slight &lt;em&gt;improvement&lt;/em&gt; over disabling LCP
entirely. How could it be faster than not lazy-loading at all? One explanation is that by not
loading below-the-fold images, there&#39;s less network contention with the LCP image, which enables it
to load more quickly.&lt;/p&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
  &lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Series&lt;/th&gt;
      &lt;th&gt;default&lt;/th&gt;
      &lt;th&gt;disabled&lt;/th&gt;
      &lt;th&gt;fix&lt;/th&gt;
      &lt;th&gt;Difference from default&lt;/th&gt;
      &lt;th&gt;Difference from disabled&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcQM_859caf47f070026732f4da3f70b8afe3-l:fix,210625_BiDcPT_2b89f12170b7180acf06cb35d3125d6a-l:disabled,210625_AiDc28_df202856ac4f0da4748c7a84a7a455a8-l:default&quot;&gt;twentytwentyone-archive-desktop&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;577&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;1173&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;577&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;0%&lt;/td&gt;
      &lt;td style=&quot;text-align: right; background-color: #a9dcc3;&quot;&gt;-51%&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcV5_003a2ee20d6ee7323fca102afe3ef511-l:fix,210625_BiDcET_810fe76322f8a6003c38f0bc901e4025-l:disabled,210625_BiDc99_44b0562e9077eb01e1e18dceec69bca9-l:default&quot;&gt;twentytwentyone-archive-mobile&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;172&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;378&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;172&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;0%&lt;/td&gt;
      &lt;td style=&quot;text-align: right; background-color: #a3d9bf;&quot;&gt;-54%&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_AiDcR8_47e248c3211951b7af3bc9a87f205cc7-l:fix,210625_AiDcXB_3d9db18bf36397fcdc5d3db207d0d9e7-l:disabled,210625_AiDc2G_ee59429fac9a388b2184758078610b61-l:default&quot;&gt;twentytwentyone-single-desktop&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;301&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;850&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;301&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;0%&lt;/td&gt;
      &lt;td style=&quot;text-align: right; background-color: #92d3b3;&quot;&gt;-65%&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.webpagetest.org/video/compare.php?medianMetric=chromeUserTiming.LargestContentfulPaint&amp;highlightLCP=1&amp;thumbSize=200&amp;ival=100&amp;end=visual&amp;tests=210625_BiDcR1_c349d38d4c7151772f2678fa7767ff42-l:fix,210625_AiDcD9_502bb504fc87aebafc5f8c9aaa70faa5-l:disabled,210625_BiDcPS_de2a3e5a526e470287d850d1dbc96fb7-l:default&quot;&gt;twentytwentyone-single-mobile&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;114&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;378&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;114&lt;/td&gt;
      &lt;td style=&quot;text-align: right;&quot;&gt;0%&lt;/td&gt;
      &lt;td style=&quot;text-align: right; background-color: #89cfad;&quot;&gt;-70%&lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;caption&gt;Change in the number of image bytes (KB) by the proposed fix for native image lazy-loading on sample WordPress pages.&lt;/caption&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;In terms of image bytes, the fix has absolutely no change as compared to the default behavior. This
is great because that was one of the strengths of the current approach.&lt;/p&gt;
&lt;p&gt;There are some caveats with this fix. WordPress determines which images to lazy-load on the
server-side, which means that it doesn&#39;t know anything about the user&#39;s viewport size or whether
images will initially load within it. So the fix uses heuristics about the images&#39; relative location
in the markup to guess whether it will be in the viewport. Specifically, if the image is the first
featured image on the page or the first image in the main content, it&#39;s assumed to be above the fold
(or close to it), and it will not be lazy-loaded. Page-level conditions like the number of words in
the heading or the amount of paragraph text early in the main content may affect whether the image
is within the viewport. There are also user-level conditions that may affect the accuracy of the
heuristics, especially the viewport size and the usage of anchor links that change the scroll
position of the page. For those reasons, it&#39;s important to acknowledge that the fix is only
calibrated to provide good performance in the general case and fine-tuning may be needed to make
these results applicable to all real-world scenarios.&lt;/p&gt;
&lt;h2 id=&quot;rolling-it-out&quot;&gt;Rolling it out &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/lcp-lazy-loading/#rolling-it-out&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now that we&#39;ve identified a better way to lazy-load images, all of the image savings and faster LCP
performance, how can we get sites to start using it? The highest priority change is to submit a
patch to WordPress core to implement the experimental fix. We&#39;ll also be updating the guidance in
the &lt;a href=&quot;https://web.dev/browser-level-lazy-loading-for-cmss/&quot;&gt;Browser-level lazy-loading for CMSs&lt;/a&gt; blog
post to clarify the negative effects of above-the-fold lazy-loading and how CMSs can use heuristics
to avoid it.&lt;/p&gt;
&lt;p&gt;Since these best practices are applicable to all web developers, it may also be worth flagging
lazy-loading antipatterns in tools like Lighthouse. Refer to the &lt;a href=&quot;https://github.com/GoogleChrome/lighthouse/issues/12785&quot; rel=&quot;noopener&quot;&gt;feature
request&lt;/a&gt; on GitHub if you&#39;re interested to
follow along with progress on that audit. Until then, one thing developers could do to find
instances of LCP elements being lazy-loaded is to add more detailed logging to their field data.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;webVitals&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getLCP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;lcp&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; latestEntry &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lcp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;entries&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;lcp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;entries&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latestEntry&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;element&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAttribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;loading&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;lazy&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;warn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Warning: LCP element was lazy loaded&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; latestEntry&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The JavaScript snippet above will evaluate the most recent LCP element and log a warning if it was
lazy-loaded.&lt;/p&gt;
&lt;p&gt;This also highlights a sharp edge of the lazy-loading technique and the potential for API
improvements at the platform level. For example, there&#39;s an open issue in Chromium to
&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=996963&quot; rel=&quot;noopener&quot;&gt;experiment&lt;/a&gt; with natively loading the
first few images eagerly, similar to the fix, despite the &lt;code&gt;loading&lt;/code&gt; attribute.&lt;/p&gt;
&lt;h2 id=&quot;wrapping-it-up&quot;&gt;Wrapping it up &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/lcp-lazy-loading/#wrapping-it-up&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If your site uses native image lazy-loading, check how it&#39;s implemented and run A/B tests to better
understand its performance costs. It may benefit from more eagerly loading images above the fold. If
you have a WordPress site, there will hopefully be a patch landing in WordPress core soon. And if
you&#39;re using another CMS, make sure they&#39;re aware of the potential performance issues described
here.&lt;/p&gt;
&lt;p&gt;Trying out relatively new web platform APIs can come with both risks and rewards—they&#39;re called
cutting edge features for a reason. While we&#39;re starting to get a sense of the thorniness of native
image lazy-loading, we&#39;re also seeing the upsides of how to use it to achieve better performance.&lt;/p&gt;
&lt;p&gt;&lt;small&gt;&lt;em&gt;Photo by &lt;a href=&quot;https://unsplash.com/@frankielopez?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText&quot;&gt;Frankie Lopez&lt;/a&gt; on &lt;a href=&quot;https://unsplash.com/s/photos/prickly-pear?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText&quot;&gt;Unsplash&lt;/a&gt;&lt;/em&gt;&lt;/small&gt;&lt;/p&gt;
</content>
      <author>
          <name>Rick Viscomi</name>
        </author><author>
          <name>Felix Arntz</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Building a breadcrumbs component</title>
      <link href="https://web.dev/building-a-breadcrumbs-component/"/>
      <updated>2021-07-14T00:00:00Z</updated>
      <id>https://web.dev/building-a-breadcrumbs-component/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;In this post I want to share thinking on a way to build breadcrumb components.
&lt;a href=&quot;https://gui-challenges.web.app/breadcrumbs/dist/&quot; rel=&quot;noopener&quot;&gt;Try the demo&lt;/a&gt;.&lt;/p&gt;
&lt;figure class=&quot;w-figure w-figure--fullbleed&quot;&gt;
  &lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/90PkYJ8y9wi2U1w034gv.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    &lt;a href=&quot;https://gui-challenges.web.app/breadcrumbs/dist/&quot;&gt;Demo&lt;/a&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;If you prefer video, here&#39;s a YouTube version of this post:&lt;/p&gt;
&lt;div class=&quot;youtube&quot;&gt;  &lt;lite-youtube videoid=&quot;kHL3gxAlvK8&quot;&gt;  &lt;/lite-youtube&gt;&lt;/div&gt;
&lt;h2 id=&quot;overview&quot;&gt;Overview &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#overview&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A &lt;a href=&quot;https://codepen.io/search/pens?q=breadcrumbs&quot; rel=&quot;noopener&quot;&gt;breadcrumbs&lt;/a&gt; component shows
where in the site hierarchy the user is. The name is from &lt;a href=&quot;https://en.wikipedia.org/wiki/Hansel_and_Gretel&quot; rel=&quot;noopener&quot;&gt;Hansel and
Gretel&lt;/a&gt;, who dropped
breadcrumbs behind them in some dark woods and were able to find their way home
by tracing crumbs backwards.&lt;/p&gt;
&lt;p&gt;The breadcrumbs in this post are not &lt;a href=&quot;https://www.w3.org/TR/wai-aria-practices-1.1/examples/breadcrumb/index.html&quot; rel=&quot;noopener&quot;&gt;standard
breadcrumbs&lt;/a&gt;,
they&#39;re breadcrumb-like. They offer additional functionality by putting sibling
pages right into the navigation with a &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt;, making multi-tiered access
possible.&lt;/p&gt;
&lt;h3 id=&quot;background-ux&quot;&gt;Background UX &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#background-ux&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In the component demo video above, the placeholder categories are genres of
video games. This trail is created by navigating the following path:  &lt;code&gt;home » rpg » indie » on sale&lt;/code&gt;, as shown below.&lt;/p&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/u3nemRGC7g39sVvPnUBh.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;This breadcrumb component should enable users to move through this
information hierarchy; jumping branches and selecting pages with speed and
accuracy.&lt;/p&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/69hQj4fuf6cJltEqGxDJ.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h2 id=&quot;information-architecture&quot;&gt;Information architecture &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#information-architecture&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I find it&#39;s helpful to think in terms of collections and items.&lt;/p&gt;
&lt;h3 id=&quot;collections&quot;&gt;Collections &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#collections&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A collection is an array of options to choose from. From the homepage of
the breadcrumb prototype of this post, the collections are FPS, RPG, brawler,
dungeon crawler, sports and puzzle.&lt;/p&gt;
&lt;h3 id=&quot;items&quot;&gt;Items &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#items&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A video game is an item, a specific collection could also be an item if it
represents another collection. For example, RPG is an item and a valid
collection. When it&#39;s an item, the user is on that collection page. For example,
they are on  the RPG page, which displays a list of RPG games, including the
additional subcategories AAA, Indie and Self Published.&lt;/p&gt;
&lt;p&gt;In computer science terms, this breadcrumbs component represents a
&lt;a href=&quot;https://www.javascripttutorial.net/javascript-multidimensional-array/&quot; rel=&quot;noopener&quot;&gt;multidimensional
array&lt;/a&gt;:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; rawBreadcrumbData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&quot;FPS&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&quot;RPG&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&quot;AAA&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&quot;indie&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&quot;new&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&quot;on sale&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&quot;under 5&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&quot;self published&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&quot;brawler&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&quot;dungeon crawler&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&quot;sports&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&quot;puzzle&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Your app or website will have custom information architecture (IA) creating a
different multidimensional array, but I hope the concept of collection landing
pages and hierarchy traversal can make it into your breadcrumbs as well.&lt;/p&gt;
&lt;h2 id=&quot;layouts&quot;&gt;Layouts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#layouts&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;markup&quot;&gt;Markup &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#markup&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Good components begin with appropriate HTML. In this next section I&#39;ll cover my
markup choices and how they impact the overall component.&lt;/p&gt;
&lt;h4 id=&quot;dark-and-light-scheme&quot;&gt;Dark and light scheme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#dark-and-light-scheme&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;meta&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;color-scheme&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;dark light&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/I8w6oe28ueaZsDiOFssl.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://web.dev/color-scheme/&quot;&gt;&lt;code&gt;color-scheme&lt;/code&gt;&lt;/a&gt; meta tag in the above
snippet informs the browser that this page wants the light and dark browser
styles. The example breadcrumbs don&#39;t include any CSS for these color schemes,
and so the breadcrumbs will use the default colors provided by the browser.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Try removing all the styles from the demo page. The component works
without them due to the well structured markup. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h4 id=&quot;navigation-element&quot;&gt;Navigation element &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#navigation-element&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;nav&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;breadcrumbs&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;navigation&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;nav&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;It&#39;s appropriate to use the
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTML/Element/nav&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;&amp;lt;nav&amp;gt;&lt;/code&gt;&lt;/a&gt; element
for site navigation, which has an implicit ARIA &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/Navigation_Role&quot; rel=&quot;noopener&quot;&gt;role of
navigation&lt;/a&gt;.
In testing, I noticed that having the &lt;code&gt;role&lt;/code&gt; attribute changed the way a
screen reader interacted with the element, it was actually announced as
navigation, and so I&#39;ve chosen to add it.&lt;/p&gt;
&lt;h4 id=&quot;icons&quot;&gt;Icons &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#icons&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;When an icon is repeated on a page, the SVG
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/SVG/Element/use&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;&amp;lt;use&amp;gt;&lt;/code&gt;&lt;/a&gt; element
means that you can define the &lt;code&gt;path&lt;/code&gt; once, and use it for all instances of the
icon. This prevents the same path information from being repeated, causing
larger documents and the potential of path inconsistency.&lt;/p&gt;
&lt;p&gt;To use this technique, add a hidden SVG element to the page and wrap the icons
in a &lt;code&gt;&amp;lt;symbol&amp;gt;&lt;/code&gt; element with a unique ID:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;svg&lt;/span&gt; &lt;span class=&quot;token special-attr&quot;&gt;&lt;span class=&quot;token attr-name&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token value css language-css&quot;&gt;&lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;symbol&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;icon-home&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;title&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;A home icon&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;title&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;path&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;symbol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;symbol&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;icon-dropdown-arrow&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;title&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;A down arrow&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;title&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;path&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;M19 9l-7 7-7-7&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;symbol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;svg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The browser reads the SVG HTML, puts the icon information into memory, and
continues with the rest of the page referencing the ID for additional uses of
the icon, like this:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;svg&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;viewBox&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;0 0 24 24&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;24&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;24&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;aria-hidden&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;true&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;use&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;#icon-home&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;svg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;svg&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;viewBox&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;0 0 24 24&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;24&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;24&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;aria-hidden&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;true&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;use&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;#icon-dropdown-arrow&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;svg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;DevTools showing a rendered &amp;#x60;&amp;lt;use&amp;gt;&amp;#x60; SVG element.&quot; decoding=&quot;async&quot; height=&quot;447&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/BVkOZ3YnQBgF6K09sLTE.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Define once, use as many times as you like, with minimal page performance impact
and flexible styling. Notice &lt;code&gt;aria-hidden=&amp;quot;true&amp;quot;&lt;/code&gt; is added to the SVG element.
The icons are not useful to someone browsing who only hears the content, hiding
them from those users stops them adding unnecessary noise.&lt;/p&gt;
&lt;h4 id=&quot;split-link-.crumb&quot;&gt;Split-link &lt;code&gt;.crumb&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#split-link-.crumb&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;This is where the traditional breadcrumb and those in this component diverge.
Normally, this would only be an &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; link, but I&#39;ve added traversal UX with a
disguised select. The &lt;code&gt;.crumb&lt;/code&gt; class is responsible for laying out the link and
the icon, while the &lt;code&gt;.crumbicon&lt;/code&gt; is responsible for stacking the icon and select
element together. I&#39;ve called it a split-link because its functions are very
similar to a &lt;a href=&quot;https://www.nngroup.com/articles/split-buttons/&quot; rel=&quot;noopener&quot;&gt;split-button&lt;/a&gt;,
but for page navigation.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;crumb&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;a&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;#sub-collection-b&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Category B&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;a&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;crumbicon&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;svg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;...&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;svg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;select&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;disguised-select&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;Navigate to another category&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Category A&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;option&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;selected&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Category B&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Category C&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;option&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;select&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;A link and some options is nothing special but adds more functionality to a
simple breadcrumb. Adding a &lt;code&gt;title&lt;/code&gt; to the &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; element is helpful for screen
reader users, giving them information about the action of the button. However it
provides the same help to everyone else too, you&#39;ll see it&#39;s front and center on
iPad. One attribute provides button context to many users.&lt;/p&gt;
&lt;img alt=&quot;Screenshot with the invisible select element being hovered and its contextual tooltip showing.&quot; decoding=&quot;async&quot; height=&quot;83&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 271px) 271px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/IbANGFRfyEC61P7ETlGp.png?auto=format&amp;w=542 542w&quot; width=&quot;271&quot; /&gt;
&lt;h4 id=&quot;separator-decorations&quot;&gt;Separator decorations &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#separator-decorations&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;span&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;crumb-separator&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;aria-hidden&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;true&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;→&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/LASjAldbKTMivtF01aWo.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;Separators are optional, adding just one works great too (see the third example in the video
above). I then give each &lt;code&gt;aria-hidden=&amp;quot;true&amp;quot;&lt;/code&gt; since they are decorative and not
something a screen reader needs to announce.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://web.dev/flexbox-gap&quot;&gt;&lt;code&gt;gap&lt;/code&gt;&lt;/a&gt; property, covered next, makes the spacing of these straightforward.&lt;/p&gt;
&lt;h3 id=&quot;styles&quot;&gt;Styles &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#styles&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Since the color uses &lt;a href=&quot;https://www.w3.org/TR/css-color-4/#css-system-colors&quot; rel=&quot;noopener&quot;&gt;system colors&lt;/a&gt;, it&#39;s mostly gaps and stacks for styles!&lt;/p&gt;
&lt;h4 id=&quot;layout-direction-and-flow&quot;&gt;Layout direction and flow &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#layout-direction-and-flow&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;img alt=&quot;DevTools showing breadcrumb nav alignment with a its flexbox overlay feature.&quot; decoding=&quot;async&quot; height=&quot;74&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/uPs9kdqJgyaY5GWqdZHP.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;The primary navigation element &lt;code&gt;nav.breadcrumbs&lt;/code&gt; sets a scoped custom property
for children to use, and otherwise establishes a horizontal vertically aligned
layout. This ensures that the crumbs, dividers, and icons align.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.breadcrumbs&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--nav-gap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 2ch&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;align-items&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; center&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;gap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--nav-gap&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--nav-gap&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;One breadcrumb shown vertically aligned with flexbox overlays.&quot; decoding=&quot;async&quot; height=&quot;66&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 167px) 167px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/8JJyoerH462n22u0vD2R.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/8JJyoerH462n22u0vD2R.png?auto=format&amp;w=167 167w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/8JJyoerH462n22u0vD2R.png?auto=format&amp;w=190 190w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/8JJyoerH462n22u0vD2R.png?auto=format&amp;w=217 217w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/8JJyoerH462n22u0vD2R.png?auto=format&amp;w=247 247w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/8JJyoerH462n22u0vD2R.png?auto=format&amp;w=282 282w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/8JJyoerH462n22u0vD2R.png?auto=format&amp;w=322 322w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/8JJyoerH462n22u0vD2R.png?auto=format&amp;w=334 334w&quot; width=&quot;167&quot; /&gt;
&lt;p&gt;Each &lt;code&gt;.crumb&lt;/code&gt; also establishes a horizontal vertically aligned layout with some
gap, but specially targets its link children and specifies the style
&lt;code&gt;white-space: nowrap&lt;/code&gt;. This is crucial for multi-word breadcrumbs as we dont
want them to go multi-line. Later in this post we&#39;ll add styles to handle the
horizontal overflow this &lt;code&gt;white-space&lt;/code&gt; property caused.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.crumb&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; inline-flex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;align-items&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; center&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;gap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--nav-gap&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 4&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;&amp;amp; &gt; a&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;white-space&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; nowrap&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token selector&quot;&gt;&amp;amp;[aria-current=&quot;page&quot;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;font-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; bold&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;aria-current=&amp;quot;page&amp;quot;&lt;/code&gt; is added to help the current page link stand out from the
rest. Not only will screen reader users have a clear indicator that the link is
for the current page, we&#39;ve visually styled the element to help sighted users
get a similar user experience.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;.crumbicon&lt;/code&gt; component uses grid to stack an SVG icon with a &amp;quot;nearly
invisible&amp;quot; &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; element.&lt;/p&gt;
&lt;img alt=&quot;Grid DevTools shown overlaying a button where the row and column are both named stack.&quot; decoding=&quot;async&quot; height=&quot;180&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 218px) 218px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jx2uAiFT8NEHD5AbuSp3.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jx2uAiFT8NEHD5AbuSp3.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jx2uAiFT8NEHD5AbuSp3.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jx2uAiFT8NEHD5AbuSp3.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jx2uAiFT8NEHD5AbuSp3.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jx2uAiFT8NEHD5AbuSp3.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jx2uAiFT8NEHD5AbuSp3.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jx2uAiFT8NEHD5AbuSp3.png?auto=format&amp;w=436 436w&quot; width=&quot;218&quot; /&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.crumbicon&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;--crumbicon-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 3ch&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; grid&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; [stack] &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--crumbicon-size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / [stack] &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--crumbicon-size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;place-items&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; center&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token selector&quot;&gt;&amp;amp; &gt; *&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;    &lt;span class=&quot;token property&quot;&gt;grid-area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; stack&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; element is last in the DOM, so it&#39;s on top of the stack,
and interactive. Add a style of &lt;code&gt;opacity: .01&lt;/code&gt; so the element is still usable,
and the result is a select box that fits perfectly to the shape of the icon.
This is a nice way to customize the look of a &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; element while
maintaining the built-in functionality.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.disguised-select&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;inline-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 100%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;block-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 100%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .01&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 16px&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;/* Defaults to 16px; fixes iOS zoom */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Try using this icon component from mobile!&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/n3MsbELMwsvYn355hXdi.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h4 id=&quot;overflow&quot;&gt;Overflow &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#overflow&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Breadcrumbs should be able to represent a very long trail. I&#39;m a fan of allowing
things to go offscreen horizontally, when appropriate, and I felt this
breadcrumbs component qualified well.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.breadcrumbs&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;overflow-x&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; auto&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;overscroll-behavior-x&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; contain&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;scroll-snap-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; x proximity&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;scroll-padding-inline&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--nav-gap&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;&amp;amp; &gt; .crumb:last-of-type&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;scroll-snap-align&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; end&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@supports&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;-webkit-hyphens&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;none&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token selector&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;scroll-snap-type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The overflow styles set up the following UX:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Horizontal scroll with overscroll containment.&lt;/li&gt;
&lt;li&gt;Horizontal scroll padding.&lt;/li&gt;
&lt;li&gt;One snap point on the last crumb. This means that on page load the first
crumb loads snapped and in view.&lt;/li&gt;
&lt;li&gt;Removes the snap point from Safari, which struggles with the horizontal
scrolling and snap effect combinations.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;media-queries&quot;&gt;Media queries &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#media-queries&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;One subtle adjustment for smaller viewports is to hide the &amp;quot;Home&amp;quot; label, leaving
just the icon:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;width &amp;lt;= 480px&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.breadcrumbs .home-label&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;Side by side of the breadcrumbs with and without a home label, for comparison.&quot; decoding=&quot;async&quot; height=&quot;84&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/T47A7AUqFPuneqNK3GWa.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;accessibility&quot;&gt;Accessibility &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#accessibility&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;motion&quot;&gt;Motion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#motion&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;There isn&#39;t a whole lot of motion in this component, but by wrapping the
transition in a &lt;code&gt;prefers-reduced-motion&lt;/code&gt; check, we can prevent unwanted motion.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;prefers-reduced-motion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; no-preference&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.crumbicon&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; box-shadow .2s ease&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;None of the other styles need to change, the hover and focus effects are great
and meaningful without a &lt;code&gt;transition&lt;/code&gt;, but if motion is okay, we&#39;ll add a subtle
transition to the interaction.&lt;/p&gt;
&lt;h3 id=&quot;javascript&quot;&gt;JavaScript &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#javascript&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;First, regardless of the type of router you use in your site or application,
when a user changes the breadcrumbs, the URL needs to be updated and the user
shown the appropriate page. Second, to normalize the user experience, make sure
no unexpected navigations happen when users are just browsing &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt;
options.&lt;/p&gt;
&lt;p&gt;Two critical user experience measures to be handled by JavaScript: select has
changed and eager &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; change event firing prevention.&lt;/p&gt;
&lt;p&gt;The eager event prevention is needed due to the use of a &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt;
element. On Windows Edge, and probably other browsers too, the select &lt;code&gt;changed&lt;/code&gt;
event fires as the user browses options with the keyboard. This is why I
called it eager, as the user has only pseudo selected the option, like a hover
or focus, yet hasn&#39;t confirmed the choice with &lt;code&gt;enter&lt;/code&gt; or a &lt;code&gt;click&lt;/code&gt;. The eager
event makes this component category change feature inaccessible, because
opening the select box and simply browsing an item will fire the event and
change the page, before the user is ready.&lt;/p&gt;
&lt;h4 id=&quot;a-better-lessselectgreater-changed-event&quot;&gt;A better &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; changed event &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#a-better-lessselectgreater-changed-event&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; crumbs &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelectorAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.breadcrumbs select&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; allowedKeys &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Tab&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Enter&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39; &#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; preventedKeys &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;ArrowUp&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;ArrowDown&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// watch crumbs for changes,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// ensures it&#39;s a full value change, not a user exploring options via keyboard&lt;/span&gt;&lt;br /&gt;crumbs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;nav&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; ignoreChange &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  nav&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;change&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ignoreChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;// it&#39;s actually changed!&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  nav&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;keydown&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; key &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;preventedKeys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;has&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;      ignoreChange &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;allowedKeys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;has&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;      ignoreChange &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The strategy for this is to watch for keyboard down events on each &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt;
element and determine if the key pressed was navigation confirmation (&lt;code&gt;Tab&lt;/code&gt; or
&lt;code&gt;Enter&lt;/code&gt;) or spatial navigation (&lt;code&gt;ArrowUp&lt;/code&gt; or &lt;code&gt;ArrowDown&lt;/code&gt;). With this
determination, the component can decide to wait or go, when the event for the
&lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; element fires.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now that you know how I did it, how would you‽ 🙂&lt;/p&gt;
&lt;p&gt;Let&#39;s diversify our approaches and learn all the ways to build on the web.
Create a demo, &lt;a href=&quot;https://twitter.com/argyleink&quot; rel=&quot;noopener&quot;&gt;tweet me&lt;/a&gt; links, and I&#39;ll add it
to the community remixes section below!&lt;/p&gt;
&lt;h2 id=&quot;community-remixes&quot;&gt;Community remixes &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-breadcrumbs-component/#community-remixes&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Nothing to see here yet.&lt;/em&gt;&lt;/p&gt;
</content>
      <author>
          <name>Adam Argyle</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Using WebAssembly threads from C, C++ and Rust</title>
      <link href="https://web.dev/webassembly-threads/"/>
      <updated>2021-07-12T00:00:00Z</updated>
      <id>https://web.dev/webassembly-threads/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;WebAssembly threads support is one of the most important performance additions to WebAssembly. It
allows you to either run parts of your code in parallel on separate cores, or the same code over
independent parts of the input data, scaling it to as many cores as the user has and significantly
reducing the overall execution time.&lt;/p&gt;
&lt;p&gt;In this article you will learn how to use WebAssembly threads to bring multithreaded applications
written in languages like C, C++, and Rust to the web.&lt;/p&gt;
&lt;h2 id=&quot;how-webassembly-threads-work&quot;&gt;How WebAssembly threads work &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#how-webassembly-threads-work&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;WebAssembly threads is not a separate feature, but a combination of several components that allows
WebAssembly apps to use traditional multithreading paradigms on the web.&lt;/p&gt;
&lt;h3 id=&quot;web-workers&quot;&gt;Web Workers &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#web-workers&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;First component is the regular
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Web_Workers_API/Using_web_workers&quot; rel=&quot;noopener&quot;&gt;Workers&lt;/a&gt; you know and
love from JavaScript. WebAssembly threads use the &lt;code&gt;new Worker&lt;/code&gt; constructor to create new underlying
threads. Each thread loads a JavaScript glue, and then the main thread uses
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Worker/postMessage&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;Worker#postMessage&lt;/code&gt;&lt;/a&gt; method to
share the compiled
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/Module&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;WebAssembly.Module&lt;/code&gt;&lt;/a&gt;
as well as a shared
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/Memory&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;WebAssembly.Memory&lt;/code&gt;&lt;/a&gt;
(see below) with those other threads. This establishes communication and allows all those threads to
run the same WebAssembly code on the same shared memory without going through JavaScript again.&lt;/p&gt;
&lt;p&gt;Web Workers have been around for over a decade now, are widely supported, and don&#39;t require any
special flags.&lt;/p&gt;
&lt;h3 id=&quot;sharedarraybuffer&quot;&gt;&lt;code&gt;SharedArrayBuffer&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#sharedarraybuffer&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;WebAssembly memory is represented by a
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/Memory&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;WebAssembly.Memory&lt;/code&gt;&lt;/a&gt;
object in the JavaScript API. By default &lt;code&gt;WebAssembly.Memory&lt;/code&gt; is a wrapper around an
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;ArrayBuffer&lt;/code&gt;&lt;/a&gt;—a
raw byte buffer that can be accessed only by a single thread.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;WebAssembly&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Memory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; initial&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; maximum&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buffer&lt;br /&gt;ArrayBuffer &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; … &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;To support multithreading, &lt;code&gt;WebAssembly.Memory&lt;/code&gt; gained a shared variant too. When created with a
&lt;code&gt;shared&lt;/code&gt; flag via the JavaScript API, or by the WebAssembly binary itself, it becomes a wrapper
around a
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;SharedArrayBuffer&lt;/code&gt;&lt;/a&gt;
instead. It&#39;s a variation of &lt;code&gt;ArrayBuffer&lt;/code&gt; that can be shared with other threads and read or
modified simultaneously from either side.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;WebAssembly&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Memory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; initial&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; maximum&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; shared&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buffer&lt;br /&gt;SharedArrayBuffer &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; … &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Unlike &lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Worker/postMessage&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;postMessage&lt;/code&gt;&lt;/a&gt;, normally used
for communication between main thread and Web Workers,
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;SharedArrayBuffer&lt;/code&gt;&lt;/a&gt;
doesn&#39;t require copying data or even waiting for the event loop to send and receive messages.
Instead, any changes are seen by all threads nearly instantly, which makes it a much better
compilation target for traditional synchronisation primitives.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SharedArrayBuffer&lt;/code&gt; has a complicated history. It was initially shipped in several browsers
mid-2017, but had to be disabled in the beginning of 2018 due to discovery of &lt;a href=&quot;https://developers.google.com/web/updates/2018/02/meltdown-spectre&quot; rel=&quot;noopener&quot;&gt;Spectre
vulnerabilities&lt;/a&gt;. The particular
reason was that data extraction in Spectre relies on timing attacks—measuring execution time of a
particular piece of code. To make this kind of attack harder, browsers reduced precision of standard
timing APIs like &lt;code&gt;Date.now&lt;/code&gt; and &lt;code&gt;performance.now&lt;/code&gt;. However, shared memory, combined with a simple
counter loop running in a separate thread &lt;a href=&quot;https://github.com/tc39/security/issues/3&quot; rel=&quot;noopener&quot;&gt;is also a very reliable way to get high-precision
timing&lt;/a&gt;, and it&#39;s much harder to mitigate without
significantly throttling runtime performance.&lt;/p&gt;
&lt;p&gt;Instead, Chrome 68 (mid-2018) re-enabled &lt;code&gt;SharedArrayBuffer&lt;/code&gt; again by leveraging &lt;a href=&quot;https://developers.google.com/web/updates/2018/07/site-isolation&quot; rel=&quot;noopener&quot;&gt;Site
Isolation&lt;/a&gt;—a feature that puts
different websites into different processes and makes it much more difficult to use side-channel
attacks like Spectre. However, this mitigation was still limited only to Chrome desktop, as Site
Isolation is a fairly expensive feature, and couldn&#39;t be enabled by default for all sites on
low-memory mobile devices nor was it yet implemented by other vendors.&lt;/p&gt;
&lt;p&gt;Fast-forward to 2020, Chrome and Firefox both have implementations of Site Isolation, and a standard
way for websites to opt-in to the feature with &lt;a href=&quot;https://web.dev/coop-coep/&quot;&gt;COOP and COEP headers&lt;/a&gt;. An opt-in
mechanism allows to use Site Isolation even on low-powered devices where enabling it for all the
websites would be too expensive. To opt-in, add the following headers to the main document in your
server configuration:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-http&quot;&gt;&lt;code class=&quot;language-http&quot;&gt;&lt;span class=&quot;token header-name keyword&quot;&gt;Cross-Origin-Embedder-Policy:&lt;/span&gt; require-corp&lt;br /&gt;&lt;span class=&quot;token header-name keyword&quot;&gt;Cross-Origin-Opener-Policy:&lt;/span&gt; same-origin&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Once you opt-in, you get access to &lt;code&gt;SharedArrayBuffer&lt;/code&gt; (including &lt;code&gt;WebAssembly.Memory&lt;/code&gt; backed by a
&lt;code&gt;SharedArrayBuffer&lt;/code&gt;), precise timers, memory measurement and other APIs that require an isolated
origin for security reasons. Check out the &lt;a href=&quot;https://web.dev/coop-coep/&quot;&gt;Making your website &amp;quot;cross-origin isolated&amp;quot; using COOP
and COEP&lt;/a&gt; for more details.&lt;/p&gt;
&lt;h3 id=&quot;webassembly-atomics&quot;&gt;WebAssembly atomics &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#webassembly-atomics&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;While &lt;code&gt;SharedArrayBuffer&lt;/code&gt; allows each thread to read and write to the same memory, for correct
communication you want to make sure they don&#39;t perform conflicting operations at the same time. For example, it&#39;s
possible for one thread to start reading data from a shared address, while another thread is writing
to it, so the first thread will now get a corrupted result. This category of bugs is known as race
conditions. In order to prevent race conditions, you need to somehow synchronize those accesses.
This is where atomic operations come in.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://webassembly.github.io/threads/core/syntax/instructions.html#atomic-memory-instructions&quot; rel=&quot;noopener&quot;&gt;WebAssembly
atomics&lt;/a&gt;
is an extension to the WebAssembly instruction set that allow to read and write small cells of data
(usually 32- and 64-bit integers) &amp;quot;atomically&amp;quot;. That is, in a way that guarantees that no two
threads are reading or writing to the same cell at the same time, preventing such conflicts at a low
level. Additionally, WebAssembly atomics contain two more instruction kinds—&amp;quot;wait&amp;quot; and &amp;quot;notify&amp;quot;—that
allow one thread to sleep (&amp;quot;wait&amp;quot;) on a given address in a shared memory until another thread wakes
it up via &amp;quot;notify&amp;quot;.&lt;/p&gt;
&lt;p&gt;All the higher-level synchronisation primitives, including channels, mutexes, and read-write locks
build upon those instructions.&lt;/p&gt;
&lt;h2 id=&quot;how-to-use-webassembly-threads&quot;&gt;How to use WebAssembly threads &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#how-to-use-webassembly-threads&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;feature-detection&quot;&gt;Feature detection &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#feature-detection&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;WebAssembly atomics and &lt;code&gt;SharedArrayBuffer&lt;/code&gt; are relatively new features and aren&#39;t yet available in
all browsers with WebAssembly support. You can find which browsers support new WebAssembly features
on the &lt;a href=&quot;https://webassembly.org/roadmap/&quot; rel=&quot;noopener&quot;&gt;webassembly.org roadmap&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To ensure that all users can load your application, you&#39;ll need to implement progressive enhancement
by building two different versions of Wasm—one with multithreading support and one without it. Then
load the supported version depending on feature detection results. To detect WebAssembly threads
support at runtime, use &lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-feature-detect&quot; rel=&quot;noopener&quot;&gt;wasm-feature-detect
library&lt;/a&gt; and load the module like this:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; threads &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;wasm-feature-detect&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; hasThreads &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;threads&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; module &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;  hasThreads&lt;br /&gt;    &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;./module-with-threads.js&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;./module-without-threads.js&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// …now use `module` as you normally would&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Now let&#39;s take a look at how to build a multithreaded version of the WebAssembly module.&lt;/p&gt;
&lt;h3 id=&quot;c&quot;&gt;C &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#c&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In C, particularly on Unix-like systems, the common way to use threads is via &lt;a href=&quot;https://en.wikipedia.org/wiki/POSIX_Threads&quot; rel=&quot;noopener&quot;&gt;POSIX
Threads&lt;/a&gt; provided by the &lt;code&gt;pthread&lt;/code&gt; library. Emscripten
&lt;a href=&quot;https://emscripten.org/docs/porting/pthreads.html&quot; rel=&quot;noopener&quot;&gt;provides an API-compatible implementation&lt;/a&gt; of
the &lt;code&gt;pthread&lt;/code&gt; library built atop Web Workers, shared memory and atomics, so that the same code can
work on the web without changes.&lt;/p&gt;
&lt;p&gt;Let&#39;s take a look at an example:&lt;/p&gt;
&lt;p class=&quot;w-label&quot;&gt;example.c:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-c&quot;&gt;&lt;code class=&quot;language-c&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;stdio.h&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;unistd.h&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;pthread.h&gt;&lt;/span&gt;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;thread_callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;arg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Inside the thread: %d\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;arg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token function&quot;&gt;puts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Before the thread&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token class-name&quot;&gt;pthread_t&lt;/span&gt; thread_id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; arg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;    &lt;span class=&quot;token function&quot;&gt;pthread_create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;thread_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; thread_callback&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;arg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;    &lt;span class=&quot;token function&quot;&gt;pthread_join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;thread_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token function&quot;&gt;puts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;After the thread&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Here the headers for the &lt;code&gt;pthread&lt;/code&gt; library are included via &lt;code&gt;pthread.h&lt;/code&gt;. You can also see a couple
of crucial functions for dealing with threads.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://man7.org/linux/man-pages/man3/pthread_create.3.html&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;pthread_create&lt;/code&gt;&lt;/a&gt; will create a
background thread. It takes a destination to store a thread handle in, some thread creation
attributes (here not passing any, so it&#39;s just &lt;code&gt;NULL&lt;/code&gt;), the callback to be executed in the new
thread (here &lt;code&gt;thread_callback&lt;/code&gt;), and an optional argument pointer to pass to that callback in case
you want to share some data from the main thread—in this example we&#39;re sharing a pointer to a
variable &lt;code&gt;arg&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://man7.org/linux/man-pages/man3/pthread_join.3.html&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;pthread_join&lt;/code&gt;&lt;/a&gt; can be called later at
any time to wait for the thread to finish the execution, and get the result returned from the
callback. It accepts the earlier assigned thread handle as well as a pointer to store the result. In
this case, there aren&#39;t any results so the function takes a &lt;code&gt;NULL&lt;/code&gt; as an argument.&lt;/p&gt;
&lt;p&gt;To compile code using threads with Emscripten, you need to invoke &lt;code&gt;emcc&lt;/code&gt; and pass a &lt;code&gt;-pthread&lt;/code&gt;
parameter, as when compiling the same code with Clang or GCC on other platforms:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;emcc -pthread example.c -o example.js&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;However, when you try to run it in a browser or Node.js, you&#39;ll see a warning and then the program
will hang:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Before the thread&lt;br /&gt;Tried to spawn a new thread, but the thread pool is exhausted.&lt;br /&gt;This might result in a deadlock unless some threads eventually exit or the code&lt;br /&gt;explicitly breaks out to the event loop.&lt;br /&gt;If you want to increase the pool size, use setting `-s PTHREAD_POOL_SIZE=...`.&lt;br /&gt;If you want to throw an explicit error instead of the risk of deadlocking in those&lt;br /&gt;cases, use setting `-s PTHREAD_POOL_SIZE_STRICT=2`.&lt;br /&gt;[…hangs here…]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;What happened? The problem is, most of the time-consuming APIs on the web are asynchronous and rely
on the event loop to execute. This limitation is an important distinction compared to traditional
environments, where applications normally run I/O in synchronous, blocking manner. Check out the
blog post about &lt;a href=&quot;https://web.dev/asyncify/&quot;&gt;Using asynchronous web APIs from WebAssembly&lt;/a&gt; if you&#39;d like to learn
more.&lt;/p&gt;
&lt;p&gt;In this case, the code synchronously invokes &lt;code&gt;pthread_create&lt;/code&gt; to create a background thread, and
follows up by another synchronous call to &lt;code&gt;pthread_join&lt;/code&gt; that waits for the background thread to
finish execution. However, Web Workers, that are used behind the scenes when this code is compiled
with Emscripten, are asynchronous. So what happens is, &lt;code&gt;pthread_create&lt;/code&gt; only &lt;em&gt;schedules&lt;/em&gt; a new
Worker thread to be created on the next event loop run, but then &lt;code&gt;pthread_join&lt;/code&gt; immediately blocks
the event loop to wait for that Worker, and by doing so prevents it from ever being created. It&#39;s a
classic example of a &lt;a href=&quot;https://en.wikipedia.org/wiki/Deadlock&quot; rel=&quot;noopener&quot;&gt;deadlock&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;One way to solve this problem is to create a pool of Workers ahead of time, before the program has
even started. When &lt;code&gt;pthread_create&lt;/code&gt; is invoked, it can take a ready-to-use Worker from the pool, run
the provided callback on its background thread, and return the Worker back to the pool. All of this
can be done synchronously, so there won&#39;t be any deadlocks as long as the pool is sufficiently
large.&lt;/p&gt;
&lt;p&gt;This is exactly what Emscripten allows with the &lt;a href=&quot;https://emsettings.surma.technology/#PTHREAD_POOL_SIZE&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;-s PTHREAD_POOL_SIZE=...&lt;/code&gt;&lt;/a&gt; option. It allows to
specify a number of threads—either a fixed number, or a JavaScript expression like
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/NavigatorConcurrentHardware/hardwareConcurrency&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;navigator.hardwareConcurrency&lt;/code&gt;&lt;/a&gt;
to create as many threads as there are cores on the CPU. The latter option is helpful when your code
can scale to an arbitrary number of threads.&lt;/p&gt;
&lt;p&gt;In the example above, there is only one thread being created, so instead of reserving all cores it&#39;s
sufficient to use &lt;code&gt;-s PTHREAD_POOL_SIZE=1&lt;/code&gt;:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;emcc -pthread -s &lt;span class=&quot;token assign-left variable&quot;&gt;PTHREAD_POOL_SIZE&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; example.c -o example.js&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This time, when you execute it, things work successfully:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Before the thread&lt;br /&gt;Inside the thread: 42&lt;br /&gt;After the thread&lt;br /&gt;Pthread 0x701510 exited.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;There is another problem though: see that &lt;code&gt;sleep(1)&lt;/code&gt; in the code example? It executes in the thread
callback, meaning off the main thread, so it should be fine, right? Well, it isn&#39;t.&lt;/p&gt;
&lt;p&gt;When &lt;code&gt;pthread_join&lt;/code&gt; is called, it has to wait for the thread execution to finish, meaning that if
the created thread is performing long-running tasks—in this case, sleeping 1 second—then the main
thread will also have to block for the same amount of time till the results are back. When this JS
is executed in the browser, it will block the UI thread for 1 second until the thread callback
returns. This leads to poor user experience.&lt;/p&gt;
&lt;p&gt;There are few solutions to this:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pthread_detach&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-s PROXY_TO_PTHREAD&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Custom Worker and Comlink&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;pthread_detach&quot;&gt;pthread_detach &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#pthread_detach&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;First, if you only need to run some tasks off the main thread, but don&#39;t need to wait for the
results, you can use &lt;a href=&quot;https://man7.org/linux/man-pages/man3/pthread_detach.3.html&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;pthread_detach&lt;/code&gt;&lt;/a&gt;
instead of &lt;code&gt;pthread_join&lt;/code&gt;. This will leave the thread callback running in the background. If you&#39;re
using this option, you can switch off the warning with &lt;a href=&quot;https://emsettings.surma.technology/#PTHREAD_POOL_SIZE_STRICT&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;-s PTHREAD_POOL_SIZE_STRICT=0&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;proxy_to_pthread&quot;&gt;PROXY_TO_PTHREAD &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#proxy_to_pthread&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Second, if you&#39;re compiling a C application rather than a library, you can use &lt;a href=&quot;https://emsettings.surma.technology/#PROXY_TO_PTHREAD&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;-s PROXY_TO_PTHREAD&lt;/code&gt;&lt;/a&gt; option, which will offload
the main application code to a separate thread in addition to any nested threads created by the
application itself. This way, main code can block safely at any time without freezing the UI.
Incidentally, when using this option, you don&#39;t have to precreate the thread pool either—instead,
Emscripten can leverage the main thread for creating new underlying Workers, and then block the
helper thread in &lt;code&gt;pthread_join&lt;/code&gt; without deadlocking.&lt;/p&gt;
&lt;h4 id=&quot;comlink&quot;&gt;Comlink &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#comlink&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Third, if you&#39;re working on a library and still need to block, you can create your own Worker,
import the Emscripten-generated code and expose it with
&lt;a href=&quot;https://github.com/GoogleChromeLabs/comlink&quot; rel=&quot;noopener&quot;&gt;Comlink&lt;/a&gt; to the main thread. Main thread will be able
to invoke any exported methods as asynchronous functions, and that way will also avoid blocking the
UI.&lt;/p&gt;
&lt;p&gt;In a simple application such as the previous example &lt;code&gt;-s PROXY_TO_PTHREAD&lt;/code&gt; is the best option:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;emcc -pthread -s PROXY_TO_PTHREAD example.c -o example.js&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;c++&quot;&gt;C++ &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#c++&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;All the same caveats and logic apply in the same way to C++. The only new thing you gain is access
to higher-level APIs like &lt;a href=&quot;https://en.cppreference.com/w/cpp/thread/thread&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;std::thread&lt;/code&gt;&lt;/a&gt; and
&lt;a href=&quot;https://en.cppreference.com/w/cpp/thread/async&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;std::async&lt;/code&gt;&lt;/a&gt;, which use the previously discussed
&lt;code&gt;pthread&lt;/code&gt; library under the hood.&lt;/p&gt;
&lt;p&gt;So the example above can be rewritten in more idiomatic C++ like this:&lt;/p&gt;
&lt;p class=&quot;w-label&quot;&gt;example.cpp:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;iostream&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;thread&gt;&lt;/span&gt;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;chrono&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token function&quot;&gt;puts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Before the thread&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; arg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;    std&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;thread &lt;span class=&quot;token function&quot;&gt;thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;        std&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;this_thread&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sleep_for&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;std&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;chrono&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;seconds&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;        std&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;cout &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Inside the thread: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; arg &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;endl&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;    thread&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    std&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;cout &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;After the thread&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;endl&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;When compiled and executed with similar parameters, it will behave in the same way as the C example:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;emcc -std&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;c++11 -pthread -s PROXY_TO_PTHREAD example.cpp -o example.js&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Output:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Before the thread&lt;br /&gt;Inside the thread: 42&lt;br /&gt;Pthread 0xc06190 exited.&lt;br /&gt;After the thread&lt;br /&gt;Proxied main thread 0xa05c18 finished with return code 0. EXIT_RUNTIME=0 set, so&lt;br /&gt;keeping main thread alive for asynchronous event operations.&lt;br /&gt;Pthread 0xa05c18 exited.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;rust&quot;&gt;Rust &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#rust&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Unlike Emscripten, Rust doesn&#39;t have a specialized end-to-end web target, but instead provides a
generic &lt;code&gt;wasm32-unknown-unknown&lt;/code&gt; target for generic WebAssembly output.&lt;/p&gt;
&lt;p&gt;If Wasm is intended to be used in a web environment, any interaction with JavaScript APIs is left to
external libraries and tooling like &lt;a href=&quot;https://rustwasm.github.io/docs/wasm-bindgen/&quot; rel=&quot;noopener&quot;&gt;wasm-bindgen&lt;/a&gt;
and &lt;a href=&quot;https://rustwasm.github.io/docs/wasm-pack/&quot; rel=&quot;noopener&quot;&gt;wasm-pack&lt;/a&gt;. Unfortunately, this means that the
standard library is not aware of Web Workers and standard APIs such as
&lt;a href=&quot;https://doc.rust-lang.org/std/thread/&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;std::thread&lt;/code&gt;&lt;/a&gt; won&#39;t work when compiled to WebAssembly.&lt;/p&gt;
&lt;p&gt;Luckily, the majority of the ecosystem depends on higher-level libraries to take care of
multithreading. At that level it&#39;s much easier to abstract away all the platform differences.&lt;/p&gt;
&lt;p&gt;In particular, &lt;a href=&quot;https://crates.io/crates/rayon&quot; rel=&quot;noopener&quot;&gt;Rayon&lt;/a&gt; is the most popular choice for
data-parallelism in Rust. It allows you to take method chains on regular iterators and, usually with
a single line change, convert them in a way where they&#39;d run in parallel on all available threads
instead of sequentially. For example:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;pub&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;token function-definition function&quot;&gt;sum_of_squares&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;numbers&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;i32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;-&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;i32&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  numbers&lt;/span&gt;&lt;br /&gt;&lt;del class=&quot;highlight-line highlight-line-remove&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/del&gt;&lt;br /&gt;&lt;ins class=&quot;highlight-line highlight-line-add&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;par_iter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/ins&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token closure-params&quot;&gt;&lt;span class=&quot;token closure-punctuation punctuation&quot;&gt;|&lt;/span&gt;x&lt;span class=&quot;token closure-punctuation punctuation&quot;&gt;|&lt;/span&gt;&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;With this small change, the code will split up the input data, calculate &lt;code&gt;x * x&lt;/code&gt; and partial sums in
parallel threads, and in the end add up those partial results together.&lt;/p&gt;
&lt;p&gt;To accommodate for platforms without working &lt;code&gt;std::thread&lt;/code&gt;, Rayon provides hooks that allow to
define custom logic for spawning and exiting threads.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon&quot; rel=&quot;noopener&quot;&gt;wasm-bindgen-rayon&lt;/a&gt; taps into those hooks
to spawn WebAssembly threads as Web Workers. To use it, you need to add it as a dependency and
follow the configuration steps described in the
&lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon#setting-up&quot; rel=&quot;noopener&quot;&gt;docs&lt;/a&gt;. The example above will
end up looking like this:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;ins class=&quot;highlight-line highlight-line-add&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;pub&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;token namespace&quot;&gt;wasm_bindgen_rayon&lt;span class=&quot;token punctuation&quot;&gt;::&lt;/span&gt;&lt;/span&gt;init_thread_pool&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/ins&gt;&lt;br /&gt;&lt;ins class=&quot;highlight-line highlight-line-add&quot;&gt;&lt;/ins&gt;&lt;br /&gt;&lt;ins class=&quot;highlight-line highlight-line-add&quot;&gt;&lt;span class=&quot;token attribute attr-name&quot;&gt;#[wasm_bindgen]&lt;/span&gt;&lt;/ins&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;pub&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;token function-definition function&quot;&gt;sum_of_squares&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;numbers&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;i32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;-&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;i32&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  numbers&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;par_iter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token closure-params&quot;&gt;&lt;span class=&quot;token closure-punctuation punctuation&quot;&gt;|&lt;/span&gt;x&lt;span class=&quot;token closure-punctuation punctuation&quot;&gt;|&lt;/span&gt;&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Once done, the generated JavaScript will export an extra &lt;code&gt;initThreadPool&lt;/code&gt; function. This function
will create a pool of Workers and reuse them throughout the lifetime of the program for any
multithreaded operations done by Rayon.&lt;/p&gt;
&lt;p&gt;This pool mechanism is similar to the &lt;code&gt;-s PTHREAD_POOL_SIZE=...&lt;/code&gt; option in Emscripten explained
earlier, and also needs to be initialized before the main code to avoid deadlocks:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; init&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; initThreadPool&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sum_of_squares &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;./pkg/index.js&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Regular wasm-bindgen initialization.&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Thread pool initialization with the given number of threads&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// (pass `navigator.hardwareConcurrency` if you want to use all cores).&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;initThreadPool&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;navigator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hardwareConcurrency&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// ...now you can invoke any exported functions as you normally would&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sum_of_squares&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Int32Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 14&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Note that the same &lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon#caveats&quot; rel=&quot;noopener&quot;&gt;caveats&lt;/a&gt; about
blocking the main thread apply here too. Even the &lt;code&gt;sum_of_squares&lt;/code&gt; example still needs to block the
main thread to wait for the partial results from other threads.&lt;/p&gt;
&lt;p&gt;It might be a very short wait or a long one, depending on the complexity of iterators and number of
available threads, but, to be on the safe side, browser engines actively prevent blocking the main
thread altogether and such code will throw an error. Instead, you should create a Worker, import the
&lt;code&gt;wasm-bindgen&lt;/code&gt;-generated code there, and expose its API with a library like
&lt;a href=&quot;https://github.com/GoogleChromeLabs/comlink&quot; rel=&quot;noopener&quot;&gt;Comlink&lt;/a&gt; to the main thread.&lt;/p&gt;
&lt;p&gt;Check out &lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon/tree/main/demo&quot; rel=&quot;noopener&quot;&gt;the wasm-bindgen-rayon
example&lt;/a&gt; for an end-to-end
demo showing:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon/blob/e13485d6d64a062b890f5bb3a842b1fe609eb3c1/demo/wasm-worker.js#L27&quot; rel=&quot;noopener&quot;&gt;Feature detection of
threads.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon/blob/e13485d6d64a062b890f5bb3a842b1fe609eb3c1/demo/package.json#L4-L5&quot; rel=&quot;noopener&quot;&gt;Building single- and multi-threaded versions of the same Rust
app.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon/blob/e13485d6d64a062b890f5bb3a842b1fe609eb3c1/demo/wasm-worker.js#L28-L31&quot; rel=&quot;noopener&quot;&gt;Loading the JS+Wasm generated by wasm-bindgen in a
Worker.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon/blob/e13485d6d64a062b890f5bb3a842b1fe609eb3c1/demo/wasm-worker.js#L32&quot; rel=&quot;noopener&quot;&gt;Using wasm-bindgen-rayon to initialize a thread
pool.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Using Comlink to &lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon/blob/e13485d6d64a062b890f5bb3a842b1fe609eb3c1/demo/wasm-worker.js#L44-L46&quot; rel=&quot;noopener&quot;&gt;expose Worker&#39;s
API&lt;/a&gt;
to &lt;a href=&quot;https://github.com/GoogleChromeLabs/wasm-bindgen-rayon/blob/e13485d6d64a062b890f5bb3a842b1fe609eb3c1/demo/index.js#L25-L29&quot; rel=&quot;noopener&quot;&gt;the main
thread&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;real-world-use-cases&quot;&gt;Real-world use cases &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/webassembly-threads/#real-world-use-cases&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We actively use WebAssembly threads in &lt;a href=&quot;https://squoosh.app/&quot; rel=&quot;noopener&quot;&gt;Squoosh.app&lt;/a&gt; for client-side image
compression—in particular, for formats like AVIF (C++), JPEG-XL (C++), OxiPNG (Rust) and WebP v2
(C++). Thanks to the multithreading alone, we&#39;ve seen consistent 1.5x-3x speed-ups (exact ratio
differs per codec), and were able to push those numbers even further by combining WebAssembly threads
with &lt;a href=&quot;https://v8.dev/features/simd&quot; rel=&quot;noopener&quot;&gt;WebAssembly SIMD&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Google Earth is another notable service that&#39;s using WebAssembly threads for its &lt;a href=&quot;https://earth.google.com/web/&quot; rel=&quot;noopener&quot;&gt;web
version&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://ffmpegwasm.github.io/&quot; rel=&quot;noopener&quot;&gt;FFMPEG.WASM&lt;/a&gt; is a WebAssembly version of a popular
&lt;a href=&quot;https://www.ffmpeg.org/&quot; rel=&quot;noopener&quot;&gt;FFmpeg&lt;/a&gt; multimedia toolchain that uses WebAssembly threads to efficiently
encode videos directly in the browser.&lt;/p&gt;
&lt;p&gt;There are many more exciting examples using WebAssembly threads out there. Be sure to check out
the demos and bring your own multithreaded applications and libraries to the web!&lt;/p&gt;
</content>
      <author>
          <name>Ingvar Stepanyan</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Find your way with field data in the Web Vitals extension update</title>
      <link href="https://web.dev/field-data-in-the-web-vitals-extension/"/>
      <updated>2021-07-02T00:00:00Z</updated>
      <id>https://web.dev/field-data-in-the-web-vitals-extension/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;&lt;a href=&quot;https://web.dev/vitals&quot;&gt;Core Web Vitals&lt;/a&gt; are the most important metrics to measure to
understand your users&#39; experiences, because when users have good experiences,
&lt;a href=&quot;https://wpostats.com/&quot; rel=&quot;noopener&quot;&gt;good things happen&lt;/a&gt;! The &lt;a href=&quot;https://chrome.google.com/webstore/detail/web-vitals/ahfhijdlegdabablpippeagghigmibma?hl=en&quot; rel=&quot;noopener&quot;&gt;Web Vitals extension&lt;/a&gt;
for Chrome is one tool in the &lt;a href=&quot;https://web.dev/vitals-tools/&quot;&gt;Web Vitals toolbox&lt;/a&gt; that shows you
performance data about the pages you visit as you browse the web.&lt;/p&gt;
&lt;p&gt;Page performance depends on many factors, including hardware and network quality. How
you experience a page on your machine may be very different from how the majority of users
experience it. That&#39;s why version 1.0 of the Web Vitals extension includes a new feature
that integrates real-user data from the &lt;a href=&quot;https://web.dev/chrome-ux-report/&quot;&gt;Chrome UX Report&lt;/a&gt; (CrUX)
with your local Core Web Vitals measurements. This feature displays your local measurements
in the context of how other users have experienced the same pages. It comes with
a sparkly new UI and I&#39;m excited to show you how it works.&lt;/p&gt;
&lt;p&gt;&lt;video class=&quot;w-screenshot&quot; controls=&quot;&quot; height=&quot;493&quot; loop=&quot;&quot; muted=&quot;&quot; preload=&quot;auto&quot; width=&quot;800&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/STd8eW8CSiNp5B1bX0R6Dww2eH32/EFeVK6dAwBZWzKhqBd1Y.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h2 id=&quot;field-data-from-crux&quot;&gt;Field data from CrUX &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/field-data-in-the-web-vitals-extension/#field-data-from-crux&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;CrUX is a public dataset of real-user experiences in Chrome. It powers some of the critical tools
in the Core Web Vitals workflow like &lt;a href=&quot;https://support.google.com/webmasters/answer/9205520#about_data&quot; rel=&quot;noopener&quot;&gt;Search Console&lt;/a&gt;
and &lt;a href=&quot;https://developers.google.com/speed/docs/insights/v5/about#crux&quot; rel=&quot;noopener&quot;&gt;PageSpeed Insights&lt;/a&gt;.
The raw data for millions of websites is also publicly queryable in the &lt;a href=&quot;https://web.dev/chrome-ux-report-bigquery&quot;&gt;CrUX dataset on BigQuery&lt;/a&gt;
and the &lt;a href=&quot;https://web.dev/chrome-ux-report-api&quot;&gt;CrUX API&lt;/a&gt;. This Web Vitals extension update
integrates the page and origin-level desktop data from the CrUX API.&lt;/p&gt;
&lt;p&gt;User experience data is broken down into three qualitative ratings: good, needs improvement, and poor.
The thresholds used for each rating are documented in the guides for each of the Core Web Vitals
metrics: &lt;a href=&quot;https://web.dev/lcp/#what-is-lcp&quot;&gt;LCP&lt;/a&gt;, &lt;a href=&quot;https://web.dev/fid/#what-is-fid&quot;&gt;FID&lt;/a&gt;, and
&lt;a href=&quot;https://web.dev/cls/#what-is-a-good-cls-score&quot;&gt;CLS&lt;/a&gt;. So for example, the CrUX API can tell you that
16% of real-user experiences on a given page are evaluated as having good
&lt;span style=&quot;white-space: nowrap;&quot;&gt;LCP under 2.5&lt;/span&gt; seconds.&lt;/p&gt;
&lt;h2 id=&quot;new-extension-ui&quot;&gt;New extension UI &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/field-data-in-the-web-vitals-extension/#new-extension-ui&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Screenshot of the Web Vitals extension showing an explanation of how the local LCP experience relates to real-user desktop data from the field.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;549&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/EaVNEuQ6gxVLtHYNkSZj.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Screenshot of the Web Vitals extension showing an explanation of how the local LCP experience
    relates to real-user desktop data from the field.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In the new Web Vitals extension interface, your local experience is layered on
top of the broader distribution of real-user experiences. It&#39;s like when you&#39;re in an expansive
place like a shopping mall and there&#39;s a big map with all of the stores and a pin labeled
&amp;quot;YOU ARE HERE&amp;quot; to help you orient yourself and find where you&#39;re going.&lt;/p&gt;
&lt;p&gt;The distributions of real-user data from CrUX are laid out on a horizontal bar for each metric.
Your local experiences are displayed as single points on those horizontal bars. The position of
your local experience on the horizontal bar indicates where that experience falls relative to the
real-user distributions. This should make it immediately apparent when your local
experience is very different from other users&#39;. For example, if you have a slow LCP experience and
only 1% of users have similar experiences, something unusual must have happened.&lt;/p&gt;
&lt;h2 id=&quot;falling-back-to-origin-level-data&quot;&gt;Falling back to origin-level data &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/field-data-in-the-web-vitals-extension/#falling-back-to-origin-level-data&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Screenshot of the Web Vitals extension showing origin-level desktop field data with &amp;quot;Waiting for input…&amp;quot; for the FID results.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;552&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/t5SmXUJqJadNsyOi26bb.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Screenshot of the Web Vitals extension showing origin-level desktop field data with
    &quot;Waiting for input…&quot; for the FID results.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Some pages don&#39;t have URL-level data in the CrUX dataset. This can happen
because the page is so new that it hasn&#39;t been picked up yet or because the page has insufficient
traffic to be included in the dataset. In cases like these, Web Vitals extension falls back to more
granular origin-level data whenever possible. This data represents the aggregate user experiences
on all pages of the website, so while it may not be immediately relevant to your particular page
experience, it should still offer some insight into how users experience the site as a whole.&lt;/p&gt;
&lt;p&gt;Another common case is to see a &amp;quot;Waiting for input…&amp;quot; message. This is because FID is the only
Core Web Vital that requires user interaction to be measured, so the extension won&#39;t have any local FID data
to show until you interact with the page.&lt;/p&gt;
&lt;h2 id=&quot;edge-cases&quot;&gt;Edge cases &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/field-data-in-the-web-vitals-extension/#edge-cases&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Screenshot of the Web Vitals extension showing only local data; field data is unavailable.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;548&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/qt6fmKIjPNrUsckKiUfS.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Screenshot of the Web Vitals extension showing only local data; field data is unavailable.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;There are some less common edge cases that you may run into while using the extension.&lt;/p&gt;
&lt;p&gt;It can happen that entire origins have insufficient data. In that case, the extension will just show you
how your local experiences performed.&lt;/p&gt;
&lt;p&gt;How you interact with the page may also affect the relevance of the data. For example, loading the
page in a background tab will count against the LCP metric the entire time until you foreground the page.
If it takes you 90 seconds to switch to the tab, the LCP might appear as 91.5 seconds. When this happens, a little
warning icon will appear next to your LCP value to warn you of the artificial inflation. Note that
these kinds of irrelevant LCP values are ignored in the CrUX dataset.&lt;/p&gt;
&lt;p&gt;One last edge case to be aware of is specific to FID. Because it depends on user interactions, that makes it
less likely to be available in the dataset for pages and websites with fewer page views. So if you&#39;re
visiting a page like that, you may only see field data for LCP and CLS. It&#39;s worth noting for the
sake of completeness that the same could happen for LCP or CLS in extremely rare situations, but
this issue is predominantly affected by FID.&lt;/p&gt;
&lt;h2 id=&quot;comparing-field-data-from-phones&quot;&gt;Comparing field data from phones &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/field-data-in-the-web-vitals-extension/#comparing-field-data-from-phones&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Screenshot of the Web Vitals extension showing local metrics compared to phone field data.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;556&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/STd8eW8CSiNp5B1bX0R6Dww2eH32/0K0g0TD22jdNZpSe3s3p.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Screenshot of the Web Vitals extension showing local metrics compared to phone field data.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;By default, all of the data in the Web Vitals extension corresponds to real desktop users&#39;
experiences from the field. After all, this extension is only available on desktop versions of
Chrome, so it&#39;d be most relevant to see how users under similar conditions experience the
page or origin.&lt;/p&gt;
&lt;p&gt;It&#39;s important to understand phone users&#39; experiences too, so the extension has an advanced setting on
the Options page that lets you see how your local experience compares to phone data from the field.&lt;/p&gt;
&lt;p&gt;To enable phone data in the extension, follow these steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Right click on the extension icon in the toolbar and select &lt;strong&gt;Options&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Check the &lt;strong&gt;Compare local experiences to phone field data&lt;/strong&gt; option.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The UI will update in a few places to indicate which mode you&#39;re in. Be aware that real phone
users&#39; experiences can be &lt;em&gt;very different&lt;/em&gt; from that of desktop users, so use this feature with discretion.&lt;/p&gt;
&lt;h2 id=&quot;get-the-web-vitals-extension&quot;&gt;Get the Web Vitals extension &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/field-data-in-the-web-vitals-extension/#get-the-web-vitals-extension&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To start using the latest version of the Web Vitals extension, head over to the
&lt;a href=&quot;https://chrome.google.com/webstore/detail/web-vitals/ahfhijdlegdabablpippeagghigmibma?hl=en&quot; rel=&quot;noopener&quot;&gt;Chrome Web Store&lt;/a&gt;
to install it. Or if you&#39;re an existing user of the extension, you should be upgraded to
version 1.0 automatically. If you have any feedback about your experience with the extension
(feature requests, bug reports, anything), let us know in the
&lt;a href=&quot;https://github.com/GoogleChrome/web-vitals-extension&quot; rel=&quot;noopener&quot;&gt;open-source repository&lt;/a&gt; on GitHub.
I hope it helps you better understand where your local experiences are in relation to other
real users from the field!&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Image credit: Mark Garlick/Science Photo Library/Getty Images&lt;/em&gt;&lt;/p&gt;
</content>
      <author>
          <name>Rick Viscomi</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Resource inlining in JavaScript frameworks</title>
      <link href="https://web.dev/aurora-resource-inlining/"/>
      <updated>2021-06-28T00:00:00Z</updated>
      <id>https://web.dev/aurora-resource-inlining/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;As part of project &lt;a href=&quot;https://web.dev/introducing-aurora/&quot;&gt;Aurora&lt;/a&gt;, Google has been working with popular web
frameworks to ensure they perform well according to &lt;a href=&quot;https://web.dev/vitals&quot;&gt;Core Web Vitals&lt;/a&gt;. Angular and Next.js
have already landed font inlining, which is explained in the first part of this article. The second
optimization we will cover is critical CSS inlining which is now enabled by default in Angular CLI
and has a work in progress implementation in Nuxt.js.&lt;/p&gt;
&lt;h2 id=&quot;font-inlining&quot;&gt;Font inlining &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/aurora-resource-inlining/#font-inlining&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;After analyzing hundreds of applications, the Aurora team found that developers often include fonts
in their applications by referencing them in the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; element of &lt;code&gt;index.html&lt;/code&gt;. Here&#39;s an example
of how this would look like when including Material Icons:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token doctype&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;!&lt;/span&gt;&lt;span class=&quot;token name&quot;&gt;doctype&lt;/span&gt; &lt;span class=&quot;token name&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;html&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;en&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;head&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://fonts.googleapis.com/icon?family=Material+Icons&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;stylesheet&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  ...&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;html&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Even though this pattern is completely valid and functional, it blocks the application&#39;s rendering
and introduces an extra request. To better understand what is going on, take a look at the source
code of the stylesheet referenced in the HTML above:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/* fallback */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Material Icons&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; normal&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 400&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;https://fonts.gstatic.com/font.woff2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.material-icons&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/*...*/&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Notice how the &lt;code&gt;font-face&lt;/code&gt; definition references an external file hosted on &lt;code&gt;fonts.gstatic.com&lt;/code&gt;.
When loading the application, the browser first has to download the original stylesheet referenced
in the head.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;An image showing how the website has to make a request to the server and download the external stylesheet&quot; decoding=&quot;async&quot; height=&quot;267&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/46NStJqOoW7xsrDe12Uf.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;First, the website loads the font stylesheet.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Next, the browser downloads the &lt;code&gt;woff2&lt;/code&gt; file, then finally, it&#39;s able to proceed with rendering the
application.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;An image showing the two requests made, one for the font stylesheet, the second for the font file.&quot; decoding=&quot;async&quot; height=&quot;281&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/S838B7UEsdXmwrD8q5gvNlWTHHP2/V1uQUNEvw4vHwAW1ekPk.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;Next, a request is made to load the font.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;An opportunity for optimization is to download the initial stylesheet at build time and inline it in
&lt;code&gt;index.html&lt;/code&gt;. This skips an entire round trip to the CDN at runtime, reducing the blocking time.&lt;/p&gt;
&lt;p&gt;When building the application, a request is sent to the CDN, this fetches the stylesheet and inlines
it in the HTML file, adding a &lt;code&gt;&amp;lt;link rel=preconnect&amp;gt;&lt;/code&gt; to the domain. Applying this technique, we&#39;d
get the following result:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token doctype&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;!&lt;/span&gt;&lt;span class=&quot;token name&quot;&gt;doctype&lt;/span&gt; &lt;span class=&quot;token name&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;html&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;en&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;head&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;preconnect&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://fonts.gstatic.com&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;crossorigin&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;style&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;text/css&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token style&quot;&gt;&lt;span class=&quot;token language-css&quot;&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Material Icons&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;font-style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;normal&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;font-weight&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;400&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;https://fonts.gstatic.com/font.woff2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token selector&quot;&gt;.material-icons&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;/*...*/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  ...&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;html&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;font-inlining-is-now-available-in-next.js-and-angular&quot;&gt;Font inlining is now available in Next.js and Angular &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/aurora-resource-inlining/#font-inlining-is-now-available-in-next.js-and-angular&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;When framework developers implement optimization in the underlying tooling, they make it easier for
existing and new applications to enable it, bringing the improvement to the entire ecosystem.&lt;/p&gt;
&lt;p&gt;This improvement is enabled by default from Next.js v10.2 and Angular v11. Both have support for
inlining Google and Adobe fonts. Angular is expecting to introduce the latter in v12.2.&lt;/p&gt;
&lt;p&gt;You can find the implementation of &lt;a href=&quot;https://github.com/vercel/next.js/pull/14746&quot; rel=&quot;noopener&quot;&gt;font inlining in Next.js on
GitHub&lt;/a&gt;, and check out the &lt;a href=&quot;https://www.youtube.com/watch?v=yOpy9UMQG-Y&quot; rel=&quot;noopener&quot;&gt;video explaining this optimization in the
context of Angular&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;inlining-critical-css&quot;&gt;Inlining critical CSS &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/aurora-resource-inlining/#inlining-critical-css&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Another enhancement involves improving the &lt;a href=&quot;https://web.dev/fcp&quot;&gt;First Contentful Paint (FCP)&lt;/a&gt; and &lt;a href=&quot;https://web.dev/lcp&quot;&gt;Largest
Contentful Paint (LCP)&lt;/a&gt; metrics by inlining critical CSS. The critical CSS of a page includes
all of the styles used at its initial rendering. To learn more about the topic, check out
&lt;a href=&quot;https://web.dev/defer-non-critical-css/&quot;&gt;Defer non-critical CSS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We observed that many applications are loading styles synchronously, which blocks application
rendering. A quick fix is to load the styles asynchronously. Rather than loading the scripts with
&lt;code&gt;media=&amp;quot;all&amp;quot;&lt;/code&gt;, set the value of the &lt;code&gt;media&lt;/code&gt; attribute to &lt;code&gt;print&lt;/code&gt;, and once the loading completes,
replace the attribute value to &lt;code&gt;all&lt;/code&gt;:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;stylesheet&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;...&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;print&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token special-attr&quot;&gt;&lt;span class=&quot;token attr-name&quot;&gt;onload&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token value javascript language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;media&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;all&#39;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This practice, however, can cause flickering of unstyled content.&lt;/p&gt;
&lt;figure class=&quot;w-figcaption&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/S838B7UEsdXmwrD8q5gvNlWTHHP2/6ZSZwK3Z0bzK90aunxrW.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption style=&quot;text-align: center;&quot;&gt;
    The page appears to flicker as the styles load in.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The video above shows the rendering of a page, which loads its styles asynchronously. The flicker
happens because the browser first starts downloading the styles, then renders the HTML which
follows. Once the browser downloads the styles, it triggers the &lt;code&gt;onload&lt;/code&gt; event of the link element,
updating the &lt;code&gt;media&lt;/code&gt; attribute to &lt;code&gt;all&lt;/code&gt;, and applies the styles to the DOM.&lt;/p&gt;
&lt;p&gt;During the time between rendering the HTML and applying the styles the page is partially unstyled.
When the browser uses the styles, we see flickering, which is a bad user experience and results in
regressions in &lt;a href=&quot;https://web.dev/cls/&quot;&gt;Cumulative Layout Shift (CLS)&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://web.dev/extract-critical-css/&quot;&gt;Critical CSS inlining&lt;/a&gt;, along with asynchronous style loading, can improve
the loading behavior. The &lt;a href=&quot;http://npmjs.com/package/critters&quot; rel=&quot;noopener&quot;&gt;critters&lt;/a&gt; tool finds which styles are
used on the page, by looking at the selectors in a stylesheet and matching them against the HTML.
When it finds a match, it considers the corresponding styles as part of the critical CSS, and
inlines them.&lt;/p&gt;
&lt;p&gt;Let&#39;s look at an example:&lt;/p&gt;
&lt;figure class=&quot;w-compare&quot;&gt;&lt;p class=&quot;w-compare__label w-compare__label--worse&quot;&gt;Example before inlining&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;head&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;   &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;stylesheet&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;styles.css&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;print&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token special-attr&quot;&gt;&lt;span class=&quot;token attr-name&quot;&gt;onload&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token value javascript language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;media&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;all&#39;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;head&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;section&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;primary&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;section&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/* styles.css */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;section button.primary&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* ... */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.list&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* ... */&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/figure&gt;
&lt;p&gt;In the example above, critters will read and parse the content of &lt;code&gt;styles.css&lt;/code&gt;, after that it
matches the two selectors against the HTML and discovers that we use &lt;code&gt;section button.primary&lt;/code&gt;.
Finally critters will inline the corresponding styles in the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; of the page resulting in:&lt;/p&gt;
&lt;figure class=&quot;w-compare&quot;&gt;&lt;p class=&quot;w-compare__label w-compare__label--better&quot;&gt;Example after inlining&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;head&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;stylesheet&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;styles.css&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;media&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;print&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token special-attr&quot;&gt;&lt;span class=&quot;token attr-name&quot;&gt;onload&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token value javascript language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;media&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;all&#39;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token style&quot;&gt;&lt;span class=&quot;token language-css&quot;&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;section button.primary&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* ... */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;head&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;section&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;primary&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;section&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/figure&gt;
&lt;p&gt;After inlining the critical CSS in the HTML you will find that the flickering of the page is gone:&lt;/p&gt;
&lt;figure class=&quot;w-figcaption&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/S838B7UEsdXmwrD8q5gvNlWTHHP2/TPbZ9TZiDzFEYfybaPoz.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption style=&quot;text-align: center;&quot;&gt;
    The page loading after CSS inlining.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Critical CSS inlining is now available in Angular and enabled by default in v12. If you&#39;re on v11,
turn it on by &lt;a href=&quot;https://angular.io/guide/workspace-config#styles-optimization-options&quot; rel=&quot;noopener&quot;&gt;setting the &lt;code&gt;inlineCritical&lt;/code&gt; property to
&lt;code&gt;true&lt;/code&gt;&lt;/a&gt; in &lt;code&gt;angular.json&lt;/code&gt;. To
opt into this feature in Next.js add &lt;code&gt;experimental: { optimizeCss: true }&lt;/code&gt; to your &lt;code&gt;next.config.js&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Enabling the critical CSS and font inlining on angular.io improved the Lighthouse score
by 27 points on a slow 3G network. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;conclusions&quot;&gt;Conclusions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/aurora-resource-inlining/#conclusions&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In this post we touched on some of the collaboration between Chrome and web frameworks. If you&#39;re a
framework author and recognize some of the problems we tackled in your technology, we hope our
findings inspire you to apply similar performance optimizations.&lt;/p&gt;
&lt;p&gt;Find out more about the improvements at &lt;a href=&quot;https://web.dev/aurora&quot;&gt;web.dev/aurora&lt;/a&gt;. You can find a comprehensive list
of the optimization work we&#39;ve been doing for Core Web Vitals in the post &lt;a href=&quot;https://web.dev/introducing-aurora/#what-has-our-work-unlocked-so-far&quot;&gt;Introducing
Aurora&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Minko Gechev</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Towards a better responsiveness metric</title>
      <link href="https://web.dev/better-responsiveness-metric/"/>
      <updated>2021-06-21T00:00:00Z</updated>
      <id>https://web.dev/better-responsiveness-metric/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;On the Chrome Speed Metrics team, we&#39;re working on deepening our understanding of how quickly web
pages respond to user input. We&#39;d like to share some ideas for improving responsiveness metrics and
hear your feedback.&lt;/p&gt;
&lt;p&gt;This post will cover two main topics:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Review our current responsiveness metric, First Input Delay (FID), and explain why we chose FID
rather than some of the alternatives.&lt;/li&gt;
&lt;li&gt;Present some improvements we&#39;ve been considering that should better capture the end-to-end
latency of individual events. These improvements also aim to capture a more
holistic picture of the overall responsiveness of a page throughout its lifetime.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;what-is-first-input-delay&quot;&gt;What is First Input Delay? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#what-is-first-input-delay&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://web.dev/fid/&quot;&gt;First Input Delay (FID)&lt;/a&gt; metric measures how long it takes the browser to begin
processing the first user interaction on a page. In particular, it measures the difference between
the time when the user interacts with the device and the time when the browser is actually able to
begin processing event handlers. FID is just measured for taps and key presses, which means that it
only considers the very first occurrence of the following events:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;click&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;keydown&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mousedown&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pointerdown&lt;/code&gt; (only if it is followed by &lt;code&gt;pointerup&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The following diagram illustrates FID:&lt;/p&gt;
&lt;img alt=&quot;First Input Delay measures from when input occurs to when input can be handled&quot; decoding=&quot;async&quot; height=&quot;330&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/Jn1Xkxxf03O1llwutAq2.jpeg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;FID does not include the time spent running those event handlers, nor any work done by the browser
afterwards to update the screen. It measures the amount of time the main thread was busy before
having the chance to handle an input. This blocking time is usually caused by long JavaScript tasks,
as these can&#39;t just be stopped at any time, so the current task must complete before the browser can
start processing the input.&lt;/p&gt;
&lt;h3 id=&quot;why-did-we-choose-fid&quot;&gt;Why did we choose FID? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#why-did-we-choose-fid&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We believe it is important to measure actual user experience in order to ensure that improvements on
the metric result in real benefits to the user. We chose to measure FID because it represents the
part of the user experience when the user decides to interact with a site that has just been loaded.
FID captures some of the time that the user has to wait in order to see a response from their
interaction with a site. In other words, FID is a lower bound on the amount of time a user waits
after interacting.&lt;/p&gt;
&lt;p&gt;Other metrics like &lt;a href=&quot;https://web.dev/tbt/&quot;&gt;Total Blocking Time (TBT)&lt;/a&gt; and &lt;a href=&quot;https://web.dev/tti/&quot;&gt;Time To Interactive (TTI)&lt;/a&gt; are based
on &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Long_Tasks_API&quot; rel=&quot;noopener&quot;&gt;long tasks&lt;/a&gt; and, like FID, also
measure main thread blocking time during load. Since these metrics can be measured in both the field
and the lab, many developers have asked why we don&#39;t prefer one of these over FID.&lt;/p&gt;
&lt;p&gt;There are several reasons for this. Perhaps the most important reason is that these metrics do not
measure the user experience directly. All of these metrics measure how much JavaScript runs on the
page. While long running JavaScript does tend to cause problems to sites, these tasks don&#39;t
necessarily impact the user experience if the user is not interacting with the page when they occur.
A page can have a great score on TBT and TTI but feel slow or it can have a poor score while feeling
fast for users. In our experience, these indirect measurements result in metrics that work great for
some sites but not for most sites. In short, the fact that long tasks and TTI are not user-centric
makes these weaker candidates.&lt;/p&gt;
&lt;p&gt;While &lt;a href=&quot;https://web.dev/user-centric-performance-metrics/#in-the-lab&quot;&gt;lab measurement&lt;/a&gt; is certainly important and an
invaluable tool for diagnostics, what really matters is how users experience sites. By having a
user-centric metric that reflects real-user conditions, you are guaranteed to capture something
meaningful about the experience. We decided to start with a small portion of that experience, even
though we know this portion is not representative of the full experience. This is why we&#39;re working
on capturing a larger chunk of the time a user waits for their inputs to be handled.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;If you&#39;re interested in a deeper dive into some of the metrics we looked into, here is a
&lt;a href=&quot;https://docs.google.com/document/d/1xCERB_X7PiP5RAZDwyIkODnIXoBk-Oo7Mi9266aEdGg/edit#heading=h.ypzsa9g2mv2g&quot; rel=&quot;noopener&quot;&gt;study about
TBT&lt;/a&gt;
and a &lt;a href=&quot;https://docs.google.com/document/d/1sHy6R58olikMTwk5hkJL4jd9S1jbksdMY5ve3Shdg-g/edit&quot; rel=&quot;noopener&quot;&gt;study about
TTI&lt;/a&gt;. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;details class=&quot;w-details&quot;&gt;
&lt;summary class=&quot;w-details__summary&quot;&gt;
  &lt;h4 class=&quot;w-details__header&quot;&gt;
    A note on measuring TTI in the field
  &lt;/h4&gt;
&lt;/summary&gt;
&lt;p&gt;Measuring TTI on real users in the field is problematic because it occurs very late in the page
load. A 5-second network quiet window is required before TTI can even be computed. In the lab, you
can choose to unload the page whenever you have all the data that you need, but that&#39;s not the case
with real-user monitoring in the field. A user may choose to leave the page or interact with it at
any time. In particular, users may choose to leave pages that take a long time to load, and an
accurate TTI will not be recorded in those cases. When we measured TTI for real users in Chrome, we
found that only about half of page loads reached TTI. &lt;/p&gt;&lt;/details&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;what-improvements-are-we-considering&quot;&gt;What improvements are we considering? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#what-improvements-are-we-considering&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We would like to develop a new metric that extends what FID measures today yet still retains its
strong connection to user experience.&lt;/p&gt;
&lt;p&gt;We want the new metric to:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Consider the responsiveness of all user inputs (not just the first one)&lt;/li&gt;
&lt;li&gt;Capture each event&#39;s full duration (not just the delay).&lt;/li&gt;
&lt;li&gt;Group events together that occur as part of the same logical user interaction and define that
interaction&#39;s latency as the max duration of all its events.&lt;/li&gt;
&lt;li&gt;Create an aggregate score for all interactions that occur on a page, throughout its full
lifecycle.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;To be successful, we should be able to say with high confidence that if a site scores poorly on this
new metric, it is not responding quickly to user interactions.&lt;/p&gt;
&lt;h3 id=&quot;capture-the-full-event-duration&quot;&gt;Capture the full event duration &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#capture-the-full-event-duration&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The first obvious improvement is to try to capture broader end-to-end latency of an event. As
mentioned above, FID only captures the delay portion of the input event. It does not account for the
time it takes the browser to actually process the event handlers.&lt;/p&gt;
&lt;p&gt;There are various stages in the lifecycle of an event, as illustrated in this diagram:&lt;/p&gt;
&lt;img alt=&quot;Five steps in the lifecycle of an event&quot; decoding=&quot;async&quot; height=&quot;383&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 610px) 610px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/l9CfiUoTxQQ7KmOzzXWn.jpeg?auto=format&amp;w=1220 1220w&quot; width=&quot;610&quot; /&gt;
&lt;p&gt;The following are steps Chrome takes to process an input:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The input from the user occurs. The time at which this occurs is the event&#39;s &lt;code&gt;timeStamp&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;The browser performs hit testing to decide which HTML frame (main frame or some iframe) an event
belongs to. Then the browser sends the event to the appropriate renderer process in charge of
that HTML frame.&lt;/li&gt;
&lt;li&gt;The renderer receives the event and queues it so that it can process when it becomes available to
do so.&lt;/li&gt;
&lt;li&gt;The renderer processes the event by running its handlers. These handlers may queue additional
asynchronous work, such as &lt;code&gt;setTimeout&lt;/code&gt; and fetches, that are part of the input handling. But at
this point, the synchronous work is complete.&lt;/li&gt;
&lt;li&gt;A frame is painted to the screen that reflects the result of event handlers running. Note that
any asynchronous tasks queued by the event handlers may still be unfinished.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The time between steps (1) and (3) above is an event&#39;s &lt;em&gt;delay&lt;/em&gt;, which is what FID measures.&lt;/p&gt;
&lt;p&gt;The time between steps (1) and (5) above is an event&#39;s &lt;em&gt;duration&lt;/em&gt;. This is what our new metric will
measure.&lt;/p&gt;
&lt;p&gt;The event&#39;s duration includes the delay, but it also includes the work occurring in event handlers
and the work the browser needs to do to paint the next frame after those handlers have run. The
duration of an event is currently available in the &lt;a href=&quot;https://web.dev/custom-metrics/#event-timing-api&quot;&gt;Event Timing API&lt;/a&gt; via the
entry&#39;s &lt;a href=&quot;https://w3c.github.io/performance-timeline/#dom-performanceentry-duration&quot; rel=&quot;noopener&quot;&gt;duration&lt;/a&gt;
attribute.&lt;/p&gt;
&lt;details class=&quot;w-details&quot;&gt;
&lt;summary class=&quot;w-details__summary&quot;&gt;
  &lt;h4 class=&quot;w-details__header&quot;&gt;
    A note on asynchronous tasks
  &lt;/h4&gt;
&lt;/summary&gt;
&lt;p&gt;Ideally we would love to also capture asynchronous work triggered by the event. But the problem is
that the definition of asynchronous work triggered by the event is extremely tricky to get right. As
an example, a developer may choose to begin some animation on event handlers and use a &lt;code&gt;setTimeout&lt;/code&gt;
to begin such animation. If we captured all tasks posted on the handlers, the animation would delay
the completion time for as long as the animation runs. We believe it is worthwhile to investigate
options on how to use heuristics to capture work that is asynchronous and which should be completed
ASAP. However, we want to be really careful when doing so because we don&#39;t want to penalize work
that is meant to take a long time to be finished. Thus, our initial effort will look at step 5 as
the end point: it will only consider synchronous work and the amount of time it takes to paint after
such work is completed. That is, we&#39;re not going to apply heuristics to guess the work that would be
kicked off asynchronously in step 4 in our initial effort.&lt;/p&gt;
&lt;p&gt;It&#39;s worth noting that, in many cases, work should be executed synchronously. In fact, this may be
unavoidable because events are sometimes dispatched one after the other and the event handlers need
to be executed in order. That said, we will still miss important work, like events which trigger
fetching or which rely on important work to be done at the next &lt;code&gt;requestAnimationFrame&lt;/code&gt; callback,
for example. &lt;/p&gt;&lt;/details&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3 id=&quot;group-events-into-interactions&quot;&gt;Group events into interactions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#group-events-into-interactions&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Extending the metric measurement from &lt;em&gt;delay&lt;/em&gt; to &lt;em&gt;duration&lt;/em&gt; is a good first step, but it still
leaves a critical gap in the metric: it focuses on individual events and not the user experience of
interacting with the page.&lt;/p&gt;
&lt;p&gt;Many different events can fire as a result of a single user interaction, and separately measuring
each doesn&#39;t build a clear picture of what the user experiences. We want to make sure our metric
captures the full amount of time a user has to wait for a response when tapping, pressing keys,
scrolling, and dragging as accurately as possible. So we&#39;re introducing the concept of
&lt;em&gt;&lt;strong&gt;interactions&lt;/strong&gt;&lt;/em&gt; to measure the latency of each.&lt;/p&gt;
&lt;h4 id=&quot;interaction-types&quot;&gt;Interaction types &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#interaction-types&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The following table lists the four interactions we want to define along with the DOM events that
they&#39;re associated with. Note that this is not quite the same as the set of all events that are
dispatched when such user interaction occurs. For instance, when a user scrolls, a scroll event is
dispatched, but it happens after the screen has been updated to reflect the scrolling, so we don&#39;t
consider it part of the interaction latency.&lt;/p&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Interaction&lt;/th&gt;
        &lt;th&gt;Start / end&lt;/th&gt;
        &lt;th&gt;Desktop events&lt;/th&gt;
        &lt;th&gt;Mobile events&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td rowspan=&quot;3&quot;&gt;Keyboard&lt;/td&gt;
        &lt;td rowspan=&quot;2&quot;&gt;Key pressed&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;keydown&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;keydown&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;code&gt;keypress&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;keypress&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Key released&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;keyup&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;keyup&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td rowspan=&quot;7&quot;&gt;Tap or drag&lt;/td&gt;
        &lt;td rowspan=&quot;2&quot;&gt;Tap start or drag start&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;pointerdown&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;pointerdown&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;code&gt;mousedown&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;touchstart&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td rowspan=&quot;5&quot;&gt;Tap up or drag end&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;pointerup&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;pointerup&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;code&gt;mouseup&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;touchend&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;code&gt;click&lt;/code&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;mousedown&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;mouseup&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;/td&gt;
        &lt;td&gt;&lt;code&gt;click&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Scroll&lt;/td&gt;
        &lt;td colspan=&quot;3&quot;&gt;N/A&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;caption&gt;DOM events for each interaction type.&lt;/caption&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;The first three interactions listed above (keyboard, tap, and drag) are currently covered by FID.
For our new responsiveness metric, we want to include scrolling as well, since scrolling is
extremely common on the web and is a critical aspect of how responsive a page feels to users.&lt;/p&gt;
&lt;details class=&quot;w-details&quot;&gt;
&lt;summary class=&quot;w-details__summary&quot;&gt;
  &lt;h5 class=&quot;w-details__header&quot;&gt;
    A note on start and end
  &lt;/h5&gt;
&lt;/summary&gt;
&lt;p&gt;Note that each of these interactions has two parts: when the user presses the mouse, finger, or key
down and when they lift it up. We need to ensure our metric doesn&#39;t count time the user spends
holding the finger down between these two actions as part of the page&#39;s latency! &lt;/p&gt;&lt;/details&gt;&lt;p&gt;&lt;/p&gt;
&lt;h5 id=&quot;keyboard&quot;&gt;Keyboard &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#keyboard&quot;&gt;#&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;A keyboard interaction has two parts to it: when the user presses the key and when they release it.
There are three associated events with this user interaction: &lt;code&gt;keydown&lt;/code&gt;, &lt;code&gt;keyup&lt;/code&gt;, and &lt;code&gt;keypress&lt;/code&gt;.
The following diagram illustrates the &lt;code&gt;keydown&lt;/code&gt; and &lt;code&gt;keyup&lt;/code&gt; delays and durations for a keyboard
interaction:&lt;/p&gt;
&lt;img alt=&quot;Keyboard interaction with disjoint event durations&quot; decoding=&quot;async&quot; height=&quot;286&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/zjRipPR9ioi551DUa3pj.jpeg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;In the diagram above, the durations are disjoint because the frame from &lt;code&gt;keydown&lt;/code&gt; updates is
presented before the &lt;code&gt;keyup&lt;/code&gt; occurs, but this does not need to be the case always. In addition, note
that a frame can be presented in the middle of a task in the renderer process since the last steps
required to produce the frame are done outside of the renderer process.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;keydown&lt;/code&gt; and &lt;code&gt;keypress&lt;/code&gt; occur when the user presses the key, while the &lt;code&gt;keyup&lt;/code&gt; occurs when the
user releases the key. Generally the main content update occurs when the key is pressed: text
appears on the screen, or the modifier effect is applied. That said, we want to capture the more
rare cases where &lt;code&gt;keyup&lt;/code&gt; would also present interesting UI updates, so we want to look at the
overall time taken.&lt;/p&gt;
&lt;p&gt;In order to capture the overall time taken by the keyboard interaction, we can compute the maximum
of the duration of the &lt;code&gt;keydown&lt;/code&gt; and the &lt;code&gt;keyup&lt;/code&gt; events.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The &lt;code&gt;keypress&lt;/code&gt; event is deprecated, and it should be fired in the same task as the &lt;code&gt;keydown&lt;/code&gt; event,
so its duration will always overlap with the duration of the&lt;code&gt;keydown&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;details class=&quot;w-details&quot;&gt;
&lt;summary class=&quot;w-details__summary&quot;&gt;
  &lt;h6 class=&quot;w-details__header&quot;&gt;
    A note on repeating keypresses
  &lt;/h6&gt;
&lt;/summary&gt;
&lt;p&gt;There is an edge case here worth mentioning: there may be cases where the user presses a key and
takes a while to release it. In this case, the sequence of events dispatched can
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent#auto-repeat_handling&quot; rel=&quot;noopener&quot;&gt;vary&lt;/a&gt;. In
these cases, we would consider there to be one interaction per &lt;code&gt;keydown&lt;/code&gt;, which may or may not have
a corresponding &lt;code&gt;keyup&lt;/code&gt;. &lt;/p&gt;&lt;/details&gt;&lt;p&gt;&lt;/p&gt;
&lt;h5 id=&quot;tap&quot;&gt;Tap &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#tap&quot;&gt;#&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;Another important user interaction is when the user taps or clicks on a website. Similar to
&lt;code&gt;keypress&lt;/code&gt;, some events are fired as the user presses down, and others as they release, as shown in
the diagram above, Note the events associated with a tap are a little different on desktop vs
mobile.&lt;/p&gt;
&lt;p&gt;For a tap or click, the release is generally the one which triggers the majority of reactions, but,
as with keyboard interactions, we want to capture the full interaction. And in this case it&#39;s more
important to do so because having some UI updates upon tap press is not actually that uncommon.&lt;/p&gt;
&lt;p&gt;We&#39;d like to include the event durations for all of these events, but as many of them overlap
completely, we need to measure just &lt;code&gt;pointerdown&lt;/code&gt;, &lt;code&gt;pointerup&lt;/code&gt;, and &lt;code&gt;click&lt;/code&gt; to cover the full
interaction.&lt;/p&gt;
&lt;details class=&quot;w-details&quot;&gt;
&lt;summary class=&quot;w-details__summary&quot;&gt;
  &lt;h6 class=&quot;w-details__header&quot;&gt;
    Can we narrow further to just &lt;code&gt;pointerdown&lt;/code&gt; and &lt;code&gt;pointerup&lt;/code&gt;?
  &lt;/h6&gt;
&lt;/summary&gt;
&lt;p&gt;One initial thought would be to use the &lt;code&gt;pointerdown&lt;/code&gt; and &lt;code&gt;pointerup&lt;/code&gt; events and assume that they
cover all of the durations that we&#39;re interested in. Sadly, this is not the case, as this &lt;a href=&quot;https://output.jsbin.com/buyiyew/quiet&quot; rel=&quot;noopener&quot;&gt;edge
case&lt;/a&gt; shows. Try opening this site on mobile, or with mobile
emulation, and tapping where it says &amp;quot;Click me&amp;quot;. This site triggers the &lt;a href=&quot;https://developers.google.com/web/updates/2013/12/300ms-tap-delay-gone-away&quot; rel=&quot;noopener&quot;&gt;browser tap
delay&lt;/a&gt;. It can be seen
that the &lt;code&gt;pointerdown&lt;/code&gt;, &lt;code&gt;pointerup&lt;/code&gt;, and &lt;code&gt;touchend&lt;/code&gt; are dispatched quickly, whereas the &lt;code&gt;mousedown&lt;/code&gt;,
&lt;code&gt;mouseup&lt;/code&gt;, and &lt;code&gt;click&lt;/code&gt; wait for the delay before being dispatched. This means that if we only looked
at &lt;code&gt;pointerdown&lt;/code&gt; and &lt;code&gt;pointerup&lt;/code&gt; then we&#39;d miss the duration from the synthetic events, which is
large due to the browser tap delay and should be included. So we should measure &lt;code&gt;pointerdown&lt;/code&gt;,
&lt;code&gt;pointerup&lt;/code&gt;, and &lt;code&gt;click&lt;/code&gt; to cover the full interaction. &lt;/p&gt;&lt;/details&gt;&lt;p&gt;&lt;/p&gt;
&lt;h5 id=&quot;drag&quot;&gt;Drag &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#drag&quot;&gt;#&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;We decided to include dragging as well since it has similar associated events and since it generally
causes important UI updates to sites. But for our metric we intend to only consider the drag start
and the drag end - the initial and final parts of the drag. This is to make it easier to reason
about as well as make the latencies comparable with the other interactions considered. This is
consistent with our decision to exclude continuous events such as &lt;code&gt;mouseover&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We&#39;re also not considering drags implemented via the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API&quot; rel=&quot;noopener&quot;&gt;Drag and Drop
API&lt;/a&gt; because they only work
on desktop.&lt;/p&gt;
&lt;h5 id=&quot;scrolling&quot;&gt;Scrolling &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#scrolling&quot;&gt;#&lt;/a&gt;&lt;/h5&gt;
&lt;p&gt;One of the most common forms of interacting with a site is via scrolling. For our new metric, we&#39;d
like to measure the latency for the initial scrolling interaction of the user. In particular, we
care about the initial reaction of the browser to the fact that the user requested a scroll. We will
not cover the whole scrolling experience. That is, scrolling produces many frames, and we&#39;ll focus
our attention on the initial frame produced as a reaction to the scroll.&lt;/p&gt;
&lt;p&gt;Why just the first one? For one, subsequent frames may be captured by a separate smoothness
&lt;a href=&quot;https://docs.google.com/presentation/d/1VwGIzypntWNosCTXWMsUI6ifw4sEKSRQgnwx3P_wqVg/edit#slide=id.p&quot; rel=&quot;noopener&quot;&gt;proposal&lt;/a&gt;.
That is, once the user has been shown the first result of scrolling, the rest should be measured in
terms of how smooth the scrolling experience feels. Therefore, we think that the smoothness effort
could better capture this. So, as with FID, we choose to stick to discrete user experiences: user
experiences that have clear points in time associated with them and for which we can easily compute
their latency. Scrolling as a whole is a continuous experience, so we do not intend to measure all
of it in this metric.&lt;/p&gt;
&lt;p&gt;So why measure scrolls? The scrolling performance we&#39;ve gathered in Chrome shows that scrolling is
generally very fast. That said, we still want to include initial scroll latencies in our new metric
for various reasons. First, scrolling is fast only because it has been optimized so much, because it
is so important. But there are still ways for a website to bypass some of the performance gains that
the browser offers. The most common one in Chrome is to force scrolling to happen on the main
thread. So our metric should be able to say when this happens and causes poor scrolling performance
for users. Second, scrolling is just too important to ignore. We worry that if we exclude scrolling
then we&#39;ll have a big blindspot, and scrolling performance could decrease over time without web
developers properly noticing.&lt;/p&gt;
&lt;p&gt;There are several events that are dispatched when a user scrolls, such as &lt;code&gt;touchstart&lt;/code&gt;, &lt;code&gt;touchmove&lt;/code&gt;,
and &lt;code&gt;scroll&lt;/code&gt;. Except for the scroll event, this is largely dependent on the device used for
scrolling: touch events are dispatched when scrolling with the finger on mobile devices, while wheel
events occur when scrolling with a mouse wheel. The scroll events are fired after initial scrolling
has completed. And in general, no DOM event blocks scrolling, unless the website uses &lt;a href=&quot;https://web.dev/uses-passive-event-listeners/&quot;&gt;non-passive
event listeners&lt;/a&gt;. So we think of scrolling as decoupled from DOM
Events altogether. What we want to measure is the time from when the user moves enough to produce a
scroll gesture until the first frame that shows that scrolling happened.&lt;/p&gt;
&lt;h4 id=&quot;how-to-define-the-latency-of-an-interaction&quot;&gt;How to define the latency of an interaction? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#how-to-define-the-latency-of-an-interaction&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;As we noted above, interactions that have a &amp;quot;down&amp;quot; and &amp;quot;up&amp;quot; component need to be considered
separately in order to avoid attributing the time the user spent holding their finger down.&lt;/p&gt;
&lt;p&gt;For these types of interactions, we&#39;d like the latency to involve the durations of all events
associated with them. Since event durations for each &amp;quot;down&amp;quot; and &amp;quot;up&amp;quot; part of the interaction can
overlap, the simplest definition of interaction latency that achieves this is the maximum duration
of any event associated with it. Referring back to the keyboard diagram from earlier, this would be
the &lt;code&gt;keydown&lt;/code&gt; duration, as it is longer than the &lt;code&gt;keyup&lt;/code&gt;:&lt;/p&gt;
&lt;img alt=&quot;Keyboard interaction with maximum duration highlighted&quot; decoding=&quot;async&quot; height=&quot;311&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/WFPm4W86CqhFsNc1UZuW.jpeg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;The &lt;code&gt;keydown&lt;/code&gt; and &lt;code&gt;keyup&lt;/code&gt; durations may overlap as well. This may happen for instance when the frame
presented for both events is the same, as in the following diagram:&lt;/p&gt;
&lt;img alt=&quot;Keyboard interaction where press and release occur in the same frame&quot; decoding=&quot;async&quot; height=&quot;311&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kns0INkO77RkiEStzHWYrugyWj32/e7htYAZb44AW4UeplBwJ.jpeg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;There&#39;s are pros and cons to this approach of using the maximum, and we&#39;re interested in &lt;a href=&quot;https://web.dev/better-responsiveness-metric/#feedback&quot;&gt;hearing
your feedback&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Pro&lt;/strong&gt;: It is aligned with how we intend to measure scroll in that it only measures a single
duration value.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Pro&lt;/strong&gt;: It aims to reduce noise for cases like keyboard interactions, where the &lt;code&gt;keyup&lt;/code&gt; usually
does nothing and where the user may execute the key press and release quickly or slowly.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Con&lt;/strong&gt;: It does not capture the full wait time of the user. For instance, it will capture the
start or end of a drag, but not both.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For scrolling (which just has a single associated event) we&#39;d like to define its latency as the time
it takes for the browser to produce the first frame as a result of scrolling. That is, the latency
is the delta between the event &lt;code&gt;timeStamp&lt;/code&gt; of the first DOM event (like &lt;code&gt;touchmove&lt;/code&gt;, if using a
finger) that is large enough to trigger a scroll and the first paint which reflects the scrolling
taking place.&lt;/p&gt;
&lt;h3 id=&quot;aggregate-all-interactions-per-page&quot;&gt;Aggregate all interactions per page &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#aggregate-all-interactions-per-page&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Once we&#39;ve defined what the latency of an interaction is, we&#39;ll need to compute an aggregate value
for a page load, which may have many user interactions. Having an aggregated value enables us to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Form correlations with business metrics.&lt;/li&gt;
&lt;li&gt;Evaluate correlations with other performance metrics. Ideally, our new metric will be sufficiently
independent that it adds value to the existing metrics.&lt;/li&gt;
&lt;li&gt;Easily expose values in tooling in ways that are easy to digest.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In order to perform this aggregation we need to solve two questions:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;What numbers do we try to aggregate?&lt;/li&gt;
&lt;li&gt;How do we aggregate those numbers?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We&#39;re exploring and evaluating several options. We welcome your thoughts on this aggregation.&lt;/p&gt;
&lt;p&gt;One option is to define a budget for the latency of an interaction, which may depend on the type
(scroll, keyboard, tap, or drag). So for example if the budget for taps is 100 ms and the
latency of a tap is 150 ms then the amount over budget for that interaction would be
50 ms. Then we could compute the maximum amount of latency that goes over the budget for any
user interaction in the page.&lt;/p&gt;
&lt;p&gt;Another option is to compute the average or median latency of the interactions throughout the life
of the page. So if we had latencies of 80 ms, 90 ms, and 100 ms, then the average
latency for the page would be 90 ms. We could also consider the average or median &amp;quot;over budget&amp;quot;
to account for different expectations depending on the type of interaction.&lt;/p&gt;
&lt;h2 id=&quot;how-does-this-look-like-on-web-performance-apis&quot;&gt;How does this look like on web performance APIs? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#how-does-this-look-like-on-web-performance-apis&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;what&#39;s-missing-from-event-timing&quot;&gt;What&#39;s missing from Event Timing? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#what&#39;s-missing-from-event-timing&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Unfortunately not all of the ideas presented in this post can be captured using the Event Timing
API. In particular, there&#39;s no simple way to know the events associated with a given user
interaction with the API. In order to do this, we&#39;ve &lt;a href=&quot;https://docs.google.com/presentation/d/1nxNFwsGqYy7WmIZ3uv_0HsSIQMSXQA9_PqlOD3V74Us/edit#slide=id.p&quot; rel=&quot;noopener&quot;&gt;proposed adding an &lt;code&gt;interactionID&lt;/code&gt; to the
API&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Another shortcoming of the Event Timing API is that there is no way to measure the scroll
interaction, so we&#39;re &lt;a href=&quot;https://docs.google.com/presentation/d/1qVdMlqgi9uuyx9imCauzMjLGHQK6TGOIZV_RnlGBKis/edit&quot; rel=&quot;noopener&quot;&gt;working on enabling these
measurements&lt;/a&gt;
(via Event Timing or a separate API).&lt;/p&gt;
&lt;h3 id=&quot;what-can-you-try-right-now&quot;&gt;What can you try right now? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#what-can-you-try-right-now&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Right now, it is still possible to compute the maximum latency for taps/drags and for keyboard
interactions. The following code snippet would produce these two metrics.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; maxTapOrDragDuration &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; maxKeyboardDuration &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; observer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PerformanceObserver&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  list&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getEntries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;entry&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;keydown&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;keyup&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;br /&gt;        maxKeyboardDuration &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;maxKeyboardDuration&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;            entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pointerdown&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pointerup&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;click&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;br /&gt;        maxTapOrDragDuration &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;maxTapOrDragDuration&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;            entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;observer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;observe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;type&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;event&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; minDuration&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; buffered&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// We can report maxTapDragDuration and maxKeyboardDuration when sending&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// metrics to analytics.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;feedback&quot;&gt;Feedback &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/better-responsiveness-metric/#feedback&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let us know what you think about these ideas by emailing: web-vitals-feedback@googlegroups.com!&lt;/p&gt;
</content>
      <author>
          <name>Nicolás Peña Moreno</name>
        </author><author>
          <name>Annie Sullivan</name>
        </author><author>
          <name>Hongbo Song</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>High performance storage for your app: the Storage Foundation API</title>
      <link href="https://web.dev/storage-foundation/"/>
      <updated>2021-06-16T00:00:00Z</updated>
      <id>https://web.dev/storage-foundation/</id>
      <content type="text/html" mode="escaped">&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The Storage Foundation API is part of the
&lt;a href=&quot;https://web.dev/fugu-status/&quot;&gt;capabilities project&lt;/a&gt; and is currently in development. This post will
be updated as the implementation progresses. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;The web platform increasingly offers developers the tools they need to build fined-tuned
high-performance applications for the web. Most notably,
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/WebAssembly&quot; rel=&quot;noopener&quot;&gt;WebAssembly&lt;/a&gt; (Wasm) has opened the door to
fast and powerful web applications, while technologies like &lt;a href=&quot;https://emscripten.org/&quot; rel=&quot;noopener&quot;&gt;Emscripten&lt;/a&gt;
now allow developers to reuse tried and tested code on the web. To truly leverage this potential,
developers must have the same power and flexibility when it comes to storage.&lt;/p&gt;
&lt;p&gt;This is where the Storage Foundation API comes in. The Storage Foundation API is a new fast and
unopinionated storage API that unlocks new and much-requested use cases for the web, such as
implementing performant databases and gracefully managing large temporary files. With this new
interface, developers can &amp;quot;bring their own storage&amp;quot; to the web, reducing the feature gap between web
and platform-specific code.&lt;/p&gt;
&lt;p&gt;The Storage Foundation API is designed to resemble a very basic file system so it gives developers
flexibility by providing generic, simple, and performant primitives on which they can build
higher-level components. Applications can take advantage of the best tool for their needs, finding
the right balance between usability, performance, and reliability.&lt;/p&gt;
&lt;h2 id=&quot;why-does-the-web-need-another-storage-api&quot;&gt;Why does the web need another storage API? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#why-does-the-web-need-another-storage-api&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The web platform offers a number of storage options for developers, each of which is built with
specific use-cases in mind.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Some of these options clearly do not overlap with this proposal as they only allow very small
amounts of data to be stored, like
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies&quot; rel=&quot;noopener&quot;&gt;cookies&lt;/a&gt;, or the
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API&quot; rel=&quot;noopener&quot;&gt;Web Storage API&lt;/a&gt; consisting of
the &lt;code&gt;sessionStorage&lt;/code&gt; and the &lt;code&gt;localStorage&lt;/code&gt; mechanisms.&lt;/li&gt;
&lt;li&gt;Other options are already deprecated for various reasons like the
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/File_and_Directory_Entries_API/Introduction&quot; rel=&quot;noopener&quot;&gt;File and Directory Entries API&lt;/a&gt;
or &lt;a href=&quot;https://www.w3.org/TR/webdatabase/&quot; rel=&quot;noopener&quot;&gt;WebSQL&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;The &lt;a href=&quot;https://web.dev/file-system-access/&quot;&gt;File System Access API&lt;/a&gt; has a similar API surface, but its use is to
interface with the client&#39;s file system and provide access to data that may be outside of the
origin&#39;s or even the browser&#39;s ownership. This different focus comes with stricter security
considerations and higher performance costs.&lt;/li&gt;
&lt;li&gt;The &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API&quot; rel=&quot;noopener&quot;&gt;IndexedDB API&lt;/a&gt; can be used as
a backend for some of the Storage Foundation API&#39;s use-cases. For example, Emscripten includes
&lt;a href=&quot;https://emscripten.org/docs/api_reference/Filesystem-API.html&quot; rel=&quot;noopener&quot;&gt;IDBFS&lt;/a&gt;, an IndexedDB-based
persistent file system. However, since IndexedDB is fundamentally a key-value store, it comes with
significant performance limitations. Furthermore, directly accessing subsections of a file is even
more difficult and slower under IndexedDB.&lt;/li&gt;
&lt;li&gt;Finally, the
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage&quot; rel=&quot;noopener&quot;&gt;CacheStorage interface&lt;/a&gt; is widely
supported and is tuned for storing large-sized data such as web application resources, but the
values are immutable.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The Storage Foundation API is an attempt at closing all the gaps of the previous storage options by
allowing for the performant storage of mutable large files defined within the origin of the
application.&lt;/p&gt;
&lt;h3 id=&quot;use-cases&quot;&gt;Suggested use cases for the Storage Foundation API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#use-cases&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Examples of sites that may use this API include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Productivity or creativity apps that operate on large amounts of video, audio, or image data. Such
apps can offload segments to disk instead of holding them in memory.&lt;/li&gt;
&lt;li&gt;Apps that rely on a persistent file system accessible from Wasm and that need more performance
than what IDBFS can guarantee.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;what&quot;&gt;What is the Storage Foundation API? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#what&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There are two main parts to the API:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;File system calls&lt;/strong&gt;, which provide basic functionality to interact with files and file paths.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;File handles&lt;/strong&gt;, which provide read and write access to an existing file.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;file-system-calls&quot;&gt;File system calls &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#file-system-calls&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The Storage Foundation API introduces a new object, &lt;code&gt;storageFoundation&lt;/code&gt;, that lives on the &lt;code&gt;window&lt;/code&gt;
object and that includes a number of functions:&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;We are currently exploring the tradeoffs between providing a synchronous versus an
asynchronous API. The interfaces are designed to be asynchronous as a temporary measure and will be
updated once a decision has been reached. For more background on the tradeoffs, see the
&lt;a href=&quot;https://github.com/WICG/storage-foundation-api-explainer#sync-vs-async&quot; rel=&quot;noopener&quot;&gt;Explainer&lt;/a&gt;. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;storageFoundation.open(name)&lt;/code&gt;: Opens the file with the given name if it exists and otherwise
creates a new file. Returns a promise that resolves with the the opened file.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;w-aside w-aside--warning&quot;&gt;
&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;:  File names are restricted to lowercase alphanumeric characters and underscore
(&lt;code&gt;a-z&lt;/code&gt;, &lt;code&gt;0-9&lt;/code&gt;, &lt;code&gt;_&lt;/code&gt;). &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;A file can only be opened once. This means concurrent access from different tabs is
currently not possible. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;storageFoundation.delete(name)&lt;/code&gt;: Removes the file with the given name. Returns a promise that
resolves when the file is deleted.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;storageFoundation.rename(oldName, newName)&lt;/code&gt;: Renames the file from the old name to the new name
atomically. Returns a promise that resolves when the file is renamed.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;storageFoundation.getAll()&lt;/code&gt;: Returns a promise that resolves with an array of all existing file
names.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;storageFoundation.requestCapacity(requestedCapacity)&lt;/code&gt;: Requests new capacity (in bytes) for usage
by the current execution context. Returns a promise that resolved with the remaining amount of
capacity available.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The Storage Foundation API achieves fast and predictable performance by implementing its
own quota management system. Web applications must explicitly ask for capacity before storing any
new data. This request will be granted according to the browser&#39;s quota guidelines. Anytime an
application starts a new JavaScript execution context (e.g., a new tab, a new worker, or when
reloading the page), it must make sure it owns sufficient capacity before writing any data.&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;storageFoundation.releaseCapacity(toBeReleasedCapacity)&lt;/code&gt;: Releases the specified number of bytes
from the current execution context, and returns a promise that resolves with the remaining
capacity.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;storageFoundation.getRemainingCapacity()&lt;/code&gt;: Returns a promise that resolves with the capacity
available for the current execution context.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;file-handles&quot;&gt;File handles &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#file-handles&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Working with files happens via the following functions:&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The Storage Foundation API used to be called NativeIO. Some references to this name
still remain and will be removed eventually. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;NativeIOFile.close()&lt;/code&gt;: Closes a file, and returns a promise that resolves when the operation
completes.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NativeIOFile.flush()&lt;/code&gt;: Synchronizes (that is, flushes) a file&#39;s in-memory state with the storage
device, and returns a promise that resolves when the operation completes.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;It is a known issue that &lt;code&gt;flush()&lt;/code&gt; might be slow and we are exploring whether offering a
faster, less reliable variant would be useful. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;NativeIOFile.getLength()&lt;/code&gt;: Returns a promise that resolves with the length of the file in bytes.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;NativeIOFile.setLength(length)&lt;/code&gt;: Sets the length of the file in bytes, and returns a promise that
resolves when the operation completes. If the new length is smaller than the current length, bytes
are removed starting from the end of the file. Otherwise the file is extended with zero-valued
bytes.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;NativeIOFile.read(buffer, offset)&lt;/code&gt;: Reads the contents of the file at the given offset through a
buffer that is the result of transferring the given buffer, which is then left detached. Returns a
&lt;code&gt;NativeIOReadResult&lt;/code&gt; with the transferred buffer and the the number of bytes that were
successfully read.&lt;/p&gt;
&lt;p&gt;A &lt;code&gt;NativeIOReadResult&lt;/code&gt; is an object that consists of two entries:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;buffer&lt;/code&gt;: An
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/ArrayBufferView&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;ArrayBufferView&lt;/code&gt;&lt;/a&gt;, which is
the result of transferring the buffer passed to &lt;code&gt;read()&lt;/code&gt;. It is of the same type and length as
source buffer.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;readBytes&lt;/code&gt;: The number of bytes that were successfully read into &lt;code&gt;buffer&lt;/code&gt;. This may be less
than the buffer size, if an error occurs or if the read range spans beyond the end of the file.
It is set to zero if the read range is beyond the end of the file.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;NativeIOFile.write(buffer, offset)&lt;/code&gt;: Writes the contents of the given buffer into the file at the
given offset. The buffer is transferred before any data is written and is therefore left detached.
Returns a &lt;code&gt;NativeIOWriteResult&lt;/code&gt; with the transferred buffer and the number of bytes that were
successfully written. The file will be extended if the write range exceeds its length.&lt;/p&gt;
&lt;p&gt;A &lt;code&gt;NativeIOWriteResult&lt;/code&gt; is an object that consists of two entries:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;buffer&lt;/code&gt;: An
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/ArrayBufferView&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;ArrayBufferView&lt;/code&gt;&lt;/a&gt; which is
the result of transferring the buffer passed to &lt;code&gt;write()&lt;/code&gt;. It is of the same type and length as
the source buffer.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;writtenBytes&lt;/code&gt;: The number of bytes that were successfully written into &lt;code&gt;buffer&lt;/code&gt;. This may be
less than the buffer size if an error occurs.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Calls to &lt;code&gt;NativeIOFile.write()&lt;/code&gt; only guarantee that the data has been written to the
file, but it does not guarantee that the data has been persisted to the underlying storage. To
ensure that no data loss occurs on system crash, you must call &lt;code&gt;NativeIOFile.flush()&lt;/code&gt; and wait for
it to successfully return. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;status&quot;&gt;Current status &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#status&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Step&lt;/th&gt;
&lt;th&gt;Status&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1. Create explainer&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/WICG/storage-foundation-api-explainer#readme&quot; rel=&quot;noopener&quot;&gt;Complete&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2. Create initial draft of specification&lt;/td&gt;
&lt;td&gt;Not started&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3. Gather feedback &amp;amp; iterate on design&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://web.dev/storage-foundation/#feedback&quot;&gt;In progress&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4. &lt;strong&gt;Origin trial&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;a href=&quot;https://developer.chrome.com/origintrials/#/view_trial/2916080758722396161&quot; rel=&quot;noopener&quot;&gt;In progress&lt;/a&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5. Launch&lt;/td&gt;
&lt;td&gt;Not started&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;There is currently an
&lt;a href=&quot;https://docs.google.com/document/d/1g7ZCqZ5NdiU7oqyCpsc2iZ7rRAY1ZXO-9VoG4LfP7fM/edit?usp=sharing&quot; rel=&quot;noopener&quot;&gt;ongoing effort&lt;/a&gt;
to augment the
&lt;a href=&quot;https://web.dev/file-system-access/#accessing-the-origin-private-file-system&quot;&gt;origin private file system&lt;/a&gt;
of the &lt;a href=&quot;https://web.dev/file-system-access/&quot;&gt;File System Access API&lt;/a&gt; as to not introduce yet another entry point
for a storage system. This article will be updated as we make progress on this. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;use&quot;&gt;How to use the Storage Foundation API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#use&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;enabling-via-about:flags&quot;&gt;Enabling via about://flags &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#enabling-via-about:flags&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To experiment with the Storage Foundation API locally, without an origin trial token, enable the
&lt;code&gt;#experimental-web-platform-features&lt;/code&gt; flag in &lt;code&gt;about://flags&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;enabling-support-during-the-origin-trial-phase&quot;&gt;Enabling support during the origin trial phase &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#enabling-support-during-the-origin-trial-phase&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Starting in Chromium 90, the Storage Foundation API is available as an origin trial in
Chromium. The origin trial is expected to end in Chromium 95 (November 10, 2021).&lt;/p&gt;
&lt;p&gt;Origin trials allow you to try new features and give feedback on their
usability, practicality, and effectiveness to the web standards community. For
more information, see the &lt;a href=&quot;https://github.com/GoogleChrome/OriginTrials/blob/gh-pages/developer-guide.md&quot; rel=&quot;noopener&quot;&gt;Origin Trials Guide for Web Developers&lt;/a&gt;.
To sign up for this or another origin trial, visit the &lt;a href=&quot;https://developers.chrome.com/origintrials/#/trials/active&quot; rel=&quot;noopener&quot;&gt;registration page&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;register-for-ot&quot;&gt;Register for the origin trial &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#register-for-ot&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.chrome.com/origintrials/#/view_trial/2916080758722396161&quot; rel=&quot;noopener&quot;&gt;Request a token&lt;/a&gt; for your origin.&lt;/li&gt;
&lt;li&gt;Add the token to your pages. There are two ways to do that:
&lt;ul&gt;
&lt;li&gt;Add an &lt;code&gt;origin-trial&lt;/code&gt; &lt;code&gt;&amp;lt;meta&amp;gt;&lt;/code&gt; tag to the head of each page. For example,
this may look something like: &lt;br /&gt;
&lt;code&gt;&amp;lt;meta http-equiv=&amp;quot;origin-trial&amp;quot; content=&amp;quot;TOKEN_GOES_HERE&amp;quot;&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;If you can configure your server, you can also add the token
using an &lt;code&gt;Origin-Trial&lt;/code&gt; HTTP header. The resulting response header should
look something like:&lt;br /&gt;
&lt;code&gt;Origin-Trial: TOKEN_GOES_HERE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;feature-detection&quot;&gt;Feature detection &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#feature-detection&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To check if the Storage Foundation API is supported, use:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;storageFoundation&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; window&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// The Storage Foundation API is supported.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;complete-examples&quot;&gt;Complete examples &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#complete-examples&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To make the concepts introduced above clearer, here are two complete examples that walk you through
the different stages in the lifecycle of Storage Foundation files.&lt;/p&gt;
&lt;h4 id=&quot;opening-writing-reading-closing&quot;&gt;Opening, writing, reading, closing &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#opening-writing-reading-closing&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Open a file (creating it if needed).&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; file &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; storageFoundation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;test_file&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Request 100 bytes of capacity for this context.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; storageFoundation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;requestCapacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; writeBuffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;66&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Write the buffer at offset 0. After this operation, `result.buffer`&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// contains the transferred buffer and `result.writtenBytes` is 3,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// the number of bytes written. `writeBuffer` is left detached.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;writeBuffer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; readBuffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Uint8Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Read at offset 1. `result.buffer` contains the transferred buffer,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// `result.readBytes` is 2, the number of bytes read. `readBuffer` is left&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// detached.&lt;/span&gt;&lt;br /&gt;  result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;readBuffer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// `Uint8Array(3) [65, 66, 0]`&lt;/span&gt;&lt;br /&gt;  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buffer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h4 id=&quot;opening-listing-deleting&quot;&gt;Opening, listing, deleting &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#opening-listing-deleting&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Open three different files (creating them if needed).&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; storageFoundation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;sunrise&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; storageFoundation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;noon&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; storageFoundation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;sunset&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// List all existing files.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// `[&quot;sunset&quot;, &quot;sunrise&quot;, &quot;noon&quot;]`&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; storageFoundation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// Delete one of the three files.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; storageFoundation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;noon&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// List all remaining existing files.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// `[&quot;sunrise&quot;, &quot;noon&quot;]`&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; storageFoundation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;demo&quot;&gt;Demo &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#demo&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;You can play with the &lt;a href=&quot;https://storage-foundation.glitch.me/&quot; rel=&quot;noopener&quot;&gt;Storage Foundation API demo&lt;/a&gt; in the embed below. Create, rename, write
into, and read from files, and see the available capacity you have requested update as you make
changes. You can find the &lt;a href=&quot;https://glitch.com/edit/#!/storage-foundation&quot; rel=&quot;noopener&quot;&gt;source code&lt;/a&gt; of the demo on Glitch.&lt;/p&gt;
&lt;div class=&quot;glitch-embed-wrap&quot; style=&quot;height: 420px; width: 100%;&quot;&gt;
  &lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi&quot; loading=&quot;lazy&quot; src=&quot;https://glitch.com/embed/#!/embed/storage-foundation?attributionHidden=true&amp;sidebarCollapsed=true&amp;previewSize=100&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;storage-foundation on Glitch&quot;&gt;&lt;/iframe&gt;
&lt;/div&gt;
&lt;h2 id=&quot;security-and-permissions&quot;&gt;Security and permissions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#security-and-permissions&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Chromium team has designed and implemented the Storage Foundation API using the core principles
defined in &lt;a href=&quot;https://chromium.googlesource.com/chromium/src/+/lkgr/docs/security/permissions-for-powerful-web-platform-features.md&quot; rel=&quot;noopener&quot;&gt;Controlling Access to Powerful Web Platform Features&lt;/a&gt;, including user
control, transparency, and ergonomics.&lt;/p&gt;
&lt;p&gt;Following the same pattern as other modern storage APIs on the web, access to the Storage Foundation
API is origin-bound, meaning that an origin may only access self-created data. It is also limited to
secure contexts.&lt;/p&gt;
&lt;h3 id=&quot;user-control&quot;&gt;User control &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#user-control&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Storage quota will be used to distribute access to disk space and to prevent abuse. Memory you want
to occupy needs to be requested first. Like other storage APIs, users can clear the space taken by
Storage Foundation API through their browser.&lt;/p&gt;
&lt;h2 id=&quot;feedback&quot;&gt;Feedback &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#feedback&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Chromium team wants to hear about your experiences with the Storage Foundation API.&lt;/p&gt;
&lt;h3 id=&quot;tell-us-about-the-api-design&quot;&gt;Tell us about the API design &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#tell-us-about-the-api-design&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Is there something about the API that does not work like you expected? Or are there missing methods
or properties that you need to implement your idea? Have a question or comment on the security
model? File a spec issue on the corresponding &lt;a href=&quot;https://github.com/WICG/storage-foundation-api-explainer/issues&quot; rel=&quot;noopener&quot;&gt;GitHub repo&lt;/a&gt;, or add your thoughts to an
existing issue.&lt;/p&gt;
&lt;h3 id=&quot;report-a-problem-with-the-implementation&quot;&gt;Report a problem with the implementation &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#report-a-problem-with-the-implementation&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Did you find a bug with Chromium&#39;s implementation? Or is the implementation different from the spec?
File a bug at &lt;a href=&quot;https://new.crbug.com/&quot; rel=&quot;noopener&quot;&gt;new.crbug.com&lt;/a&gt;. Be sure to include as much detail as you can,
simple instructions for reproducing, and enter &lt;code&gt;Blink&amp;gt;Storage&lt;/code&gt; in the &lt;strong&gt;Components&lt;/strong&gt; box.
&lt;a href=&quot;https://glitch.com/&quot; rel=&quot;noopener&quot;&gt;Glitch&lt;/a&gt; works great for sharing quick and easy repros.&lt;/p&gt;
&lt;h3 id=&quot;show-support-for-the-api&quot;&gt;Show support for the API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#show-support-for-the-api&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Are you planning to use the Storage Foundation API? Your public support helps the Chromium team
prioritize features and shows other browser vendors how critical it is to support them.&lt;/p&gt;
&lt;p&gt;Send a tweet to &lt;a href=&quot;https://twitter.com/ChromiumDev&quot; rel=&quot;noopener&quot;&gt;@ChromiumDev&lt;/a&gt; using the hashtag
&lt;a href=&quot;https://twitter.com/search?q=%23StorageFoundation&amp;amp;src=recent_search_click&amp;amp;f=live&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;#StorageFoundation&lt;/code&gt;&lt;/a&gt;
and let us know where and how you are using it. Ask a question on StackOverflow with the hashtag
&lt;a href=&quot;https://stackoverflow.com/questions/tagged/file-system-access-api&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;#file-system-access-api&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;helpful&quot;&gt;Helpful links &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#helpful&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/WICG/storage-foundation-api-explainer#readme&quot; rel=&quot;noopener&quot;&gt;Public explainer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://storage-foundation.glitch.me/&quot; rel=&quot;noopener&quot;&gt;Storage Foundation API demo&lt;/a&gt; | &lt;a href=&quot;https://glitch.com/edit/#!/storage-foundation&quot; rel=&quot;noopener&quot;&gt;Storage Foundation API demo source&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=914488&quot; rel=&quot;noopener&quot;&gt;Chromium tracking bug&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://chromestatus.com/feature/5670244905385984&quot; rel=&quot;noopener&quot;&gt;ChromeStatus.com entry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Blink Component: &lt;a href=&quot;https://chromestatus.com/features#component%3ABlink%3EStorage&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;Blink&amp;gt;Storage&amp;gt;NativeIO&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/w3ctag/design-reviews/issues/566&quot; rel=&quot;noopener&quot;&gt;TAG Review&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://groups.google.com/a/chromium.org/g/blink-dev/c/gh0gTHO18YQ&quot; rel=&quot;noopener&quot;&gt;Intent to Prototype&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://lists.webkit.org/pipermail/webkit-dev/2021-February/031687.html&quot; rel=&quot;noopener&quot;&gt;WebKit thread&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/mozilla/standards-positions/issues/481&quot; rel=&quot;noopener&quot;&gt;Mozilla thread&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/storage-foundation/#acknowledgements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Storage Foundation API was specified and implemented by
&lt;a href=&quot;https://github.com/fivedots&quot; rel=&quot;noopener&quot;&gt;Emanuel Krivoy&lt;/a&gt; and &lt;a href=&quot;https://github.com/rstz&quot; rel=&quot;noopener&quot;&gt;Richard Stotz&lt;/a&gt;. This
article was reviewed by &lt;a href=&quot;https://github.com/petele&quot; rel=&quot;noopener&quot;&gt;Pete LePage&lt;/a&gt; and
&lt;a href=&quot;https://github.com/jpmedley&quot; rel=&quot;noopener&quot;&gt;Joe Medley&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Hero image via &lt;a href=&quot;https://unsplash.com/@markusspiske&quot; rel=&quot;noopener&quot;&gt;Markus Spiske&lt;/a&gt; on
&lt;a href=&quot;https://unsplash.com/photos/iar-afB0QQw&quot; rel=&quot;noopener&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Thomas Steiner</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Blibli&#39;s PWA generates 10x more revenue per user than their previous mobile website</title>
      <link href="https://web.dev/blibli/"/>
      <updated>2021-06-15T19:59:43Z</updated>
      <id>https://web.dev/blibli/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;&lt;a href=&quot;https://www.blibli.com/&quot; rel=&quot;noopener&quot;&gt;Blibli&lt;/a&gt; is a well known e-commerce marketplace in
Indonesia. The company had over 29 million average monthly website visits in
2019. In a recent study, Blibli&#39;s web team found that their mobile web platform
is a significant visitor and user acquisition platform, with 70% of web
users landing on mobile and 30% of web users landing on desktop.&lt;/p&gt;
&lt;p&gt;With that insight, Blibli embarked on a journey to develop a better web
experience and improve conversions. As a result, they were able to achieve some
exceptional results:&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;42&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;Reduction in bounce rates&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;8&lt;sub class=&quot;w-stat__sub&quot;&gt;x&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;Better mCVR in installed PWA compared to browser mobile web&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;2.5&lt;sub class=&quot;w-stat__sub&quot;&gt;x&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;More pages/sessions on installed PWA&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;highlighting-the-opportunity&quot;&gt;Highlighting the opportunity &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/blibli/#highlighting-the-opportunity&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Blibli identified the following areas of opportunities:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For Blibli, the mobile web platform was important for user
acquisition with many users on mid- to low-tier devices.&lt;/li&gt;
&lt;li&gt;Indonesia&#39;s internet economy was &lt;a href=&quot;https://storage.googleapis.com/gweb-economy-sea.appspot.com/assets/pdf/Indonesia-e-Conomy_SEA_2020_Country_Insights.pdf&quot; rel=&quot;noopener&quot;&gt;expanding rapidly beyond tier 1
cities&lt;/a&gt;.
Hence, PWA and fast pages were a good investment to support user needs like
limited storage and slow networks.&lt;/li&gt;
&lt;li&gt;50% of users that are coming to the Blibli web platform are returning users.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;the-approach-they-used&quot;&gt;The approach they used &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/blibli/#the-approach-they-used&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The team took a staged strategy of short- to medium-term improvements on the
mobile web platform. This included:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A performance optimized website including a UX revamped &lt;a href=&quot;https://www.blibli.com/&quot; rel=&quot;noopener&quot;&gt;home
page&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;A lite version of the home page for new users with a
&lt;a href=&quot;https://developers.google.com/web/fundamentals/primers/service-workers&quot; rel=&quot;noopener&quot;&gt;service worker&lt;/a&gt;
to cache critical assets for subsequent navigation.&lt;/li&gt;
&lt;li&gt;A &lt;a href=&quot;https://web.dev/progressive-web-apps/&quot;&gt;Progressive Web App&lt;/a&gt; (PWA) for
returning users.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;user-flow&quot;&gt;User flow &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/blibli/#user-flow&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;New visitors are presented with a lightweight page which is three times faster
when compared to the old home page.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;A lightweight page that is three times faster than the old.&quot; decoding=&quot;async&quot; height=&quot;1422&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/bfL1ZGsRjv3QcbACnRGu.png?auto=format&amp;w=400&quot; srcset=&quot;https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/bfL1ZGsRjv3QcbACnRGu.png?w=400&amp;auto=format&amp;dpr=1&amp;q=75 1x, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/bfL1ZGsRjv3QcbACnRGu.png?w=400&amp;auto=format&amp;dpr=2&amp;q=50 2x, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/bfL1ZGsRjv3QcbACnRGu.png?w=400&amp;auto=format&amp;dpr=3&amp;q=35 3x, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/bfL1ZGsRjv3QcbACnRGu.png?w=400&amp;auto=format&amp;dpr=4&amp;q=23 4x, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/bfL1ZGsRjv3QcbACnRGu.png?w=400&amp;auto=format&amp;dpr=5&amp;q=20 5x&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    A lightweight page that is three times faster than the old.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;On subsequent pages, Blibli prompts users to add the PWA shortcut
to their home screen.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video controls=&quot;&quot; autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; class=&quot;w-screenshot&quot; style=&quot;width:800px;&quot;&gt;
    &lt;source src=&quot;https://storage.googleapis.com/web-dev-assets/blibli/save-to-home-screen.webm&quot; type=&quot;video/webm&quot; /&gt;
    &lt;source src=&quot;https://storage.googleapis.com/web-dev-assets/blibli/save-to-home-screen.mp4&quot; type=&quot;video/mp4&quot; /&gt;
  &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    The add to home screen prompt.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;If users lose the network connection, they are presented with an elegant offline
fallback page.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;An elegent offline fallback page.&quot; decoding=&quot;async&quot; height=&quot;468&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/biDb6f1owQWxmRNXUauu.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    An elegent offline fallback page.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Blibli&#39;s lite page created a first impression that Blibli.com is fast and
responsive. Moreover, the lite page streamlined the number of features by only
focusing on those that deliver the value proposition of Blibli.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video controls=&quot;&quot; autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; class=&quot;w-screenshot&quot; style=&quot;width:800px;&quot;&gt;
    &lt;source src=&quot;https://storage.googleapis.com/web-dev-assets/blibli/responsive-comparison.webm&quot; type=&quot;video/webm&quot; /&gt;
    &lt;source src=&quot;https://storage.googleapis.com/web-dev-assets/blibli/responsive-comparison.mp4&quot; type=&quot;video/mp4&quot; /&gt;
  &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Comparison of loading times before and after streamlining.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Blibli&#39;s PWA is installable, giving it an app-like look and feel. It is also
fast and reliable which was achieved using service worker caching and graceful
offline fallback.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;The offline fallback&quot; decoding=&quot;async&quot; height=&quot;1778&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/sQ51XsLqKMgSQMCZjIN0B7hlBO02/ONCtI6MryOS5wCLPd3Ep.jpeg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    The offline fallback.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This comes as a delight for web users, a large proportion of whom use mid-tier
devices. Since Blibli&#39;s PWA is less than 1MB in size (that&#39;s a whopping 24 times
lighter than their Android app!), there is much less friction for users to
install it. It also makes it easier for Blibli to retain users while providing
them with a seamless app-like experience.&lt;/p&gt;
&lt;h3 id=&quot;set-performance-budgets&quot;&gt;Set performance budgets &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/blibli/#set-performance-budgets&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Blibli made performance budgeting a performance standard within the tech
development and management, where the standard was reviewed on a regular basis.
It&#39;s set as the KPI of internal tech development, with the guidance
of top management to ensure the best platform for all of our users.&lt;/p&gt;
&lt;h2 id=&quot;overall-business-results&quot;&gt;Overall business results &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/blibli/#overall-business-results&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;3x reduction in page load times.&lt;/li&gt;
&lt;li&gt;42% reduction in bounce rates.&lt;/li&gt;
&lt;li&gt;8x Better mobile conversion rates in installed PWA compared to browser
mobile web.&lt;/li&gt;
&lt;li&gt;2.5x more pages/sessions on installed PWA.&lt;/li&gt;
&lt;li&gt;10x more revenue per user compared to the previous mobile website.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;quot;Speed and PWA were a valuable investment for us to provide the best mobile
experience and representing our mission, to deliver the best platform for our
users&amp;quot;
&lt;em&gt;—Collin Dion Agata, Lead Product Manager, Blibli&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Photo by &lt;a href=&quot;https://unsplash.com/@cristian1&quot; rel=&quot;noopener&quot;&gt;Cristian Escobar&lt;/a&gt; on Unsplash.&lt;/p&gt;
</content>
      <author>
          <name>Collin Dion Agata</name>
        </author><author>
          <name>Swetha Gopalakrishnan</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Introducing Aurora</title>
      <link href="https://web.dev/introducing-aurora/"/>
      <updated>2021-06-15T00:00:00Z</updated>
      <id>https://web.dev/introducing-aurora/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;On the Chrome team, we care about user experience and a thriving web ecosystem.
We want users to have the best possible experience on the web, not only with
static documents but also when they use rich, highly-interactive applications.&lt;/p&gt;
&lt;p&gt;Open-source tools and frameworks play a large role in enabling developers to
build modern apps for the web, while also supporting good developer experiences.
These frameworks and tools empower companies of all sizes, as well as
individuals building for the web.&lt;/p&gt;
&lt;p&gt;We believe that frameworks can also play a big role in helping developers with
key quality aspects such as performance, accessibility, security, mobile
readiness. Instead of asking every developer and site owner to become an expert
in these areas and keep up with the constantly changing best practices, the
framework can support these with baked-in solutions. This empowers developers
and enables them to focus on building product features.&lt;/p&gt;
&lt;p&gt;In a nutshell, our vision is that a high bar of UX quality becomes a side effect
of building for the web.&lt;/p&gt;
&lt;h2 id=&quot;aurora:-a-collaboration-between-chrome-and-open-source-web-frameworks-and-tools&quot;&gt;Aurora: a collaboration between Chrome and open-source web frameworks &amp;amp; tools &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/introducing-aurora/#aurora:-a-collaboration-between-chrome-and-open-source-web-frameworks-and-tools&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;For almost two years, we have worked with some of the most popular frameworks
such as Next.js, Nuxt and Angular, working to improve web performance. We&#39;ve
also funded popular tools and libraries such as Vue, ESLint, webpack. Today, we
are giving this effort a name - &lt;strong&gt;Aurora&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;An aurora is a natural light display that shimmers in the sky. As we are trying
to help user experiences built with frameworks shimmer and shine, we thought
this name was an appropriate choice.&lt;/p&gt;
&lt;img alt=&quot;Aurora logo&quot; decoding=&quot;async&quot; height=&quot;450&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/lxaUR7Za1DoQMJuJEZHP.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;In the coming months, we&#39;ll be sharing a lot more detail on Aurora. This is a
collaboration between a small team of Chrome engineers (internally codenamed
WebSDK) and framework authors. Our goal is to deliver the best user experience
possible for production apps regardless of the browser you&#39;re rendering in.&lt;/p&gt;
&lt;h2 id=&quot;what-is-our-strategy&quot;&gt;What is our strategy? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/introducing-aurora/#what-is-our-strategy&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;At Google, we&#39;ve learned a lot while using frameworks and tools to build and
maintain large scale web applications such as Google Search, Maps, Image Search,
Google Photos etc. We discovered how frameworks can play a crucial role in
predictable app quality by providing &lt;strong&gt;strong defaults&lt;/strong&gt; and &lt;strong&gt;opinionated
tooling&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Frameworks have a unique vantage point for influencing both DX and UX as they
span the entire system: the client and the server, the development and
production environments, and they integrate tools such as compiler, bundler,
linter etc.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Chart that shows   common tooling in frameworks&quot; decoding=&quot;async&quot; height=&quot;450&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/ARzxz7gjVfJRFwdkzQoS.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Common tooling used by framework developers
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;When solutions are baked into the framework, teams of developers can use these
solutions and focus their time on what matters most to the product -- shipping
great features for users.&lt;/p&gt;
&lt;p&gt;While we work to improve tools that live in every layer of the stack, frameworks
such as Next.js, Nuxt, and Angular CLI, manage every step of an application&#39;s
lifecycle. For this reason, and the fact that React adoption is the largest
within the core UI framework ecosystem, most of our optimizations have begun
with proving out in Next.js before expanding to the rest of the ecosystem.&lt;/p&gt;
&lt;p&gt;Aurora supports success at scale by bringing solutions to the &lt;em&gt;right layer&lt;/em&gt; of
popular tech stacks. By bridging the gap between browsers and frameworks, it
enables high-quality to be a side-effect of building for the web while acting as
a feedback loop to improve the web platform.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Check out the &lt;a href=&quot;https://web.dev/conformance&quot;&gt;Conformance&lt;/a&gt; post to learn more about a key component of
our strategy.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;what-is-our-work-process&quot;&gt;What is our work process? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/introducing-aurora/#what-is-our-work-process&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Our principles for how Aurora bridges browsers and the developer ecosystem are:
humility, curiosity, scientific enquiry and pragmatism. We work with framework
authors on improvements, collaborate with the community and do our due diligence
prior to landing any changes.&lt;/p&gt;
&lt;img alt=&quot;Aurora&amp;#x27;s partner driven process for improving Core Web Vital metrics&quot; decoding=&quot;async&quot; height=&quot;448&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/QFTQX7npdBsFheXIqbuc.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;To summarize the steps we take for any new feature we work on:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Identify user experience pain in a popular stack, using representative apps.&lt;/li&gt;
&lt;li&gt;Prototype solutions that address this, with an emphasis on &amp;quot;strong defaults&amp;quot;
.&lt;/li&gt;
&lt;li&gt;Verify the feature with another framework stack, to ensure it is adaptable.&lt;/li&gt;
&lt;li&gt;Validate the feature by experimenting in a few production apps, typically
with lab testing for performance.&lt;/li&gt;
&lt;li&gt;Drive design using the RFC process, addressing community feedback.&lt;/li&gt;
&lt;li&gt;Land the feature in a popular stack, typically behind a flag.&lt;/li&gt;
&lt;li&gt;Enable the feature in a representative production app to assess quality and
developer workflow integration.&lt;/li&gt;
&lt;li&gt;Measure performance improvement by tracking metrics in representative
production apps that adopted the feature or upgraded.&lt;/li&gt;
&lt;li&gt;Enable the feature as the default in the stack, so all upgrading users
benefit.&lt;/li&gt;
&lt;li&gt;Once proven, work with additional frameworks to land the feature.&lt;/li&gt;
&lt;li&gt;Identify gaps in the web platform, with a feedback loop.&lt;/li&gt;
&lt;li&gt;Move onto the next problems.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The underlying tools and plugins (webpack, Babel, ESLint, TypeScript, etc…)
are shared across many frameworks. This helps create ripple effects, even when
contributing to a single framework stack.&lt;/p&gt;
&lt;p&gt;Furthermore, the &lt;a href=&quot;https://blog.opencollective.com/chromes-framework-of-open-source-investment/&quot; rel=&quot;noopener&quot;&gt;Chrome Framework
Fund&lt;/a&gt;
supports open-source tools and libraries with funding. While we hope that there
is enough overlap in the problems and solution layers to our efforts above to
translate to other frameworks and tools, we know we can do more. To that end, we
want to do our part to ensure libraries and frameworks helping developers
succeed can thrive. That&#39;s one reason we will be continuing to invest in the
Chrome Framework Fund. To date, it has supported work towards Webpack 5, Nuxt
and performance and improvements to ESLint.&lt;/p&gt;
&lt;h2 id=&quot;what-has-our-work-unlocked-so-far&quot;&gt;What has our work unlocked so far? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/introducing-aurora/#what-has-our-work-unlocked-so-far&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Our work has been focused on &lt;strong&gt;foundational optimizations&lt;/strong&gt; for resources like
images, JS, CSS, fonts. We&#39;ve shipped a number of optimizations to improve the
defaults of multiple frameworks, including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;An Image component in
&lt;a href=&quot;https://nextjs.org/docs/basic-features/image-optimization&quot; rel=&quot;noopener&quot;&gt;Next.js&lt;/a&gt; that
encapsulates best practices for image loading, followed by a collaboration
with &lt;a href=&quot;https://image.nuxtjs.org/&quot; rel=&quot;noopener&quot;&gt;Nuxt&lt;/a&gt; on the same. Use of this component
has resulted in significant improvements to paint times and layout shift
(example: 57% reduction in Largest Contentful Paint and 100% reduction in
Cumulative Layout Shift on
&lt;a href=&quot;https://mobile.twitter.com/rauchg/status/1321452444656623616/photo/2&quot; rel=&quot;noopener&quot;&gt;nextjs.org/give&lt;/a&gt;).&lt;/li&gt;
&lt;li&gt;Automated inlining of CSS for Web Font declarations at build time. This
feature has landed in
&lt;a href=&quot;https://angular.io/guide/workspace-config#fonts-optimization-options&quot; rel=&quot;noopener&quot;&gt;Angular&lt;/a&gt;
(Google Fonts) and
&lt;a href=&quot;https://nextjs.org/docs/basic-features/font-optimization&quot; rel=&quot;noopener&quot;&gt;Next.js&lt;/a&gt; (Google
Fonts &amp;amp; Adobe Fonts) resulting in notable improvements to Largest Contentful
Paint and First Contentful Paint
(&lt;a href=&quot;https://twitter.com/griefcode/status/1387746148883050496&quot; rel=&quot;noopener&quot;&gt;example&lt;/a&gt;).&lt;/li&gt;
&lt;li&gt;Inlining critical CSS using
&lt;a href=&quot;https://github.com/GoogleChromeLabs/critters&quot; rel=&quot;noopener&quot;&gt;Critters&lt;/a&gt; in both
&lt;a href=&quot;https://angular.io/guide/workspace-config#styles-optimization-options&quot; rel=&quot;noopener&quot;&gt;Angular&lt;/a&gt;
and Next.js to reduce paint times. Resulted in a 20-30 point improvement in
Lighthouse performance scores in a typical, large-scale Angular app when this
was combined with font CSS inlining feature.&lt;/li&gt;
&lt;li&gt;Out-of-the-box &lt;a href=&quot;https://nextjs.org/docs/basic-features/eslint&quot; rel=&quot;noopener&quot;&gt;ESLint support&lt;/a&gt;
in Next.js that includes a custom plugin and shareable configuration to make
it easier to catch common framework-specific issues at build-time, resulting
in more predictable loading performance.&lt;/li&gt;
&lt;li&gt;An introduction of a built-in performance relayer in &lt;a href=&quot;https://create-react-app.dev/docs/measuring-performance/&quot; rel=&quot;noopener&quot;&gt;Create React
App&lt;/a&gt; and
&lt;a href=&quot;https://nextjs.org/docs/advanced-features/measuring-performance&quot; rel=&quot;noopener&quot;&gt;Next.js&lt;/a&gt; to
allow easier insight into page performance through web vitals and other custom
metrics.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://web.dev/granular-chunking-nextjs/&quot;&gt;Granular chunking&lt;/a&gt; shipped in Next.js and Gatsby,
resulting in 30 to 70 percent reduction in bundle sizes while improving caching
performance. This has become the default in Webpack 5.&lt;/li&gt;
&lt;li&gt;A separate &lt;a href=&quot;https://github.com/vercel/next.js/pull/10212#issue-365945853&quot; rel=&quot;noopener&quot;&gt;polyfill
chunk&lt;/a&gt; for older
browsers, in collaboration with the Next.js team, to improve bundle size in modern
browsers.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Every one of these features have either been automated to be enabled by default
or only need a simple opt-in. This is essential to ensure that developers can
easily reap their benefits without adding complexity to their workflow.&lt;/p&gt;
&lt;h2 id=&quot;what-are-we-planning-for-2021&quot;&gt;What are we planning for 2021? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/introducing-aurora/#what-are-we-planning-for-2021&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Through the rest of this year, we will be focused on helping framework stacks
improve user experience and how well they perform on metrics such as the Core
Web Vitals. This work will include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Conformance for enforcing best practices. Check out the &lt;a href=&quot;https://web.dev/conformance&quot;&gt;blog post&lt;/a&gt; to
learn more.&lt;/li&gt;
&lt;li&gt;Optimizing initial load performance by building on our collaborations to optimize
&lt;a href=&quot;https://nextjs.org/blog/next-10#built-in-image-component-and-automatic-image-optimization&quot; rel=&quot;noopener&quot;&gt;Images&lt;/a&gt;,
&lt;a href=&quot;https://nextjs.org/blog/next-10-2#automatic-webfont-optimization&quot; rel=&quot;noopener&quot;&gt;Fonts&lt;/a&gt; and &lt;a href=&quot;https://angular.io/guide/workspace-config#optimization-configuration&quot; rel=&quot;noopener&quot;&gt;Critical
CSS&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Loading third-party scripts (3Ps) with minimal perf impact by building on our foundation of work
on a &lt;a href=&quot;https://nextjs.org/docs/basic-features/script&quot; rel=&quot;noopener&quot;&gt;Script&lt;/a&gt; component and performing deep
research into how best to order and sequence 3Ps.&lt;/li&gt;
&lt;li&gt;JavaScript performance at scale (e.g. supporting &lt;a href=&quot;https://reactjs.org/blog/2020/12/21/data-fetching-with-react-server-components.html&quot; rel=&quot;noopener&quot;&gt;React Server
Components&lt;/a&gt;
in Next.js).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Our team will aim to post more regular information on RFCs and design docs for
these ideas so that any framework or developer that wishes to follow along can
do so.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/introducing-aurora/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Aurora team (&lt;a href=&quot;https://github.com/spanicker&quot; rel=&quot;noopener&quot;&gt;Shubhie&lt;/a&gt;,
&lt;a href=&quot;https://github.com/housseindjirdeh&quot; rel=&quot;noopener&quot;&gt;Houssein&lt;/a&gt;,
&lt;a href=&quot;https://github.com/atcastle&quot; rel=&quot;noopener&quot;&gt;Alex&lt;/a&gt;, &lt;a href=&quot;https://github.com/devknoll&quot; rel=&quot;noopener&quot;&gt;Gerald&lt;/a&gt;,
&lt;a href=&quot;https://github.com/janicklas-ralph&quot; rel=&quot;noopener&quot;&gt;Ralph&lt;/a&gt;,
&lt;a href=&quot;https://github.com/addyosmani&quot; rel=&quot;noopener&quot;&gt;Addy&lt;/a&gt;) look forward to continuing to work
closely with the open-source framework community on improving user experience
defaults in Next.js, Nuxt and Angular. We&#39;ll be growing our engagement to cover
even more frameworks and tools over time. Watch this space for more blog posts,
talks and RFCs from our team over the coming year :)&lt;/p&gt;
</content>
      <author>
          <name>Shubhie Panicker</name>
        </author><author>
          <name>Addy Osmani</name>
        </author><author>
          <name>Houssein Djirdeh</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Conformance for Frameworks</title>
      <link href="https://web.dev/conformance/"/>
      <updated>2021-06-15T00:00:00Z</updated>
      <id>https://web.dev/conformance/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;In our &lt;a href=&quot;https://web.dev/aurora&quot;&gt;introductory blog post&lt;/a&gt;, we covered how we&#39;ve learned a lot while
building and using frameworks and tools to develop and maintain large scale web applications such as
Google Search, Maps, Photos, and so on. By safeguarding developers from writing code that can
negatively affect user experience, we proved that frameworks can play a key role in shifting
outcomes for performance and application quality.&lt;/p&gt;
&lt;p&gt;Internally at Google, we used the term &amp;quot;&lt;strong&gt;Conformance&lt;/strong&gt;&amp;quot; to describe this methodology, and this
article covers how we plan to open-source this concept to the JavaScript framework ecosystem.&lt;/p&gt;
&lt;h2 id=&quot;what-is-conformance&quot;&gt;What is Conformance? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#what-is-conformance&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;At Google, Conformance was an evolution. Teams relied on a small set of deeply experienced
maintainers who did extensive code reviews, flagging things that impacted app quality and
maintainability well beyond correctness issues. To scale this to growing teams of app developers, a
Conformance system was developed to codify best practices in a way that is automated and
enforceable. This ensured a consistently high bar for app quality and codebase maintainability
regardless of the number of code contributors.&lt;/p&gt;
&lt;p&gt;Conformance is a system that ensures that developers stay on the well-lit path;
it builds confidence and ensures predictable outcomes. It makes teams
productive, and becomes crucial for &lt;em&gt;scale&lt;/em&gt; -- as teams grow and more features
are developed simultaneously. It empowers developers to focus on building
product features, freeing them from minutiae and the changing landscape in
various areas such as performance, accessibility, security, etc. Anyone can
opt-out of Conformance at any time, and it should be customizable to the extent
that teams will have the option to enforce whatever they decide to commit to.&lt;/p&gt;
&lt;p&gt;Conformance is founded on &lt;strong&gt;strong defaults&lt;/strong&gt; and providing &lt;strong&gt;actionable rules&lt;/strong&gt; that can be
enforced at &lt;strong&gt;authoring time&lt;/strong&gt;. This breaks down into the following 3 principles.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Conformance in this article focuses on coding best practices to achieve predictable loading
performance &amp;amp; &lt;a href=&quot;https://web.dev/vitals/&quot;&gt;Core Web Vital&lt;/a&gt; scores, but the principles apply equally to
other aspects such as security, accessibility, and so forth.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;1.-strong-defaults&quot;&gt;1. Strong defaults &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#1.-strong-defaults&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A foundational aspect of conformance is ensuring that the tools developers use have strong defaults
in place. This means solutions are not only baked into frameworks, but also framework design
patterns make it easy to do the right thing and hard to follow anti-patterns. The framework supports
developers with application design and code structure.&lt;/p&gt;
&lt;p&gt;For loading performance, every resource (fonts, CSS, JavaScript, images, etc.) should be optimized.
This is a complex challenge involving trimming of bytes, reducing round trips, and separating out
what is needed for the first render, visual readiness, and user interaction. For example, extracting
critical CSS, and setting priority on important images.&lt;/p&gt;
&lt;h3 id=&quot;2.-actionable-rules&quot;&gt;2. Actionable rules &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#2.-actionable-rules&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Even with foundational optimizations in place, developers still have to make choices. There&#39;s a
spectrum of possibilities for optimizations when it comes to how much developer input is needed:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Defaults that require no developer input such as inlining critical CSS.&lt;/li&gt;
&lt;li&gt;Require developer opt-in. For example, using a framework-provided image component to size and
scale images.&lt;/li&gt;
&lt;li&gt;Require developer opt-in and customization. For example, tagging important images to be loaded
early.&lt;/li&gt;
&lt;li&gt;Not a specific feature but things that still require developer decision. For example, avoiding
fonts or synchronous scripts that delay early rendering.&lt;/li&gt;
&lt;/ul&gt;
&lt;img alt=&quot;Diagram that shows a spectrum between automatic and manual developer optimizations&quot; decoding=&quot;async&quot; height=&quot;450&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/A4kWjuu0tExEsTC4PoHe.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Optimizations that require any decision by developers pose a risk to the performance of the
application. As features are added and your team scales, even the most experienced developers cannot
keep up with the constantly changing best practices, nor is it the best use of their time. For
Conformance, appropriate actionable rules are as important as strong defaults to ensure that the
application continues to meet a certain standard even when developers continue to make changes.&lt;/p&gt;
&lt;h3 id=&quot;3.-authoring-time&quot;&gt;3. Authoring time &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#3.-authoring-time&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;It&#39;s important to catch and &lt;em&gt;preclude&lt;/em&gt; performance problems early in the development lifecycle.
Authoring time, before code is committed, is ideally suited to catching and addressing problems. The
later a problem is caught in the development lifecycle, the harder and more expensive it is to
address it. While this applies to correctness issues, it is also true for performance issues, as
many of these issues will not be retroactively addressed once committed to the codebase.&lt;/p&gt;
&lt;p&gt;Today, most performance feedback is out-of-band via documentation, one-off audits, or it is surfaced
too late via metrics regression after deployment to production. We want to bring this to authoring
time.&lt;/p&gt;
&lt;h2 id=&quot;conformance-in-frameworks&quot;&gt;Conformance in Frameworks &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#conformance-in-frameworks&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To maintain a high bar of user experience for loading performance, the following questions need to
be answered:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;What constitutes optimal loading, and what are the common issues that could impact it adversely?&lt;/li&gt;
&lt;li&gt;Which solutions can be baked in that do not need any developer input?&lt;/li&gt;
&lt;li&gt;How can we ensure that the developer uses these solutions and leverages them optimally?&lt;/li&gt;
&lt;li&gt;What other choices could the developer make that impact loading performance?&lt;/li&gt;
&lt;li&gt;What are the code patterns that can tell us about these choices (#3 and #4 above) early at
authoring time?&lt;/li&gt;
&lt;li&gt;What rules can we formulate to assess these code patterns? How can they be surfaced to the
developer at authoring time while seamlessly integrated into their workflow?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;To bring the Conformance model we have internally at Google to open-source frameworks, our team has
experimented heavily in Next.js and we are excited to share our refined vision and plans. We&#39;ve
realized that the best set of rules that can assess code patterns will need to be a combination of
&lt;strong&gt;static code analysis&lt;/strong&gt; and &lt;strong&gt;dynamic checks.&lt;/strong&gt; These rules can span multiple surfaces, including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ESLint&lt;/li&gt;
&lt;li&gt;TypeScript&lt;/li&gt;
&lt;li&gt;Dynamic checks in the user&#39;s development server (post DOM creation)&lt;/li&gt;
&lt;li&gt;Module bundler (webpack)&lt;/li&gt;
&lt;li&gt;CSS tooling (still exploratory)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;By taking advantage of providing rules through different tools, we can ensure they are cohesive but
also encompass any user experience issues that directly impact loading performance. Additionally,
these rules can also be surfaced to developers at different times:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;During local development in the development server, browser and user&#39;s IDE will surface warnings,
prompting developers to make small code changes.&lt;/li&gt;
&lt;li&gt;At build time, unresolved issues will be resurfaced in the user&#39;s terminal&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In a nutshell, teams will choose outcomes they care about, such as Core Web Vitals or loading
performance, and enable relevant rulesets for all code contributors to follow.&lt;/p&gt;
&lt;p&gt;While this works really well for new projects, it&#39;s not easy to upgrade large codebases to comply
with full rulesets. At Google we have an extensive system for opting-out at different levels such as
individual lines of source code, entire directories, legacy codebases or parts of the app that are
not under active development. We are actively exploring effective strategies for bringing this to
teams using open-source frameworks.&lt;/p&gt;
&lt;h2 id=&quot;conformance-in-next.js&quot;&gt;Conformance in Next.js &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#conformance-in-next.js&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ESLint is widely used among JavaScript developers. and over 50% of Next.js applications use ESLint
in some part of their build workflow. Next.js v11 introduced out-of-the-box ESLint support that
includes a &lt;a href=&quot;https://nextjs.org/docs/basic-features/eslint#eslint-plugin&quot; rel=&quot;noopener&quot;&gt;custom plugin&lt;/a&gt; and
&lt;a href=&quot;https://nextjs.org/docs/basic-features/eslint#base-configuration&quot; rel=&quot;noopener&quot;&gt;shareable configuration&lt;/a&gt; to
make it easier to catch common framework-specific issues during development and at build time. This
can help developers fix significant problems at authoring time. Examples include when a certain
component is used, or not used, in a way that could harm performance as in &lt;a href=&quot;https://nextjs.org/docs/messages/no-html-link-for-pages&quot; rel=&quot;noopener&quot;&gt;No HTML link for
page&lt;/a&gt;). Or, if a certain font, stylesheet,
or script can negatively affect resource loading on a page. For example, &lt;a href=&quot;https://nextjs.org/docs/messages/no-sync-scripts&quot; rel=&quot;noopener&quot;&gt;No synchronous
script&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In addition to ESLint, &lt;a href=&quot;https://nextjs.org/blog/next-9#built-in-zero-config-typescript-support&quot; rel=&quot;noopener&quot;&gt;integrated
type-checking&lt;/a&gt; in both
development and production has been supported in Next.js since v9 with TypeScript support. Multiple
components provided by the framework (Image, Script, Link) have been built as an extension of HTML
elements (&lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt;, &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;, &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt;) to provide developers with a performant approach to adding
content to a web page. Type-checking supports appropriate usage of these features by ensuring that
properties and options assigned are in the acceptable scope of supported values and types. See
&lt;a href=&quot;https://nextjs.org/docs/api-reference/next/image#width&quot; rel=&quot;noopener&quot;&gt;required Image width and height&lt;/a&gt; for an
example.&lt;/p&gt;
&lt;h3 id=&quot;surfacing-errors-with-toasts-and-overlays&quot;&gt;Surfacing Errors With Toasts and Overlays &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#surfacing-errors-with-toasts-and-overlays&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;As mentioned previously, Conformance rules can be surfaced in multiple areas. Toasts and overlays
are currently being explored as a way to surface errors directly in the browser within the user&#39;s
local development environment.&lt;/p&gt;
&lt;img alt=&quot;Errors surfaced via toasts&quot; decoding=&quot;async&quot; height=&quot;454&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/0SXGYLkliuPQY3aSy3zWvdv7RqG2/6euyc60GeSrmqpDprbQ7.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Many error-checking and auditing tools that developers rely on (Lighthouse, Chrome DevTools Issues
tab) are passive and require some form of user interaction to retrieve information. Developers are
more likely to act when errors are surfaced directly within their existing tooling, and when they
provide concrete and specific actions that should be taken to fix the problem.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Utilizing toasts and overlays as a UI surface for Conformance is still being explored in
Next.js.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;conformance-in-other-frameworks&quot;&gt;Conformance in Other Frameworks &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#conformance-in-other-frameworks&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Conformance is being explored in Next.js first with the goal of expanding to other frameworks
(Nuxt, Angular, etc.). ESLint and TypeScript are already used in many frameworks in many
different ways, but the concept of a cohesive, browser-level runtime system is being actively
explored.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/conformance/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Conformance codifies best practices into rulesets that are actionable for developers as simple code
patterns. The Aurora team has focused on loading performance, but other best practices, such as
accessibility and security, are just as applicable.&lt;/p&gt;
&lt;p&gt;Following Conformance rules should result in predictable outcomes, and achieving a high bar for user
experience can become a side-effect of building on your tech stack. Conformance makes teams
productive, and ensures a high quality bar for the application, even as teams and codebases grow
over time.&lt;/p&gt;
</content>
      <author>
          <name>Shubhie Panicker</name>
        </author><author>
          <name>Houssein Djirdeh</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Improving Cumulative Layout Shift at Telegraph Media Group</title>
      <link href="https://web.dev/telegraph/"/>
      <updated>2021-06-14T00:00:00Z</updated>
      <id>https://web.dev/telegraph/</id>
      <content type="text/html" mode="escaped">&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Chris is a principal software engineer at &lt;a href=&quot;https://www.telegraph.co.uk/&quot; rel=&quot;noopener&quot;&gt;The
Telegraph&lt;/a&gt;. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;the-visual-stability-challenge&quot;&gt;The visual stability challenge &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#the-visual-stability-challenge&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Layout shifts can be very disruptive. At Telegraph Media Group (TMG) visual stability
is particularly important because readers predominantly use our applications to
consume the news. If the layout shifts while reading an article, the reader will
likely lose their place. This can be a frustrating and distracting experience.&lt;/p&gt;
&lt;p&gt;From an engineering perspective, ensuring the pages don&#39;t shift and interrupt
the reader can be challenging, especially when areas of your application are
loaded asynchronously and added to the page dynamically.&lt;/p&gt;
&lt;p&gt;At TMG, we have multiple teams contributing code client-side:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Core engineering.&lt;/strong&gt; Implementing third-party solutions to power areas such
as content recommendations and commenting.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Marketing.&lt;/strong&gt; Running A/B tests to assess how our readers interact with new
features or changes.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advertising.&lt;/strong&gt; Managing advert requests and advert pre-bidding.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Editorial.&lt;/strong&gt; Embedding code within articles such as tweets or videos, as
well as custom widgets (for example, Coronavirus case tracker).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ensuring each of these teams do not cause the layout of the page to jolt can be
difficult. Using the &lt;a href=&quot;https://web.dev/cls/&quot;&gt;Cumulative Layout Shift&lt;/a&gt; metric to measure how
often it&#39;s occurring for our readers, the teams got more insight into the real
user experience and a clear goal to strive to. This resulted in our 75th
percentile CLS improving from 0.25 to 0.1 and our passing bucket growing from
57% to 72%.&lt;/p&gt;
&lt;div class=&quot;w-stats&quot;&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;250&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;75th percentile CLS improvement&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;w-stat&quot;&gt;
    &lt;p class=&quot;w-stat__figure&quot;&gt;15&lt;sub class=&quot;w-stat__sub&quot;&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p class=&quot;w-stat__desc&quot;&gt;More users with good CLS score&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;where-we-started&quot;&gt;Where we started &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#where-we-started&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using &lt;a href=&quot;https://web.dev/chrome-ux-report-data-studio-dashboard/&quot;&gt;CrUX dashboards&lt;/a&gt; we were able
to establish that our pages were shifting more than we&#39;d like.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;CrUX Dashboard showing about 55-60% good, 15% needs improvement, and 25% of poor scores.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;472&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 780px) 780px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/JvZwGUWfJ0bxKBQmD11P.png?auto=format&amp;w=1560 1560w&quot; width=&quot;780&quot; /&gt;
    &lt;figcaption&gt;Our Cumulative Layout Shift scores between June 2020 and February 2021.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;We ideally wanted at least 75% of our readers to have a &amp;quot;good&amp;quot; experience so we
started identifying the causes of the layout instability.&lt;/p&gt;
&lt;h2 id=&quot;how-we-measured-the-layout-shifts&quot;&gt;How we measured the layout shifts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#how-we-measured-the-layout-shifts&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We used a combination of &lt;a href=&quot;https://developer.chrome.com/docs/devtools/&quot; rel=&quot;noopener&quot;&gt;Chrome
DevTools&lt;/a&gt; and
&lt;a href=&quot;https://www.webpagetest.org/&quot; rel=&quot;noopener&quot;&gt;WebPageTest&lt;/a&gt; to help recognize what was causing
the layout to shift. In DevTools, we used the &lt;a href=&quot;https://developer.chrome.com/blog/new-in-devtools-84/#cls&quot; rel=&quot;noopener&quot;&gt;Experience
section&lt;/a&gt; of the
&lt;a href=&quot;https://developer.chrome.com/docs/devtools/evaluate-performance/&quot; rel=&quot;noopener&quot;&gt;Performance&lt;/a&gt;
tab to highlight individual instances of shifting layout and how they
contributed to the overall score.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;The front page of Telegraph with an ad in the header highlughted with a blue overlay.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;465&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/zfpYNnnpwtcG7YAmf7E5.jpg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;Identifying a layout shift caused by the advert loading client-side above the header using the Experience section of Chrome DevTools.&lt;figcaption&gt;
&lt;/figcaption&gt;&lt;/figcaption&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://www.webpagetest.org/&quot; rel=&quot;noopener&quot;&gt;WebPageTest&lt;/a&gt; helpfully highlights where the
layout shift occurs in the timeline view when &amp;quot;Highlight Layout Shifts&amp;quot; is
selected.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;WebPageTest filmstrip view of the Telegraph website with the layoutshift highlighted with a red overlay.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;369&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/qaa60OEaFLoKVzWtntVw.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;WebPageTest highlighting where the layout shifted.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;After reviewing each shift across our most visited templates we came up with a
list of ideas as to how we could improve.&lt;/p&gt;
&lt;h2 id=&quot;reducing-layout-shifts&quot;&gt;Reducing layout shifts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#reducing-layout-shifts&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We focused on four areas where we could reduce layout shifts:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;adverts&lt;/li&gt;
&lt;li&gt;images&lt;/li&gt;
&lt;li&gt;headers&lt;/li&gt;
&lt;li&gt;embeds&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;adverts&quot;&gt;Adverts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#adverts&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The adverts load after the initial paint via JavaScript. Some of the containers
they loaded in did not have any reserved height on them.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Animation of the Telegraph website. The list of stories gets pushed down when an ad loads above it.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;438&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 387px) 387px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/klpZyS7okn4DwfPbL5qZ.gif?auto=format&amp;w=774 774w&quot; width=&quot;387&quot; /&gt;
    &lt;figcaption&gt;The &quot;More stories&quot; block below the advert is shifted down after the advert loads.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Although we don&#39;t know the exact height, we&#39;re able to reserve space by using
the most common advert size loaded in the slot.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;Animation of the Telegraph website. A placeholder rectangle for the ad is placed above the list of stories. The ad loads in place of the placeholder without causing a layout shift.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;438&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 387px) 387px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aA7rq5NGK1f1cA5FkT8n.gif?auto=format&amp;w=774 774w&quot; width=&quot;387&quot; /&gt;
    &lt;figcaption&gt;By reserving space for the advert, the &quot;More stories&quot; block below remains static before and after the advert loads.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;We had misjudged the average height of the advert in some cases. For tablet
readers, the slot was collapsing.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Animation of a tablet view of the Telegraph website. The placeholder slot is bigger than the ad so the content shifts up after ad loads.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;313&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 600px) 600px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/by1xeAvvBKNjiZTVbQ1v.gif?auto=format&amp;w=1200 1200w&quot; width=&quot;600&quot; /&gt;
&lt;figcaption&gt;The advert slot collapsing after it loaded for readers on tablet sized devices.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;We revisited the slot and adjusted the height to use the most common size.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Animation of a tablet view of the Telegraph website. With the placeholder matching the ad size, there&amp;#x27;s no layoutshift when the ad loads.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;205&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 600px) 600px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/arV5fG7O7CUUHb7mdt54.gif?auto=format&amp;w=1200 1200w&quot; width=&quot;600&quot; /&gt;
&lt;figcaption&gt;Ensuring the space we reserved for the advert slot matched the most commonly served height of the advert.
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;images&quot;&gt;Images &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#images&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A lot of the images across the website are lazy loaded and have their space
reserved for them.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;Animation of article preview cards loading.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;352&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 600px) 600px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/IFeiuIif24EDbbpObx4n.gif?auto=format&amp;w=1200 1200w&quot; width=&quot;600&quot; /&gt;
    &lt;figcaption&gt;Lazy loading images without disrupting the layout.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;However the inline images at the top of the articles did not have any space
reserved on the container, nor did they have width and height attributes
associated with the tags. This caused the layout to shift as they loaded in.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;Animation of the article page loading. When the main image loads at the top of the page, the text moves down.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;612&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 360px) 360px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/G7PnNyKZhURv7mpYMx9Q.gif?auto=format&amp;w=720 720w&quot; width=&quot;360&quot; /&gt;
    &lt;figcaption&gt;A layout shift caused by the article&#39;s main image.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Simply adding the width and height attributes to the images ensured the layout
did not shift.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;Animation of the article page loading with placeholder reserved for the main image. When the main image loads at the top of the page, there&amp;#x27;s no layout shift.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;630&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 360px) 360px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/LuYayFKwpXN889Fk3GLG.gif?auto=format&amp;w=720 720w&quot; width=&quot;360&quot; /&gt;
    &lt;figcaption&gt;The main article image loading without causing the layout to shift.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;header&quot;&gt;Header &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#header&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The header was below the content in the markup and was positioned at the top
using CSS. The original idea was to prioritise the content loading before the
navigation however this caused the page to momentarily shift.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;ALT_TEXT_HERE&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;333&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/ym64zcKRzey40Ov0JYX5.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;The header of the page loading inelegantly.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Moving the header to the top of the markup allowed the page to render without
this shift.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;ALT_TEXT_HERE&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;303&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/drYhZauv1oWZyp7mpQz9.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;The layout is no longer disrupted by the header of the page loading.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;embeds&quot;&gt;Embeds &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#embeds&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Some of the frequently used embeds have a defined aspect ratio. For example,
YouTube videos. While the player is loading, we pull the thumbnail from YouTube
and use it as a placeholder while the video loads.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;The video player slot loading a low resolution thumbnail while the video player loads.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;612&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 360px) 360px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/BKPbdBJROUIUqoT8coFW.gif?auto=format&amp;w=720 720w&quot; width=&quot;360&quot; /&gt;
    &lt;figcaption&gt;The video player slot loading a low resolution thumbnail while the video player loads.
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;measuring-the-impact&quot;&gt;Measuring the impact &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#measuring-the-impact&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We were able to measure the impact at a feature level quite easily using the
tooling mentioned towards the start of the article. However we wanted to measure
CLS both at a template level and at a site level. Synthetically, we used
&lt;a href=&quot;https://speedcurve.com/&quot; rel=&quot;noopener&quot;&gt;SpeedCurve&lt;/a&gt; to validate changes both in pre-production
and production.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;SpeedCurve chart showing a steep drop in CLS score.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;343&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/kVRCtjeFVTbN7aOV4O0z.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;Tracking CLS progress synthetically using SpeedCurve.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;We&#39;re able to then validate the results in our RUM data (provided by
&lt;a href=&quot;https://www.akamai.com/uk/en/products/performance/mpulse-real-user-monitoring.jsp&quot; rel=&quot;noopener&quot;&gt;mPulse&lt;/a&gt;)
once the code reached production.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;mPulse chart showing a drop in CLS score.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;550&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/Bv8QeCPy9zQ4eru2qrhU.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;Validating site-wide CLS improvements with mPulse RUM data before and after making changes.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Checking the RUM data provides us with a good level of confidence that the
changes we&#39;re making are having a positive impact for our readers.&lt;/p&gt;
&lt;p&gt;The final numbers we looked at are for the RUM data Google collects. This is
especially relevant now as they will soon &lt;a href=&quot;https://developers.google.com/search/blog/2020/05/evaluating-page-experience#page-experience-ranking&quot; rel=&quot;noopener&quot;&gt;have an impact on page
ranking&lt;/a&gt;.
For starters we used the &lt;a href=&quot;https://web.dev/chrome-ux-report/&quot;&gt;Chrome UX Report&lt;/a&gt;, both in the
monthly origin level data available through the &lt;a href=&quot;https://g.co/chromeuxdash&quot; rel=&quot;noopener&quot;&gt;CrUX
dashboard&lt;/a&gt;, as well as by &lt;a href=&quot;https://web.dev/chrome-ux-report-bigquery/&quot;&gt;querying
BigQuery&lt;/a&gt; to retrieve historic p75 data. This way
we were easily able to see that for all of the traffic measured by CrUX, &lt;strong&gt;our
75th percentile CLS improved by 250% from 0.25 to 0.1 and our passing bucket
grew from 57% to 72%&lt;/strong&gt;.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;CrUX dashboard showing p75 CLS for telegraph.co.uk is 0.1.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;449&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/vmmokEtVcn7FJzmOIJB8.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;Results from the Crux Dashboard.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;BigQuery showing p75 values improving month to month, from 0.25 to 0.1.&quot; decoding=&quot;async&quot; height=&quot;517&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 488px) 488px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/8d8UOEi5GPcIitsTcQMA.png?auto=format&amp;w=976 976w&quot; width=&quot;488&quot; /&gt;
    &lt;figcaption&gt;BigQuery run displaying the p75 values of 2021 to date.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In addition, we were able to make use of the &lt;a href=&quot;https://developers.google.com/web/tools/chrome-user-experience-report/api/reference&quot; rel=&quot;noopener&quot;&gt;Chrome UX Report
API&lt;/a&gt;
and create some internal dashboards split into templates.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;Internal dashboard showing average good score of 76.2, needs improvement of 9.3, and poor score of 14.6.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;402&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/aYW2QPaFucKThXxZfFAD.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;Internal dashboards making use of the Chrome UX Report API highlighting our average score and the worst performing pages using that template.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;avoiding-cls-regressions&quot;&gt;Avoiding CLS regressions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#avoiding-cls-regressions&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;An important aspect of making performance improvements is avoiding regressions.
We&#39;ve set up some basic &lt;a href=&quot;https://web.dev/performance-budgets-101/&quot;&gt;performance budgets&lt;/a&gt; for our
key metrics and included CLS in those.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
    &lt;img alt=&quot;&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;343&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vgdbNJBYHma2o62ZqYmcnkq3j0o1/9ggBNUTAptmnmxVlXZGo.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;A performance budget dashboard which shows synthetic checks measuring CLS on some of our high traffic templates. The budget is currently set at 0.025.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;If the test exceeds the budget it&#39;ll send a message to a Slack channel so we can
investigate the cause. We&#39;ve also set up weekly reports, so that even if the
templates remain in budget we&#39;re aware of any changes that have had a negative
impact.&lt;/p&gt;
&lt;p&gt;We&#39;re also planning to expand our budgets to use RUM data as well as synthetic
data, using mPulse to set both &lt;a href=&quot;https://learn.akamai.com/en-us/webhelp/mpulse/mpulse-help/GUID-CEE8FE75-2CD9-423A-BB3E-26EC9D8735A9.html&quot; rel=&quot;noopener&quot;&gt;static
alerts&lt;/a&gt;
and potentially &lt;a href=&quot;https://learn.akamai.com/en-us/webhelp/mpulse/mpulse-help/GUID-C6C446C4-E545-471F-A943-2CE6D885E60C.html&quot; rel=&quot;noopener&quot;&gt;anomaly
detection&lt;/a&gt;
which would make us aware of any changes that are out of the ordinary.&lt;/p&gt;
&lt;p&gt;It&#39;s important for us to approach new features with CLS in mind. A lot of the
changes I&#39;ve mentioned are those we&#39;ve had to fix after they&#39;ve been released to
our readers. Layout stability will be a consideration for the solution design of
any new feature going forward so that we can avoid any unexpected layout shifts
from the start.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/telegraph/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The improvements we&#39;ve made so far were quite easy to implement and have had a
significant impact. A lot of changes I&#39;ve outlined in this article didn&#39;t take
much time to deliver and they were applied to all of the most commonly used
templates which means they&#39;ve had a widespread positive impact for our readers.&lt;/p&gt;
&lt;p&gt;There are still areas of the site we need to improve. We&#39;re exploring ways we
might be able to do more of our client-side logic server-side which will improve
CLS even more. We will keep tracking and monitoring our metrics with an aim to
constantly improve them and provide our readers with the best user experience
possible.&lt;/p&gt;
</content>
      <author>
          <name>Chris Boakes</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>CSS `size-adjust` for `@font-face`</title>
      <link href="https://web.dev/css-size-adjust/"/>
      <updated>2021-06-09T00:00:00Z</updated>
      <id>https://web.dev/css-size-adjust/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;Consider the following
&lt;a href=&quot;https://codepen.io/argyleink/pen/8ace843980e2fd24bf15c8bd1bd072e4?editors=1100&quot; rel=&quot;noopener&quot;&gt;demo&lt;/a&gt;
where the &lt;code&gt;font-size&lt;/code&gt; is a consistent &lt;code&gt;64px&lt;/code&gt;, and the only difference between each of these headers is the &lt;code&gt;font-family&lt;/code&gt;. The examples on the left have not been adjusted and
have an inconsistent final size. The examples on the right use &lt;code&gt;size-adjust&lt;/code&gt; to
ensure &lt;code&gt;64px&lt;/code&gt; is the consistent final size.&lt;/p&gt;
&lt;figure class=&quot;w-figure w-figure--fullbleed&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/6xhatUhszn7M6pDFcVgV.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
   In this example Chrome DevTools CSS grid layout debug tools are used to show heights.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This post explores a &lt;a href=&quot;https://drafts.csswg.org/css-fonts-5/#size-adjust-desc&quot; rel=&quot;noopener&quot;&gt;new CSS font-face
descriptor&lt;/a&gt; called
&lt;code&gt;size-adjust&lt;/code&gt;, available in Chromium 92 and Firefox 89 (behind a flag); (see
&lt;a href=&quot;https://caniuse.com/mdn-css_at-rules_font-face_size-adjust&quot; rel=&quot;noopener&quot;&gt;caniuse&lt;/a&gt; for latest
support). It also demonstrates a few ways to correct and normalize font sizes
for smoother user experience, consistent design systems and more predictable
page layout. One important use case is optimizing web font rendering to prevent
&lt;a href=&quot;https://web.dev/cls/&quot;&gt;cumulative layout shift&lt;/a&gt; (CLS).&lt;/p&gt;
&lt;p&gt;Here&#39;s an interactive &lt;a href=&quot;https://codepen.io/argyleink/pen/rNyMjxR&quot; rel=&quot;noopener&quot;&gt;demo&lt;/a&gt; of the
problem space. Try changing the typeface with the dropdown and observe:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The height differences in the results.&lt;/li&gt;
&lt;li&gt;Visually jarring content shifts.&lt;/li&gt;
&lt;li&gt;Moving interactive target areas (the dropdown jumps around!).&lt;/li&gt;
&lt;/ol&gt;
&lt;div style=&quot;height: 500px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/WNpzRKd?height=500&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen WNpzRKd by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;div class=&quot;w-aside w-aside--key-term&quot;&gt;
&lt;p&gt;&lt;strong&gt;Key Term&lt;/strong&gt;:&lt;br /&gt;
Font family vs Typeface: A &lt;strong&gt;typeface&lt;/strong&gt; is referred to by
its family name plus its font face. &lt;code&gt;Helvetica Bold&lt;/code&gt; is referring to the
specific bold typeface while &lt;code&gt;Helvetica&lt;/code&gt; is generically referring to the entire
family of 8+ typefaces (normal, bold, italic, etc). With CSS &lt;code&gt;@font-face&lt;/code&gt; you&#39;ll be dealing with typefaces, even
though to use them you need to write &lt;code&gt;font-family&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;how-to-scale-fonts-with-size-adjust&quot;&gt;How to scale fonts with &lt;code&gt;size-adjust&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#how-to-scale-fonts-with-size-adjust&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;An introduction to the syntax:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Adjusted Typeface&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 150%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;some/path/to/typeface.woff2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;ol&gt;
&lt;li&gt;Creates a custom typeface named &lt;code&gt;Adjusted Typeface&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Uses &lt;code&gt;size-adjust&lt;/code&gt; to scale up each glyph to 150% their default size.&lt;/li&gt;
&lt;li&gt;Affects only the single imported typeface.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Use the above custom typeface like this:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;h1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Adjusted Typeface&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div style=&quot;height: 500px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/yLMKgRx?height=500&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen yLMKgRx by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;div class=&quot;w-aside w-aside--warning&quot;&gt;
&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;:&lt;br /&gt;
If the second headline in the above demo is not larger than the
first one, your browser does not support &lt;code&gt;size-adjust&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;mitigating-cls-with-seamless-font-swapping&quot;&gt;Mitigating CLS with seamless font swapping &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#mitigating-cls-with-seamless-font-swapping&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In the following gif, watch the examples on the left and how there&#39;s a shift
when the font is changed. This is just a small example with a single headline
element and the issue is very noticeable.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/6xhatUhszn7M6pDFcVgV.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    The example on the left has layout shift, the one on the right does not.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;To improve font rendering, a great technique is &lt;a href=&quot;https://web.dev/font-display/&quot;&gt;font
swapping&lt;/a&gt;. Render a quick-loading
system font to show the content first, then swap that with a web font when
the web font finishes loading. This gives you the best of both worlds: the
content is visible as soon as possible, and you get a nicely styled page without
sacrificing your user&#39;s time to content. The problem however, is that sometimes
when the web font loads, it shifts the entire page around since it presents at a
slightly different box height size.&lt;/p&gt;
&lt;figure class=&quot;w-figure w-screenshot&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/F7CwbZuMHaapGTeXRfSJ.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    more content equals more potential layout shift when font swaps
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;By putting &lt;code&gt;size-adjust&lt;/code&gt; in the &lt;code&gt;@font-face&lt;/code&gt; rule, it sets a global glyph
adjustment for the font face. Timing this right will lead to minimal visual
change, a seamless swap. To create a seamless swap, hand adjust or try this
&lt;a href=&quot;https://deploy-preview-15--upbeat-shirley-608546.netlify.app/perfect-ish-font-fallback&quot; rel=&quot;noopener&quot;&gt;size-adjust
calculator&lt;/a&gt;
by &lt;a href=&quot;https://twitter.com/cramforce&quot; rel=&quot;noopener&quot;&gt;Malte Ubl&lt;/a&gt;.&lt;/p&gt;
&lt;figure class=&quot;w-figure w-screenshot&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/Tw8J2e0ymyGogeA7NJjY.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    Choose a &lt;a href=&quot;https://fonts.google.com/&quot;&gt;Google Web Font&lt;/a&gt;, get back a pre-adjusted &lt;code&gt;@font-face&lt;/code&gt; snippet.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;At the beginning of this post, fixing the font size issue was done by trial and
error. &lt;code&gt;size-adjust&lt;/code&gt; was nudged in the source code until the same header in
&lt;code&gt;Cookie&lt;/code&gt; and &lt;code&gt;Arial&lt;/code&gt; rendered the same &lt;code&gt;64px&lt;/code&gt; as &lt;code&gt;Press Start 2P&lt;/code&gt; did naturally.
I aligned two fonts to a target font size.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Adjusted Arial&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 86%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Arial&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Cookie&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 90.25%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;...woff2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div style=&quot;height: 500px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/jOBzyop?height=500&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen jOBzyop by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;h3 id=&quot;calibrating-fonts&quot;&gt;Calibrating fonts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#calibrating-fonts&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;You as the author determine the calibration target(s) for normalizing font
scale. You might normalize on Times, Arial, or a system font, then adjust custom
fonts to match. Or, you might adjust local fonts to match what you download.&lt;/p&gt;
&lt;p&gt;Strategies for &lt;code&gt;size-adjust&lt;/code&gt; calibration:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Remote target:&lt;/strong&gt;&lt;br /&gt;Adjust local fonts towards downloaded fonts.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Local target:&lt;/strong&gt;&lt;br /&gt;Adjust downloaded fonts towards local target fonts.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;example-1:-remote-target&quot;&gt;Example 1: Remote target &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#example-1:-remote-target&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Consider the following snippet which adjusts a locally available font to size
match a remote src custom font. A remote custom font is the target for
calibration, a brand font perhaps:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Adjusted Regular Arial For Brand&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Arial&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 90%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Rad Brand&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;some/path/to/a.woff2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Rad Brand&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Adjusted Regular Arial For Brand&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;In this example, local font Arial is adjusting in anticipation of a loaded custom font, for a
seamless swap.&lt;/p&gt;
&lt;p&gt;This strategy has an advantage of offering designers and developers the same
font for sizing and typography. &lt;strong&gt;The brand is the calibration target.&lt;/strong&gt; This is
great news for design systems.&lt;/p&gt;
&lt;p&gt;Having a brand typeface as the target is also how Malte&#39;s calculator works.
Choose a Google Font and it will calculate how to adjust Arial to seamlessly
swap with it. Here&#39;s an example of Roboto CSS from &lt;a href=&quot;https://deploy-preview-15--upbeat-shirley-608546.netlify.app/perfect-ish-font-fallback&quot; rel=&quot;noopener&quot;&gt;the
calculator&lt;/a&gt;,
where Arial is loaded and named &amp;quot;Roboto-fallback&amp;quot;:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Roboto-fallback&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 100.06%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Arial&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div class=&quot;w-aside w-aside--warning&quot;&gt;
&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;:&lt;br /&gt;
The order of &lt;code&gt;font-family&lt;/code&gt; is critical. It&#39;s where order
and priority go. Ensure the typeface you want the most, is first. Furthermore,
&lt;code&gt;local(Arial)&lt;/code&gt; may not be available on all your user&#39;s devices, therefore it&#39;s
important to provide multiple fallbacks in the font-family.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;To create a fully cross platform adjustment, see the following example which provides 2 adjusted local fallback fonts in anticipation of a brand font.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Roboto-fallback-1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 100.06%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Arial&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Roboto-fallback-2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 99.94%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Arimo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Roboto Regular&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;some/path/to/roboto.woff2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Roboto Regular&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Roboto-fallback-1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Roboto-fallback-2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h4 id=&quot;example-2:-local-target&quot;&gt;Example 2: Local target &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#example-2:-local-target&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Consider the following snippet which adjusts a brand custom font to match Arial:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Rad Brand - Adjusted For Arial&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;some/path/to/a.woff2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;woff2&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;size-adjust&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 110%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Rad Brand - Adjusted For Arial&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Arial&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This strategy has the advantage of rendering without any adjustments, then
adjusting any incoming fonts to match.&lt;/p&gt;
&lt;h2 id=&quot;finer-tuning-with-ascent-override-descent-override-and-line-gap-override&quot;&gt;Finer tuning with &lt;code&gt;ascent-override&lt;/code&gt;, &lt;code&gt;descent-override&lt;/code&gt; and &lt;code&gt;line-gap-override&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#finer-tuning-with-ascent-override-descent-override-and-line-gap-override&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If generic scaling of glyphs isn&#39;t enough adjustment for your design or loading
strategies, here are some finer tuning options that work along with
&lt;code&gt;size-adjust&lt;/code&gt;. The
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/ascent-override&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;ascent-override&lt;/code&gt;&lt;/a&gt;,
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/descent-override&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;descent-override&lt;/code&gt;&lt;/a&gt;,
and
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/line-gap-override&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;line-gap-override&lt;/code&gt;&lt;/a&gt;
properties are currently implemented in Chromium 87+, and Firefox 89+.&lt;/p&gt;
&lt;img alt=&quot;scissors above and blow the word overrides, demonstrating the areas the features can trim to&quot; decoding=&quot;async&quot; height=&quot;136&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/R0VZLOdnHUWpAomfMK3g.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;ascent-override&quot;&gt;&lt;code&gt;ascent-override&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#ascent-override&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;ascent-override&lt;/code&gt; descriptor defines the height above the baseline of a
font.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Ascent Adjusted Arial Bold&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Arial Bold&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;ascent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 71%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div style=&quot;height: 500px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/ZEexebZ?height=500&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen ZEexebZ by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;The red headline (unadjusted) has space above it&#39;s capital letter A and O, while
the blue headline has been adjusted so it&#39;s &lt;a href=&quot;https://en.wikipedia.org/wiki/Cap_height&quot; rel=&quot;noopener&quot;&gt;cap
height&lt;/a&gt; fits snug against the overall
bounding box.&lt;/p&gt;
&lt;h3 id=&quot;descent-override&quot;&gt;&lt;code&gt;descent-override&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#descent-override&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;descent-override&lt;/code&gt; descriptor defines the height below the baseline of the
font.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Ascent Adjusted Arial Bold&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Arial Bold&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;descent-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div style=&quot;height: 500px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/OJpvpNQ?height=500&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen OJpvpNQ by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;The red headline (unadjusted) has space below it&#39;s D and O
&lt;a href=&quot;https://en.wikipedia.org/wiki/Baseline_(typography)&quot; rel=&quot;noopener&quot;&gt;baselines&lt;/a&gt;, while the blue
headline has been adjusted so it&#39;s letters rest snug on the baseline.&lt;/p&gt;
&lt;h3 id=&quot;line-gap-override&quot;&gt;&lt;code&gt;line-gap-override&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#line-gap-override&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;line-gap-override&lt;/code&gt; descriptor defines the line-gap metric for the font.
This is the font recommended line-gap or external leading.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@font-face&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Line Gap Adjusted Arial&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Arial&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;line-gap-override&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 50%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div style=&quot;height: 500px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/xxqWqOw?height=500&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen xxqWqOw by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;The red headline (unadjusted) has no &lt;code&gt;line-gap-override&lt;/code&gt;, essentially it&#39;s at
&lt;code&gt;0%&lt;/code&gt;, while the blue headline has been adjusted up by 50%, creating space above
and below the letters accordingly.&lt;/p&gt;
&lt;h3 id=&quot;putting-it-all-together&quot;&gt;Putting it all together &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#putting-it-all-together&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Each of these overrides offer an additional way to trim excess from the web&#39;s
safe text bounding box. You can tailor the text box for precise presentation.&lt;/p&gt;
&lt;div style=&quot;height: 500px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/web-dot-dev/embed/poeLebG?height=500&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen poeLebG by web-dot-dev on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;div class=&quot;w-aside w-aside--warning&quot;&gt;
&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;:  If any of the above demos aren&#39;t showing differences, your
browser does not support the overrides. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-size-adjust/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;@font-face&lt;/code&gt; &lt;code&gt;size-adjust&lt;/code&gt; CSS feature is an exciting way to customize the
text bounding box of your web layouts to improve the font swapping experience
thus avoiding layout shift for your users. To learn more, check out these
resources:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://drafts.csswg.org/css-fonts-5/#size-adjust-desc&quot; rel=&quot;noopener&quot;&gt;CSS Fonts Level 5
Spec&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/size-adjust&quot; rel=&quot;noopener&quot;&gt;Size Adjust on
MDN&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://deploy-preview-15--upbeat-shirley-608546.netlify.app/perfect-ish-font-fallback/?font=Montserrat&quot; rel=&quot;noopener&quot;&gt;Seamless swap @font-face
generator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://web.dev/cls/&quot;&gt;Cumulative Layout Shift (CLS) on web.dev&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.smashingmagazine.com/2021/05/reduce-font-loading-impact-css-descriptors/&quot; rel=&quot;noopener&quot;&gt;A New Way To Reduce Font Loading Impact: CSS Font Descriptors
&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;Photo by &lt;a href=&quot;https://unsplash.com/@kristianstrand&quot; rel=&quot;noopener&quot;&gt;Kristian Strand&lt;/a&gt; on &lt;a href=&quot;https://unsplash.com/photos/p8gzCnZf39k&quot; rel=&quot;noopener&quot;&gt;Unsplash&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
</content>
      <author>
          <name>Adam Argyle</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Building a color scheme</title>
      <link href="https://web.dev/building-a-color-scheme/"/>
      <updated>2021-06-09T00:00:00Z</updated>
      <id>https://web.dev/building-a-color-scheme/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;In this post I want to share thinking on ways to manage multiple color schemes
in CSS. &lt;a href=&quot;https://gui-challenges.web.app/color-schemes/dist/&quot; rel=&quot;noopener&quot;&gt;Try the demo&lt;/a&gt;.&lt;/p&gt;
&lt;figure class=&quot;w-figure w-figure--fullbleed&quot;&gt;
  &lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/b2EpUdydz61rRc11XdkH.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    &lt;a href=&quot;https://gui-challenges.web.app/color-schemes/dist/&quot;&gt;Demo&lt;/a&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;If you prefer video, here&#39;s a YouTube version of this post:&lt;/p&gt;
&lt;div class=&quot;youtube&quot;&gt;  &lt;lite-youtube videoid=&quot;oHcTn83M1ls&quot;&gt;  &lt;/lite-youtube&gt;&lt;/div&gt;
&lt;h2 id=&quot;overview&quot;&gt;Overview &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#overview&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We&#39;ll build an accessible color system with custom properties and &lt;code&gt;calc()&lt;/code&gt;, to
make a webpage that&#39;s adaptive to user preferences while keeping the authoring
experience minimal. We start with a base brand color and build a system of
variants from it: 2 text colors, 4 surface colors and a matching shadow.&lt;/p&gt;
&lt;p&gt;This guide begins with defining all of the colors for each color scheme up
front. Not until the very end are they used to change the page.&lt;/p&gt;
&lt;h3 id=&quot;the-brand&quot;&gt;The Brand &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#the-brand&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Often, a brand color has already been established and is delivered as
&lt;a href=&quot;https://web.dev/learn/css/color/#hex-colors&quot;&gt;hex&lt;/a&gt; or
&lt;a href=&quot;https://web.dev/learn/css/color/#rgb-(red-green-blue)&quot;&gt;rgb&lt;/a&gt;. This GUI Challenge
has a base brand color of &lt;code&gt;#0af&lt;/code&gt;. Firstly, for this color system, the hex value
needs converted to
&lt;a href=&quot;https://web.dev/learn/css/color/#hsl-(hue-saturation-lightness)&quot;&gt;hsl&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;--brand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #0af&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;mark class=&quot;highlight-line highlight-line-active&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;--brand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;200 100% 50%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/mark&gt;&lt;br /&gt;&lt;span class=&quot;highlight-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;In order to enable a concept of darkening or lightening the brand color, by say
20%, the 3 channels of the hsl color value need extracted into their own custom
properties, like this:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-hue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 200&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-saturation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 100%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-lightness&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 50%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;CSS can do math on those color properties, for example &lt;code&gt;calc(var(--brand-lightness) - 20%)&lt;/code&gt; to decrease the lightness value by 20%. This is foundational to building a
color scheme as CSS can keep all colors in the same hue family by adjusting the
hsl saturation and lightness amounts.&lt;/p&gt;
&lt;h2 id=&quot;light-theme&quot;&gt;Light theme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#light-theme&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Each color variant will be marked with its matching scheme, in this case, each
is appended with &lt;code&gt;-light&lt;/code&gt;.&lt;/p&gt;
&lt;img alt=&quot;preview of the light theme end results&quot; decoding=&quot;async&quot; height=&quot;480&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SS3ejtV78NsBGaNEjZhY.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;brand&quot;&gt;Brand &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#brand&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Starting with the brand color, it&#39;s rebuilt by wrapping &lt;code&gt;--brand-hue&lt;/code&gt;, &lt;code&gt;--brand-saturation&lt;/code&gt;
and &lt;code&gt;--brand-lightness&lt;/code&gt; custom properties inside the hsl &lt;code&gt;()&lt;/code&gt; function parenthesis,
without any calculations:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-saturation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-lightness&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;text-colors&quot;&gt;Text colors &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#text-colors&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Next, the essentials of a color scheme need text colors. In a light theme, text
should be very dark. Notice how the lightness of the following colors is low,
well under 50%.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-saturation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 30% 30%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;--text1-light&lt;/code&gt;, since it&#39;s very dark at 10% lightness, keeps the heavy 100%
saturation so the brand color can still peek through into the dark dark navy.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Most users wouldn&#39;t be able to tell you it&#39;s not black, but they
will notice it feels harmonious somehow. &lt;strong&gt;The secret&lt;/strong&gt; is to reserve black and
white exclusively for brightest highlights and darkest shadows.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;--text2-light&lt;/code&gt;, it&#39;s not quite as dark as the 1st color, which is good as it&#39;s
a secondary color, and it&#39;s also much less saturated.&lt;/p&gt;
&lt;h3 id=&quot;surface-colors&quot;&gt;Surface colors &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#surface-colors&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Surface colors are the backgrounds, borders and other decorative surfaces that
text sits upon or within. In a light theme, these are the light colors, as
opposed to the text colors which were dark. To create light colors with hsl,
we&#39;ll use higher percentage values in the third lightness value. We&#39;ll also lower
the saturation, so the light greys don&#39;t look too tinted.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 25% 90%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 20% 99%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 20% 92%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 20% 85%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;4 surface colors were created since decorative colors tend to need more
variants, for interactive moments like &lt;code&gt;:focus&lt;/code&gt; or &lt;code&gt;:hover&lt;/code&gt; or to create the
appearance of paper layers. In these scenarios, it&#39;s nice to transition
&lt;code&gt;--surface2-light&lt;/code&gt; on hover to &lt;code&gt;--surface3-light&lt;/code&gt;, so a hover results in an
increase of contrast (99% lightness to 92% lightness; making it darker).&lt;/p&gt;
&lt;h3 id=&quot;shadows&quot;&gt;Shadows &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#shadows&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Shadows within a color scheme are above and beyond, but add a lifelike nature to
the effect and help it stand out from unrealistic black based shadows. To do
this, the color of the shadow will use the hue custom property, be slightly
saturated with the hue but still very dark. Essentially building a very dark
slightly blue shadow.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 20%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .02&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;--surface-shadow-light&lt;/code&gt; is not wrapped in an hsl function. This is because the
&lt;code&gt;--shadow-strength&lt;/code&gt; value will be combined to create some opacity, and CSS needs
the pieces in order to perform calculations. Skip to the &lt;a href=&quot;https://web.dev/building-a-color-scheme/#rad-shadow&quot;&gt;rad shadow
section&lt;/a&gt; to learn more.&lt;/p&gt;
&lt;h3 id=&quot;light-colors-all-together&quot;&gt;Light colors all together &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#light-colors-all-together&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;No need to hunt around to find how any of the light colors are made, they are
all in one place in the CSS.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-saturation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-lightness&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-saturation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 30% 30%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 25% 90%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 20% 99%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 20% 92%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 20% 85%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-lightness&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 5&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .02&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;screenshot of the light colors all together&quot; decoding=&quot;async&quot; height=&quot;144&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/f0H9hh4Qi0aQ61hZwOlU.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    &lt;a href=&quot;https://codepen.io/argyleink/pen/WNpyypP&quot;&gt;Sandbox on CodePen&lt;/a&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;dark-theme&quot;&gt;Dark theme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#dark-theme&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Most brands don&#39;t begin with a dark theme, it&#39;s a variant of their primary,
usually lighter, theme. Users, on the other hand, often choose a dark theme for
different contexts, like night time. These factors have led me to keeping two
things in mind with dark themes:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Users will generally be in the dark while using this theme, so test in the
dark.&lt;/li&gt;
&lt;li&gt;Colors should desaturate as to not vibrate on the screen due to being
over-intense.&lt;/li&gt;
&lt;/ol&gt;
&lt;img alt=&quot;preview of the end result of the dark theme&quot; decoding=&quot;async&quot; height=&quot;486&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/SMSrhAcRyZFnaf34XA3g.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;brand-2&quot;&gt;Brand &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#brand-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The light theme used the 3 brand hsl color channels values without alteration,
the dark theme does not. The saturation is cut in half and the lightness reduced
a relative 50%.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-saturation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-lightness&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 1.5&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;text-colors-2&quot;&gt;Text colors &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#text-colors-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In a dark theme, the text colors should be light. The following colors have high
values for lightness, putting them closer to white.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 15% 85%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5% 65%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;surface-colors-2&quot;&gt;Surface colors &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#surface-colors-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In a dark theme, the surface colors should be dark. The following colors have
low lightness and saturation, with the 1st surface being the darkest at 10%.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 10%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 15%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5%  20%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5% 25%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;shadows-2&quot;&gt;Shadows &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#shadows-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In a dark theme, shadows can be very hard to see. Makes sense since it&#39;s hard to
darken something that&#39;s already fairly dark. This is where
&lt;code&gt;--shadow-strength-dark&lt;/code&gt; comes in super handy as it allows us to darken the
shadows by changing one variable.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 50% 3%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .8&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Also, look at how much saturation is in that shadow. Can you notice the color
when you&#39;re looking at the interface? Try removing the saturation from the
devtools, which do you prefer?!&lt;/p&gt;
&lt;h3 id=&quot;dark-colors-all-together&quot;&gt;Dark colors all together &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#dark-colors-all-together&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-saturation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-lightness&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 1.5&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 15% 85%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5% 65%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 10%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 15%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5%  20%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5% 25%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 50% 3%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength-dark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .8&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;screenshot of the dark colors all together&quot; decoding=&quot;async&quot; height=&quot;160&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/CHAQlRXJKvclpyaChVyv.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    &lt;a href=&quot;https://codepen.io/argyleink/pen/WNpyypP&quot;&gt;Sandbox on CodePen&lt;/a&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;dim-theme&quot;&gt;Dim theme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#dim-theme&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This color scheme is all about orchestrating lightness and saturation. There
should be enough saturation present to still have a hue visible, but should also
just barely pass &lt;a href=&quot;https://web.dev/color-contrast/&quot;&gt;contrast scores&lt;/a&gt; since it&#39;s
intended to be dim and low contrast anyway.&lt;/p&gt;
&lt;img alt=&quot;preview of the end results from the dim theme&quot; decoding=&quot;async&quot; height=&quot;485&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/QjvjPLubdap7v7s9vAEh.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;brand-3&quot;&gt;Brand &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#brand-3&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-saturation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 1.25&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-lightness&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 1.25&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;text-colors-3&quot;&gt;Text colors &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#text-colors-3&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 15% 75%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 61%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;surface-colors-3&quot;&gt;Surface colors &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#surface-colors-3&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 20%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 25%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5%  30%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5% 35%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;shadows-3&quot;&gt;Shadows &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#shadows-3&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 30% 13%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .2&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;dim-colors-all-together&quot;&gt;Dim colors all together &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#dim-colors-all-together&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-saturation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 1.25&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-lightness&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 1.25&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 15% 75%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 61%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 20%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 25%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5%  30%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 5% 35%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 30% 13%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength-dim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .2&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;screenshot of the dim colors all together&quot; decoding=&quot;async&quot; height=&quot;150&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/MCCNiyM5zQwnVlr86O8k.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    &lt;a href=&quot;https://codepen.io/argyleink/pen/WNpyypP&quot;&gt;Sandbox on CodePen&lt;/a&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;accessible-colors&quot;&gt;Accessible colors &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#accessible-colors&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Notice how the lowest lightness in the dark text color set is 65% and the
highlest lightness in the dark surfaces is 25%. That&#39;s 40% of lightness
breathing room between them. In the light theme, there&#39;s 55% breathing room in
the light theme. Keeping lightness differences between text and surface colors
at around 40-50% can help keep color contrast ratios high, while also being a
subtle lever to adjust in case scores are poor.&lt;/p&gt;
&lt;p&gt;I call it &amp;quot;bump bump til ya pass&amp;quot;, which is the interaction of bumping the
lightness value until a tool shows I&#39;m passing.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/DQ0fOGl9Bg8Uy7ErdBPA.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    shift + down arrow is pressed to lower the lightness and increase contrast until passing
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Each of the themes created in this challenge pass contrast scores. The dim color scheme has the lowest contrast of them, but still passes the minimum requirements. To help others on the team use good contrasting colors, it&#39;s a good idea to create a classname that pairs a surface color with an accessible text color.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.surface1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.surface2&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.surface3&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface3&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.surface4&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface4&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Screenshot of the dim surface and text pairings&quot; decoding=&quot;async&quot; height=&quot;560&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/zrOv3KCNHU8lXELRTkvF.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    Screenshot of the dim surface and text pairings with &lt;a href=&quot;https://a.nerdy.dev/gimme-visbug&quot;&gt;VisBug&lt;/a&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;rad-shadow&quot;&gt;Rad Shadow &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#rad-shadow&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The themes use a utility class called &lt;code&gt;.rad-shadow&lt;/code&gt;. This shadow was generated
at this &lt;a href=&quot;https://shadows.brumm.af/&quot; rel=&quot;noopener&quot;&gt;Smooth Shadow&lt;/a&gt; tool, which I appreciate very
much. I took its generated snippet and customized it with my own colors and,
opacity calculations. The reason for this was to create a shadow I could adjust
within each color scheme.&lt;/p&gt;
&lt;img alt=&quot;each shadow next to each other&quot; decoding=&quot;async&quot; height=&quot;477&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/cAjKit2v0f5dOQnUebCK.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;To accomplish this, I created 2 variables for each color scheme to adjust, a
shadow color and a shadow strength. The color is for saturation and darkness
adjustments, while the strength is for an easy way to drive up the shadow
intensity when it&#39;s a dark color scheme. End result was something like this.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-hue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; 10% 20%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength-light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .02&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;.rad-shadow&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;box-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;br /&gt;    0 2.8px 2.2px &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; + .03&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    0 6.7px 5.3px &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; + .01&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    0 12.5px 10px &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; + .02&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    0 22.3px 17.9px &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; + .02&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    0 41.8px 33.4px &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; + .03&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    0 100px 80px &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;If I were to go further with shadows in my color scheme, I&#39;d make the shadow
angles a design token constant too, as the light direction should be the same
between all the shadows of the design.&lt;/p&gt;
&lt;h2 id=&quot;using-of-the-color-schemes&quot;&gt;Using of the color schemes &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#using-of-the-color-schemes&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;With the predefining of colors complete, it&#39;s time to turn them into
scheme agnostic properties. What I mean is, as a CSS
author inside this color scheme project, one should rarely need to access a
specific color scheme&#39;s value. I want to make it easy to stay within the theme.&lt;/p&gt;
&lt;p&gt;To accomplish this, usage of the color scheme should be exclusively done through
the generic custom properties, which we&#39;ll be defining in a moment. This way,
folks using the design variables never need to worry about which color scheme is
currently set, they just need to use the surface and text colors. Instead of
&lt;code&gt;color: var(--text1-light)&lt;/code&gt; use &lt;code&gt;color: var(--text1)&lt;/code&gt;. All adapting and pivoting
of colors is done much higher level in the CSS.&lt;/p&gt;
&lt;p&gt;Diving in, the light theme&#39;s connective styles in the following code block,
connect a generic custom property with the light theme specific color. Now all
uses of &lt;code&gt;var(--brand)&lt;/code&gt; will use the light brand color.&lt;/p&gt;
&lt;h3 id=&quot;light-theme-(auto)&quot;&gt;Light theme (auto) &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#light-theme-(auto)&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; light&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text1-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text2-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface1-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface2-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface3-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface4-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The site is now using the light theme. This is a very fun successful moment!
Let&#39;s have a few more of those moments as we use our predefined colors in other
color scheme contexts.&lt;/p&gt;
&lt;h3 id=&quot;dark-theme-(auto)&quot;&gt;Dark theme (auto) &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#dark-theme-(auto)&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;prefers-color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; dark&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--brand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--text1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text1-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--text2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text2-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--surface1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface1-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--surface2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface2-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--surface3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface3-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--surface4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface4-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--surface-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--shadow-strength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;light-theme-2&quot;&gt;Light theme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#light-theme-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[color-scheme=&quot;light&quot;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; light&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text1-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text2-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface1-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface2-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface3-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface4-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength-light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;dark-theme-2&quot;&gt;Dark theme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#dark-theme-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[color-scheme=&quot;dark&quot;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; dark&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text1-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text2-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface1-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface2-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface3-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface4-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength-dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;dim-theme-2&quot;&gt;Dim theme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#dim-theme-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;[color-scheme=&quot;dim&quot;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; dark&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--brand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--brand-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text1-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--text2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--text2-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface1-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface2-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface3-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface4-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--surface-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--surface-shadow-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--shadow-strength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--shadow-strength-dim&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;At this point, authors are free to use the provided color scheme generics as
needed, and should never need to worry about themes again.&lt;/p&gt;
&lt;div style=&quot;height: 500px; width: 100%&quot;&gt;
&lt;iframe allow=&quot;camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi;&quot; loading=&quot;lazy&quot; src=&quot;https://codepen.io/argyleink/embed/vYxrrpd?height=500&amp;theme-id=light&amp;default-tab=result&amp;editable=true&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot; title=&quot;Pen vYxrrpd by argyleink on Codepen&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now that you know how I did it, how would you?! 🙂&lt;/p&gt;
&lt;p&gt;Let&#39;s diversify our approaches and learn all the ways to build on the web.
Create a Codepen or host your own demo, tweet me with it, and I&#39;ll add it to the
Community remixes section below.&lt;/p&gt;
&lt;h3 id=&quot;source&quot;&gt;Source &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/building-a-color-scheme/#source&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/argyleink/gui-challenges&quot; rel=&quot;noopener&quot;&gt;GUI Challenges source on GitHub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://codepen.io/argyleink/pen/vYxrrpd&quot; rel=&quot;noopener&quot;&gt;Color scheme Codepen starter&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Community remixes
Nothing to see here yet!&lt;/p&gt;
</content>
      <author>
          <name>Adam Argyle</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Introducing libSquoosh</title>
      <link href="https://web.dev/introducing-libsquoosh/"/>
      <updated>2021-06-08T00:00:00Z</updated>
      <id>https://web.dev/introducing-libsquoosh/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;&lt;strong&gt;We are happy to introduce &lt;a href=&quot;https://github.com/GoogleChromeLabs/squoosh/tree/dev/libsquoosh&quot; rel=&quot;noopener&quot;&gt;libSquoosh&lt;/a&gt;, an experimental Node library on top of which the Squoosh CLI is built, giving you all the capabilities for the Squoosh CLI with a JavaScript-idiomatic interface.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Squoosh.app is a PWA that compresses images for you in the browser. It supports many old and new image formats and processes them client-side in the browser through WebAssembly. This means your pictures stay safely on your own computer rather than being sent to a server somewhere, and that Squoosh works even when offline.&lt;/p&gt;
&lt;p&gt;At Chrome DevSummit 2020 &lt;a href=&quot;https://web.dev/squoosh-v2/&quot;&gt;we announced Squoosh v2&lt;/a&gt;, together with the Squoosh CLI to bring all the codecs of Squoosh to the command-line using Node and WebAssembly. This allows you to compress entire folders with one command and make use of the &lt;a href=&quot;https://github.com/GoogleChromeLabs/squoosh/tree/dev/cli#auto-optimizer&quot; rel=&quot;noopener&quot;&gt;CLI&#39;s&lt;/a&gt; to let it choose the codec parameters for you.&lt;/p&gt;
&lt;p&gt;The CLI enables a lot of automation and so it&#39;s only natural that developers began asking for a more idiomatic interface than programmatically invoking the Squoosh CLI via the shell. &lt;a href=&quot;https://github.com/atjn&quot; rel=&quot;noopener&quot;&gt;Anton (@atjn on GitHub)&lt;/a&gt; stepped up to the task and separated the Squoosh CLI code into two parts: The command line interface code and the underlying core functionality.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; ImagePool &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@squoosh/lib&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// libSquoosh uses a worker-pool under the hood&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// to parallelize all image processing.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imagePool &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ImagePool&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// Accepts both file paths and Buffers/TypedArrays.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; image &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; imagePool&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ingestImage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;./squoosh.jpeg&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// Optional.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// await image.preprocess({&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;//   resize: {&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;//     enabled: true,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;//     width: 128,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;//   },&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// });&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; image&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// All codecs are initialized with default values&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// that can be individually overwritten.&lt;/span&gt;&lt;br /&gt;  mozjpeg&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    quality&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  avif&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    cqLevel&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  jxl&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; extension&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; binary &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; image&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;encodedWith&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mozjpeg&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;output.&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;extension&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; binary&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// ... same for other encoders ...&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; imagePool&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Our goal is to make image compression more accessible to tooling authors. We hope to see integration into Webpack, Rollup and other build tools to make sure your images are appropriately optimized for the web.&lt;/p&gt;
&lt;p&gt;I&#39;d like to express a huge &amp;quot;thank you&amp;quot; to Anton for the time he has committed to Squoosh!&lt;/p&gt;
&lt;p&gt;It&#39;s still early for the Squoosh CLI and libSquoosh and we have many more ideas and plans that we&#39;d like to implement. In the meanwhile, try libSquoosh! However, be mindful that this is an early, experimental release and that there is a good chance you will run into some bugs. If you find some or have questions, please open an &lt;a href=&quot;https://github.com/GoogleChromeLabs/squoosh/issues/new/choose&quot; rel=&quot;noopener&quot;&gt;issue&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If you are interested in contributing to Squoosh—for example contributing to the extremely sparse documentation around libSquoosh or help with any of the other parts of the app—we are starting a mentorship program to help you get started. If you want to know more, check out our &lt;a href=&quot;https://github.com/GoogleChromeLabs/squoosh/issues/1020&quot; rel=&quot;noopener&quot;&gt;tracking issue&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Surma</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Using AVIF to compress images on your site</title>
      <link href="https://web.dev/compress-images-avif/"/>
      <updated>2021-06-07T00:00:00Z</updated>
      <id>https://web.dev/compress-images-avif/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;We
&lt;a href=&quot;https://web.dev/fast/#optimize-your-images&quot;&gt;frequently write&lt;/a&gt;
about the bloat on websites from images,
and tools like
&lt;a href=&quot;https://web.dev/optimize-vitals-lighthouse/&quot;&gt;Lighthouse&lt;/a&gt;
highlight when image loading is having a negative impact on user experience,
such as increasing load time,
or taking bandwidth away from more important resources.
One way to fix this is to use modern compression to reduce the file size of images,
and a new option for web developers is the
&lt;a href=&quot;https://aomediacodec.github.io/av1-avif/&quot; rel=&quot;noopener&quot;&gt;AVIF image format&lt;/a&gt;.
This blog post talks about recent updates to open source tooling for AVIF,
introduces the libaom and libavif encoding libraries,
and includes a tutorial for using these libraries to encode AVIF images efficiently.&lt;/p&gt;
&lt;p&gt;AVIF is an image format based on the AV1 video codec,
and standardized by the
&lt;a href=&quot;https://aomedia.org/&quot; rel=&quot;noopener&quot;&gt;Alliance for Open Media&lt;/a&gt;.
AVIF offers significant compression gains over other image formats like JPEG and WebP.
While the exact savings will depend on the content, encoding settings, and quality target,
&lt;a href=&quot;https://jakearchibald.com/2020/avif-has-landed/&quot; rel=&quot;noopener&quot;&gt;we&lt;/a&gt; and
&lt;a href=&quot;https://netflixtechblog.com/avif-for-next-generation-image-coding-b1d75675fe4&quot; rel=&quot;noopener&quot;&gt;others&lt;/a&gt;
have seen &amp;gt;50% savings vs. JPEG.&lt;/p&gt;
&lt;div class=&quot;w-columns&quot;&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;a href=&quot;https://storage.googleapis.com/web-dev-uploads/image/foR0vJZKULb5AGJExlazy1xYDgI2/kVqh1xli2O6mqKF3fQNx.avif&quot; target=&quot;_blank&quot;&gt;
    &lt;img src=&quot;https://storage.googleapis.com/web-dev-uploads/image/foR0vJZKULb5AGJExlazy1xYDgI2/kVqh1xli2O6mqKF3fQNx.avif&quot; width=&quot;1120&quot; height=&quot;840&quot; alt=&quot;The image using AVIF&quot; /&gt;
  &lt;/a&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
  1120 x 840 AVIF at 18,769 bytes (click to enlarge)
&lt;/figcaption&gt;&lt;/figure&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;a href=&quot;https://storage.googleapis.com/web-dev-uploads/image/foR0vJZKULb5AGJExlazy1xYDgI2/Jy0O0q0mLXl668HAo43n.jpeg&quot; target=&quot;_blank&quot;&gt;
    &lt;img src=&quot;https://storage.googleapis.com/web-dev-uploads/image/foR0vJZKULb5AGJExlazy1xYDgI2/Jy0O0q0mLXl668HAo43n.jpeg&quot; width=&quot;1120&quot; height=&quot;840&quot; alt=&quot;The image using JPEG&quot; /&gt;
  &lt;/a&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
  1120 x 840 JPEG at 20,036 bytes (click to enlarge)
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;p&gt;Additionally, AVIF adds codec and container support for new image features such as
&lt;a href=&quot;https://w3c.github.io/ColorWeb-CG/&quot; rel=&quot;noopener&quot;&gt;High Dynamic Range and Wide Color Gamut&lt;/a&gt;,
&lt;a href=&quot;https://norkin.org/research/film_grain/&quot; rel=&quot;noopener&quot;&gt;film grain synthesis&lt;/a&gt;,
and progressive decoding.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;AVIF supports two types of progressive decoding.
Spatial scalability can be used to offer a lower resolution image for network constrained users
and &#39;progressively&#39; provide a higher resolution image by sending just
the additional data required to fill in the high frequency details.
Quality scalability offers a similar progression by steadily improving visual quality with each render.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;what&#39;s-new&quot;&gt;What&#39;s New &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#what&#39;s-new&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Since landing AVIF support in Chrome M85 last summer,
AVIF support in the open source ecosystem has improved on a number of fronts.&lt;/p&gt;
&lt;h3 id=&quot;libaom&quot;&gt;Libaom &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#libaom&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://aomedia.googlesource.com/aom/&quot; rel=&quot;noopener&quot;&gt;Libaom&lt;/a&gt;
is an open source AV1 encoder and decoder maintained by the companies in the Alliance for Open Media,
and used in many production services at Google and other member companies.
Between the libaom 2.0.0 release—around the same time Chrome added AVIF support—and the recent 3.1.0 release,
there have been significant still image encoding optimizations added to the codebase.
These include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Optimizations for multi-threading and tiled encoding.&lt;/li&gt;
&lt;li&gt;5x reduction in memory usage.&lt;/li&gt;
&lt;li&gt;6.5x reduction in CPU usage, as shown in the chart below.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;&quot; decoding=&quot;async&quot; height=&quot;467&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/ZDZVuXt6QqfXtxkpXcPGfnygYjd2/mJJfiNsC7Qgl98IJ1LNi.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;Using speed=6, cq-level=18, for 8.1 MP images&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;These changes massively reduce the cost of encoding AVIF—
particularly the most frequently loaded,
or highest priority images on your site.
As &lt;a href=&quot;https://www.cnet.com/news/google-supercharges-youtube-with-a-custom-video-chip/&quot; rel=&quot;noopener&quot;&gt;hardware-accelerated encoding&lt;/a&gt;
of AV1 becomes more available on servers and cloud services,
the cost to create AVIF images will continue to drop.&lt;/p&gt;
&lt;h3 id=&quot;libavif&quot;&gt;Libavif &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#libavif&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/AOMediaCodec/libavif&quot; rel=&quot;noopener&quot;&gt;Libavif&lt;/a&gt;,
the reference implementation of AVIF,
is an open source AVIF muxer and parser which is used in Chrome for decoding AVIF images.
It can also be used with libaom for creating AVIF images from your existing uncompressed images,
or transcoding from existing web images (JPEG, PNG, etc).&lt;/p&gt;
&lt;p&gt;Libavif recently added support for a wider range of encoder settings,
including integration with more advanced libaom encoder settings.
Optimizations in the processing pipeline like fast YUV-to-RGB conversion using libyuv
and premultiplied alpha support further speed up the decoding process.
And finally, support for the all-intra encoding mode newly added in libaom 3.1.0
brings all the libaom improvements mentioned in the above.&lt;/p&gt;
&lt;p&gt;Note: &lt;a href=&quot;https://github.com/strukturag/libheif&quot; rel=&quot;noopener&quot;&gt;libheif&lt;/a&gt;
is another popular open source AVIF muxer and parser,
used in
&lt;a href=&quot;https://imagemagick.org/index.php&quot; rel=&quot;noopener&quot;&gt;ImageMagick&lt;/a&gt;,
&lt;a href=&quot;https://github.com/libvips/libvips&quot; rel=&quot;noopener&quot;&gt;libvips&lt;/a&gt;, and the
&lt;a href=&quot;https://sharp.pixelplumbing.com/&quot; rel=&quot;noopener&quot;&gt;sharp&lt;/a&gt; Node.js module.&lt;/p&gt;
&lt;h2 id=&quot;encoding-avif-images-with-avifenc&quot;&gt;Encoding AVIF images with avifenc &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#encoding-avif-images-with-avifenc&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A quick way to experiment with AVIF is
&lt;a href=&quot;https://squoosh.app/&quot; rel=&quot;noopener&quot;&gt;Squoosh.app&lt;/a&gt;.
Squoosh runs a WebAssembly version of libavif,
and exposes many of the same features as the command line tools.
It&#39;s an easy way to compare AVIF to other formats old and new.
There&#39;s also a
&lt;a href=&quot;https://www.npmjs.com/package/@squoosh/cli&quot; rel=&quot;noopener&quot;&gt;CLI version&lt;/a&gt;
of Squoosh aimed at Node apps.&lt;/p&gt;
&lt;p&gt;However, WebAssembly doesn&#39;t yet have access to all the performance primitives of CPUs,
so if you want to run libavif at its fastest,
we recommend the command line encoder, avifenc.&lt;/p&gt;
&lt;p&gt;To understand how to encode AVIF images,
we will present a tutorial using the
&lt;a href=&quot;https://codelabs.developers.google.com/codelabs/avif/images/happy_dog.jpg&quot; rel=&quot;noopener&quot;&gt;same source image&lt;/a&gt;
used in our example above.  To start, you will need:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.google.com/chrome/&quot; rel=&quot;noopener&quot;&gt;Chrome&lt;/a&gt; version 85 or later&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cmake.org/&quot; rel=&quot;noopener&quot;&gt;cmake&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://git-scm.com/&quot; rel=&quot;noopener&quot;&gt;git&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://ninja-build.org/&quot; rel=&quot;noopener&quot;&gt;ninja&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You will also need to install the development packages for zlib, libpng, and libjpeg.
The commands for the Debian and Ubuntu Linux distributions are:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; zlib1g-dev&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; libpng-dev&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; libjpeg-dev&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;building-command-line-encoder-avifenc&quot;&gt;Building command line encoder avifenc &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#building-command-line-encoder-avifenc&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id=&quot;1.-get-the-code&quot;&gt;1. Get the code &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#1.-get-the-code&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Check out a release tag of libavif.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone -b v0.9.1 https://github.com/AOMediaCodec/libavif.git&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h4 id=&quot;2.-change-directory-to-libavif&quot;&gt;2. Change directory to libavif &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#2.-change-directory-to-libavif&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; libavif&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;There are many different ways you can configure avifenc and libavif to build.
You can find more information at &lt;a href=&quot;https://github.com/AOMediaCodec/libavif&quot; rel=&quot;noopener&quot;&gt;libavif&lt;/a&gt;.
We are going to build avifenc so that it is statically linked to the
AV1 encoder and decoder library, &lt;a href=&quot;https://aomedia.googlesource.com/aom&quot; rel=&quot;noopener&quot;&gt;libaom&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;3.-get-and-build-libaom&quot;&gt;3. Get and build libaom &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#3.-get-and-build-libaom&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Change to the libavif external dependencies directory.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; ext&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The next command will pull the libaom source code
and build libaom statically.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;./aom.cmd&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Change directory to libavif.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h4 id=&quot;4.-build-the-command-line-encoding-tool-avifenc&quot;&gt;4. Build the command line encoding tool, avifenc &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#4.-build-the-command-line-encoding-tool-avifenc&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;It is a good idea to create a build directory for avifenc.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; build&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Change to the build directory.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; build&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Create the build files for avifenc.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;cmake -DCMAKE_BUILD_TYPE&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Release -DBUILD_SHARED_LIBS&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; -DAVIF_CODEC_AOM&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; -DAVIF_LOCAL_AOM&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; -DAVIF_BUILD_APPS&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Build avifenc.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;You have successfully built avifenc!&lt;/p&gt;
&lt;h3 id=&quot;understanding-the-avifenc-command-line-parameters&quot;&gt;Understanding the avifenc command line parameters &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#understanding-the-avifenc-command-line-parameters&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;avifenc uses the command-line structure:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;./avifenc &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; input.file output.avif&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The basic parameters for avifenc used in this tutorial are:&lt;/p&gt;
&lt;table class=&quot;w-table&quot;&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;avifenc&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;--min 0&lt;/td&gt;&lt;td&gt;Set min quantizer for color to 0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;--max 63&lt;/td&gt;&lt;td&gt;Set max quantizer for color to 63&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;--minalpha 0&lt;/td&gt;&lt;td&gt;Set min quantizer for alpha to 0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;--maxalpha 63&lt;/td&gt;&lt;td&gt;Set max quantizer for alpha to 63&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-a end-usage=q&lt;/td&gt;&lt;td&gt;Set the rate control mode to Constant Quality (Q) mode&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-a cq-level=Q&lt;/td&gt;&lt;td&gt;Set quantize level for both color and alpha to Q&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-a color:cq-level=Q&lt;/td&gt;&lt;td&gt;Set quantize level for color to Q&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-a alpha:cq-level=Q&lt;/td&gt;&lt;td&gt;Set quantize level for alpha to Q&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-a tune=ssim&lt;/td&gt;&lt;td&gt;Tune for SSIM (default is to tune for PSNR)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;--jobs J&lt;/td&gt;&lt;td&gt;Use J worker threads (default: 1)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;--speed S&lt;/td&gt;&lt;td&gt;Set encoder speed from 0-10 (slowest-fastest. default: 6)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The cq-level option sets the quantize level (0-63) to control the quality for color or alpha.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;You can think of cq-level as the &amp;quot;amount&amp;quot; of quantization, so a lower value yields higher quality&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Higher speed settings will run faster,
but produce worse compression efficiency and quality.
This tutorial uses the default setting of Speed 6,
which we recommend as a balance of encode speed, compression efficiency, and quality.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;create-an-avif-image-with-default-settings&quot;&gt;Create an AVIF image with default settings &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#create-an-avif-image-with-default-settings&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The most basic parameters for avifenc to run, are setting the input and output files.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;./avifenc happy_dog.jpg happy_dog.avif&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;We recommend the following command line to encode an image, say at quantize level 18:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;./avifenc --min &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; --max &lt;span class=&quot;token number&quot;&gt;63&lt;/span&gt; -a end-usage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;q -a cq-level&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt; -a &lt;span class=&quot;token assign-left variable&quot;&gt;tune&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ssim happy_dog.jpg happy_dog.avif&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;&lt;code&gt;&amp;quot;--min 0 --max 63 -a end-usage=q -a cq-level=18 -a tune=ssim&amp;quot;&lt;/code&gt;
are the recommended settings for AVIF images.
If the image has an alpha channel,
add &lt;code&gt;&amp;quot;--minalpha 0 --maxalpha 63&amp;quot;&lt;/code&gt;.
To specify different quantize levels for color and alpha,
replace &lt;code&gt;&amp;quot;-a cq-level=18&amp;quot;&lt;/code&gt; with, say,
&lt;code&gt;&amp;quot;-a color:cq-level=18 -a alpha:cq-level=10&amp;quot;&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Avifenc has a lot of options that will affect both quality and speed.
If you want to see the options and learn more about them just run &lt;code&gt;./avifenc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You now have your very own AVIF image!&lt;/p&gt;
&lt;h3 id=&quot;speeding-up-the-encoder&quot;&gt;Speeding up the encoder &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#speeding-up-the-encoder&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;One parameter that may be good to change
depending on how many cores you have on your machine is the &lt;code&gt;--jobs&lt;/code&gt; parameter.
This parameter sets how many threads avifenc will use to create AVIF images.
Try running this at the command line.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;./avifenc --min &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; --max &lt;span class=&quot;token number&quot;&gt;63&lt;/span&gt; -a end-usage&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;q -a cq-level&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt; -a &lt;span class=&quot;token assign-left variable&quot;&gt;tune&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ssim --jobs &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt; happy_dog.jpg happy_dog.avif&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This tells avifenc to use 8 threads when creating the AVIF image,
which speeds up AVIF encoding by roughly 5x.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compress-images-avif/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using libaom, libavif and other open source tooling,
you can get the best image quality and performance for your website using AVIF.
The format is still relatively new,
and optimizations and tooling integrations are actively being developed.
If you have questions, comments, or feature requests,
reach out on the
&lt;a href=&quot;https://groups.google.com/a/aomedia.org/g/av1-discuss&quot; rel=&quot;noopener&quot;&gt;av1-discuss mailing list&lt;/a&gt;,
&lt;a href=&quot;https://github.com/AOMediaCodec/community/wiki&quot; rel=&quot;noopener&quot;&gt;AOM Github community&lt;/a&gt;, and
&lt;a href=&quot;https://github.com/AOMediaCodec/av1-avif/wiki&quot; rel=&quot;noopener&quot;&gt;AVIF wiki&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Jai Krishnan</name>
        </author><author>
          <name>Wan-Teh Chang</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>PWAs as URL Handlers</title>
      <link href="https://web.dev/pwa-url-handler/"/>
      <updated>2021-06-03T00:00:00Z</updated>
      <id>https://web.dev/pwa-url-handler/</id>
      <content type="text/html" mode="escaped">&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;PWAs as URL Handlers is part of the &lt;a href=&quot;https://web.dev/fugu-status/&quot;&gt;capabilities project&lt;/a&gt;
and is currently in development. This post will be updated as the implementation progresses.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;what&quot;&gt;What is PWAs as URL Handlers? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#what&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Imagine you are chatting with a friend using an instant messenger application like Messages on macOS
and you are talking about music. Further imagine you both have the &lt;code&gt;music.example.com&lt;/code&gt; PWA installed
on your devices. If you want to share your favorite track for your friend to enjoy, you can send
them a deep link like &lt;code&gt;https://music.example.com/rick-astley/never-gonna-give-you-up&lt;/code&gt;. Since this
link is pretty long, the developers of &lt;code&gt;music.example.com&lt;/code&gt; may have decided to add an additional
short link to each track, like, for example, &lt;code&gt;https://🎵.example.com/r-a/n-g-g-y-u&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;PWA as URL Handlers allows apps like &lt;code&gt;music.example.com&lt;/code&gt; to register themselves as URL handlers for
URLs that match patterns like &lt;code&gt;https://music.example.com&lt;/code&gt;, &lt;code&gt;https://*.music.example.com&lt;/code&gt;, or
&lt;code&gt;https://🎵.example.com&lt;/code&gt;, so
that links from outside of the PWA, for example, from an instant messenger application or an email
client, open in the installed PWA rather than in a browser tab.&lt;/p&gt;
&lt;p&gt;PWA as URL Handlers consists of two additions:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The &lt;code&gt;&amp;quot;url_handlers&amp;quot;&lt;/code&gt; web app manifest member.&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;web-app-origin-association&lt;/code&gt; file format for validating in- and out-of-scope URL associations.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;use-cases&quot;&gt;Suggested use cases for PWAs as URL Handlers &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#use-cases&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Examples of sites that may use this API include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Music or video streaming sites so track links or playlist links open in the player experience of
the app.&lt;/li&gt;
&lt;li&gt;News or RSS readers so followed or subscribed-to sites open in the app&#39;s reader mode.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;status&quot;&gt;Current status &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#status&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Step&lt;/th&gt;
&lt;th&gt;Status&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1. Create explainer&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/WICG/pwa-url-handler/blob/main/explainer.md&quot; rel=&quot;noopener&quot;&gt;Complete&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2. Create initial draft of specification&lt;/td&gt;
&lt;td&gt;Not started&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3. Gather feedback &amp;amp; iterate on design&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://web.dev/pwa-url-handler/#feedback&quot;&gt;In progress&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4. Origin trial&lt;/td&gt;
&lt;td&gt;Not started&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5. Launch&lt;/td&gt;
&lt;td&gt;Not started&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;use&quot;&gt;How to use PWAs as URL Handlers &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#use&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;enabling-via-about:flags&quot;&gt;Enabling via about://flags &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#enabling-via-about:flags&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To experiment with PWAs as URL Handlers locally, without an origin trial token, enable the
&lt;code&gt;#enable-desktop-pwas-url-handling&lt;/code&gt; flag in &lt;code&gt;about://flags&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Support for the PWAs as URL Handlers feature is limited to desktop operating systems
like Windows, macOS, and Linux. On Android, Chromium browsers install PWAs by generating a
&lt;a href=&quot;https://developers.google.com/web/fundamentals/integration/webapks&quot; rel=&quot;noopener&quot;&gt;WebAPK&lt;/a&gt;, which can register a
set of intent filters for all URLs within the scope of the app. This means that PWAs already handle
associated URLs on Android at the operating system level using intent filters. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3 id=&quot;the-&amp;quot;url_handlers&amp;quot;-web-app-manifest-member&quot;&gt;The &lt;code&gt;&amp;quot;url_handlers&amp;quot;&lt;/code&gt; web app manifest member &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#the-%22url_handlers%22-web-app-manifest-member&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To associate an installed PWA with URL patterns, these patterns need to be specified in the web app
manifest. This happens through the &lt;code&gt;&amp;quot;url_handlers&amp;quot;&lt;/code&gt; member. It accepts an array of objects with an
&lt;code&gt;origin&lt;/code&gt; property, which is a required &lt;code&gt;string&lt;/code&gt; that is a pattern for matching origins. These
patterns are allowed to have a wildcard (&lt;code&gt;*&lt;/code&gt;) prefix in order to include multiple sub-domains (like
&lt;code&gt;https://*.example.com&lt;/code&gt;). URLs that match these origins could be handled by this web app. The scheme is
always assumed to be &lt;code&gt;https://&lt;/code&gt;, but it needs to be explicitly mentioned.&lt;/p&gt;
&lt;p&gt;The excerpt of a web app manifest below shows how the music PWA example from the introductory
paragraph could set this up. The second entry with the wildcard (&lt;code&gt;&amp;quot;https://*.music.example.com&amp;quot;&lt;/code&gt;) makes sure
that the app also gets activated for &lt;code&gt;https://www.music.example.com&lt;/code&gt; or potential other examples like
&lt;code&gt;https://marketing-activity.music.example.com&lt;/code&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;&quot;url_handlers&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;&quot;origin&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://music.example.com&quot;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;&quot;origin&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://*.music.example.com&quot;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;&quot;origin&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://🎵.example.com&quot;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;While in an online scenario, short links from &lt;code&gt;https://🎵.example.com&lt;/code&gt; would typically be
redirected to &lt;code&gt;https://music.example.com&lt;/code&gt;. Such navigation redirection is not a good alternative with
respect to offline scenarios. Therefore the app needs to register for both origins. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3 id=&quot;the-web-app-origin-association-file&quot;&gt;The &lt;code&gt;web-app-origin-association&lt;/code&gt; file &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#the-web-app-origin-association-file&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Since the PWA lives on a different origin (&lt;code&gt;music.example.com&lt;/code&gt;) than some of the URLs it needs to
handle (e.g., &lt;code&gt;https://🎵.example.com&lt;/code&gt;), the app needs to verify ownership of these other origins. This
happens in a &lt;code&gt;web-app-origin-association&lt;/code&gt; file hosted on the other origins.&lt;/p&gt;
&lt;p&gt;This file must contain valid JSON. The top-level structure is an object, with a member named
&lt;code&gt;&amp;quot;web_apps&amp;quot;&lt;/code&gt;. This member is an array of objects and each object represents an entry for a unique
web app. Each object contains:&lt;/p&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Field&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Default&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;&amp;quot;manifest&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;(Required) URL string of the web app manifest of the associated PWA&lt;/td&gt;
&lt;td&gt;&lt;code&gt;string&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;&amp;quot;details&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;(Optional) An object that contains arrays of included and excluded URL patterns&lt;/td&gt;
&lt;td&gt;&lt;code&gt;object&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;p&gt;Each &lt;code&gt;&amp;quot;details&amp;quot;&lt;/code&gt; object contains:&lt;/p&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Field&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Default&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;&amp;quot;paths&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;(Optional) Array of allowed path strings&lt;/td&gt;
&lt;td&gt;&lt;code&gt;string[]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;[]&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;&amp;quot;exclude_paths&amp;quot;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;(Optional) Array of disallowed path strings&lt;/td&gt;
&lt;td&gt;&lt;code&gt;string[]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;[]&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;p&gt;An example &lt;code&gt;web-app-origin-association&lt;/code&gt; file for the music PWA example from above is given below. It
would be hosted on the origin &lt;code&gt;🎵.example.com&lt;/code&gt; and establishes the association with the
&lt;code&gt;music.example.com&lt;/code&gt; PWA, identified by its web app manifest URL.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;&quot;web_apps&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;&quot;manifest&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://music.example.com/manifest.json&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;&quot;details&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token property&quot;&gt;&quot;paths&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token property&quot;&gt;&quot;exclude_paths&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/internal/*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The &lt;code&gt;web-app-origin-association&lt;/code&gt; file is similar to
&lt;a href=&quot;https://developer.apple.com/documentation/safariservices/supporting_associated_domains_in_your_app#3001215&quot; rel=&quot;noopener&quot;&gt;Apple&#39;s associated domain file&lt;/a&gt;,
&lt;a href=&quot;https://developer.android.com/training/app-links/verify-site-associations&quot; rel=&quot;noopener&quot;&gt;Android&#39;s &lt;code&gt;assetlinks.json&lt;/code&gt; file&lt;/a&gt;,
and
&lt;a href=&quot;https://docs.microsoft.com/en-us/windows/uwp/launch-resume/web-to-app-linking#associate-your-app-and-website-with-a-json-file&quot; rel=&quot;noopener&quot;&gt;Windows&#39; &lt;code&gt;windows-app-web-link&lt;/code&gt; file&lt;/a&gt;.
What differs is that the &lt;code&gt;web-app-origin-association&lt;/code&gt; file does not reference PWAs using a
platform-specific app ID, but by their web app manifest URL. &lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;h4 id=&quot;when-does-a-url-match&quot;&gt;When does a URL match? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#when-does-a-url-match&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;A PWA matches a URL for handling if both of the following conditions are fulfilled:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The URL matches one of the origin strings in &lt;code&gt;&amp;quot;url_handlers&amp;quot;&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;The browser is able to validate via the respective &lt;code&gt;web-app-origin-association&lt;/code&gt; file that each
origin agrees to let this app handle such a URL.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;regarding-web-app-origin-association-file-discovery&quot;&gt;Regarding &lt;code&gt;web-app-origin-association&lt;/code&gt; file discovery &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#regarding-web-app-origin-association-file-discovery&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;For the browser to discover the &lt;code&gt;web-app-origin-association&lt;/code&gt; file, developers need to
place the &lt;code&gt;web-app-origin-association&lt;/code&gt; file in the
&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc8615&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;/.well-known/&lt;/code&gt;&lt;/a&gt; folder at the root of the app.
For this to work, the file name must exactly be &lt;code&gt;web-app-origin-association&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;demo&quot;&gt;Demo &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#demo&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To test PWAs as URL Handlers, be sure to &lt;a href=&quot;https://web.dev/pwa-url-handler/#enabling-via-about:flags&quot;&gt;set the browser flag&lt;/a&gt; as
outlined above and then install the PWA at
&lt;a href=&quot;https://mandymsft.github.io/pwa/&quot; rel=&quot;noopener&quot;&gt;https://mandymsft.github.io/pwa/&lt;/a&gt;. By looking at its
&lt;a href=&quot;https://github.com/mandymsft/pwa/blob/main/manifest.json&quot; rel=&quot;noopener&quot;&gt;web app manifest&lt;/a&gt;, you can see that it
handles URLs with the following URL patterns: &lt;code&gt;https://mandymsft.github.io&lt;/code&gt; and
&lt;code&gt;https://luhuangmsft.github.io&lt;/code&gt;. Since the latter is on a different origin (&lt;code&gt;luhuangmsft.github.io&lt;/code&gt;)
than the PWA, the PWA on &lt;code&gt;mandymsft.github.io&lt;/code&gt; needs to prove ownership, which happens via the
&lt;code&gt;web-app-origin-association&lt;/code&gt; file hosted at
&lt;a href=&quot;https://luhuangmsft.github.io/.well-known/web-app-origin-association&quot; rel=&quot;noopener&quot;&gt;https://luhuangmsft.github.io/.well-known/web-app-origin-association&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To test that it is indeed working, send yourself a test message using an instant messaging app of
your choice or an email viewed in an email client that is not web-based like Mail on macOS. The
email or text message should contain either of the links &lt;code&gt;https://mandymsft.github.io&lt;/code&gt; or
&lt;code&gt;https://luhuangmsft.github.io&lt;/code&gt;. Both should open in the installed PWA.&lt;/p&gt;
&lt;img alt=&quot;The Windows Skype instant messenger app next to the installed demo PWA, which is opened in standalone mode after clicking a link handled by it in a Skype chat message.&quot; decoding=&quot;async&quot; height=&quot;498&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/EjFQNwv2IfINKykzsxxs.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;security-and-permissions&quot;&gt;Security and permissions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#security-and-permissions&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Chromium team has designed and implemented PWAs as URL Handlers using the core principles
defined in &lt;a href=&quot;https://chromium.googlesource.com/chromium/src/+/lkgr/docs/security/permissions-for-powerful-web-platform-features.md&quot; rel=&quot;noopener&quot;&gt;Controlling Access to Powerful Web Platform Features&lt;/a&gt;, including user
control, transparency, and ergonomics.&lt;/p&gt;
&lt;h3 id=&quot;user-control&quot;&gt;User control &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#user-control&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If more than one PWA registers as a URL handler for a given URL pattern, the user will be prompted
to choose which PWA they want to handle the pattern with—if any at all. Navigations that start in a
browser tab are not handled by this proposal, it is explicitly aimed at navigations that start
outside of the browser.&lt;/p&gt;
&lt;h3 id=&quot;transparency&quot;&gt;Transparency &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#transparency&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If the necessary association validation cannot be completed successfully during PWA installation for
any reason, the browser will not register the app as an active URL handler for the affected URLs.
URL handlers, if improperly implemented, can be used to hijack traffic for websites. This is why the
app association mechanism is an important part of the scheme.&lt;/p&gt;
&lt;p&gt;Platform-specific applications can already use operating system APIs to enumerate installed
applications on the user&#39;s system. For example, applications on Windows can use the
&lt;a href=&quot;https://docs.microsoft.com/en-us/uwp/api/windows.system.launcher.findappurihandlersasync&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;FindAppUriHandlersAsync&lt;/code&gt;&lt;/a&gt;
API to enumerate URL handlers. If PWAs register as OS level URL handlers in Windows, their presence
would be visible to other applications.&lt;/p&gt;
&lt;h3 id=&quot;permission-persistence&quot;&gt;Permission persistence &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#permission-persistence&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;An origin could modify its associations with PWAs at any time. Browsers will regularly attempt to
revalidate the associations of installed web apps. If a URL handler registration fails to revalidate
because the association data has changed or is no longer available, the browser will remove
registrations.&lt;/p&gt;
&lt;h2 id=&quot;feedback&quot;&gt;Feedback &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#feedback&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Chromium team wants to hear about your experiences with the PWAs as URL Handlers.&lt;/p&gt;
&lt;h3 id=&quot;tell-us-about-the-api-design&quot;&gt;Tell us about the API design &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#tell-us-about-the-api-design&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Is there something about the API that doesn&#39;t work like you expected? Or are there missing methods
or properties that you need to implement your idea? Have a question or comment on the security
model? File a spec issue on the corresponding &lt;a href=&quot;https://github.com/WICG/pwa-url-handler/issues&quot; rel=&quot;noopener&quot;&gt;GitHub repo&lt;/a&gt;, or add your thoughts to an
existing issue.&lt;/p&gt;
&lt;h3 id=&quot;report-a-problem-with-the-implementation&quot;&gt;Report a problem with the implementation &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#report-a-problem-with-the-implementation&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Did you find a bug with Chromium&#39;s implementation? Or is the implementation different from the spec?
File a bug at &lt;a href=&quot;https://new.crbug.com/&quot; rel=&quot;noopener&quot;&gt;new.crbug.com&lt;/a&gt;. Be sure to include as much detail as you can,
simple instructions for reproducing, and enter &lt;code&gt;UI&amp;gt;Browser&amp;gt;WebAppInstalls&lt;/code&gt; in the &lt;strong&gt;Components&lt;/strong&gt;
box. &lt;a href=&quot;https://glitch.com/&quot; rel=&quot;noopener&quot;&gt;Glitch&lt;/a&gt; works great for sharing quick and easy repros.&lt;/p&gt;
&lt;h3 id=&quot;show-support-for-the-api&quot;&gt;Show support for the API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#show-support-for-the-api&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Are you planning to use PWAs as URL Handlers? Your public support helps the Chromium team prioritize
features and shows other browser vendors how critical it is to support them.&lt;/p&gt;
&lt;p&gt;Send a tweet to &lt;a href=&quot;https://twitter.com/ChromiumDev&quot; rel=&quot;noopener&quot;&gt;@ChromiumDev&lt;/a&gt; using the hashtag
&lt;a href=&quot;https://twitter.com/search?q=%23URLHandlers&amp;amp;src=recent_search_click&amp;amp;f=live&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;#URLHandlers&lt;/code&gt;&lt;/a&gt; and let
us know where and how you&#39;re using it.&lt;/p&gt;
&lt;h2 id=&quot;helpful&quot;&gt;Helpful links &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#helpful&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/WICG/pwa-url-handler/blob/main/explainer.md&quot; rel=&quot;noopener&quot;&gt;Public explainer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://mandymsft.github.io/pwa/&quot; rel=&quot;noopener&quot;&gt;Demo&lt;/a&gt; | &lt;a href=&quot;https://github.com/mandymsft/pwa/&quot; rel=&quot;noopener&quot;&gt;Demo source&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1072058&quot; rel=&quot;noopener&quot;&gt;Chromium tracking bug&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://chromestatus.com/feature/5739732661174272&quot; rel=&quot;noopener&quot;&gt;ChromeStatus.com entry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Blink Component: &lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/list?q=component:UI%3EBrowser%3EWebAppInstalls&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;UI&amp;gt;Browser&amp;gt;WebAppInstalls&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/w3ctag/design-reviews/issues/552&quot; rel=&quot;noopener&quot;&gt;TAG Review&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps-chromium/experimental-features/#url-link-handling&quot; rel=&quot;noopener&quot;&gt;Microsoft documentation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/pwa-url-handler/#acknowledgements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;PWAs as URL Handlers was specified and implemented by &lt;a href=&quot;https://github.com/LuHuangMSFT&quot; rel=&quot;noopener&quot;&gt;Lu Huang&lt;/a&gt; and &lt;a href=&quot;https://github.com/mandymsft&quot; rel=&quot;noopener&quot;&gt;Mandy Chen&lt;/a&gt; from the Microsoft Edge team.
This article was reviewed by
&lt;a href=&quot;https://github.com/jpmedley&quot; rel=&quot;noopener&quot;&gt;Joe Medley&lt;/a&gt;.
Hero image by &lt;a href=&quot;https://unsplash.com/@trhammerhead&quot; rel=&quot;noopener&quot;&gt;Bryson Hammer&lt;/a&gt; on
&lt;a href=&quot;https://unsplash.com/photos/JZ8AHFr2aEg&quot; rel=&quot;noopener&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Thomas Steiner</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Observing compute pressure</title>
      <link href="https://web.dev/compute-pressure/"/>
      <updated>2021-06-03T00:00:00Z</updated>
      <id>https://web.dev/compute-pressure/</id>
      <content type="text/html" mode="escaped">&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The Compute Pressure API is part of the
&lt;a href=&quot;https://web.dev/fugu-status/&quot;&gt;capabilities project&lt;/a&gt; and is currently in
development. This post will be updated as the implementation progresses.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;background&quot;&gt;Background &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#background&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The sound of fans revving up inside of a laptop&#39;s body, or a phone that&#39;s warm
to the touch are unpleasant, if all too familiar, sensations. They&#39;re signs that
the hardware inside of a device is being pushed to its limit, and the only
options are dissipating the associated heat, or deliberately slowing down the
speed of the processors so that they&#39;ll run cooler. Most installed applications
are able to detect when a device is under this type of CPU stress, and can
selectively disable features or reduce their workloads in response.
Increasingly, there are web applications that would benefit from the same
information.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/oyiptong/compute-pressure/&quot; rel=&quot;noopener&quot;&gt;Compute Pressure&lt;/a&gt; is a new,
experimental API allows web applications to gain insight into the CPU
utilization of the browser&#39;s device. The API provides a callback
that receives periodic updates, allowing developers to observe changes in CPU
utilization over time. A web app that uses this API can enable or
disable heavyweight features in response to these
observations. It&#39;s a feedback mechanism that unlocks new doors for adaptive
behavior, which can in turn lead to smoother, cooler experiences across a range
of hardware devices.&lt;/p&gt;
&lt;h2 id=&quot;use-cases&quot;&gt;Use cases &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#use-cases&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The motivating use cases are helping video conferencing and video game web
applications adapt to CPU utilization. The initial experimental implementation
of the API aims to support the decisions listed here.&lt;/p&gt;
&lt;h3 id=&quot;video-conferencing&quot;&gt;Video conferencing &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#video-conferencing&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Dynamically adjusting the number of live video feeds displayed on the screen at
once.&lt;/li&gt;
&lt;li&gt;Adjusting the video resolution or frame rate.&lt;/li&gt;
&lt;li&gt;Skipping non-essential video processing, such as cosmetic filters.&lt;/li&gt;
&lt;li&gt;Disabling non-essential audio processing, such as noise suppression.&lt;/li&gt;
&lt;li&gt;Skewing the quality-vs-speed and size-vs-speed knobs towards &amp;quot;speed&amp;quot; in video and
audio encoding.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;video-games&quot;&gt;Video games &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#video-games&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Using lower-quality video and audio assets as needed.&lt;/li&gt;
&lt;li&gt;Disabling optional effects like reflections, glare, or particle animations that
don&#39;t affect gameplay.&lt;/li&gt;
&lt;li&gt;Tweaking quality-vs-speed knobs in the game&#39;s rendering engine, affecting areas
like shadow quality, texture filtering, and view distance.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The secondary use case is measuring the CPU resource consumption of a feature.
This ultimately supports the main goal of avoiding driving user devices into
high CPU utilization. The API helps developers make the types of decisions
listed here.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Comparing the CPU consumption of alternative implementations of the same
feature to find out which is more efficient. The API supports measuring CPU
utilization in the field via
&lt;a href=&quot;https://en.wikipedia.org/wiki/A/B_testing&quot; rel=&quot;noopener&quot;&gt;A/B tests&lt;/a&gt; because a feature&#39;s
CPU utilization depends on the hardware it&#39;s running on. Most developers
cannot afford performance measurement labs covering all the devices owned by
their users.&lt;/li&gt;
&lt;li&gt;Estimating the impact on CPU consumption of enabling a feature. This cost
estimate feeds into the decisions outlined in the primary use case.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;cpu-utilization&quot;&gt;CPU utilization &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#cpu-utilization&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The CPU utilization of a device is the average of the utilization of all the
device&#39;s &lt;a href=&quot;https://en.wikipedia.org/wiki/Multi-core_processor&quot; rel=&quot;noopener&quot;&gt;CPU cores&lt;/a&gt;,
represented in the API as a number between &lt;code&gt;0.0&lt;/code&gt; and &lt;code&gt;1.0&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;A CPU core&#39;s utilization is the fraction of time that the core has been
executing code belonging to a thread, as opposed to being in an idle state.&lt;/p&gt;
&lt;p&gt;A CPU utilization close to &lt;code&gt;0.0&lt;/code&gt; indicates that the processor has been almost
entirely idle. A CPU utilization close to &lt;code&gt;1.0&lt;/code&gt; is very likely to
generate excessive heat. Web applications can help avoiding bad
user experiences by reducing their compute demands when the CPU utilization is
high.&lt;/p&gt;
&lt;h2 id=&quot;cpu-clock-speed&quot;&gt;CPU clock speed &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#cpu-clock-speed&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Modern CPU cores support a set of clock speeds. The device&#39;s firmware or
operating system can set the core clock speed in order to trade off the
available CPU computational resources with power consumption.&lt;/p&gt;
&lt;p&gt;From a user experience standpoint, the following are the most interesting clock
speeds:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The minimum clock speed, which results in the lowest power consumption.&lt;/li&gt;
&lt;li&gt;The base clock speed, which results in a moderate level of power consumption
and heat generation. This tends to be the speed advertised in marketing
materials.&lt;/li&gt;
&lt;li&gt;The maximum clock speed, sometimes marketed as &amp;quot;turbo boost.&amp;quot; Running at this
speed causes unsustainable amounts of heating. It can only be used for short
periods of time, to satisfy bursts in demand for computing power.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When a device&#39;s CPU utilization gets high, the device may increase clock speeds
across its CPU cores, in an attempt to meet the demand for computing power. As
the speeds exceed the base clock speed, the elevated power consumption increases
the CPU&#39;s temperature. At some point, the device enters a
&lt;a href=&quot;https://en.wikipedia.org/wiki/Dynamic_frequency_scaling&quot; rel=&quot;noopener&quot;&gt;thermal throttling regime&lt;/a&gt;,
where the CPU clock speed is reduced in order to bring the temperature down.&lt;/p&gt;
&lt;p&gt;As with CPU utilization, values from &lt;code&gt;0.0&lt;/code&gt; (minimal) to &lt;code&gt;1.0&lt;/code&gt; (boosted) are used
to normalize clock speeds. A value of &lt;code&gt;0.5&lt;/code&gt; represents the base clock speed for
a given CPU.&lt;/p&gt;
&lt;h2 id=&quot;using-the-api&quot;&gt;Using the API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#using-the-api&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The following code creates a &lt;code&gt;ComputePressureObserver&lt;/code&gt;, configured with specific
triggering thresholds, along with an associated callback function that may be
invoked when a threshold is crossed. The callback is intentionally rate-limited,
with the current implementation maxing out at one invocation per second for a
page in the foreground, and once per ten seconds for background pages.&lt;/p&gt;
&lt;p&gt;Inside the callback function, your web application can respond to the changing
utilization and clock speed levels by enabling or disabling CPU-intensive
functionality.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cpuSpeed &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;// The CPU is running at faster than base speed.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;// The CPU is running at normal or reduced speed.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cpuUtilization &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;// CPU utilization is over 90%.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cpuUtilization &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.75&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;// CPU utilization is over 75%.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;update&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cpuUtilization &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;// CPU utilization is over 50%.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;// CPU utilization is under 50%.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; observer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ComputePressureObserver&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;callback&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Thresholds divide the interval [0.0 .. 1.0] into ranges.&lt;/span&gt;&lt;br /&gt;  cpuUtilizationThresholds&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.75&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// The minimum clock speed is 0.0, and the maximum speed is 1.0.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// 0.5 represents the base clock speed.&lt;/span&gt;&lt;br /&gt;  cpuSpeedThresholds&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// Begin observing changes and triggering callbacks:&lt;/span&gt;&lt;br /&gt;observer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;observe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// ...later on, to stop observing changes:&lt;/span&gt;&lt;br /&gt;observer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;unobserve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;exposing-limited-information-via-thresholds-and-buckets&quot;&gt;Exposing limited information via thresholds and buckets &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#exposing-limited-information-via-thresholds-and-buckets&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;One of the key API design goals is to provide enough information for an
application to make useful decisions based on compute pressure, while not
exposing information that might
&lt;a href=&quot;https://github.com/oyiptong/compute-pressure/blob/main/security-privacy-self-assessment.md&quot; rel=&quot;noopener&quot;&gt;harm a user&#39;s privacy&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;With this in mind, the API reports normalized, unitless values between
&lt;code&gt;0.0&lt;/code&gt; and &lt;code&gt;1.0&lt;/code&gt; instead of more identifiable values like clock speeds in GHz.
The values passed to the callback fall into one of the &amp;quot;buckets&amp;quot; defined by the
thresholds used to configure the observer. The actual value will be the midpoint
between the upper and lower bounds for the bucket. In other words, they will be
values determined by how you configure the observer, and not based on the actual
device.&lt;/p&gt;
&lt;p&gt;To give an example, the configuration in the preceding section uses
&lt;code&gt;cpuUtilizationThresholds: [0.5, 0.75, 0.9]&lt;/code&gt;. This configuration sets up a total
of four possible buckets that the reported values might fall into, covering the
ranges 0.0 to 0.5, 0.5 to 0.75, 0.75 to 0.9, and 0.9 to 1.0. To represent bucket
membership, the value reported to the callback is the average between
the lower and upper bounds for the bucket.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A diagram illustrating the bucketing for different actual CPU utilizations&quot; decoding=&quot;async&quot; height=&quot;549&quot; loading=&quot;lazy&quot; src=&quot;https://web-dev.imgix.net/image/FNkVSAX8UDTTQWQkKftSgGe9clO2/VUrr3MykViLDtHuTkjYG.svg&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    This diagram illustrates the relationship between three thresholds and the
    four buckets that they form.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Here&#39;s how some &amp;quot;real&amp;quot; CPU utilization values, as reported by the operating
system to the browser, would be represented as values passed to your callback:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;quot;Real&amp;quot; 0% utilization would map to the 0.0 to 0.5 bucket, and would be
reported as &lt;code&gt;cpuUtilization: 0.25&lt;/code&gt;, since 0.25 is the average of 0.0 and 0.5.&lt;/li&gt;
&lt;li&gt;&amp;quot;Real&amp;quot; 40% utilization would similarly map to the 0.0 to 0.5 bucket, and be
reported as &lt;code&gt;cpuUtilization: 0.25&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&amp;quot;Real&amp;quot; 60% utilization would map to the 0.5 to 0.75 bucket, and be reported as
&lt;code&gt;cpuUtilization: 0.625&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&amp;quot;Real&amp;quot; 80% utilization would map to the 0.75 to 0.9 bucket, and be reported as
&lt;code&gt;cpuUtilization: 0.825&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The same threshold and bucket system applies to the exposed CPU speed values.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The values reported by the API reflect the overall state of the CPU,
due to utilization across all applications currently running. Therefore, even if
your own web application is almost entirely idle, you may see high utilization
and clock speed values reported, due to the activities of other applications.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;try-a-demo&quot;&gt;Try a demo &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#try-a-demo&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;When accessed on a browser that supports the origin trial (currently Chrome 92
or later), &lt;a href=&quot;https://googlechrome.github.io/samples/compute-pressure/index.html&quot; rel=&quot;noopener&quot;&gt;this demo&lt;/a&gt;
will display an ongoing readout of your device&#39;s CPU utilization and speed.&lt;/p&gt;
&lt;h2 id=&quot;api-status&quot;&gt;API status &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#api-status&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Step&lt;/th&gt;
&lt;th&gt;Status&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1. Create explainer&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/oyiptong/compute-pressure/blob/main/README.md&quot; rel=&quot;noopener&quot;&gt;Complete&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2. Create initial draft of specification&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://oyiptong.github.io/compute-pressure/&quot; rel=&quot;noopener&quot;&gt;In Progress&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3. Gather feedback &amp;amp; iterate on design&lt;/td&gt;
&lt;td&gt;In progress&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4. &lt;strong&gt;Origin trial&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://web.dev/compute-pressure/#ot&quot;&gt;In progress&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5. Launch&lt;/td&gt;
&lt;td&gt;Not started&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;api-availability&quot;&gt;API Availability &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#api-availability&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;ot&quot;&gt;Enabling support during the origin trial phase &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#ot&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Starting in Chrome 92, the Compute Pressure API can be used as part of an origin
trial.&lt;/p&gt;
&lt;p&gt;Origin trials allow you to try new features and give feedback on their
usability, practicality, and effectiveness to the web standards community. For
more information, see the &lt;a href=&quot;https://github.com/GoogleChrome/OriginTrials/blob/gh-pages/developer-guide.md&quot; rel=&quot;noopener&quot;&gt;Origin Trials Guide for Web Developers&lt;/a&gt;.
To sign up for this or another origin trial, visit the &lt;a href=&quot;https://developers.chrome.com/origintrials/#/trials/active&quot; rel=&quot;noopener&quot;&gt;registration page&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;register-for-ot&quot;&gt;Register for the origin trial &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#register-for-ot&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.chrome.com/origintrials/#/view_trial/1838594547874004993&quot; rel=&quot;noopener&quot;&gt;Request a token&lt;/a&gt; for your origin.&lt;/li&gt;
&lt;li&gt;Add the token to your pages. There are two ways to do that:
&lt;ul&gt;
&lt;li&gt;Add an &lt;code&gt;origin-trial&lt;/code&gt; &lt;code&gt;&amp;lt;meta&amp;gt;&lt;/code&gt; tag to the head of each page. For example,
this may look something like: &lt;br /&gt;
&lt;code&gt;&amp;lt;meta http-equiv=&amp;quot;origin-trial&amp;quot; content=&amp;quot;TOKEN_GOES_HERE&amp;quot;&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;If you can configure your server, you can also add the token
using an &lt;code&gt;Origin-Trial&lt;/code&gt; HTTP header. The resulting response header should
look something like:&lt;br /&gt;
&lt;code&gt;Origin-Trial: TOKEN_GOES_HERE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;enabling-via-about:flags&quot;&gt;Enabling via about://flags &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#enabling-via-about:flags&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To experiment with the API locally, without an origin trial token, enable the
&lt;code&gt;#enable-experimental-web-platform-features&lt;/code&gt; flag in about://flags.&lt;/p&gt;
&lt;h3 id=&quot;feature-detection&quot;&gt;Feature detection &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#feature-detection&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;You should check for the presence of &lt;code&gt;ComputePressureObserver&lt;/code&gt; in the &lt;code&gt;window&lt;/code&gt;
scope to see if the feature is available:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;ComputePressureObserver&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; window&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// The Compute Pressure API is available.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/compute-pressure/#acknowledgements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This blog post is derived on the sample code and
&lt;a href=&quot;https://github.com/oyiptong/compute-pressure/blob/main/README.md&quot; rel=&quot;noopener&quot;&gt;API explainer&lt;/a&gt;
created by Olivier Yiptong and Victor Costan.&lt;/p&gt;
&lt;p&gt;The hero image was created by Robert Anasch on
&lt;a href=&quot;https://unsplash.com/photos/-C7IKRBZHrg&quot; rel=&quot;noopener&quot;&gt;Unsplash&lt;/a&gt;. The diagram illustrating
bucketing was created by &lt;a href=&quot;https://web.dev/authors/adamargyle/&quot;&gt;Adam Argyle&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Jeff Posnick</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>CSS for Web Vitals</title>
      <link href="https://web.dev/css-web-vitals/"/>
      <updated>2021-06-02T00:00:00Z</updated>
      <id>https://web.dev/css-web-vitals/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;The way you write your styles and build layouts can have a major impact on &lt;a href=&quot;https://web.dev/learn-web-vitals&quot;&gt;Core
Web Vitals&lt;/a&gt;. This is particularly true for
&lt;a href=&quot;https://web.dev/cls&quot;&gt;Cumulative Layout Shift (CLS)&lt;/a&gt; and &lt;a href=&quot;https://web.dev/lcp&quot;&gt;Largest Contentful
Paint (LCP)&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This article covers CSS-related techniques for optimizing Web Vitals. These
optimizations are broken down by different aspects of a page: layout, images,
fonts, animations, and loading. Along the way, we&#39;ll explore improving an
&lt;a href=&quot;https://codepen.io/una/pen/vYyLKvY&quot; rel=&quot;noopener&quot;&gt;example page&lt;/a&gt;:&lt;/p&gt;
&lt;img alt=&quot;Screenshot of example site&quot; decoding=&quot;async&quot; height=&quot;646&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/pgmpMOmweK7BVBsVkQ5g.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;layout&quot;&gt;Layout &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#layout&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;inserting-content-into-the-dom&quot;&gt;Inserting content into the DOM &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#inserting-content-into-the-dom&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Inserting content into a page after the surrounding content has already loaded
pushes everything else on the page down. This causes &lt;a href=&quot;https://web.dev/cls/#layout-shifts-in-detail&quot;&gt;layout
shifts&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://web.dev/cookie-notice-best-practices/&quot;&gt;Cookie notices&lt;/a&gt;, particularly
those placed at the top of the page, are a common example of this problem. Other
page elements that often cause this type of layout shift when they load include
ads and embeds.&lt;/p&gt;
&lt;h4 id=&quot;identify&quot;&gt;Identify &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#identify&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The Lighthouse &amp;quot;Avoid large layout shifts&amp;quot; audit identifies page elements that
have shifted. For this demo, the results look like this:&lt;/p&gt;
&lt;img alt=&quot;Lighthouse&amp;#x27;s &amp;#x27;Avoid large layout shifts&amp;#x27; audit&quot; decoding=&quot;async&quot; height=&quot;500&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/jaHtgwzDXCjx3vAFOO33.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;The cookie notice is not listed in these findings because the cookie notice
itself isn&#39;t shifting when it loads. Rather, it causes the items below it on the
page (that is, &lt;code&gt;div.hero&lt;/code&gt; and &lt;code&gt;article&lt;/code&gt;) to shift. For more information on
identifying and fixing layout shifts, see &lt;a href=&quot;https://web.dev/debugging-layout-shifts&quot;&gt;Debugging Layout
Shifts&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Lighthouse only analyzes a page&#39;s performance up until the &amp;quot;page load&amp;quot; event.
Cookie banners, ads, and other widgets sometimes do not load until after page
load. These layout shifts still affect users—even if they are not flagged by
Lighthouse.&lt;/p&gt;
&lt;/div&gt;
&lt;h4 id=&quot;fix&quot;&gt;Fix &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#fix&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Place the cookie notice at the bottom of the page using absolute or fixed
positioning.&lt;/p&gt;
&lt;img alt=&quot;Cookie notice displayed at bottom of page&quot; decoding=&quot;async&quot; height=&quot;656&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/YBYLT9jJ9AXrbsaRNVoa.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Before:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.banner&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; sticky&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;After:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.banner&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; fixed&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;bottom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Another way to fix this layout shift would be to reserve space for the cookie
notice at the top of the screen. This approach is equally effective. For more
information, see &lt;a href=&quot;https://web.dev/cookie-notice-best-practices/&quot;&gt;Cookie notice best
practices&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The cookie notice is one of multiple page elements that are triggering layout
shifts when it loads. To help us get a closer look at these page elements,
subsequent demo steps will not include the cookie notice.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;images&quot;&gt;Images &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#images&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;images-and-largest-contentful-paint-(lcp)&quot;&gt;Images and Largest Contentful Paint (LCP) &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#images-and-largest-contentful-paint-(lcp)&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Images are commonly the Largest Contentful Paint (LCP) element on a page. Other
&lt;a href=&quot;https://web.dev/lcp/#what-elements-are-considered&quot;&gt;page elements that can be the LCP
element&lt;/a&gt; include text blocks
and video poster images. The time at which the LCP element loads determines LCP.&lt;/p&gt;
&lt;p&gt;It&#39;s important to note that a page&#39;s LCP element can vary from page load to page
load depending on the content that is visible to the user when the page is first
displayed. For example, in this demo, the background of the cookie notice, the
hero image, and the article text are some of the potential LCP elements.&lt;/p&gt;
&lt;img alt=&quot;Diagram highlighting the page&amp;#x27;s LCP element in different scenarios.&quot; decoding=&quot;async&quot; height=&quot;498&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/bMoAoohyLOgTqV6B7lHr.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;In the example site, the background image of the cookie notice is actually a
large image. To improve LCP, you could instead paint the gradient in CSS, rather
than load an image to create the effect.&lt;/p&gt;
&lt;h4 id=&quot;fix-2&quot;&gt;Fix &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#fix-2&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Change the &lt;code&gt;.banner&lt;/code&gt; CSS to use a CSS gradient rather than an image:&lt;/p&gt;
&lt;p&gt;Before:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&quot;https://cdn.pixabay.com/photo/2015/07/15/06/14/gradient-845701\_960\_720.jpg&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;After:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;linear-gradient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;135deg&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; #fbc6ff 20%&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; #bdfff9 90%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;images-and-layout-shifts&quot;&gt;Images and layout shifts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#images-and-layout-shifts&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Browsers can only determine the size of an image once the image loads. If the
image load occurs after the page has been rendered, but no space has been
reserved for the image, a layout shift occurs when the image appears. In the
demo, the hero image is causing a layout shift when it loads.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;The phenomenon of images causing layout shifts is more obvious in
situations where images are slow to load - for example, on a slow connection or
when loading an image with a particularly large file size.&lt;/p&gt;
&lt;/div&gt;
&lt;h4 id=&quot;identify-2&quot;&gt;Identify &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#identify-2&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;To identify images without explicit &lt;code&gt;width&lt;/code&gt; and &lt;code&gt;height&lt;/code&gt;, use Lighthouse&#39;s
&amp;quot;Image elements have explicit width and height&amp;quot; audit.&lt;/p&gt;
&lt;img alt=&quot;Lighthouse&amp;#x27;s &amp;#x27;Image elements have explicit width and height&amp;#x27; audit&quot; decoding=&quot;async&quot; height=&quot;274&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wDGRVi7JaUOTjD9ODOk9.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;In this example, both the hero image and article image are missing &lt;code&gt;width&lt;/code&gt; and
&lt;code&gt;height&lt;/code&gt; attributes.&lt;/p&gt;
&lt;h4 id=&quot;fix-3&quot;&gt;Fix &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#fix-3&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Set the &lt;code&gt;width&lt;/code&gt; and &lt;code&gt;height&lt;/code&gt; attributes on these images to avoid layout shifts.&lt;/p&gt;
&lt;p&gt;Before:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;img&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://source.unsplash.com/random/2000x600&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;image to load in&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;img&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://source.unsplash.com/random/800x600&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;image to load in&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;After:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;img&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://source.unsplash.com/random/2000x600&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;2000&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;600&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;image to load in&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;img&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://source.unsplash.com/random/800x600&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;800&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;600&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;image to load in&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/j2RDdG43oidUy6AL6LovThjeX9c2/fLUscMGOlGhKnNHef2py.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    The image now loads without causing a layout shift.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;Another approach to loading images is to use the
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/srcset&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;srcset&lt;/code&gt;&lt;/a&gt;
and
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;sizes&lt;/code&gt;&lt;/a&gt;
attributes in conjunction with specifying &lt;code&gt;width&lt;/code&gt; and &lt;code&gt;height&lt;/code&gt; attributes. This
has the additional performance advantage of allowing you to serve different
sized images to different devices. For more information, see &lt;a href=&quot;https://web.dev/serve-responsive-images/&quot;&gt;Serve responsive
images&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;fonts&quot;&gt;Fonts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#fonts&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Fonts can delay text rendering and cause layout shifts. As a result, it is
important to deliver fonts quickly.&lt;/p&gt;
&lt;h3 id=&quot;delayed-text-rendering&quot;&gt;Delayed text rendering &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#delayed-text-rendering&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;By default, a browser will not immediately render a text element if its
associated web fonts have not loaded yet. This is done to prevent a &lt;a href=&quot;https://en.wikipedia.org/wiki/Flash_of_unstyled_content&quot; rel=&quot;noopener&quot;&gt;&amp;quot;flash of
unstyled text&amp;quot; (FOUT)&lt;/a&gt;.
In many situations, this delays &lt;a href=&quot;https://web.dev/fcp&quot;&gt;First Contentful Paint
(FCP)&lt;/a&gt;. In some situations, this delays Largest Contentful
Paint (LCP).&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;By default, Chromium-based and Firefox browsers will &lt;a href=&quot;https://developers.google.com/web/updates/2016/02/font-display&quot; rel=&quot;noopener&quot;&gt;block text rendering for
up to 3 seconds&lt;/a&gt;
if the associated web font has not loaded; Safari will block text rendering
indefinitely. The &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display#the_font_display_timeline&quot; rel=&quot;noopener&quot;&gt;block
period&lt;/a&gt;
begins when the browser requests a web font. If the font has still not loaded by
the end of the block period, the browser will render the text using a fallback
font and swap in the web font once available.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;layout-shifts&quot;&gt;Layout shifts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#layout-shifts&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Font swapping, while excellent for displaying content to the user quickly, has
the potential to cause layout shifts. These layout shifts occur when a web font
and its fallback font take up different amounts of space on the page. Using
similarly proportioned fonts will minimize the size of these layout shifts.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Diagram showing a layout shift caused by a font swap&quot; decoding=&quot;async&quot; height=&quot;452&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/g0892nhvz3SnSaasaO1b.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    In this example, font swapping caused page elements to shift upwards by five pixels.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h4 id=&quot;identify-3&quot;&gt;Identify &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#identify-3&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;To see the fonts that are being loaded on a particular page, open the
&lt;strong&gt;Network&lt;/strong&gt; tab in DevTools and filter by &lt;strong&gt;Font&lt;/strong&gt;. Fonts can be large files, so
only using fewer fonts is generally better for performance.&lt;/p&gt;
&lt;img alt=&quot;Screenshot of a font displayed in DevTools&quot; decoding=&quot;async&quot; height=&quot;252&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/Ts38bQtR6x0SDgufA9vz.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;To see how long it takes for the font to be requested, click on the &lt;strong&gt;Timing&lt;/strong&gt;
tab. The sooner that a font is requested, the sooner it can be loaded and used.&lt;/p&gt;
&lt;img alt=&quot;Screenshot of &amp;#x27;Timing&amp;#x27; tab in DevTools&quot; decoding=&quot;async&quot; height=&quot;340&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/wfS7qVThKMkGA7SHd439.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;To see the request chain for a font, click on the  &lt;strong&gt;Initiator&lt;/strong&gt; tab.
Generally speaking, the shorter the request chain, the sooner the font can be
requested.&lt;/p&gt;
&lt;img alt=&quot;Screenshot of &amp;#x27;Initiator&amp;#x27; tab in DevTools&quot; decoding=&quot;async&quot; height=&quot;189&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/0tau1GQnZfj5vPhzwnIQ.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h4 id=&quot;fix-4&quot;&gt;Fix &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#fix-4&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;This demo uses the Google Fonts API. Google Fonts provides the option to load
fonts via &lt;code&gt;&amp;lt;link&amp;gt;&lt;/code&gt; tags or an &lt;code&gt;@import&lt;/code&gt; statement. The &lt;code&gt;&amp;lt;link&amp;gt;&lt;/code&gt; code snippet
includes a &lt;code&gt;preconnect&lt;/code&gt; resource hint. This should result in faster
stylesheet delivery than using the &lt;code&gt;@import&lt;/code&gt; version.&lt;/p&gt;
&lt;p&gt;At a very high-level, you can think of &lt;a href=&quot;https://www.w3.org/TR/resource-hints/#resource-hints&quot; rel=&quot;noopener&quot;&gt;resource
hints&lt;/a&gt; as a way to hint
to the browser that it will need to set up a particular connection or download a
particular resource. As a result, the browser will prioritize these actions.
When using resource hints, keep in mind that prioritizing a particular action
takes away browser resources from other actions. Thus, resource hints should be
used thoughtfully and not for everything. For more information, see &lt;a href=&quot;https://web.dev/preconnect-and-dns-prefetch/&quot;&gt;Establish
network connections early to improve perceived page
speed&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Remove the following &lt;code&gt;@import&lt;/code&gt; statement from your stylesheet:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@import&lt;/span&gt; &lt;span class=&quot;token url&quot;&gt;&lt;span class=&quot;token function&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string url&quot;&gt;&#39;https://fonts.googleapis.com/css2?family=Montserrat:wght@400&amp;amp;family=Roboto:wght@300&amp;amp;display=swap&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Add the following &lt;code&gt;&amp;lt;link&amp;gt;&lt;/code&gt; tags to the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; of the document:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;preconnect&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://fonts.googleapis.com&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;preconnect&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://fonts.gstatic.com&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;crossorigin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;https://fonts.googleapis.com/css2?family=Roboto:wght@100&amp;amp;display=swap&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;stylesheet&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;These link tags instruct the browser to establish an early connection to
the origins used by Google Fonts and to load the stylesheet that
contains the font declaration for Montserrat and Roboto. These &lt;code&gt;&amp;lt;link&amp;gt;&lt;/code&gt; tags
should be placed as early in the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; as possible.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;To only load a subset of a font from Google Fonts, add the
&lt;a href=&quot;https://developers.google.com/fonts/docs/getting_started&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;?text=&lt;/code&gt;&lt;/a&gt; API
parameter. For example, &lt;code&gt;?text=ABC&lt;/code&gt; loads only the characters necessary to
render &amp;quot;ABC&amp;quot;. This is a good way to reduce the file size of a font.&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;animations&quot;&gt;Animations &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#animations&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The primary way that animations affect Web Vitals is when they cause layout
shifts. There are two types of animations that you should avoid using:
&lt;a href=&quot;https://web.dev/animations-guide/#triggers&quot;&gt;animations that trigger layout&lt;/a&gt; and
&amp;quot;animation-like&amp;quot; effects that move page elements. Typically these animations can
be replaced with more performant equivalents by using CSS properties like
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/transform&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;transform&lt;/code&gt;&lt;/a&gt;,
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/opacity&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;opacity&lt;/code&gt;&lt;/a&gt;, and
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/CSS/filter&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;filter&lt;/code&gt;&lt;/a&gt;. For more
information, see &lt;a href=&quot;https://web.dev/animations/&quot;&gt;How to create high-performance CSS
animations&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;identify-4&quot;&gt;Identify &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#identify-4&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The Lighthouse &amp;quot;Avoid non-composited animations&amp;quot; audit may be helpful for
identifying non-performant animations.&lt;/p&gt;
&lt;img alt=&quot;Lighthouse&amp;#x27;s &amp;#x27;Avoid non-composited animations&amp;#x27; audit&quot; decoding=&quot;async&quot; height=&quot;132&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 512px) 512px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/j2RDdG43oidUy6AL6LovThjeX9c2/mXgypW9x3qgvmWDLbIZx.png?auto=format&amp;w=1024 1024w&quot; width=&quot;512&quot; /&gt;
&lt;div class=&quot;w-aside w-aside--caution&quot;&gt;
&lt;p&gt;&lt;strong&gt;Caution&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;The Lighthouse &amp;quot;Avoid non-composited animations&amp;quot; audit only identifies
non-performant &lt;em&gt;CSS animations&lt;/em&gt;; JavaScript-driven animations (for example,
using
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;setInterval()&lt;/code&gt;&lt;/a&gt;
to &amp;quot;animate&amp;quot; an element) are bad for performance but will not be flagged by this
audit.&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&quot;fix-5&quot;&gt;Fix &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#fix-5&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Change the &lt;code&gt;slideIn&lt;/code&gt; animation sequence to use &lt;code&gt;transform: translateX()&lt;/code&gt; rather
than transitioning the&lt;code&gt;margin-left&lt;/code&gt; property.&lt;/p&gt;
&lt;p&gt;Before:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.header&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; slideIn 1s 1 ease&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@keyframes&lt;/span&gt; slideIn&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;margin-left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; -100%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;margin-left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;After:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.header&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; slideIn 1s 1 ease&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@keyframes&lt;/span&gt; slideIn&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;translateX&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;-100%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;translateX&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;critical-css&quot;&gt;Critical CSS &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#critical-css&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Stylesheets are render-blocking. This means that the browser encounters a
stylesheet, it will stop downloading other resources until the browser has
downloaded and parsed the stylesheet. This may delay LCP. To improve
performance, consider &lt;a href=&quot;https://css-tricks.com/how-do-you-remove-unused-css-from-a-site/&quot; rel=&quot;noopener&quot;&gt;removing unused
CSS&lt;/a&gt;,
&lt;a href=&quot;https://web.dev/extract-critical-css/&quot;&gt;inlining critical CSS&lt;/a&gt;, and &lt;a href=&quot;https://web.dev/defer-non-critical-css/#optimize&quot;&gt;deferring
non-critical CSS&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/css-web-vitals/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Although there is still room for further improvements (for example, using &lt;a href=&quot;https://web.dev/use-imagemin-to-compress-images/&quot;&gt;image
compression&lt;/a&gt; to deliver images
more quickly), these changes have significantly improved the Web Vitals of this
site. If this were a real site, the next step would be to &lt;a href=&quot;https://web.dev/vitals-measurement-getting-started/#measuring-web-vitals-using-rum-data&quot;&gt;collect performance
data from real
users&lt;/a&gt;
to assess whether it is &lt;a href=&quot;https://web.dev/vitals-measurement-getting-started/#data-interpretation&quot;&gt;meeting the Web Vitals thresholds for most
users&lt;/a&gt;.
For more information about Web Vitals, see &lt;a href=&quot;https://web.dev/learn-web-vitals&quot;&gt;Learn Web
Vitals&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Katie Hempenius</name>
        </author><author>
          <name>Una Kravets</name>
        </author>
    </entry>
    
</feed>
