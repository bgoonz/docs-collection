
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=356b87b4c2835">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Virtual reality comes to the web</title>
<meta name="description" content="Virtual reality came to the web in Chrome 79. Based on the WebXR Devicer API, this launch is the foundation for both augmented and virtual reality. This article is the first in a series, exploring basic concepts and describing how to enter an XR session. Other browsers will soon be supporting the WebXR Device API, including Firefox Reality, Oculus Browser, Edge and Magic Leap's Helio browser, among others." />

<link rel="canonical" href="https://web.dev/vr-comes-to-the-web/" />

<meta itemprop="name" content="Virtual reality comes to the web" />
<meta itemprop="description" content="Virtual reality came to the web in Chrome 79. Based on the WebXR Devicer API, this launch is the foundation for both augmented and virtual reality. This article is the first in a series, exploring basic concepts and describing how to enter an XR session. Other browsers will soon be supporting the WebXR Device API, including Firefox Reality, Oculus Browser, Edge and Magic Leap's Helio browser, among others." />
<meta itemprop="image" content="https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/vr-comes-to-the-web/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Virtual reality comes to the web" />
<meta property="og:description" content="Virtual reality came to the web in Chrome 79. Based on the WebXR Devicer API, this launch is the foundation for both augmented and virtual reality. This article is the first in a series, exploring basic concepts and describing how to enter an XR session. Other browsers will soon be supporting the WebXR Device API, including Firefox Reality, Oculus Browser, Edge and Magic Leap's Helio browser, among others." />
<meta property="og:image" content="https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="A person using a virtual reality headset." />
<meta property="tag" content="augmented-reality" />
<meta property="tag" content="virtual-reality" />
<meta property="tag" content="webxr" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Virtual reality comes to the web" />
<meta name="twitter:description" content="Virtual reality came to the web in Chrome 79. Based on the WebXR Devicer API, this launch is the foundation for both augmented and virtual reality. This article is the first in a series, exploring basic concepts and describing how to enter an XR session. Other browsers will soon be supporting the WebXR Device API, including Firefox Reality, Oculus Browser, Edge and Magic Leap's Helio browser, among others." />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>








<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=aca81417523d6', 'module');




  loadScript('/js/content.js?v=9b014f307dfb7', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="30" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
      
    
    


<div class="guide-landing-page">
  
  

  
    <img     alt="A person using a virtual reality headset."     class="w-hero w-hero--cover"     decoding="auto"     height="480"               sizes="100vw"     src="https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/5TAFoyhWvniJzDchNzPT.jpg?auto=format&w=1600 1600w"          width="1600"   />
  

  <web-table-of-contents>
    <h2 class="w-toc__header">
      <a href="#virtual-reality-comes-to-the-web" class="w-toc__header--link">
        Virtual reality comes to the web
      </a>
    </h2>
    <div class="w-toc__list">
        <ul><li><a href="#what-is-the-immersive-web">What is the immersive web?</a></li><li><a href="#concepts-and-usage">Concepts and usage</a></li><li><a href="#request-a-session">Request a session</a></li><li><a href="#enter-a-session">Enter a session</a></li><li><a href="#run-a-frame-loop">Run a frame loop</a></li><li><a href="#end-the-session">End the session</a></li><li><a href="#conclusion">Conclusion</a></li></ul></div>
  </web-table-of-contents>
  <web-table-of-contents-button></web-table-of-contents-button>

  
  <div class="w-actions">
    <share-action authors="@medleyjp"
      class="gc-analytics-event w-actions__fab w-actions__fab--share"
      data-category="web.dev"
      data-label="share"
      data-action="click"
      data-icon="share"
      tabindex="0"
      role="button"
    >
      <span>Share</span>
    </share-action>
    <a class="w-actions__fab w-actions__fab--subscribe gc-analytics-event" data-category="web.dev" data-label="view-subscribe" data-action="click" href="/newsletter/">
  <span>subscribe</span>
</a>

  </div>

  <div class="w-layout-container--narrow w-post-content">
    <header class="w-article-header">
      
        <div class="w-post-breadcrumbs">
          <ul class="w-breadcrumbs">
  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link w-breadcrumbs__link--left-justify gc-analytics-event"
      data-category="web.dev"
      data-label="post, home breadcrumb"
      data-action="click"
      href="/"
    >
      Home
    </a>
  </li>

  <svg
    class="w-breadcrumbs__icon"
    xmlns="http://www.w3.org/2000/svg"
    height="24"
    viewBox="0 0 24 24"
    width="24"
    aria-hidden="true"
  >
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z" />
  </svg>

  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link gc-analytics-event"
      data-category="web.dev"
      data-label="post, path breadcrumb"
      data-action="click"
      href=/blog
    >
      All articles
    </a>
  </li>
</ul>
        </div>
      

      <h1 id="virtual-reality-comes-to-the-web" class="w-article-header__headline">Virtual reality comes to the web</h1>
      
        <p class="w-article-header__subhead w-mb--non">
          A few basics to prepare you for a spectrum of immersive experiences: virtual reality, augmented reality, and everything in between.
        </p>
      

      
        <div class="w-author__published">
          <time>Oct 31, 2019</time>
           <span class="w-author__separator">•</span> Updated <time>Mar 2, 2020</time> 
        </div>
      
      

      
        <div class="w-authors w-mt--xl w-pt--sm">
          
            <div class="w-author">
  <a href="/authors/joemedley/"><img     alt="Joe Medley"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/ynJFmvKEbD9diZZsTdkD.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/ynJFmvKEbD9diZZsTdkD.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/ynJFmvKEbD9diZZsTdkD.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/ynJFmvKEbD9diZZsTdkD.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/ynJFmvKEbD9diZZsTdkD.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/ynJFmvKEbD9diZZsTdkD.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/joemedley/">Joe Medley</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/medleyjp"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/jpmedley">GitHub</a>
      </li>
      
      
    </ul>
  </div>
</div>
          
        </div>
      
    </header>

    

    <p>Immersive experiences came to the web in Chrome 79. The WebXR Device API brings
virtual reality brought virtual reality, while support for augmented reality
arrives in Chrome 81. While an update to the GamePad API extends the advanced
use of controlls to VR. Other browsers will be supporting these specs soon,
including Firefox Reality, Oculus Browser, Edge and Magic Leap's Helio browser,
among others.</p>
<p>This article begins a series on the immersive web. This installment covers
setting up a basic WebXR application as well as entering and exiting an XR
session. Later articles will cover the frame loop (the workhorse of WebXR
experience), the specifics of augmented reality, and the WebXR Hit Test API, a
means of detecting surfaces in an AR session. Unless stated otherwise,
everything I cover in this and succeeding articles applies equally to both AR
and VR.</p>
<h2 id="what-is-the-immersive-web">What is the immersive web? <a class="w-headline-link" href="#what-is-the-immersive-web">#</a></h2>
<p>Though we use two terms to describe immersive experiences—augmented
reality and virtual reality—many think of them on a spectrum from complete
reality to completely virtual, with degrees of immersion in between. The 'X' in
XR is intended to reflect that thinking by being a sort of algebraic variable
that stands for anything in the spectrum of immersive experiences.</p>
<figure class="w-figure">
  <img     alt="A graph illustrating the spectrum of visual experiences from complete reality to completely immersive."          decoding="async"     height="204"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/iQ99APUTFIgjdRPyS1C4.png?auto=format&w=1600 1600w"          width="800"   />
  <figcaption class="w-figcaption w-figcaption--fullbleed">
    The spectrum of immersive experiences
  </figcaption>
</figure
<p>Examples of immersive experiences include:</p>
<ul>
<li>Games</li>
<li>360° videos</li>
<li>Traditional 2D (or 3D) videos presented in immersive surroundings</li>
<li>Home buying</li>
<li>Viewing products in your home before you buy them</li>
<li>Immersive art</li>
<li>Something cool nobody's thought of yet</li>
</ul>
<h2 id="concepts-and-usage">Concepts and usage <a class="w-headline-link" href="#concepts-and-usage">#</a></h2>
<p>I'll explain a few basics of using the WebXR Device API. If you need more depth
than I've provided, check out the Immersive Web Working Group's <a href="https://immersive-web.github.io/webxr-samples/" rel="noopener">WebXR
samples</a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebXR_Device_API" rel="noopener">MDN's growing
reference
materials</a>.
If you're familiar with early versions of the WebXR Device API, you should
glance over all of this material. There have been changes.</p>
<p>The code in this article is based on the Immersive Web Working Group's barebones
sample (<a href="https://immersive-web.github.io/webxr-samples/vr-barebones.html" rel="noopener">demo</a>,
<a href="https://github.com/immersive-web/webxr-samples/blob/master/vr-barebones.html" rel="noopener">source</a>),
but is edited for clarity and simplicity.</p>
<p>Part of creating the WebXR specification has been fleshing out security and
privacy measures to protect users. Consequently, implementations must adhere to
certain requirements. A web page or app must be active and focused before it can
request anything sensitive from the viewer. Web pages or apps must be served
over HTTPS. The API itself is designed to protect information obtained from
sensors and cameras, which it needs in order to function.</p>
<h3 id="request-a-session">Request a session <a class="w-headline-link" href="#request-a-session">#</a></h3>
<p>Entering an XR session requires a user gesture. To get that, use feature
detection to test for <code>XRSystem</code> (via <code>navigator.xr</code>) and make a call to
<code>XRSystem.isSessionSupported()</code>. Be aware that in Chrome versions 79 and 80 the
<code>XRSystem</code> object was called <code>XR</code>.</p>
<p>In the example below, I've indicated that I
want a virtual reality session with the <code>'immersive-vr'</code> session type. The
<a href="https://developer.mozilla.org/en-US/docs/Web/API/XR/isSessionSupported#Syntax" rel="noopener">other session
types</a>
are <code>'immersive-ar'</code> and <code>'inline'</code>. An inline session is for presenting content
within HTML and is mainly used for teaser content. The <a href="https://immersive-web.github.io/webxr-samples/immersive-ar-session.html" rel="noopener">Immersive AR
Session</a>
sample demonstrates this. I'll explain that in a later article.</p>
<p>Once I know that virtual reality sessions are supported, I enable a button that
lets me acquire a user gesture.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>xr<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> supported <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>xr<span class="token punctuation">.</span><span class="token function">isSessionSupported</span><span class="token punctuation">(</span><span class="token string">'immersive-vr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>supported<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    xrButton<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> onButtonClicked<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    xrButton<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'Enter VR'</span><span class="token punctuation">;</span><br>    xrButton<span class="token punctuation">.</span>enabled <span class="token operator">=</span> supported<span class="token punctuation">;</span> <span class="token comment">// supported is Boolean</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>After enabling the button, I wait for a click event then request a session.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> xrSession <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br><span class="token keyword">function</span> <span class="token function">onButtonClicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>xrSession<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    navigator<span class="token punctuation">.</span>xr<span class="token punctuation">.</span><span class="token function">requestSession</span><span class="token punctuation">(</span><span class="token string">'immersive-vr'</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">session</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      xrSession <span class="token operator">=</span> session<span class="token punctuation">;</span><br>      xrButton<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'Exit XR'</span><span class="token punctuation">;</span><br>      <span class="token function">onSessionStarted</span><span class="token punctuation">(</span>xrSession<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    xrSession<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>Notice the object hierarchy in this code. It moves from <code>navigator</code> to <code>xr</code> to
an <code>XRSession</code> instance. In early versions of the API, a script had to request a
device before requesting a session. Now, the device is acquired implicitly.</p>
<h3 id="enter-a-session">Enter a session <a class="w-headline-link" href="#enter-a-session">#</a></h3>
<p>After getting a session, I need to start it and enter it. But first, I need to
set up a few things. A session needs an <code>onend</code> event handler so that the app or
web page can be reset when the user exits.</p>
<p>I'll also need a <code>&lt;canvas&gt;</code> element to draw my scene on. It needs to be an
XR-compatible
<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext" rel="noopener">WebGLRenderingContext</a>
or
<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext" rel="noopener">WebGL2RenderingContext</a>.
All drawing is done using them or a WebGL-based framework such as
<a href="https://threejs.org/" rel="noopener">Three.js</a>.</p>
<p>Now that I have a place to draw, I need a source of content to draw on
it. For that, I create an instance of <code>XRWebGLLayer</code>. I associate it with the
canvas by calling <code>XRSession.updateRenderState()</code>.</p>
<p>Once I'm in a session, I need a way of determining where things are in virtual
reality. I'll need a reference space. A <code>'local-floor'</code> reference space is one
where the origin is located near the viewer and the y-axis is 0 at floor level
and is not expected to move. There are <a href="https://developer.mozilla.org/en-US/docs/Web/API/XRSession/requestReferenceSpace" rel="noopener">other types of reference
spaces</a>,
but that is a more complicated topic than I can go into here. I save the
reference space to a variable because I'll need it when I draw to the screen.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onSessionStarted</span><span class="token punctuation">(</span><span class="token parameter">xrSession</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  xrSession<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> onSessionEnded<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">let</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  webGLRenContext <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'webgl'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> xrCompatible<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  xrSession<span class="token punctuation">.</span><span class="token function">updateRenderState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>    baseLayer<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">XRWebGLLayer</span><span class="token punctuation">(</span>xrSession<span class="token punctuation">,</span> webGLRenContext<span class="token punctuation">)</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  xrSession<span class="token punctuation">.</span><span class="token function">requestReferenceSpace</span><span class="token punctuation">(</span><span class="token string">'local-floor'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">refSpace</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    xrRefSpace <span class="token operator">=</span> refSpace<span class="token punctuation">;</span><br>    xrSession<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>onXRFrame<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>After getting a reference space, I call <code>XRSession.requestAnimationFrame()</code>.
This is the start of presenting virtual content, which is done in the frame
loop.</p>
<h3 id="run-a-frame-loop">Run a frame loop <a class="w-headline-link" href="#run-a-frame-loop">#</a></h3>
<p>The frame loop is a user-agent controlled infinite loop in which content is
repeatedly drawn to the screen. Content is drawn in discrete blocks called
frames. The succession of frames creates the illusion of movement. For VR
applications the frames per second can be anywhere from 60 to 144. AR for
Android runs at 30 frames per second. Your code should not assume any particular
frame rate.</p>
<p>The basic process for the frame loop is:</p>
<ol>
  <li>Call <code>XRSession.requestAnimationFrame()</code>. In response, the user agent invokes the <code>XRFrameRequestCallback</code>, which is defined by you.</li>
  <li>Inside your callback function:
    <ol>
      <li>Call <code>XRSession.requestAnimationFrame()</code> again.</li>
      <li>Get the viewer's pose.</li>
      <li>Pass ('bind') the <code>WebGLFramebuffer</code> from the <code>XRWebGLLayer</code> to the <code>WebGLRenderingContext</code>.</li>
      <li>Iterate over each <code>XRView</code> object, retrieving its <code>XRViewport</code> from the <code>XRWebGLLayer</code> and passing it to the <code>WebGLRenderingContext</code>.</li>
      <li>Draw something to the framebuffer.</li>
    </ol>
  </li>
</ol>
<p>The remainder of this article describes step 1 and part of step 2,  setting up
and calling the <code>XRFrameRequestCallback</code>. The remaining items of step 2 are
covered in part II.</p>
<h4 id="the-xrframerequestcallback">The XRFrameRequestCallback <a class="w-headline-link" href="#the-xrframerequestcallback">#</a></h4>
<p>The <code>XRFrameRequestCallback</code> is defined by you. It takes two parameters: a
<code>DOMHighResTimeStamp</code> and an <code>XRFrame</code> instance. The <code>XRFrame</code> object provides
the information needed to render a single frame to the display. The
<code>DOMHighResTimeStamp</code> argument is for future use.</p>
<p>Before doing anything else, I'm going to request the next animation frame. As
previously stated, the timing of frames is determined by the user agent based on
the underlying hardware. Requesting the next frame first ensures that
the frame loop continues if something during the callback throws an error.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onXRFrame</span><span class="token punctuation">(</span><span class="token parameter">hrTime<span class="token punctuation">,</span> xrFrame</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">let</span> xrSession <span class="token operator">=</span> xrFrame<span class="token punctuation">.</span>session<span class="token punctuation">;</span><br>  xrSession<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>onXRFrame<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Render a frame.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>At this point, it's time to draw something for the viewer. That's a discussion
for part II. Before going there, let me show you how to end a session.</p>
<h3 id="end-the-session">End the session <a class="w-headline-link" href="#end-the-session">#</a></h3>
<p>An immersive session may end for several reasons including ending by your own
code through a call to <code>XRSession.end()</code>. Other causes include the headset being
disconnected or another application taking control of it. This is why a
well-behaved application should monitor the <code>end</code> event. When it occurs, discard
the session and its related render objects. An ended immersive session cannot be
resumed. To reenter the immersive experience, my app needs to start a new
session.</p>
<p>Recall from <a href="#entering-a-session">Entering a session</a> that during setup, I added
an <code>onend</code> event handler.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onSessionStarted</span><span class="token punctuation">(</span><span class="token parameter">xrSession</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  xrSession<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> onSessionEnded<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// More setup…</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>Inside the event handler, restore the state of the app before the user entered a
session.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">onSessionEnded</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  xrSession <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>  xrButton<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'Enter VR'</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h2 id="conclusion">Conclusion <a class="w-headline-link" href="#conclusion">#</a></h2>
<p>I haven't explained everthing you need to write a Web XR or AR application.
Hopefull, I've give  you enought to start making sense of the code for yourself,
and enough to start experimenting. In the next article, I'll explain the frame
loop, which is where content is drawn to the screen.</p>
<p>Photo by <a href="https://unsplash.com/@jeshoots" rel="noopener">JESHOOTS.COM</a> on <a href="https://unsplash.com/" rel="noopener">Unsplash</a></p>


    

    
  <div class="w-chips ">
    
      
    
      
    
      
        
        <a class="w-chip" href="/tags/augmented-reality/">Augmented Reality</a>
      
    
      
        
        <a class="w-chip" href="/tags/virtual-reality/">Virtual Reality</a>
      
    
      
        
        <a class="w-chip" href="/tags/webxr/">WebXR</a>
      
    
  </div>


    <div class="w-post-github-link w-mt--l w-mb--l">
      <span class="w-mr--sm">
        
        Last updated: <time>Mar 2, 2020</time>
        
      </span>
      <a
        href="https://github.com/GoogleChrome/web.dev/blob/master/src/site/content/en/blog/vr-comes-to-the-web/index.md"
      >
        Improve article
      </a>
       
    </div>

    
    <web-feedback additional-questions="api"></web-feedback>
  </div>

  
    
    <nav class="w-article-navigation">
  <a
    class="w-article-navigation__link w-article-navigation__link--back
      w-article-navigation__link--single gc-analytics-event"
    data-category="web.dev"
    data-label="navigation, go back"
    data-action="click"
    href="/blog"
  >
    Return to all articles
  </a>
</nav>
  
</div>

  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://devwebfeed.appspot.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">
              DevWeb Content Firehose
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/@ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/home"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
